!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("three"),require("react"),require("js-clipper"),require("pako"),require("stats.js")):"function"==typeof define&&define.amd?define(["three","react","js-clipper","pako","stats.js"],e):"object"==typeof exports?exports.REALITYREMOD=e(require("three"),require("react"),require("js-clipper"),require("pako"),require("stats.js")):t.REALITYREMOD=e(t.three,t.react,t["js-clipper"],t.pako,t["stats.js"])}(window,(function(__WEBPACK_EXTERNAL_MODULE__1__,__WEBPACK_EXTERNAL_MODULE__18__,__WEBPACK_EXTERNAL_MODULE__59__,__WEBPACK_EXTERNAL_MODULE__60__,__WEBPACK_EXTERNAL_MODULE__65__){return function(t){var e={};function i(n){if(e[n])return e[n].exports;var a=e[n]={i:n,l:!1,exports:{}};return t[n].call(a.exports,a,a.exports,i),a.l=!0,a.exports}return i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)i.d(n,a,function(e){return t[e]}.bind(null,a));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="dist/",i(i.s=14)}([function(t,e,i){"use strict";i.d(e,"c",(function(){return n.c})),i.d(e,"r",(function(){return n.t})),i.d(e,"I",(function(){return n.H})),i.d(e,"h",(function(){return n.h})),i.d(e,"i",(function(){return n.i})),i.d(e,"g",(function(){return n.g})),i.d(e,"H",(function(){return n.G})),i.d(e,"z",(function(){return n.C})),i.d(e,"y",(function(){return n.B})),i.d(e,"s",(function(){return n.u})),i.d(e,"E",(function(){return n.E})),i.d(e,"x",(function(){return n.A})),i.d(e,"w",(function(){return n.z})),i.d(e,"o",(function(){return n.o})),i.d(e,"m",(function(){return n.m})),i.d(e,"l",(function(){return n.l})),i.d(e,"n",(function(){return n.n})),i.d(e,"b",(function(){return n.b})),i.d(e,"d",(function(){return n.d})),i.d(e,"a",(function(){return n.a})),i.d(e,"A",(function(){return n.D})),i.d(e,"F",(function(){return n.F})),i.d(e,"p",(function(){return n.p})),i.d(e,"q",(function(){return n.q})),i.d(e,"f",(function(){return n.f})),i.d(e,"v",(function(){return n.y})),i.d(e,"u",(function(){return n.x})),i.d(e,"t",(function(){return n.v})),i.d(e,"J",(function(){return n.I})),i.d(e,"e",(function(){return n.e})),i.d(e,"j",(function(){return n.j})),i.d(e,"k",(function(){return n.k})),i.d(e,"G",(function(){return s})),i.d(e,"D",(function(){return o})),i.d(e,"C",(function(){return r})),i.d(e,"B",(function(){return h}));var n=i(12),a=i(27);class s{static isNodeIndexed(t){switch(t.data.type){case n.t.DTPattern:case n.t.DTTileInst:case n.t.DTBackgroundImage:case n.t.DTTiledLayer:case n.t.DTLight:case n.t.DTLightList:case n.t.DTMaskList:case n.t.DTMask:case n.t.DTRug:case n.t.DTPrjData:case n.t.DTCorridor:return!0;case n.t.DTFace3D:{const e=t.data;if(e.flags&(n.i.FF_COVER|n.i.FF_WALL))return!0;if(n.J(e.classId))return!0;break}}return!1}constructor(){this.projectChanged=new a.a,this.onBeforeSave=new a.a,this.createNew()}unserialize(t){this.root=JSON.parse(t,n.c.reviver),this.root.enableIndex(s.isNodeIndexed)}createNew(){this.root=new n.c(new n.w),this.root.enableIndex(s.isNodeIndexed);const t=new n.r;t.data.set(1,r),t.data.set(2,o);const e=new n.c(t);this.root.appendChild(e),this.projectChanged.notify({type:"LOADED"})}loadNew(t,e=!0){this.unserialize(t),e&&this.projectChanged.notify({type:"LOADED"})}restore(t){const e=this.save();this.unserialize(t),this.projectChanged.notify({type:"RESTORED",previousState:e})}save(){return this.onBeforeSave.notify(this),JSON.stringify(this.root)}clone(){const t=new s,e=this.save();return t.root=JSON.parse(e,n.c.reviver),t}removePattern(t){if(t.data.type!==n.t.DTPattern)throw new Error("Invalid node type");t.parentNode.removeChildById(t.id),this.projectChanged.notify({type:"PATTERN_REMOVED",node:t})}removeTileList(t){if(t.data.type!==n.t.DTTileList)throw new Error("Invalid node type");if(t.countAllChildrenByType(n.t.DTPattern,!0)>0)throw new Error("DTPattern nodes must be removed before DTTileList");t.parentNode.removeChildById(t.id),this.projectChanged.notify({type:"TILELIST_REMOVED",node:t})}addBackgroundImage(t){if(t.data.type!==n.t.DTBackgroundImage)throw new Error("Invalid node type");this.root.appendChild(t),this.projectChanged.notify({type:"BACKGROUNDIMAGE_ADDED",node:t})}addTiledLayer(t){if(t.data.type!==n.t.DTTiledLayer)throw new Error("Invalid node type");this.root.appendChild(t),this.projectChanged.notify({type:"TILEDLAYER_ADDED",node:t})}removeTiledLayer(t){if(t.data.type!==n.t.DTTiledLayer)throw new Error("Invalid node type");this.root.removeChildById(t.id),this.projectChanged.notify({type:"TILEDLAYER_REMOVED",node:t})}addMaskListNode(t){if(t.data.type!==n.t.DTMaskList)throw new Error("Invalid node type");this.root.appendChild(t),this.projectChanged.notify({type:"MASKLIST_ADDED",node:t})}addGroupListNode(t){if(t.data.type!==n.t.DTGroupList)throw new Error("Invalid node type");this.root.appendChild(t)}addRug(t){if(t.data.type!==n.t.DTRug)throw new Error("Invalid node type");this.root.appendChild(t),this.projectChanged.notify({type:"RUG_ADDED",node:t})}removeRug(t){if(t.data.type!==n.t.DTRug)throw new Error("Invalid node type");this.root.removeChildById(t.id),this.projectChanged.notify({type:"RUG_REMOVED",node:t})}getMaterialList(){const t=this.root.getChildNodes(!1);if(t.moveNextByType(n.t.DTMaterialList))return t.current;const e=new n.c(new n.r);return this.root.appendChild(e),e}addMaterialKey(t){const e=this.getMaterialList().data;let i=0,n=0;return e.data.forEach(((e,a)=>{t.manufacturer===e.manufacturer&&t.name===e.name&&(n=a),a>i&&(i=a)})),n>0?n:(i++,e.data.set(i,t),i)}getMaterialKey(t){return this.getMaterialList().data.data.get(t)}getMaterialKeyFromId(t){return this.getMaterialList().data.data.get(t)}walkOnAllChildrenOfType(t,e){if(t!==n.t.DTTileInst)throw new Error("Please implement a smart walk on project tree!!!!");this.root.walkOnAllChildrenByCbk((e=>e.data.type==t),!0,e)}static getTiledLayerPattern(t){if(t.data.type!==n.t.DTTiledLayer)throw new Error("Invalid node type");const e=t.getFirstChildOfType(n.t.DTFace3D).getFirstChildOfType(n.t.DTTileList);if(e){return e.getFirstChildOfType(n.t.DTPattern)}return null}static getTileListObject3D(t){if(t.data.type!==n.t.DTTileList)throw new Error("Invalid node type");return t.parentNode.parentNode}static getTileListFace3D(t){if(t.data.type!==n.t.DTTileList)throw new Error("Invalid node type");return t.parentNode}static getPatternTiledLayer(t){if(t.data.type!==n.t.DTPattern)throw new Error("Invalid node type");return t.parentNode.parentNode.parentNode}static getPatternFace3D(t){if(t.data.type!==n.t.DTPattern)throw new Error("Invalid node type");return t.parentNode.parentNode}static getPatternTileList(t){if(t.data.type!==n.t.DTPattern)throw new Error("Invalid node type");return t.parentNode}static getTileInstFace3D(t){if(t.data.type!==n.t.DTTileInst)throw new Error("Invalid node type");return t.parentNode.parentNode.parentNode}static getTileInstTileList(t){if(t.data.type!==n.t.DTTileInst)throw new Error("Invalid node type");return t.parentNode.parentNode}static getTileInstPattern(t){if(t.data.type!==n.t.DTTileInst)throw new Error("Invalid node type");return t.parentNode}static getFace3DTiledLayer(t){if(t.data.type!==n.t.DTFace3D)throw new Error("Invalid node type");return t.parentNode}}const o=new n.G("GENERIC","DefaultWall"),r=new n.G("GENERIC","DefaultFloor"),h=new n.G("GENERIC","DefaultBorder")},function(t,e){t.exports=__WEBPACK_EXTERNAL_MODULE__1__},function(t,e,i){"use strict";i.d(e,"a",(function(){return n.a})),i.d(e,"b",(function(){return a.e})),i.d(e,"e",(function(){return a.h})),i.d(e,"f",(function(){return a.i})),i.d(e,"c",(function(){return a.f})),i.d(e,"d",(function(){return a.g}));var n=i(39),a=i(28)},function(t,e,i){"use strict";var n;i.d(e,"Q",(function(){return n})),i.d(e,"zb",(function(){return s})),i.d(e,"Ab",(function(){return o})),i.d(e,"K",(function(){return h})),i.d(e,"L",(function(){return l})),i.d(e,"I",(function(){return c})),i.d(e,"J",(function(){return d})),i.d(e,"O",(function(){return p})),i.d(e,"P",(function(){return g})),i.d(e,"m",(function(){return x})),i.d(e,"n",(function(){return T})),i.d(e,"fb",(function(){return E})),i.d(e,"gb",(function(){return D})),i.d(e,"w",(function(){return w})),i.d(e,"x",(function(){return S})),i.d(e,"q",(function(){return I})),i.d(e,"r",(function(){return L})),i.d(e,"u",(function(){return A})),i.d(e,"v",(function(){return O})),i.d(e,"a",(function(){return _})),i.d(e,"b",(function(){return k})),i.d(e,"C",(function(){return F})),i.d(e,"D",(function(){return z})),i.d(e,"Sb",(function(){return H})),i.d(e,"Tb",(function(){return U})),i.d(e,"T",(function(){return G})),i.d(e,"U",(function(){return V})),i.d(e,"i",(function(){return K})),i.d(e,"j",(function(){return Y})),i.d(e,"qc",(function(){return $})),i.d(e,"rc",(function(){return X})),i.d(e,"Db",(function(){return Q})),i.d(e,"Eb",(function(){return Z})),i.d(e,"vb",(function(){return et})),i.d(e,"wb",(function(){return it})),i.d(e,"Yb",(function(){return ot})),i.d(e,"Zb",(function(){return rt})),i.d(e,"M",(function(){return lt})),i.d(e,"N",(function(){return ct})),i.d(e,"nb",(function(){return ut})),i.d(e,"ob",(function(){return pt})),i.d(e,"G",(function(){return gt})),i.d(e,"H",(function(){return mt})),i.d(e,"g",(function(){return Tt})),i.d(e,"h",(function(){return Mt})),i.d(e,"o",(function(){return Ct})),i.d(e,"p",(function(){return bt})),i.d(e,"c",(function(){return Pt})),i.d(e,"d",(function(){return Et})),i.d(e,"E",(function(){return Dt})),i.d(e,"F",(function(){return wt})),i.d(e,"Ob",(function(){return St})),i.d(e,"Pb",(function(){return It})),i.d(e,"pb",(function(){return At})),i.d(e,"qb",(function(){return Ot})),i.d(e,"A",(function(){return kt})),i.d(e,"B",(function(){return jt})),i.d(e,"eb",(function(){return Ht})),i.d(e,"bb",(function(){return Ut})),i.d(e,"hb",(function(){return Gt})),i.d(e,"ib",(function(){return Vt})),i.d(e,"lb",(function(){return Wt})),i.d(e,"mb",(function(){return Jt})),i.d(e,"y",(function(){return qt})),i.d(e,"z",(function(){return Kt})),i.d(e,"xb",(function(){return Yt})),i.d(e,"yb",(function(){return $t})),i.d(e,"Mb",(function(){return Xt})),i.d(e,"Nb",(function(){return Qt})),i.d(e,"Ub",(function(){return Zt})),i.d(e,"Vb",(function(){return te})),i.d(e,"Wb",(function(){return ee})),i.d(e,"Xb",(function(){return ie})),i.d(e,"s",(function(){return ne})),i.d(e,"t",(function(){return ae})),i.d(e,"Lb",(function(){return se})),i.d(e,"Jb",(function(){return oe})),i.d(e,"Kb",(function(){return re})),i.d(e,"jb",(function(){return yt})),i.d(e,"kb",(function(){return vt})),i.d(e,"ec",(function(){return he})),i.d(e,"fc",(function(){return le})),i.d(e,"cc",(function(){return ce})),i.d(e,"dc",(function(){return de})),i.d(e,"X",(function(){return at})),i.d(e,"Y",(function(){return st})),i.d(e,"ac",(function(){return ue})),i.d(e,"bc",(function(){return pe})),i.d(e,"k",(function(){return ge})),i.d(e,"l",(function(){return me})),i.d(e,"Qb",(function(){return ye})),i.d(e,"Rb",(function(){return ve})),i.d(e,"kc",(function(){return xe})),i.d(e,"lc",(function(){return Te})),i.d(e,"mc",(function(){return Me})),i.d(e,"nc",(function(){return Ce})),i.d(e,"ic",(function(){return be})),i.d(e,"jc",(function(){return Pe})),i.d(e,"Fb",(function(){return Ee})),i.d(e,"Gb",(function(){return De})),i.d(e,"cb",(function(){return we})),i.d(e,"db",(function(){return Se})),i.d(e,"oc",(function(){return Ie})),i.d(e,"pc",(function(){return Le})),i.d(e,"Hb",(function(){return Ae.a})),i.d(e,"Ib",(function(){return Ae.b})),i.d(e,"V",(function(){return _e})),i.d(e,"W",(function(){return je})),i.d(e,"gc",(function(){return Ne.a})),i.d(e,"hc",(function(){return Ne.b})),i.d(e,"Bb",(function(){return Fe})),i.d(e,"Cb",(function(){return ze})),i.d(e,"tb",(function(){return Be})),i.d(e,"ub",(function(){return He})),i.d(e,"rb",(function(){return Ue})),i.d(e,"sb",(function(){return Ge})),i.d(e,"e",(function(){return Ve})),i.d(e,"f",(function(){return We})),i.d(e,"Z",(function(){return Je})),i.d(e,"ab",(function(){return qe})),i.d(e,"R",(function(){return Ke})),i.d(e,"S",(function(){return Ye})),function(t){t[t.AddBackgroundImage=0]="AddBackgroundImage",t[t.AddTiledLayer=1]="AddTiledLayer",t[t.AlignTiledLayer=2]="AlignTiledLayer",t[t.ApplyMaterial=3]="ApplyMaterial",t[t.ApplyPattern=4]="ApplyPattern",t[t.ApplyProjectCustomization=5]="ApplyProjectCustomization",t[t.ApplyTile=6]="ApplyTile",t[t.ApplyTilePatternToSurface=7]="ApplyTilePatternToSurface",t[t.ApplyPatternsToSurfaces=8]="ApplyPatternsToSurfaces",t[t.CalcPerspective=9]="CalcPerspective",t[t.CalcPerspectiveAI=10]="CalcPerspectiveAI",t[t.CalcSegmentation=11]="CalcSegmentation",t[t.Cancel=12]="Cancel",t[t.ChangeGrout=13]="ChangeGrout",t[t.ChangeGroutColor=14]="ChangeGroutColor",t[t.ChangePatternRotation=15]="ChangePatternRotation",t[t.ChangeSelection=16]="ChangeSelection",t[t.CreateTiledLayer=17]="CreateTiledLayer",t[t.DeleteTiledLayer=18]="DeleteTiledLayer",t[t.EditCorridor=19]="EditCorridor",t[t.EditLightIntensity=20]="EditLightIntensity",t[t.EditLightPower=21]="EditLightPower",t[t.EditLights=22]="EditLights",t[t.EditPattern=23]="EditPattern",t[t.EditPerspective=24]="EditPerspective",t[t.EditRug=25]="EditRug",t[t.EditTiledLayer=26]="EditTiledLayer",t[t.LoadExternalTile=27]="LoadExternalTile",t[t.LoadProject=28]="LoadProject",t[t.LoadSceneWithPB=29]="LoadSceneWithPB",t[t.LoadSharedProject=30]="LoadSharedProject",t[t.LoadSingleTITile=31]="LoadSingleTITile",t[t.LoadTIProject=32]="LoadTIProject",t[t.Print=33]="Print",t[t.PublishProject=34]="PublishProject",t[t.RemoveFurn=35]="RemoveFurn",t[t.RequestInfo=36]="RequestInfo",t[t.SaveImage=37]="SaveImage",t[t.SaveProject=38]="SaveProject",t[t.SaveProjectCustomization=39]="SaveProjectCustomization",t[t.SetSelectedNode=40]="SetSelectedNode",t[t.SetupCorridor=41]="SetupCorridor",t[t.SetupRug=42]="SetupRug",t[t.ShareOnFacebook=43]="ShareOnFacebook",t[t.ShareProjectLink=44]="ShareProjectLink",t[t.ShareProjectLinkMail=45]="ShareProjectLinkMail",t[t.ShowLightPlaceholder=46]="ShowLightPlaceholder",t[t.ToggleLightAnimation=47]="ToggleLightAnimation",t[t.AddRug=48]="AddRug",t[t.ApplyPatternExt=49]="ApplyPatternExt",t[t.CalcSegmentationCorridor=50]="CalcSegmentationCorridor",t[t.CalcSegmentationRug=51]="CalcSegmentationRug",t[t.ChangeMaterial=52]="ChangeMaterial",t[t.ExportProject=53]="ExportProject",t[t.LoadExternalProject=54]="LoadExternalProject",t[t.SetSelectedLayer=55]="SetSelectedLayer",t[t.AddCorridor=56]="AddCorridor",t[t.RemoveCorridor=57]="RemoveCorridor",t[t.AddGroups=58]="AddGroups",t[t.EditGroups=59]="EditGroups",t[t.DeleteGroups=60]="DeleteGroups",t[t.GetSceneRugImage=61]="GetSceneRugImage",t[t.LoadTileVignette=62]="LoadTileVignette",t[t.LoadRugVignette=63]="LoadRugVignette",t[t.LoadCorridorVignette=64]="LoadCorridorVignette",t[t.LoadBroadloomVignette=65]="LoadBroadloomVignette",t[t.DownloadVignetteImage=66]="DownloadVignetteImage",t[t.SetupVignetteView=67]="SetupVignetteView"}(n||(n={}));var a=i(6);class s{constructor(t,e=1){this.serializedProject=t,this.version=e,this.type=n.LoadProject}}class o extends a.a{constructor(t,e,i){super(),this.project=t,this.projectLoaded=e,this.activityManager=i,this.onProjectLoaded=()=>{this.activityManager.blockingTaskCompleted(),this.end()}}onStart(){const t=this.command;this.activityManager.addBlockingTask(),this.projectLoaded.Changed.on(this.onProjectLoaded);try{this.project.loadNew(t.serializedProject)}catch(t){console.log("CANNOT PARSE PROJECT"),this.activityManager.blockingTaskCompleted(),this.end()}}onEnd(t){this.projectLoaded.Changed.off(this.onProjectLoaded),t()}}var r=i(0);class h{constructor(t){this.groutSize=t,this.type=n.ChangeGrout}}class l extends a.a{constructor(t,e,i,n){super(),this.project=t,this.selection=e,this.patternManager=i,this.activityManager=n}onStart(){if(this.command.type!==n.ChangeGrout)throw new Error(`Invalid command type ${this.command.type}`);const t=this.command;if(t.groutSize<0)throw new Error(`Invalid grout value ${t.groutSize}`);for(const e of this.selection.getSelectionSet().values())if(e){const i=this.project.root.getIndexedNodeById(e);if(i&&i.data.type==r.r.DTTiledLayer){this.activityManager.addBlockingTask();const e=r.G.getTiledLayerPattern(i);e&&this.patternManager.updatePatternProperties(e,t.groutSize).then((()=>{this.activityManager.blockingTaskCompleted()})).catch((t=>{console.log("[ChangeGrout] updatePatternProperties error"),this.activityManager.blockingTaskCompleted(),this.end()}))}else console.debug("[ChangeGrout] wrong node type")}else console.debug("[ChangeGrout] cannot find node");this.end()}onEnd(t){t()}}class c{constructor(t){this.groutColor=t,this.type=n.ChangeGroutColor}}class d extends a.a{constructor(t,e){super(),this.project=t,this.selection=e}onStart(){if(this.command.type!=n.ChangeGroutColor)throw new Error(`Invalid command type ${this.command.type}`);let t=this.command;for(const e of this.selection.getSelectionSet().values())if(e){let i=this.project.root.getIndexedNodeById(e);if(i&&i.data.type==r.r.DTTiledLayer){let e=i.getFirstChildOfType(r.r.DTFace3D).getFirstChildOfType(r.r.DTTileList).getFirstChildOfType(r.r.DTPattern);e.data.groutColor=t.groutColor,this.project.projectChanged.notify({type:"GROUTCOLOR_CHANGED",node:e})}else console.debug("[ChangeGroutColor] wrong node type")}else console.debug("[ChangeGroutColor] cannot find node");this.end()}onEnd(t){t()}}var u=i(2);class p{constructor(t){this.rotation=t,this.type=n.ChangePatternRotation}}class g extends a.a{constructor(t,e,i,n){super(),this.project=t,this.selection=e,this.patternManager=i,this.activityManager=n}onStart(){if(this.command.type!==n.ChangePatternRotation)throw new Error(`Invalid command type ${this.command.type}`);const t=this.command;for(const e of this.selection.getSelectionSet().values())if(e){const i=this.project.root.getIndexedNodeById(e);if(i&&i.data.type==r.r.DTTiledLayer){this.activityManager.addBlockingTask();const e=r.G.getTiledLayerPattern(i);e&&this.patternManager.updatePatternProperties(e,null,u.a.degToRad(t.rotation)).then((()=>{this.activityManager.blockingTaskCompleted()})).catch((t=>{this.activityManager.blockingTaskCompleted(),console.log("[ChangePatternRotation] updatePatternProperties error"),this.end()}))}else console.debug("[ChangePatternRotation] wrong node type")}else console.debug("[ChangePatternRotation] cannot find node");this.end()}onEnd(t){t()}}var m=i(10),f=i(11),y=i(8);class v{}v.patterns={pieno_01:{bmpFile:"pieno_01.xaml",constraints:[],id:"pieno_01",name:"Pieno",tiles:[{code:"pias",default0:600,default1:400,default2:0,edges:"A;C",formatType:"RETT",info:"1-Rettangolo [AxB]",vMode:!0}],tilesPose:[{code:"pias",h:{insertPoint:0,rotation:0,xPosition:"0",yPosition:"0"},v:{insertPoint:1,rotation:90,xPosition:"0",yPosition:"0"}}],xDir0:"D00_0+TLD",xDir1:"0",yDir0:"0",yDir1:"D00_1+TLD"},pieno_02:{bmpFile:"pieno_02.xaml",constraints:[],fileName:"pieno_02.pos",id:"pieno_02",name:"Pieno orizz. 1/2",prefix:null,tiles:[{code:"pias",default0:600,default1:300,default2:0,edges:"A;C",formatType:"RETT",info:"1-Rettangolo [AxB]",vMode:!0}],tilesPose:[{code:"pias",h:{insertPoint:0,rotation:0,xPosition:"0",yPosition:"0"},v:{insertPoint:1,rotation:90,xPosition:"0",yPosition:"0"}},{code:"pias",h:{insertPoint:0,rotation:0,xPosition:"D00_0/2+TLD/2",yPosition:"D00_1+TLD"},v:{insertPoint:1,rotation:90,xPosition:"D00_0/2+TLD/2",yPosition:"D00_1+TLD"}}],xDir0:"0",xDir1:"D00_0+TLD",yDir0:"2*D00_1+2*TLD",yDir1:"0"},pieno_03:{bmpFile:"pieno_03.xaml",constraints:[],id:"pieno_03",name:"Pieno orizz. 1/3",tiles:[{code:"pias",default0:600,default1:200,default2:0,edges:"A;C",formatType:"RETT",info:"1-Rettangolo [AxB]",vMode:!0}],tilesPose:[{code:"pias",h:{insertPoint:0,rotation:0,xPosition:"0",yPosition:"0"},v:{insertPoint:1,rotation:90,xPosition:"0",yPosition:"0"}},{code:"pias",h:{insertPoint:0,rotation:0,xPosition:"D00_0/3+TLD/3",yPosition:"D00_1+TLD"},v:{insertPoint:1,rotation:90,xPosition:"D00_0/3+TLD/3",yPosition:"D00_1+TLD"}},{code:"pias",h:{insertPoint:0,rotation:0,xPosition:"2*D00_0/3+2*TLD/3",yPosition:"2*D00_1+2*TLD"},v:{insertPoint:1,rotation:90,xPosition:"2*D00_0/3+2*TLD/3",yPosition:"2*D00_1+2*TLD"}}],xDir0:"D00_0+TLD",xDir1:"0",yDir0:"0",yDir1:"3*D00_1+3*TLD"},pieno_04:{bmpFile:"pieno_04.xaml",constraints:[],id:"pieno_04",name:"Pieno orizz. 1/4",tiles:[{code:"pias",default0:600,default1:300,default2:0,edges:"A;C",formatType:"RETT",info:"1-Rettangolo [AxB]",vMode:!0}],tilesPose:[{code:"pias",h:{insertPoint:0,rotation:0,xPosition:"0",yPosition:"0"},v:{insertPoint:1,rotation:90,xPosition:"0",yPosition:"0"}},{code:"pias",h:{insertPoint:0,rotation:0,xPosition:"D00_0/4+TLD/4",yPosition:"D00_1+TLD"},v:{insertPoint:1,rotation:90,xPosition:"D00_0/4+TLD/4",yPosition:"D00_1+TLD"}},{code:"pias",h:{insertPoint:0,rotation:0,xPosition:"D00_0/2+TLD/2",yPosition:"2*D00_1+2*TLD"},v:{insertPoint:1,rotation:90,xPosition:"D00_0/2+TLD/2",yPosition:"2*D00_1+2*TLD"}},{code:"pias",h:{insertPoint:0,rotation:0,xPosition:"3*D00_0/4+3*TLD/4",yPosition:"3*D00_1+3*TLD"},v:{insertPoint:1,rotation:90,xPosition:"3*D00_0/4+3*TLD/4",yPosition:"3*D00_1+3*TLD"}}],xDir0:"0",xDir1:"D00_0+TLD",yDir0:"4*D00_1+4*TLD",yDir1:"0"},spina_01:{bmpFile:"spina_01.xaml",constraints:["D00_0-1-D00_1 >= 0"],id:"Spina_01",name:"Sp. di pesce 01",tiles:[{code:"rett",default0:600,default1:200,default2:0,edges:"A;C",formatType:"RETT",info:"1-Rettangolo [AxB]",vMode:!0}],tilesPose:[{code:"rett",h:{insertPoint:0,rotation:0,xPosition:"0",yPosition:"0"},v:{insertPoint:1,rotation:90,xPosition:"0",yPosition:"0"}},{code:"rett",h:{insertPoint:1,rotation:90,xPosition:"0",yPosition:"D00_1+TLD"},v:{insertPoint:0,rotation:0,xPosition:"0",yPosition:"D00_1+TLD"}}],xDir0:"D00_1+TLD",xDir1:"-D00_0-TLD",yDir0:"D00_1+TLD",yDir1:"D00_0+TLD"}};class x{constructor(t,e,i,a){this.patternID=t,this.groutSize=e,this.groutColor=i,this.rotation=a,this.type=n.ApplyPattern}}class T extends a.a{constructor(t,e,i,n,a,s,o){super(),this.project=t,this.tileClient=e,this.patternManager=i,this.selection=n,this.resourceManager=a,this.activityManager=s,this.analyticsManager=o,this.getPatternData=t=>new Promise(((e,i)=>{if(null!=v.patterns[t.toLowerCase()]){const i=v.patterns[t.toLowerCase()];e(i)}else this.tileClient.getPosFile(t).then((t=>{e(t)})).catch((e=>{console.debug("[ApplyPattern] cannod download pattern: "+t),i(e)}))})),this.applyPatternData=(t,e,i,n)=>new Promise(((a,s)=>{const o=[],h=this.gePatternInfo(e,i,n);let l=m.g.createPatternStructureWithTiles(t,[],h[0]);this.analyticsManager&&this.analyticsManager.droppedPattern(t.id);for(const t of this.selection.getSelectionSet().values()){const e=this.project.root.getIndexedNodeById(t);e&&e.data.type==r.r.DTTiledLayer&&o.push(this.replacePattern(e,l,h))}Promise.all(o).then((()=>{console.debug("[ApplyPattern] apply pattern ok"),a()})).catch((()=>{console.debug("[ApplyPattern] cannot apply pattern"),s()}))})),this.replacePattern=(t,e,i)=>new Promise(((n,a)=>{try{const a=t.getFirstChildOfType(r.r.DTFace3D),s=r.G.getTiledLayerPattern(t);s?this.patternManager.getOrCreatePatternStructure(s).then((t=>{const o=t.tiles,r=m.g.substituteTile(e.tiles[0].tileCode,o[0],e,i[0]);this.patternManager.addPattern(a,s,i[1],i[0],i[2],r),n()})):(this.patternManager.addPattern(a,s,i[1],i[0],i[2],e),n())}catch(t){console.debug("[ApplyPattern] replace pattern error: "+JSON.stringify(t)),a()}})),this.gePatternInfo=(t,e,i)=>{let n=0,a=16777215,s=0;if(null!=t&&(n=t),null!=e&&(a=e),null!=i&&(s=i),null==t||null==e||null==i){const o=this.selection.getSelectionSet().values().next().value,h=this.project.root.getIndexedNodeById(o),l=r.G.getTiledLayerPattern(h);if(l){const o=l.data;null==t&&(n=o.groutSize),null==e&&(a=o.groutColor),null==i&&(s=o.rotation)}}return[n,a,s]}}onStart(){if(this.command.type!==n.ApplyPattern)throw new Error(`Invalid command type ${this.command.type}`);if(null!=Object(y.B)(this.project,this.selection)){const t=this.command;this.activityManager.addBlockingTask(),this.getPatternData(t.patternID).then((e=>{this.applyPatternData(e,t.groutSize,t.groutColor,t.rotation).then((()=>{this.activityManager.blockingTaskCompleted(),this.end()})).catch((()=>{this.activityManager.blockingTaskCompleted(),this.end()}))})).catch((()=>{this.activityManager.blockingTaskCompleted(),this.end()}))}else{this.project.root.countAllChildrenByType(r.r.DTTiledLayer,!1)>0&&this.resourceManager.showMessageCallout(f.d.WARNING,f.c.SELECT_DRAG_DROP_TILE),this.end()}}onEnd(t){t()}}var M=i(9),C=i(4),b=i(7),P=i(34);class E{constructor(t){this.currentPatternId=t,this.type=n.EditPattern}}class D extends a.a{constructor(t,e,i,n,a,s){super(),this.project=t,this.resourceManager=e,this.objectControls=i,this.patternManager=n,this.activityManager=a,this.renderFrame=s,this.getSelectedPattern=()=>{const t=this.command.currentPatternId;return this.project.root.getIndexedNodeById(t)},this.onClick=t=>{this.getSelectedPattern()&&(t.handled=!0)},this.onPointerDown=t=>{const e=this.getSelectedPattern();if(null!=e)for(const i of t.intersections){const n=i;if("GROUTMESH"===n.object.name){if(n.object.userData.id==e.id){this.interactionObject=n.object.parent,t.target=n,t.handled=!0;break}}}else this.end()},this.onPointerUp=()=>{},this.onDragStart=t=>{this.interactionObject&&(t.handled=!0,this.resourceManager.userInteractionStart&&this.resourceManager.userInteractionStart())},this.onDrag=t=>{if(this.interactionObject){t.handled=!0;const e=Object(u.c)(t.delta.clone().applyMatrix4(C.c));this.diffFace3DVec3=u.a.pnt3Transform(this.face3DTo2DMatrix,e);const i=u.a.mat4GetIdentity();u.a.mat4SetPosition(i,e),this.interactionObject.matrixAutoUpdate=!0,b.a.setObject3DTransform(this.interactionObject,Object(C.e)(i,C.c,C.a)),this.renderFrame.value=!0}},this.onDragEnd=t=>{if(this.interactionObject){t.handled=!0;const e=this.getSelectedPattern();if(e){const t=e.data;if("pb"!=t.id){this.activityManager.addBlockingTask();const i=u.a.vec2Add(t.origin,this.diffFace3DVec3);this.patternManager.getOrCreatePatternStructure(e).then((t=>{this.patternManager.updatePatternSimpleProperties(e,t,null,null,i),this.interactionObject.matrixAutoUpdate=!0,b.a.setObject3DTransform(this.interactionObject,Object(C.e)(u.a.mat4GetIdentity(),C.c,C.a)),this.interactionObject=null,this.renderFrame.value=!0,this.activityManager.blockingTaskCompleted(),this.resourceManager.userInteractionEnd&&this.resourceManager.userInteractionEnd()})).catch((t=>{console.log("[EditPattern] updatePatternProperties error"),this.activityManager.blockingTaskCompleted()}))}}}}}attachEventHandlers(){this.objectControls.addEventListener(M.b.POINTERDOWN,this.onPointerDown),this.objectControls.addEventListener(M.b.POINTERUP,this.onPointerUp),this.objectControls.addEventListener(M.b.CLICK,this.onClick),this.objectControls.addEventListener(M.b.DRAGSTART,this.onDragStart),this.objectControls.addEventListener(M.b.DRAG,this.onDrag),this.objectControls.addEventListener(M.b.DRAGEND,this.onDragEnd)}detachEventHandlers(){this.objectControls.removeEventListener(M.b.POINTERDOWN,this.onPointerDown),this.objectControls.removeEventListener(M.b.POINTERUP,this.onPointerUp),this.objectControls.removeEventListener(M.b.CLICK,this.onClick),this.objectControls.removeEventListener(M.b.DRAGSTART,this.onDragStart),this.objectControls.removeEventListener(M.b.DRAG,this.onDrag),this.objectControls.removeEventListener(M.b.DRAGEND,this.onDragEnd)}onStart(){if(this.command.type!==n.EditPattern)throw new Error(`Invalid command type ${this.command.type}`);const t=this.getSelectedPattern();if(this.attachEventHandlers(),t){const e=t.parentNode.parentNode,i=e.data,n=P.a.getPolygonNormal(i.points).normalize().negate();n.applyMatrix4(C.a),this.objectControls.dragPlaneNormal=n;const a=this.patternManager.get2DFace3D(e);this.face3DTo2DMatrix=a._2DMatrix,u.a.mat4SetPosition(this.face3DTo2DMatrix,{x:0,y:0,z:0})}}onEnd(t){this.detachEventHandlers(),t()}}class w{constructor(t,e,i,a,s,o,r){this.surfaceType=t,this.surfaceIndex=e,this.tileKeys=i,this.patternID=a,this.groutColor=s,this.groutSize=o,this.patternRotation=r,this.type=n.ApplyTilePatternToSurface}}class S extends a.a{constructor(t,e,i,n,a,s){super(),this.project=t,this.tileClient=e,this.patternManager=i,this.selection=n,this.resourceManager=a,this.activityManager=s}onStart(){if(this.command.type!=n.ApplyTilePatternToSurface&&this.command.type!=n.ApplyPatternsToSurfaces)throw new Error(`Invalid command type ${this.command.type}`);{let t=[];const e=this.command;t.push({tiles:e.tileKeys,surfaceType:e.surfaceType,surfaceIndex:e.surfaceIndex,pattern:e.patternID,rotation:e.patternRotation,formatSize:null,id:null,groutSize:e.groutSize,groutColor:e.groutColor}),this.activityManager.addBlockingTask();const i=[];for(const e of t)i.push(this.applyPatternToSurface(e.tiles,e.surfaceType,e.surfaceIndex,e.pattern,e.rotation,e.groutSize,e.groutColor));Promise.all(i).then((()=>{this.activityManager.blockingTaskCompleted(),this.end()})).catch((t=>{this.activityManager.blockingTaskCompleted(),this.resourceManager.showMessageCallout(f.d.ERROR,f.c.CONNECTION_ERROR),this.end()}))}}applyPatternToSurface(t,e,i,n,a,s,o){return new Promise(((h,l)=>{const c=[];if(t.length>0){for(const e of t)c.push(e.tileNum?this.tileClient.getTileInfo(e.tileNum):this.tileClient.getTileInfoByKey(e.manufacturer,e.code,e.color));if(0===c.length)return void l();Promise.all(c).then((t=>{if(!this.canceled){let c,d=null,u=0;if(this.project.root.walkOnAllChildrenByType(r.r.DTTiledLayer,!1,(t=>{const n=t.data;n.surfaceType===e&&n.surfaceIndex===i&&(d=t.getFirstChildOfType(r.r.DTFace3D),d.data.classId===r.h.CLASSID_FLOOR_AI&&n.arData&&n.arData.rotation&&(u+=n.arData.rotation))})),null===d)return console.log("ApplyTilePatternToSurfaceCommand error: cannot find face3d"),void l();"CPLXPOLY"==t[0].formatType&&null!=t[0].posFile?c=this.tileClient.getFpsPosFile(t[0].posFile):"CPLXPOLY"!==t[0].formatType&&(c=this.tileClient.getPosFile(n)),c?c.then((e=>{if(!this.canceled){u=a+u,d.childNodes.length>0&&this.patternManager.removeTileListNodes(d);const i=m.g.createPatternStructureWithTiles(e,t,s),n=d.data,h=this.patternManager.getTileListDefaultFlags(n.classId);let l;if(n.classId===r.h.CLASSID_WALL){const t=n.points[0].z;l=n.points[3].z-t}const c=this.patternManager.applyPatternStructure(d,h,o,s,u,i,null,l);this.selection.set(c)}h()})).catch((t=>{console.log("ApplyTilePatternToSurfaceCommand error: "+t.message+" - "+t.stack),l()})):(console.log("ApplyTilePatternToSurfaceCommand error: wrong configuration for complex tile"),l())}})).catch((t=>{console.log("ApplyTilePatternToSurfaceCommand error: "+t.message+" - "+t.stack),l()}))}else{let t=null;this.project.root.walkOnAllChildrenByType(r.r.DTTiledLayer,!1,(n=>{const a=n.data;a.surfaceType===e&&a.surfaceIndex===i&&(t=n.getFirstChildOfType(r.r.DTFace3D))})),t.childNodes.length>0&&this.patternManager.removeTileListNodes(t),h()}}))}onEnd(t){t()}}class I{constructor(t){this.patternInfos=t,this.type=n.ApplyPatternsToSurfaces}}class L extends a.a{constructor(t,e,i,n,a){super(),this.project=t,this.tileClient=e,this.patternManager=i,this.resourceManager=n,this.activityManager=a}onStart(){if(this.command.type!=n.ApplyTilePatternToSurface&&this.command.type!=n.ApplyPatternsToSurfaces)throw new Error(`Invalid command type ${this.command.type}`);{let t=[];t=this.command.patternInfos,this.activityManager.addBlockingTask();const e=[];let i=!0,n=!0;for(const a of t)if(i&&null!==a.surfaceType&&(a.surfaceType===r.J.FLOOR||a.surfaceType===r.J.HPLANE)||a.tileDestination===m.e.FLOOR||a.tileDestination===m.e.BOTH?(e.push(this.applyPatternToSurface(a.tiles,r.J.FLOOR,a.tileDestination,a.pattern,a.rotation,a.groutSize,a.groutColor)),i=!1):(n&&null!==a.surfaceType&&(a.surfaceType===r.J.WALL||a.surfaceType===r.J.BACKSPLASH)||a.tileDestination===m.e.WALL||a.tileDestination===m.e.BOTH)&&(e.push(this.applyPatternToSurface(a.tiles,r.J.WALL,a.tileDestination,a.pattern,a.rotation,a.groutSize,a.groutColor)),n=!1),!i&&!n)break;Promise.all(e).then((()=>{this.activityManager.blockingTaskCompleted(),this.end()})).catch((t=>{this.activityManager.blockingTaskCompleted(),this.resourceManager.showMessageCallout(f.d.ERROR,f.c.CONNECTION_ERROR),this.end()}))}}applyPatternToSurface(t,e,i,n,a,s,o){return new Promise(((h,l)=>{const c=[];let d=[],u=[];if(t.length>0){for(const e of t)c.push(e.tileNum?this.tileClient.getTileInfo(e.tileNum):this.tileClient.getTileInfoByKey(e.manufacturer,e.code,e.color));if(0===c.length)return void l();Promise.all(c).then((t=>{if(!this.canceled){let c=0;const p=[],g=this.project.root.getFirstChildOfType(r.r.DTGroupList);if(g&&g.walkOnAllChildrenByType(r.r.DTGroup,!1,(t=>{const n=t.data,a=n.tileDestination===m.e.FLOOR?r.J.FLOOR:n.tileDestination===m.e.WALL?r.J.WALL:null;if(null!==a&&a===e||i===m.e.BOTH)for(const t of n.layers){const e=this.project.root.getIndexedNodeById(t);if(e){p.push(e);const t=e.data,i=e.getFirstChildOfType(r.r.DTFace3D);d.push(i),u.push(0),i.data.classId===r.h.CLASSID_FLOOR_AI&&t.arData&&t.arData.rotation&&(u[c]+=t.arData.rotation),c+=1}}else n.layers.forEach((t=>{const e=this.project.root.getIndexedNodeById(t);e&&p.push(e)}))})),this.project.root.walkOnAllChildrenByType(r.r.DTTiledLayer,!1,(t=>{if(!p.find((e=>e.id===t.id))){const n=t.data;if(i===m.e.BOTH||e===r.J.FLOOR&&(n.surfaceType===r.J.FLOOR||n.surfaceType===r.J.HPLANE)||e===r.J.WALL&&(n.surfaceType===r.J.WALL||n.surfaceType===r.J.BACKSPLASH)){const e=t.getFirstChildOfType(r.r.DTFace3D);d.push(e),u.push(0),e.data.classId===r.h.CLASSID_FLOOR_AI&&n.arData&&n.arData.rotation&&(u[c]+=n.arData.rotation),c+=1}}})),0===d.length)return console.log("ApplyTilePatternToSurfaceCommand error: cannot find face3d"),void l();let f;"CPLXPOLY"==t[0].formatType&&null!=t[0].posFile?f=this.tileClient.getFpsPosFile(t[0].posFile):"CPLXPOLY"!==t[0].formatType&&(f=this.tileClient.getPosFile(n)),f?f.then((e=>{if(!this.canceled)for(let i=0;i<d.length;i++){const n=d[i];let h=u[i];h=a+h,n.childNodes.length>0&&this.patternManager.removeTileListNodes(n);const l=m.g.createPatternStructureWithTiles(e,t,s),c=n.data,p=this.patternManager.getTileListDefaultFlags(c.classId);let g;if(c.classId===r.h.CLASSID_WALL){const t=c.points[0].z;g=c.points[3].z-t}this.patternManager.applyPatternStructure(n,p,o,s,h,l,null,g)}h()})).catch((t=>{console.log("ApplyTilePatternToSurfaceCommand error: "+t.message+" - "+t.stack),l()})):(console.log("ApplyTilePatternToSurfaceCommand error: wrong configuration for complex tile"),l())}})).catch((t=>{console.log("ApplyTilePatternToSurfaceCommand error: "+t.message+" - "+t.stack),l()}))}else{let t=null;this.project.root.walkOnAllChildrenByType(r.r.DTTiledLayer,!1,(i=>{i.data.surfaceType===e&&(t=i.getFirstChildOfType(r.r.DTFace3D))})),t.childNodes.length>0&&this.patternManager.removeTileListNodes(t),h()}}))}onEnd(t){t()}}class A{constructor(t,e,i,a){this.key=t,this.groutColor=e,this.groutSize=i,this.patternId=a,this.type=n.ApplyTile}}class O extends a.a{constructor(t,e,i,n,a,s,o,h,l,c){super(),this.project=t,this.tileClient=e,this.patternManager=i,this.selection=n,this.resourceManager=a,this.activityManager=s,this.analyticsManager=o,this.camera=h,this.canvasSize=l,this.scene=c,this.downloadTileAndPatternData=(t,e,i,n)=>new Promise(((a,s)=>{this.tileClient.getTileInfo(t).then((t=>{this.analyticsManager&&this.analyticsManager.droppedTile(t.idManufacturer,t.idProduct,t.colorVar,t.collection,e);const o=this.getPatternPromise(t.formatType,t.defaultPattern,t.posFile,i);o?o.then((e=>{const i=m.g.createPatternStructureWithTiles(e,[t],n);a(i)})):(console.debug("[ApplyTile] cannot download pattern data"),s())})).catch((()=>{console.debug("[ApplyTile] cannot download tile data"),s()}))})),this.applyTile=(t,e,i,n)=>new Promise(((a,s)=>{const o=t.getFirstChildOfType(r.r.DTFace3D),h=this.getPatternRotation(o.parentNode),l=Object(y.o)(t,o.id,this.camera,this.canvasSize,this.scene.children);try{o.childNodes.length>0&&this.patternManager.removeTileListNodes(o);const t=o.data,s=this.patternManager.getTileListDefaultFlags(t.classId);this.patternManager.applyPatternStructure(o,s,n,i,h,e,l),a()}catch(t){s()}}))}onStart(){if(this.command.type!==n.ApplyTile)throw new Error(`Invalid command type ${this.command.type}`);const t=Object(y.B)(this.project,this.selection);if(null!=t){const e=this.command;this.activityManager.addBlockingTask(),this.downloadTileAndPatternData(e.key,t,e.patternId,e.groutSize).then((t=>{const i=[];for(const n of this.selection.getSelectionSet().values()){const a=this.project.root.getIndexedNodeById(n);a&&a.data.type==r.r.DTTiledLayer&&i.push(this.applyTile(a,t,e.groutSize,e.groutColor))}Promise.all(i).then((()=>{console.debug("[ApplyTile] apply tile ok"),this.activityManager.blockingTaskCompleted(),this.end()})).catch((()=>{console.debug("[ApplyTile] cannot apply tile"),this.activityManager.blockingTaskCompleted(),this.end()}))})).catch((()=>{this.activityManager.blockingTaskCompleted(),this.end()}))}else{this.project.root.countAllChildrenByType(r.r.DTTiledLayer,!1)>0&&this.resourceManager.showMessageCallout(f.d.WARNING,f.c.SELECT_DRAG_DROP_TILE),this.end()}}getPatternPromise(t,e,i,n){let a;return"CPLXPOLY"==t&&null!=i?a=this.tileClient.getFpsPosFile(i):"CPLXPOLY"!==t&&(a=e&&""!==e?this.tileClient.getPosFile(e):n&&""!==n?this.tileClient.getPosFile(n):this.tileClient.getDefaultPosFile(t)),a}getPatternRotation(t){let e=0;const i=t.data,n=t.getFirstChildOfType(r.r.DTFace3D),a=n.getFirstChildOfType(r.r.DTTileList);if(a){e+=a.getFirstChildOfType(r.r.DTPattern).data.rotation}else n.data.classId===r.h.CLASSID_FLOOR_AI&&i.arData&&i.arData.rotation&&(e+=i.arData.rotation);return e}onEnd(t){t()}}var R=i(5);class _{constructor(t,e,i){this.imageFile=t,this.imageAspect=e,this.isSceneSetup=i,this.type=n.AddBackgroundImage}}class k extends a.a{constructor(t,e){super(),this.project=t,this.canvasWidth=e,this.addBackgroundNode=(t,e,i,n,a)=>{const s=new r.d,o=this.project.root.data;a?(t=Math.round(this.canvasWidth),e=Math.round(this.canvasWidth/i),o.sceneType=r.I.STATIC):o.sceneType=r.I.CUSTOM,s.imageSizeProcessing={x:t,y:e},s.src=n,s.cameraParams=new r.b(R.d,R.e,R.g,R.f,i);const h=new r.c(s);this.project.addBackgroundImage(h),this.end(null,{imageAspect:i,sceneId:o.sceneId})}}onStart(){const t=this.command,e=new Image;e.onload=()=>{const i=e.width,n=e.height,a=t.imageAspect?t.imageAspect:i/n;if(t.imageFile instanceof File){const s=document.createElement("canvas");s.width=i,s.height=n;const o=s.getContext("2d");o.save(),o.drawImage(e,0,0),o.restore();const r=s.toDataURL("image/"+R.r);this.addBackgroundNode(i,n,a,r,t.isSceneSetup)}else this.addBackgroundNode(i,n,a,t.imageFile,t.isSceneSetup)},t.imageFile instanceof File?e.src=URL.createObjectURL(t.imageFile):e.src=t.imageFile}onEnd(t){t()}}var j=i(1);const N=[[1,0,0,0],[0,0,-1,0],[0,1,0,0],[0,0,0,1]];class F{constructor(t,e,i){this.imageFile=t,this.wallsVisible=e,this.storageAccount=i,this.type=n.CalcSegmentation}}class z extends a.a{constructor(t,e,i,n,a,s,o){super(),this.project=t,this.aiClient=e,this.activityManager=i,this.canvasSize=n,this.aiConfig=a,this.projectLoaded=s,this.resourceManager=o,this.getSurfaceLightData=(t,e,i,n,a)=>{let s,o=null;if(e){const t=new j.Vector2(e.x*this.canvasSize.x/100,e.y*this.canvasSize.y/100),o=Object(u.f)(i).applyMatrix4(C.a),r=Object(u.f)(n).applyMatrix4(C.a).normalize(),h=(new j.Plane).setFromNormalAndCoplanarPoint(r,o),l=b.a.getPlaneIntersection(h,t,a,this.canvasSize.x,this.canvasSize.y);if(l){const t=l.clone();t.applyMatrix4(C.c),console.log("refl point 3D model: "+JSON.stringify(t)),s=Object(u.c)(t)}}return o={reflPointModel:s,normal:n,hotspot2D:t},o},this.setupLights=(t,e,i,n)=>{const a=new r.n,s=new r.c(a);let o=400,h=R.c;if(e){const t=this.getLightPositionFromReflPoint(e.reflPointModel,e.normal,2500);console.log("WALL LIGHT POSITION: "+JSON.stringify(t));this.checkDistanceFromWalls(t,i)&&(o=200,h=R.c+2),this.appendOmniLightMode(t,o,s)}else{let e;e=t.reflPointModel?this.getLightPositionFromReflPoint(t.reflPointModel,{x:0,y:0,z:1},2500):Object(y.u)(n,t.hotspot2D,this.canvasSize),console.log("FLOOR LIGHT POSITION: "+JSON.stringify(e)),this.checkDistanceFromWalls(e,i),this.appendOmniLightMode(e,o,s)}const l=new r.l(r.o.Ambient,0,null,null,h,0,0,null),c=new r.c(l);s.appendChild(c),this.project.root.appendChild(s)},this.checkDistanceFromWalls=(t,e)=>{let i=!1;for(const n of e){const e=Math.sqrt(u.a.line2SegmentDistanceToPointSq(t.x,t.y,n.p0.x,n.p0.y,n.p1.x,n.p1.y));console.log(`distance from ${n.surfaceIndex}: ${e}`),e<1e3&&(i=!0)}return i},this.appendOmniLightMode=(t,e,i)=>{t.z=R.l;const n=new r.l(r.o.Omni,0,t,null,e,null,null,r.m.Sphere,25,null),a=Object(u.f)({x:-t.x,y:-t.y,z:0}).normalize(),s=this.movePointInDirection(Object(u.f)(t),a,2e3);n.animationPositions=[{x:s.x,y:s.y,z:s.z}];const o=new r.c(n);console.log("light id: "+o.id),i.appendChild(o)},this.getLightPositionFromReflPoint=(t,e,i)=>{const n={x:t.x,y:t.y},a=u.a.vec2MultScal(n,e),s=u.a.vec2Diff(n,u.a.vec2Mult(2*a,e));u.a.vec2Normalize(s);return this.movePointInDirection(Object(u.f)({x:n.x,y:n.y,z:0}),Object(u.f)({x:s.x,y:s.y,z:0}),i)},this.onProjectLoaded=()=>{this.activityManager.blockingTaskCompleted(),this.end()},this.setupMaskNode=t=>{const e=new r.q,i=new r.c(e);if(t[0].id===r.F.ALL){const e=t[0],n=new r.p(e.id,e.maskUrl,e.indexes,this.aiConfig.defaultReflection,this.aiConfig.defaultShading);e.contour2d&&(n.contour2d=e.contour2d);const a=new r.c(n);i.appendChild(a)}else for(const e of t){if(this.aiConfig.onlyFloor&&"MaskFloor"!==e.id)continue;e.maskUrl=this.aiClient.getEndpoint()+"/api/segmentation/files?id="+encodeURIComponent(e.maskUrl);const t=new r.p(e.id,e.maskUrl,e.indexes,this.aiConfig.defaultReflection,this.aiConfig.defaultShading);e.contour2d&&(t.contour2d=e.contour2d);const n=new r.c(t);i.appendChild(n)}this.project.root.appendChild(i)}}onStart(){this.projectLoaded.Changed.on(this.onProjectLoaded),this.activityManager.addBlockingTask();const t=this.command;this.aiClient.getMasks(t.imageFile,this.aiConfig.onlyFloor).then((e=>{var i;if(e.sessionId&&this.aiClient.setSessionId(e.sessionId),0===e.surfaces.length)return this.activityManager.blockingTaskCompleted(),this.resourceManager.showMessageCallout(f.d.ERROR,f.c.NO_FLOOR_DETECTED),void this.end();console.debug("fovX: "+u.a.radToDeg(e.cameraParameters.fovRadX)+" - fovY: "+u.a.radToDeg(e.cameraParameters.fovRadY)+" - rotation: "+u.a.radToDeg(e.cameraParameters.yaw)+" - grade: "+u.a.radToDeg(e.cameraParameters.pitch)+" - roll: "+u.a.radToDeg(e.cameraParameters.roll)+" - CAMERA HEIGHT: "+e.cameraParameters.cameraHeight),this.setupMaskNode(e.masks);const n=this.project.root.getFirstChildOfType(r.r.DTBackgroundImage).data,a={fov:u.a.radToDeg(e.cameraParameters.fovRadY),grade:u.a.radToDeg(e.cameraParameters.pitch),roll:Math.abs(e.cameraParameters.roll)>.52?0:u.a.radToDeg(e.cameraParameters.roll),heightFromGround:e.cameraParameters.cameraHeight?e.cameraParameters.cameraHeight:n.cameraParams.heightFromGround,imageAspect:n.cameraParams.imageAspect,rotation:u.a.radToDeg(e.cameraParameters.yaw)};n.cameraParams=a,n.imageSizeProcessing=e.imageSizeProcessing;const s=Object(y.g)(a),o=[];let h=null,l=null,c=0;for(const n of e.surfaces){if(this.aiConfig.onlyFloor&&n.surfaceType!==r.J.FLOOR)continue;const a=new r.A;a.surfaceType=n.surfaceType,a.surfaceIndex=n.surfaceIndex,a.hotspot=n.hotspot;const d=Object(y.f)(n.surfaceType),p=d.data;a.arData={gridPoints:n.gridPoints,alignPoints:n.alignPoints,rotation:e.cameraParameters.yaw};let g=!1;if(n.surfaceType===r.J.WALL||n.surfaceType===r.J.BACKSPLASH){if(a.visible=null!==(i=t.wallsVisible)&&void 0!==i&&i,console.log("SURFACE INDEX: "+a.surfaceIndex),n.alignPoints){const t=this.getWallAlignment(n.alignPoints,s,e.imageSizeProcessing);t&&(p.points=[{x:t.endPosition.x,y:t.endPosition.y,z:0},{x:t.startPosition.x,y:t.startPosition.y,z:0},{x:t.startPosition.x,y:t.startPosition.y,z:1e4},{x:t.endPosition.x,y:t.endPosition.y,z:1e4}],g=!0)}else if(n.normal){const t=new j.Vector2(n.point.x*this.canvasSize.x/e.imageSizeProcessing.x,n.point.y*this.canvasSize.y/e.imageSizeProcessing.y),i=new j.Plane(new j.Vector3(0,1,0),0),r=b.a.getPlaneIntersection(i,t,s,this.canvasSize.x,this.canvasSize.y);if(r){const t=r.clone();t.applyMatrix4(C.c),n.normal.y=0,u.a.vec3Normalize(n.normal);const i=u.a.pnt3Transform(N,n.normal),l=u.a.mat4GetIdentity();u.a.mat4RotZ(l,u.a.degToRad(90));const d=u.a.mat4GetIdentity();u.a.mat4RotZ(d,u.a.degToRad(-90));const m=u.a.pnt3Transform(l,i),f=u.a.pnt3Transform(d,i),y=this.movePointInDirection(t.clone(),Object(u.f)(m),8e3),v=this.movePointInDirection(t.clone(),Object(u.f)(f),8e3);p.points=[{x:y.x,y:y.y,z:0},{x:v.x,y:v.y,z:0},{x:v.x,y:v.y,z:5e3},{x:y.x,y:y.y,z:5e3}],console.log("face3d point 3D model: "+JSON.stringify(p.points[0])+" - "+JSON.stringify(p.points[1]));const x=this.movePointInDirection(t.clone(),Object(u.f)(m),500),T=this.movePointInDirection(t.clone(),Object(u.f)(f),500);x.applyMatrix4(C.a),T.applyMatrix4(C.a);const M=b.a.worldToViewportPosition(x,s,this.canvasSize.x,this.canvasSize.y,window.devicePixelRatio),P=b.a.worldToViewportPosition(T,s,this.canvasSize.x,this.canvasSize.y,window.devicePixelRatio),E={x:Math.round(M.x*e.imageSizeProcessing.x/this.canvasSize.x),y:Math.round(M.y*e.imageSizeProcessing.y/this.canvasSize.y)},D={x:Math.round(P.x*e.imageSizeProcessing.x/this.canvasSize.x),y:Math.round(P.y*e.imageSizeProcessing.y/this.canvasSize.y)};let w,S;E.x>D.x?(w=D,S=E):(w=E,S=D),a.arData.alignPoints=[w,S],a.arData.gridPoints=[{x:w.x,y:0},{x:S.x,y:0},S,w],o.push({p0:p.points[0],p1:p.points[1],surfaceIndex:n.surfaceIndex}),console.log("widthPerc: "+n.widthPerc+" - maxWallPerc: "+c),n.widthPerc>25&&n.widthPerc>c&&(h=this.getSurfaceLightData(n.hotspot,n.reflectionPoint2D,p.points[0],i,s),c=n.widthPerc),g=!0}}}else if(n.surfaceType===r.J.FLOOR){p.classId=r.h.CLASSID_FLOOR_AI;const t=Object(y.j)(n.gridPoints,s,e.imageSizeProcessing,this.canvasSize);if(t)p.points=t;else{const t=u.a.mat4GetIdentity();u.a.mat4RotZ(t,e.cameraParameters.yaw);const i=u.a.pnt3TransformArray(t,p.points);p.points=i}l=this.getSurfaceLightData(n.hotspot,n.reflectionPoint2D,p.points[0],{x:0,y:0,z:1},s),g=!0}if(g){const t=new r.c(a);t.appendChild(d),this.project.root.appendChild(t)}}this.setupLights(l,h,o,s),this.project.projectChanged.notify({type:"PROJECT_BUILT"})})).catch((t=>{console.log("Seg error: "+t),this.activityManager.blockingTaskCompleted(),this.end()}))}getWallAlignment(t,e,i){const n=new j.Vector2(t[0].x*this.canvasSize.x/i.x,t[0].y*this.canvasSize.y/i.y),a=new j.Vector2(t[1].x*this.canvasSize.x/i.x,t[1].y*this.canvasSize.y/i.y),s=new j.Plane(new j.Vector3(0,1,0),0),o=b.a.getPlaneIntersection(s,n,e,this.canvasSize.x,this.canvasSize.y),r=b.a.getPlaneIntersection(s,a,e,this.canvasSize.x,this.canvasSize.y);if(null!=o&&null!=r){o.applyMatrix4(C.c),r.applyMatrix4(C.c);const t=5e3,e=o.clone(),i=r.clone(),n=e.add(i).multiplyScalar(.5);return{startPosition:this.movePoint(n,r,o,t),endPosition:this.movePoint(n,o,r,t)}}return null}movePoint(t,e,i,n){const a=e.clone(),s=i.clone().sub(a).normalize();return this.movePointInDirection(t,s,n)}movePointInDirection(t,e,i){const n=e.clone().multiplyScalar(i),a=t.clone();return a.add(n),a}onEnd(t){this.projectLoaded.Changed.off(this.onProjectLoaded),t()}}var B=i(36);class H{constructor(t,e){this.screenshotConfig=t,this.download=e,this.type=n.SaveImage}}class U extends a.a{constructor(t,e,i){super(),this.project=t,this.imageManager=e,this.activityManager=i}onStart(){const t=this.command;this.activityManager.addBlockingTask();const e=t.screenshotConfig.maxWidth,i=t.screenshotConfig.maxHeight;this.imageManager.getImage(e,i).then((e=>{this.imageManager.applyWatermark(e,t.screenshotConfig).then((e=>{t.download?(this.activityManager.blockingTaskCompleted(),this.downloadImage(e,t.screenshotConfig.name,R.r),this.end()):(this.activityManager.blockingTaskCompleted(),this.end(null,{imgString:e}))})).catch((t=>{this.activityManager.blockingTaskCompleted(),console.log("[SaveImage] applyWatermark error")}))})).catch((t=>{this.activityManager.blockingTaskCompleted(),console.log("[SaveImage] getImage error")}))}downloadImage(t,e,i){null==e&&(e="realityremod"),t=t.replace("data:image/"+i+";base64,","");const n=atob(t);B.b.downloadFile(n,e,"image/"+i)}onEnd(t){t()}}class G{constructor(t){this.selectedLayerId=t,this.type=n.DeleteTiledLayer}}class V extends a.a{constructor(t){super(),this.project=t}onStart(){const t=this.command.selectedLayerId,e=this.project.root.getIndexedNodeById(t);this.project.removeTiledLayer(e),this.end(null,{removedLayerId:t})}onEnd(t){t()}}var W=i(16),J=i(17),q=i(20);class K{constructor(t,e,i,a,s){this.surfaceType=t,this.surfaceIndex=e,this.mask=i,this.tile=a,this.pattern=s,this.type=n.AddTiledLayer}}class Y extends a.a{constructor(t,e,i,n,a,s,o,h,l){super(),this.project=t,this.gridCanvasManager=e,this.resourceManager=i,this.objectControls=n,this.layerSelectionEnabled=a,this.unitOfMeasurement=s,this.tileClient=o,this.matManager=h,this.patternManager=l,this.onDeleteLayerCallback=()=>{this.project.removeTiledLayer(this.tiledLayerNode),this.resourceManager.deleteLayer(this.tiledLayerNode.id),this.end()},this.floorBoxChanged=t=>{console.debug("[AddTiledLayer] floorBoxChanged: "+JSON.stringify(t));let e=0;this.command.surfaceType===r.J.HPLANE&&(e=this.planeHeight);const i=[{x:t.min.x,y:t.min.y,z:e},{x:t.min.x,y:t.max.y,z:e},{x:t.max.x,y:t.max.y,z:e},{x:t.max.x,y:t.min.y,z:e}],n=this.tiledLayerNode.getFirstChildOfType(r.r.DTFace3D),a=n.data,s=u.a.mat4GetIdentity(),o=this.project.root.getFirstChildOfType(r.r.DTPrjData);if(o){const t=o.data;u.a.mat4RotZ(s,t.cameraRotation)}const h=u.a.pnt3TransformArray(s,i);a.points=h,this.project.projectChanged.notify({type:"FACE3D_UPDATE",node:n})},this.onSetHotspotCallback=t=>{this.insertingHotspot=t,this.hotspotClicked=!0,!this.alignClicked&&this.layerSetupProps.alignButtonEnabled||(this.layerSetupProps.nextButtonEnabled=!0,this.resourceManager.loadLayerSetup(this.layerSetupProps))},this.onAlignCallback=t=>{this.layerSetupProps.surfaceType!==r.J.WALL&&this.layerSetupProps.surfaceType!==r.J.BACKSPLASH||(t?this.gridCanvasManager.showGridCanvas(this.tiledLayerNode):this.gridCanvasManager.removeGridCanvas()),this.alignClicked=!0,this.hotspotClicked&&(this.layerSetupProps.nextButtonEnabled=!0,this.resourceManager.loadLayerSetup(this.layerSetupProps))},this.onEditMaskCallback=t=>{this.project.root.getFirstChildOfType(r.r.DTMaskList).walkOnAllChildrenByType(r.r.DTMask,!1,(e=>{const i=e.data;i.id===t.id&&(i.src=t.src,i.reflection=t.reflection,i.shading=t.shading,i.indexes=t.indexes,i.contour2d=t.contour2d,this.project.projectChanged.notify({type:"MASK_UPDATED",node:e}))}))},this.onSetHotspotLabelCallback=t=>{if(this.tiledLayerNode){const e=this.tiledLayerNode.data;if(null!==t&&this.resourceManager.setHotspot){e.label=t;const i=this.gridCanvasManager.getSize();let n={x:null,y:null};e.hotspot&&(n={x:e.hotspot.x*i.x/100,y:e.hotspot.y*i.y/100}),this.resourceManager.setHotspot(this.tiledLayerNode.id,n.x,n.y,e.surfaceType,e.surfaceIndex,null,e.label)}}},this.onSetOriginPoseCallback=t=>{this.insertingOriginPose=t},this.onEditOriginPoseCallback=t=>{if(this.tiledLayerNode){const e=this.tiledLayerNode.data,i=this.gridCanvasManager.getSize();e.origin={x:100*t.x/i.x,y:100*t.y/i.y},this.resourceManager.setOriginPoseById&&this.resourceManager.setOriginPoseById(this.tiledLayerNode.id,t)}},this.planeHeightChange=t=>{this.planeHeight=t,this.updatePlanePoints()},this.planeRotationChange=t=>{const e=this.project.root.getFirstChildOfType(r.r.DTPrjData);if(e){const i=e.data;this.planeRotation=u.a.degToRad(t)+i.cameraRotation,this.updatePlanePoints()}},this.updatePlanePoints=()=>{const t=this.tiledLayerNode.getFirstChildOfType(r.r.DTFace3D),e=t.data,i=u.a.mat4GetIdentity();u.a.mat4Translate(i,0,0,this.planeHeight),u.a.mat4RotZ(i,this.planeRotation);const n=u.a.pnt3TransformArray(i,R.k);e.points=n;const a=this.project.root.getFirstChildOfType(r.r.DTPrjData);if(a){const t=a.data;for(const e of t.hPlanesData)if(e.surfaceIndex===this.tiledLayerNode.data.surfaceIndex){e.rotation=this.planeRotation,e.heightFromGround=this.planeHeight;break}}this.project.projectChanged.notify({type:"FACE3D_UPDATE",node:t})},this.onClick=t=>{if(this.insertingHotspot){const e=W.a.getPointerCoordinates(t.originalEvent,this.objectControls.domElement.parentElement.id);t.handled=!0;const i=this.gridCanvasManager.getSize(),n=this.tiledLayerNode.data;n.hotspot={x:100*e.x/i.x,y:100*e.y/i.y},this.resourceManager.setHotspot&&this.resourceManager.setHotspot(this.tiledLayerNode.id,e.x,e.y,n.surfaceType,n.surfaceIndex,null,n.label)}else if(this.insertingOriginPose){const e=W.a.getPointerCoordinates(t.originalEvent,this.objectControls.domElement.parentElement.id),i=this.gridCanvasManager.getSize();this.tiledLayerNode.data.origin={x:100*e.x/i.x,y:100*e.y/i.y},this.resourceManager.setOriginPoseById&&this.resourceManager.setOriginPoseById(this.tiledLayerNode.id,e)}},this.nextButtonCallBack=()=>{this.resourceManager.layerSetupFinished(),this.end()},this.createTileList=(t,e,i,n)=>new Promise(((a,s)=>{this.tileClient.getPosFile(n).then((n=>{var s;const o=new r.f;o.key=new r.H(i.idManuf,i.idProduct,1),q.a.fillMaterialData(0,o,i.material),this.matManager.createExternalTileMat(i.idManuf,i.idProduct,"0",1,e,o);const h=new m.f({idProduct:i.idProduct,idManufacturer:i.idManuf,colorVar:"0",width:i.width,height:i.height,diagonal:i.diagonal,formatType:i.formatType,offshaded:i.offshaded,numImages:i.material.maps.length,dominantColor:null!==(s=i.material.dominantColor)&&void 0!==s?s:16777215,offshadedRot:i.offshadedRot,polygon:J.b.getTilePolygon(i.formatType,i.width,i.height,i.diagonal)}),l=m.g.createPatternStructureWithTiles(n,[h],0);this.patternManager.applyPatternStructure(t,r.z.Full,16777215,1,0,l,null,null,null,null,!1),a()})).catch((t=>{console.debug("download pattern error: "+JSON.stringify(t)),s(t)}))})),this.layerSetupProps={surfaceType:r.J.FLOOR,imageSizeProcessing:{x:0,y:0},alignButtonEnabled:!0,nextButtonEnabled:!1,onSetHotspotCallback:this.onSetHotspotCallback,onAlignCallback:this.onAlignCallback,onEditMaskCallback:this.onEditMaskCallback,onDeleteLayerCallback:this.onDeleteLayerCallback,nextButtonCallback:this.nextButtonCallBack,onSetHotspotLabelCallback:this.onSetHotspotLabelCallback,onSetOriginPoseCallback:this.onSetOriginPoseCallback,onEditOriginPoseCallback:this.onEditOriginPoseCallback,layerMask:null,layerMaskIndex:0,planeHeightChange:this.planeHeightChange,planeRotationChange:this.planeRotationChange,planeHeight:0,planeRotation:0,floorBoxChanged:this.floorBoxChanged,originPose:null},this.insertingHotspot=!1,this.insertingOriginPose=!1,this.hotspotClicked=!1,this.alignClicked=!1,this.planeHeight=0,this.planeRotation=0}onStart(){if(this.command.type!==n.AddTiledLayer)throw new Error(`Invalid command type ${this.command.type}`);this.layerSelectionEnabled.value=!1,this.attachEventHandlers();const t=this.command;t.surfaceType!==r.J.FLOOR&&t.surfaceType!==r.J.HPLANE||(this.layerSetupProps.floorBox={min:{x:R.k[0].x,y:R.k[0].y},max:{x:R.k[2].x,y:R.k[2].y}}),this.layerSetupProps.surfaceType=t.surfaceType,this.layerSetupProps.layerMask=t.mask,this.layerSetupProps.layerMaskIndex=t.surfaceIndex;const e=this.project.root.getFirstChildOfType(r.r.DTBackgroundImage).data;this.layerSetupProps.imageSizeProcessing=e.imageSizeProcessing,this.resourceManager.loadLayerSetup(this.layerSetupProps),Object(y.c)(this.project,t.mask),Object(y.b)(this.project);const i=new r.A;i.surfaceType=t.surfaceType,i.surfaceIndex=t.surfaceIndex,this.tiledLayerNode=new r.c(i);const a=Object(y.f)(t.surfaceType),s=a.data;if(t.surfaceType===r.J.FLOOR||t.surfaceType===r.J.HPLANE){const e=u.a.mat4GetIdentity(),i=this.project.root.getFirstChildOfType(r.r.DTPrjData);if(i){const n=i.data;u.a.mat4RotZ(e,n.cameraRotation),t.surfaceType===r.J.HPLANE&&n.hPlanesData.push({surfaceIndex:t.surfaceIndex,rotation:n.cameraRotation,heightFromGround:0})}const n=u.a.pnt3TransformArray(e,s.points);s.points=n}else if(t.surfaceType===r.J.WALL||t.surfaceType===r.J.BACKSPLASH){const t=u.a.mat4GetIdentity();u.a.mat4Translate(t,0,R.o,0);const e=u.a.pnt3TransformArray(t,s.points);s.points=e}this.tiledLayerNode.appendChild(a),this.project.root.appendChild(this.tiledLayerNode),this.createTileList(a,t.surfaceIndex,t.tile,t.pattern).then((()=>{this.project.projectChanged.notify({type:"TILEDLAYER_ADDED",node:this.tiledLayerNode})})).catch((t=>{console.debug("[AddTiledLayer] createTileList error: "+JSON.stringify(t))}))}attachEventHandlers(){this.objectControls.enabled=!0,this.objectControls.addEventListener(M.b.CLICK,this.onClick)}detachEventHandlers(){this.objectControls.enabled=!1,this.objectControls.removeEventListener(M.b.CLICK,this.onClick)}onEnd(t){this.resourceManager.layerSetupFinished(),this.detachEventHandlers(),this.layerSelectionEnabled.value=!0,t()}}class ${constructor(){this.type=n.ToggleLightAnimation}}class X extends a.a{constructor(t){super(),this.animationManager=t}onStart(){this.animationManager.animateLights()}onEnd(t){t()}}class Q{constructor(t,e,i=1){this.serializedProject=t,this.pbData=e,this.version=i,this.type=n.LoadSceneWithPB}}class Z extends a.a{constructor(t,e,i,n,a,s,o,r){super(),this.project=t,this.tileClient=e,this.patternManager=i,this.activityManager=n,this.projectLoaded=a,this.camera=s,this.canvasSize=o,this.scene=r,this.onProjectLoaded=()=>{this.activityManager.blockingTaskCompleted(),this.end()}}onStart(){let t=this.command;this.activityManager.addBlockingTask(),this.projectLoaded.Changed.on(this.onProjectLoaded),this.project.loadNew(t.serializedProject,!1);let e=JSON.parse(t.pbData),i=[];for(const t of e.tileList){let n=t;i.push(this.tileClient.getTileInfoByKey(e.codProd,n.codArt,n.varCol))}Promise.all(i).then((t=>{let i=new m.a;i.posFile={id:"pb",name:"pb",bmpFile:null,xDir0:null,yDir0:null,xDir1:null,yDir1:null,constraints:[],tilesPose:[],tiles:[]};for(let i=0;i<t.length;i++){let n=t[i],a=e.tileList[i];n.rotation=a.rotAngle?u.a.radToDeg(a.rotAngle):0,n.tileIndex=i,n.insertPoint=0,n.tileCode=n.idProduct,n.polygon=J.b.getTilePolygon(n.formatType,n.width,n.height,n.diagonal,n.polySet)}i.tiles=t;let n=new m.b,a=u.a.vec2Diff(e.expDir1.p0,{x:0,y:0});n.v0=u.a.vec2Diff(e.expDir1.p1,a),n.v0=u.a.vec2Add(n.v0,{x:e.expDir1.dx,y:e.expDir1.dy});let s=u.a.vec2Diff(e.expDir2.p0,{x:0,y:0});n.v1=u.a.vec2Diff(e.expDir2.p1,s),n.v1=u.a.vec2Add(n.v1,{x:e.expDir2.dx,y:e.expDir2.dy}),i.posInfo=n;for(let t=0;t<i.tiles.length;t++){let n=i.tiles[t],a=e.tileList[t],s=n.polygon.polySet.contours[0].vertices[0],o={x:n.polygon.boundingBox.min.x,y:n.polygon.boundingBox.min.y},r=u.a.vec2Diff(s,o),h=u.a.vec2Add(a.realPoint,r),l=u.a.vec2Diff(h,e.expDir1.p0);n.x=l.x,n.y=l.y}const o=this.project.root.getFirstChildOfType(r.r.DTBackgroundImage).data,h=Object(y.g)(o.cameraParams);this.project.root.walkOnAllChildrenByType(r.r.DTTiledLayer,!1,(t=>{let n=t.getFirstChildOfType(r.r.DTFace3D);n.childNodes.length>0&&this.patternManager.removeTileListNodes(n);let a=r.z.Full;const s=n.data;let o=new j.Mesh;o.geometry=Object(C.f)(s.points,C.a,null,[],!1),o.userData=new M.h(n.id);const l=Object(y.o)(t,n.id,h,this.canvasSize,[o]);o.geometry.dispose(),o=null,this.patternManager.applyPatternStructure(n,a,new j.Color(e.options.jointCol).getHex(),e.options.joint,0,i,l,null,null,null,!1)})),this.project.projectChanged.notify({type:"LOADED"})})).catch((t=>{console.debug("Error getting tile data: "+t),this.activityManager.blockingTaskCompleted()}))}onEnd(t){this.projectLoaded.Changed.off(this.onProjectLoaded),t()}}class tt{constructor(t,e,i,n){this.project=t,this.tileClient=e,this.matManager=i,this.patternManager=n}importProject(t){return new Promise(((e,i)=>{try{this.project.createNew();const n=JSON.parse(t);n.cameraParams||i("CANNOT_PARSE");let a=r.I.STATIC;n.type&&(a=n.type);const s=this.project.root.data;if(null!=n.prjData){const t=new r.t;t.cameraRotation=n.prjData.cameraRotation,t.alignPlaneHeight=n.prjData.alignPlaneHeight,t.hPlanesData=JSON.parse(JSON.stringify(n.prjData.hPlanesData));const e=new r.c(t);this.project.root.appendChild(e),n.type||(a=r.I.STATIC)}s.sceneType=a;const o=new r.d;o.src=n.backgroundImage.src,o.cameraParams=n.cameraParams,o.imageSizeProcessing=n.backgroundImage.size;const h=new r.c(o);this.project.root.appendChild(h);const l=new r.q,c=new r.c(l);for(const t of n.maskList){const e=new r.p(t.id,t.src,t.indexes,t.reflection,t.shading);e.contour2d=t.contour2d?t.contour2d:[];const i=new r.c(e);c.appendChild(i)}this.project.root.appendChild(c);const d=new r.n,p=new r.c(d);for(const t of n.lights){const e=t,i=new r.l(e.lightType,0,e.pnt,e.targetPnt,e.power,e.angle,e.penumbra,e.areaType,e.areaDim1,e.areaDim2,e.animationPositions),n=new r.c(i);p.appendChild(n)}this.project.root.appendChild(p);const g=[];if(n.layers&&n.layers.length>0)for(const t of n.layers)if("FLOOR"===t.surfaceType||"WALL"===t.surfaceType||"BACKSPLASH"===t.surfaceType||"HPLANE"===t.surfaceType){const e=new r.A;e.surfaceType=q.a.getSurfaceType(t.surfaceType),e.surfaceIndex=t.surfaceIndex,e.hotspot=t.hotspot,e.arData=t.arData;const i=Object(y.f)(e.surfaceType,t.points),a=i.data;t.arData&&a.classId===r.h.CLASSID_FLOOR&&(a.classId=r.h.CLASSID_FLOOR_AI);const s=new r.c(e);s.appendChild(i),this.project.root.appendChild(s),t.tileList&&t.tileList.length>0&&g.push(this.importTileList(i,t.tileList,n.tiles))}Promise.all(g).then((()=>{if(n.rugs&&n.rugs.length>0)for(const t of n.rugs){const e=q.a.rr3RugToDTRug(t.rugData,t.surfaceIndex);u.a.mat4RotZ(e.matrix,u.a.degToRad(t.rotation)),u.a.mat4Translate(e.matrix,t.position.x,t.position.y,t.position.z);const i=new r.c(e);this.project.root.appendChild(i)}if(n.corridor){const t=n.corridor,e=[{x:t.corridorData.width/2,y:-R.i/2,z:R.h},{x:-t.corridorData.width/2,y:-R.i/2,z:R.h},{x:-t.corridorData.width/2,y:R.i/2,z:R.h},{x:t.corridorData.width/2,y:R.i/2,z:R.h}],i=new r.e(t.corridorData.id,t.corridorData.width,t.corridorData.height,t.surfaceIndex,e,t.corridorData.mapUrl);u.a.mat4RotZ(i.matrix,u.a.degToRad(t.rotation)),u.a.mat4Translate(i.matrix,t.position.x,t.position.y,0);const a=new r.c(i);this.project.root.appendChild(a)}e()})).catch((t=>{i(t)}))}catch(t){i(t)}}))}importTileList(t,e,i){return new Promise(((n,a)=>{const s=e[0],o=[];for(const e of s.patterns)o.push(this.importPattern(t,s.fillPolicy,e,i));Promise.all(o).then((()=>{n()})).catch((t=>{a(t)}))}))}importPattern(t,e,i,n){return new Promise(((a,s)=>{this.tileClient.getPosFile(i.pattern.id).then((s=>{const o=r.G.getFace3DTiledLayer(t).data,h=[];for(const t of i.tiles){const e=this.getRR3Tile(t.idProduct,t.idManuf,n),i=new m.f({idProduct:t.idProduct,idManufacturer:t.idManuf,colorVar:"0",width:e.width,height:e.height,diagonal:e.diagonal,formatType:e.formatType,offshaded:e.offshaded,numImages:e.material.maps.length,dominantColor:null!=e.material.dominantColor?e.material.dominantColor:16777215,offshadedRot:e.offshadedRot,polygon:J.b.getTilePolygon(e.formatType,e.width,e.height,e.diagonal)});h.push(i);for(let t=0;t<e.material.maps.length;t++){const n=new r.f;n.key=new r.H(e.idManuf,e.idProduct,t+1),q.a.fillMaterialData(t,n,e.material),this.matManager.createExternalTileMat(i.idManufacturer,i.idProduct,i.colorVar,t+1,o.surfaceIndex,n)}}const l=m.g.createPatternStructureWithTiles(s,h,i.pattern.groutSize);let c,d,u;i.pattern.areaRect&&(c=i.pattern.areaRect.max.y-i.pattern.areaRect.min.y,d=i.pattern.areaRect.min.y),i.pattern.origin&&(u=i.pattern.origin),this.patternManager.applyPatternStructure(t,e,i.pattern.groutColor,i.pattern.groutSize,i.pattern.rotation,l,null,c,d,u,!1),a()})).catch((t=>{console.log("importPattern error: "+JSON.stringify(t)),s()}))}))}getRR3Tile(t,e,i){let n;for(const a of i)if(a.idProduct===t&&a.idManuf===e){n=a;break}return n}}class et{constructor(t){this.serializedProject=t,this.type=n.LoadExternalProject}}class it extends a.a{constructor(t,e,i,n,a,s){super(),this.project=t,this.tileClient=e,this.matManager=i,this.patternManager=n,this.activityManager=a,this.projectLoaded=s,this.onProjectLoaded=()=>{this.activityManager.blockingTaskCompleted(),this.end()}}onStart(){this.projectLoaded.Changed.on(this.onProjectLoaded);const t=this.command;this.activityManager.addBlockingTask();new tt(this.project,this.tileClient,this.matManager,this.patternManager).importProject(t.serializedProject).then((()=>{this.project.projectChanged.notify({type:"PROJECT_BUILT"})})).catch((e=>{this.activityManager.blockingTaskCompleted(),"CANNOT_PARSE"===e?(console.log("CANNOT PARSE RR3PROJECT"),this.end(new s(t.serializedProject))):(this.errorMsg=JSON.stringify(e),this.end())}))}onEnd(t){this.projectLoaded.Changed.off(this.onProjectLoaded),t()}}var nt=i(37);class at{constructor(t){this.pointModel3D=t,this.type=n.EditCorridor}}class st extends a.a{constructor(t,e,i,n,a,s,o,h){super(),this.project=t,this.selection=e,this.objectControls=i,this.sceneEntities=n,this.gizmoConfig=a,this.resourceManager=s,this.phScene=o,this.renderFrame=h,this.onPointerDown=t=>{for(const e of t.intersections)if(this.interactionObject=b.a.getSelfOrAncestorObject3D(e.object,(t=>nt.a.isGizmoPart(t))),this.interactionObject)return t.target=e,void(t.handled=!1);for(const e of t.intersections)if(this.interactionObject=b.a.getSelfOrAncestorObject3D(e.object,(t=>{const e=t.userData,i=this.project.root.getIndexedNodeById(e.id);return!(!i||i.data.type!==r.r.DTCorridor)})),this.interactionObject){t.target=e,t.handled=!0;const i=new j.Vector3(e.point.x,e.point.y,e.point.z),n=Object(u.c)(i.applyMatrix4(C.c));this.updateCenterPoint(n);const a=this.project.root.getIndexedNodeById(this.interactionObject.userData.id).data,s=t.originalEvent.type;return this.resourceManager.setSelectedLayer(r.J.CORRIDOR,a.surfaceIndex,s),void this.onEntityInteractionObjectChanged(this.interactionObject)}},this.onPointerUp=()=>{this.interactionObject=null,this.renderFrame.value=!0},this.onClick=t=>{if(this.interactionObject){const e=this.interactionObject.userData.id,i=this.getSelectedCorridor();if(i&&i.id===e){let e;for(const i of t.intersections)if(i.object.name.includes("CORRIDOR")){const t=new j.Vector3(i.point.x,i.point.y,i.point.z);e=Object(u.c)(t.applyMatrix4(C.c));break}this.updateCenterPoint(e),t.handled=!0,this.attachGizmo(this.interactionObject,this.gizmoConfig.value.gizmoRotationEnabled),this.renderFrame.value=!0}else this.gizmoControls.detach()}},this.onDragStart=t=>{if(this.interactionObject){const e=this.interactionObject.userData.id,i=this.getSelectedCorridor();i&&i.id===e&&(t.handled=!0,this.activeCorridor=i.data,this.currGizmoPos=this.worldPoint.clone(),this.resourceManager.userInteractionStart&&this.resourceManager.userInteractionStart())}},this.onDrag=t=>{if(this.interactionObject&&this.selection.has(this.interactionObject.userData.id)){t.handled=!0;const e=u.a.mat4GetIdentity();u.a.mat4SetPosition(e,Object(u.c)(t.delta.clone().applyMatrix4(C.c))),this.transformMatrix=u.a.mat4Clone(this.activeCorridor.matrix),u.a.mat4Mult(e,this.transformMatrix),u.a.mat4SetPositionZ(this.transformMatrix,0),b.a.setObject3DTransform(this.interactionObject,Object(C.e)(this.transformMatrix,C.c,C.a)),this.gizmoControls.update(this.worldPoint.clone().add(t.delta.clone())),this.currGizmoPos=this.worldPoint.clone().add(t.delta.clone()),this.renderFrame.value=!0}},this.onDragEnd=t=>{this.interactionObject&&this.selection.has(this.interactionObject.userData.id)&&(t.handled=!0,this.activeCorridor.matrix=this.transformMatrix,this.worldPoint=this.currGizmoPos.clone(),this.resourceManager.userInteractionEnd&&this.resourceManager.userInteractionEnd(),this.renderFrame.value=!0)},this.onGizmoChanged=t=>{switch(t.type){case"BEGIN":this.resourceManager.userInteractionStart&&this.resourceManager.userInteractionStart();break;case"CHANGED":this.updateGizmoTargetTransform(t),this.renderFrame.value=!0;break;case"END":{const e=t.target.userData.id;this.project.root.getIndexedNodeById(e).data.matrix=this.getObject3DMat4(t.target),this.lastRotation=0,this.resourceManager.userInteractionEnd&&this.resourceManager.userInteractionEnd();break}default:}},this.gizmoControls=new nt.a(this.objectControls,this.gizmoConfig.value,this.phScene),this.updateGizmoPosition=!1,this.lastRotation=0}updateCenterPoint(t){if(t){const e=this.getSelectedCorridor().data;e.thickness&&(t.z=e.thickness);const i=u.a.mat4GetInverted(e.matrix);this.centerModelPoint=u.a.pnt3Transform(i,t),this.centerModelPoint.x=0;const n=u.a.pnt3Transform(e.matrix,this.centerModelPoint);this.worldPoint=Object(u.f)(n).applyMatrix4(C.a),this.updateGizmoPosition=!0}}updateGizmoTargetTransform(t){const e=t.deltaRotation-this.lastRotation,i=this.worldPoint.clone(),n=new j.Vector3(0,1,0);t.target.position.sub(i),t.target.position.applyAxisAngle(n,e),t.target.position.add(i),t.target.rotateOnAxis(n,e),this.lastRotation=t.deltaRotation}attachGizmo(t,e){if(this.gizmoControls.targetObject===t&&!this.updateGizmoPosition)return;(null!=this.gizmoControls.targetObject||this.updateGizmoPosition)&&(this.gizmoControls.detach(),this.updateGizmoPosition=!1);const i=this.project.root.getIndexedNodeById(t.userData.id).data,n=i.width/2,a=i.thickness?i.thickness:R.h,s={min:{x:-n,y:this.centerModelPoint.y-n,z:0},max:{x:n,y:this.centerModelPoint.y+n,z:a}},o=Object(C.d)(s,C.a);this.gizmoControls.attach(t,e,o,this.worldPoint.clone()),this.gizmoControls.setVisibility(!0)}attachEventHandlers(){this.objectControls.addEventListener(M.b.POINTERDOWN,this.onPointerDown),this.objectControls.addEventListener(M.b.POINTERUP,this.onPointerUp),this.objectControls.addEventListener(M.b.DRAGSTART,this.onDragStart),this.objectControls.addEventListener(M.b.DRAG,this.onDrag),this.objectControls.addEventListener(M.b.DRAGEND,this.onDragEnd),this.objectControls.addEventListener(M.b.CLICK,this.onClick),this.gizmoControls.onChange.attach(this.onGizmoChanged)}detachEventHandlers(){this.objectControls.removeEventListener(M.b.POINTERDOWN,this.onPointerDown),this.objectControls.removeEventListener(M.b.POINTERUP,this.onPointerUp),this.objectControls.removeEventListener(M.b.DRAGSTART,this.onDragStart),this.objectControls.removeEventListener(M.b.DRAG,this.onDrag),this.objectControls.removeEventListener(M.b.DRAGEND,this.onDragEnd),this.objectControls.removeEventListener(M.b.CLICK,this.onClick),this.gizmoControls.onChange.detach(this.onGizmoChanged)}getObject3DMat4(t){return t.updateMatrix(),Object(C.g)(t.matrix,C.c,C.a)}onEntityInteractionObjectChanged(t){if(this.interactionObject){const e=t.userData.id;this.selection.has(e)&&this.attachGizmo(t,this.gizmoConfig.value.gizmoRotationEnabled)}}getSelectedCorridor(){return Object(y.p)(this.project,this.selection,r.r.DTCorridor)}onStart(){this.attachEventHandlers();const t=this.getSelectedCorridor();if(t){this.interactionObject=this.sceneEntities.get(t.id);const e=this.command;this.updateCenterPoint(e.pointModel3D),this.onEntityInteractionObjectChanged(this.interactionObject)}else this.end()}onEnd(t){this.detachEventHandlers(),this.gizmoControls.detach(),t()}}class ot{constructor(t,e){this.surfaceType=t,this.surfaceIndex=e,this.type=n.SetSelectedLayer}}class rt extends a.a{constructor(t,e){super(),this.project=t,this.selection=e}onStart(){const t=this.command;let e,i;t.surfaceType===r.J.RUG?this.project.root.walkOnAllChildrenByType(r.r.DTRug,!1,(n=>{const a=n.data;if(a.surfaceIndex===t.surfaceIndex){e=n.id,this.selection.set(e);const t=u.a.mat4GetPosition(a.matrix);i=new yt(t,!1)}})):t.surfaceType===r.J.CORRIDOR?this.project.root.walkOnAllChildrenByType(r.r.DTCorridor,!1,(n=>{const a=n.data;if(a.surfaceIndex===t.surfaceIndex){e=n.id,this.selection.set(e);const t=u.a.mat4GetPosition(a.matrix);i=new at(t)}})):this.project.root.walkOnAllChildrenByType(r.r.DTTiledLayer,!1,(i=>{const n=i.data;n.surfaceType===t.surfaceType&&n.surfaceIndex===t.surfaceIndex&&(e=i.id,this.selection.set(e))})),null==e&&(this.errorMsg="Cannot find surface "+t.surfaceType+" - "+t.surfaceIndex),this.end(i)}onEnd(t){t()}}var ht=i(14);class lt{constructor(t,e,i){this.tileIds=t,this.tiles=e,this.pattern=i,this.type=n.ChangeMaterial}}class ct extends a.a{constructor(t,e,i,n,a,s,o){super(),this.project=t,this.selection=e,this.tileClient=i,this.patternManager=n,this.resourceManager=a,this.matManager=s,this.activityManager=o,this.getSelectedNode=()=>{const t=this.selection.getSelectionSet().values().next().value;if(t){return this.project.root.getIndexedNodeById(t)}return null}}onStart(){const t=this.command;if(null!=t.pattern)if(null!=v.patterns[t.pattern.toLowerCase()]){const e=v.patterns[t.pattern.toLowerCase()],i=this.getSelectedNode();i&&i.data.type===r.r.DTTiledLayer?this.applyTile(e,i,t.tiles):(this.errorMsg="Cannot find node",this.end())}else this.activityManager.addBlockingTask(),this.tileClient.getPosFile(t.pattern).then((e=>{this.activityManager.blockingTaskCompleted();const i=this.getSelectedNode();i&&i.data.type===r.r.DTTiledLayer?this.applyTile(e,i,t.tiles):(this.errorMsg="Cannot find node",this.activityManager.blockingTaskCompleted(),this.end())})).catch((t=>{this.activityManager.blockingTaskCompleted(),"core"!==t.message&&this.resourceManager.showMessageCallout(ht.MessageType.ERROR,ht.MessageCode.CONNECTION_ERROR),this.errorMsg=JSON.stringify(t.stack),this.end()}));else{const e=this.getSelectedNode();if(e){const i=e.data,n=Object(y.r)(t.tiles,i.surfaceIndex,this.matManager);this.patternManager.getOrCreatePatternStructure(e).then((i=>{for(let a=0;a<n.length;a++){const s=this.getTileCode(t.tileIds[a].tileIndex-1,i.tiles);this.substituteTileAndUpdatePattern(s,n[a],i,e)}})).catch((t=>{console.debug("[ChangeMaterial] getOrCreatePatternStructure error: "+JSON.stringify(t))}))}else this.errorMsg="Cannot find node",this.end()}}applyToAll(t,e){this.project.root.walkOnAllChildrenByType(r.r.DTTiledLayer,!1,(i=>{this.applyTile(t,i,e,!1)})),this.end()}applyTile(t,e,i,n=!0){if(this.canceled)n&&this.end();else{if(this.activityManager.addBlockingTask(),-1!==t.xDir0.indexOf("SF_HWFIX")||-1!==t.xDir0.indexOf("SF_HWRAND"))return this.resourceManager.showMessageCallout(ht.MessageType.ERROR,ht.MessageCode.PATTERN_NOT_SUPPORTED),this.errorMsg=ht.MessageCode.PATTERN_NOT_SUPPORTED,this.activityManager.blockingTaskCompleted(),void this.end();const a=e.data,s=e.getFirstChildOfType(r.r.DTFace3D);this.patternManager.removeTileListNodes(s);const o=Object(y.r)(i,a.surfaceIndex,this.matManager);let h=0;a.arData&&a.arData.rotation&&(h+=a.arData.rotation);const l=m.g.createPatternStructureWithTiles(t,o,1);this.patternManager.addPattern(s,null,16777215,1,h,l),this.activityManager.blockingTaskCompleted(),n&&this.end()}}onEnd(t){t()}substituteTileAndUpdatePattern(t,e,i,n){this.activityManager.addBlockingTask();const a=n.data,s=m.g.substituteTile(t,e,i,a.groutSize);null!=s?this.patternManager.updatePattern(n,s):this.resourceManager.showMessageCallout(ht.MessageType.ERROR,ht.MessageCode.PATTERN_CONSTRAINTS_VIOLATION),this.activityManager.blockingTaskCompleted(),this.end()}getTileCode(t,e){let i;for(const n of e)if(n.tileIndex===t){i=n.tileCode;break}return i}}var dt=i(24);class ut{constructor(t,e,i){this.removeBase64Images=t,this.download=e,this.isSceneSetup=i,this.type=n.ExportProject}}class pt extends a.a{constructor(t,e,i,n,a,s){super(),this.project=t,this.materialManager=e,this.patternManager=i,this.imageManager=n,this.unitOfMeasurement=a,this.activeTask=s,this.activeTaskChanged=t=>{if(0===t){const t=this.command;this.export(t.isSceneSetup)}}}onStart(){if(0===this.activeTask.value){const t=this.command;this.export(t.isSceneSetup)}else this.activeTask.Changed.on(this.activeTaskChanged)}export(t){const e=this.command,i=new dt.e,n=this.project.root.data;i.version=n.verMax,i.sceneId=n.sceneId,i.type=t?r.I.STATIC:n.sceneType,i.layers=[],i.tiles=[],i.maskList=[],i.lights=[],i.rugs=[];if(this.project.root.getFirstChildOfType(r.r.DTPrjData)){const t=this.project.root.getFirstChildOfType(r.r.DTPrjData).data;i.prjData={cameraRotation:t.cameraRotation,alignPlaneHeight:t.alignPlaneHeight,hPlanesData:JSON.parse(JSON.stringify(t.hPlanesData))}}const a=[],s=this.project.root.getFirstChildOfType(r.r.DTBackgroundImage).data;i.cameraParams=s.cameraParams,i.backgroundImage={src:s.src,size:u.a.vec2Clone(s.imageSizeProcessing)};const o=n.sceneType===r.I.CUSTOM;e.removeBase64Images?i.backgroundImage.src="BACKGROUND_URL":a.push(this.imageManager.getStringImage(s.src,R.r,o));const h=this.project.root.getFirstChildOfType(r.r.DTMaskList);h&&h.walkOnAllChildrenByType(r.r.DTMask,!1,(n=>{const r=n.data;let h=r.src;e.removeBase64Images?h="MASK_URL":!t&&s.src.startsWith("data:image/jpeg;base64")?a.push(this.imageManager.getStringImage(r.src,R.u,o)):t&&!r.src.startsWith("data:image/jpeg;base64")&&a.push(this.imageManager.getStringImage(r.src,R.u));const l={id:r.id,src:h,indexes:r.indexes,reflection:r.reflection,shading:r.shading,contour2d:r.contour2d};i.maskList.push(l)}));const l=this.project.root.getFirstChildOfType(r.r.DTLightList);l&&l.walkOnAllChildrenByType(r.r.DTLight,!1,(t=>{const e=t.data,n={lightType:e.lightType,pnt:e.pnt,targetPnt:e.targetPnt,power:e.power,angle:e.angle,penumbra:e.penumbra,areaType:e.areaType,areaDim1:e.areaDim1,areaDim2:e.areaDim2,animationPositions:e.animationPositions};i.lights.push(n)}));const c=new Map;this.project.root.walkOnAllChildrenByType(r.r.DTTiledLayer,!1,(n=>{const a=n.data,s=new dt.d;s.surfaceType=r.J[a.surfaceType],s.surfaceIndex=a.surfaceIndex,s.hotspot=a.hotspot,s.arData=a.arData;const o=n.getFirstChildOfType(r.r.DTFace3D),h=o.data;s.points=h.points,s.tileList=[];const l=o.getFirstChildOfType(r.r.DTTileList);l?l.walkOnAllChildrenByType(r.r.DTPattern,!1,(n=>{const a=n.data,o={pattern:{id:a.id,groutSize:a.groutSize,groutColor:a.groutColor,rotation:a.rotation,origin:a.origin,areaRect:a.areaRect},tiles:[]};if(t){if(!e.removeBase64Images){const t={idProduct:"RRSTUDIO",idManuf:"RRSTUDIO",tileIndex:1};o.tiles.push(t);const e={fillPolicy:l.data.flags,patterns:[o]};s.tileList.push(e)}i.layers.push(s)}else{const t=this.patternManager.getPatternStructure(n.id);let e=1;for(const i of t.posFile.tiles)for(let n of t.tiles)if(n.tileCode===i.code){const t={idProduct:n.idProduct,idManuf:n.idManufacturer,tileIndex:e};e++,o.tiles.push(t);break}const a=Object(y.s)(n).data;n.walkOnAllChildrenByType(r.r.DTTileInst,!1,(t=>{const e=t.data,i={idProduct:e.idProduct,idManuf:e.idManuf,formatType:e.formatType,width:e.width,height:e.height,diagonal:e.diagonal,offshaded:e.offshaded,offshadedRot:e.offshadedRot,material:{maps:new Array(e.numImages)}};c.has(e.idProduct+":"+e.idManuf+":"+a.surfaceIndex)||c.set(e.idProduct+":"+e.idManuf+":"+a.surfaceIndex,i)}));const h={fillPolicy:l.data.flags,patterns:[o]};s.tileList.push(h),i.layers.push(s)}})):i.layers.push(s)})),this.project.root.walkOnAllChildrenByType(r.r.DTRug,!1,(n=>{const a=n.data,s=new dt.f;s.surfaceIndex=a.surfaceIndex,s.position=u.a.mat4GetPosition(a.matrix),s.rotation=-u.a.radToDeg(Math.atan2(a.matrix[1][0],a.matrix[0][0]));const o={id:a.id,mapUrl:a.texture,objModelUrl:a.objModel,mapWidth:a.textureWidth,mapHeight:a.textureHeight,shape:a.shape};t&&e.removeBase64Images&&(o.mapUrl="REPLACE_DIMENSIONS_AND_RUG_URL"),null==a.objModel&&(o.width=a.bbox.max.x-a.bbox.min.x,o.height=a.bbox.max.y-a.bbox.min.y,o.thickness=a.bbox.max.z-a.bbox.min.z),s.rugData=o,i.rugs.push(s)})),this.project.root.walkOnAllChildrenByType(r.r.DTCorridor,!1,(n=>{const a=n.data,s=new dt.c;s.surfaceIndex=a.surfaceIndex,s.position=u.a.mat4GetPosition(a.matrix),s.rotation=-u.a.radToDeg(Math.atan2(a.matrix[1][0],a.matrix[0][0]));const o={id:a.id,width:a.width,height:a.height,mapUrl:a.texture};t&&e.removeBase64Images&&(o.mapUrl="REPLACE_DIMENSIONS_AND_CORRIDOR_URL"),s.corridorData=o,i.corridor=s}));const d=[];(i.layers.length>0||i.rugs||i.corridor)&&(t?d.push(this.setupDefaultMaterial(i,e.removeBase64Images)):d.push(this.setupMaterial(c,i))),Promise.all(d).then((()=>{this.finalize(a,i,e.download,e.removeBase64Images)})).catch((()=>{console.debug("[ExportProject] setupMaterialPromises error")}))}finalize(t,e,i,n){Promise.all(t).then((t=>{if(!n&&t&&t.length>0){e.backgroundImage.src=t[0];for(let i=1;i<t.length;i++)e.maskList[i-1].src=t[i]}if(i){let t="";n&&(t="_noBase64"),B.b.downloadFile(JSON.stringify(e),"exported"+t+".json","text/json"),this.end()}else this.end(null,{data:JSON.stringify(e)})})).catch((t=>{console.debug("[ExportProject] finalize error: "+JSON.stringify(t))}))}setupMaterial(t,e){return new Promise(((i,n)=>{const a=[];for(const e of Array.from(t.keys())){const i=t.get(e),n=e.split(":");for(let t=0;t<i.material.maps.length;t++)a.push(this.materialManager.fetchTileMat(i.idManuf,i.idProduct,"0",t+1,parseFloat(n[2]),!1))}e.corridor&&a.push(this.materialManager.fetchTileMat("Corridor",e.corridor.corridorData.id,"0",1,e.corridor.surfaceIndex,!1)),Promise.all(a).then((n=>{if(n&&n.length>0){let i=0;const a=Array.from(t.keys());if(a.length>0)for(const s of a){const a=t.get(s);for(let t=0;t<a.material.maps.length;t++){const e=n[t+i];this.fillRR3MaterialFromThree(e,a.material,t)}i+=a.material.maps.length,e.tiles.push(a)}if(e.corridor){const t=n[n.length-1];null!=t.map&&(e.corridor.corridorData.mapUrl=t.map.image.src)}}i()})).catch((()=>{console.debug("[ExportProject] setupmaterial error"),n()}))}))}fillRR3MaterialFromThree(t,e,i){null!=t.map&&(e.maps[i]=t.map.image.src),null!=t.bumpMap&&(e.bumpMaps||(e.bumpMaps=[]),e.bumpMaps.push(t.bumpMap.image.src)),null!=t.metalnessMap&&(e.metalnessMaps||(e.metalnessMaps=[]),e.metalnessMaps.push(t.metalnessMap.image.src)),null!=t.normalMap&&(e.normalMaps||(e.normalMaps=[]),e.normalMaps.push(t.normalMap.image.src)),null!=t.roughnessMap&&(e.roughnessMaps||(e.roughnessMaps=[]),e.roughnessMaps.push(t.roughnessMap.image.src)),e.bumpScale=t.bumpScale,e.metalness=t.metalness,e.normalScale=t.normalScale,e.roughness=t.roughness,e.color=t.color.getHex(),e.opacity=t.opacity}setupDefaultMaterial(t,e){return new Promise(((i,n)=>{if(t.layers.length>0&&!e){let e,i,n;this.unitOfMeasurement!==ht.UNITS.FT&&this.unitOfMeasurement!==ht.UNITS.IN?(e=1e3,i=1e3,n="https://prototypes.maticad.com/rrvisualizer/images/rrstudio/metric.jpg"):(e=1219.2,i=1219.2,n="https://prototypes.maticad.com/rrvisualizer/images/rrstudio/imperial.jpg");const a={idProduct:"RRSTUDIO",idManuf:"RRSTUDIO",formatType:"RETT",width:e,height:i,diagonal:0,thickness:0,offshaded:!1,offshadedRot:!1,material:{maps:[n],roughness:1,metalness:0}};t.tiles.push(a)}i()}))}onEnd(t){this.activeTask.Changed.off(this.activeTaskChanged),t()}}class gt{constructor(t,e){this.imageFile=t,this.rug=e,this.type=n.CalcSegmentationRug}}class mt extends a.a{constructor(t,e,i,n,a,s,o){super(),this.project=t,this.aiClient=e,this.activityManager=i,this.canvasSize=n,this.aiConfig=a,this.selection=s,this.resourceManager=o}onStart(){this.activityManager.addBlockingTask(),this.startSegmentation()}startSegmentation(){const t=this.command;this.aiClient.getMasks(t.imageFile,!0).then((e=>{if(e.sessionId&&this.aiClient.setSessionId(e.sessionId),console.debug("fovX: "+u.a.radToDeg(e.cameraParameters.fovRadX)+" - fovY: "+u.a.radToDeg(e.cameraParameters.fovRadY)+" - rotation: "+u.a.radToDeg(e.cameraParameters.yaw)+" - grade: "+u.a.radToDeg(e.cameraParameters.pitch)+" - roll: "+u.a.radToDeg(e.cameraParameters.roll)+" - CAMERA HEIGHT: "+e.cameraParameters.cameraHeight),0===e.surfaces.length)return this.activityManager.blockingTaskCompleted(),this.resourceManager.showMessageCallout(f.d.ERROR,f.c.NO_FLOOR_DETECTED),void this.end();const i=new r.q,n=new r.c(i);let a,s,o=!1;for(const t of e.surfaces)if(t.surfaceType===r.J.FLOOR){o=!0,a=t.hotspot,s=t.gridPoints;break}if(o){if(e.masks[0].id===r.F.ALL){const t=e.masks[0],i=new r.p(t.id,t.maskUrl,t.indexes,this.aiConfig.defaultReflection,this.aiConfig.defaultShading);t.contour2d&&(i.contour2d=t.contour2d);const a=new r.c(i);n.appendChild(a)}else for(const t of e.masks){if(this.aiConfig.onlyFloor&&"MaskFloor"!==t.id)continue;t.maskUrl=this.aiClient.getEndpoint()+"/api/segmentation/files?id="+encodeURIComponent(t.maskUrl);const e=new r.p(t.id,t.maskUrl,t.indexes,this.aiConfig.defaultReflection,this.aiConfig.defaultShading);t.contour2d&&(e.contour2d=t.contour2d);const i=new r.c(e);n.appendChild(i)}this.project.root.appendChild(n);const i=this.project.root.getFirstChildOfType(r.r.DTBackgroundImage).data,o={fov:u.a.radToDeg(e.cameraParameters.fovRadY),grade:u.a.radToDeg(e.cameraParameters.pitch),roll:Math.abs(e.cameraParameters.roll)>.52?0:u.a.radToDeg(e.cameraParameters.roll),heightFromGround:e.cameraParameters.cameraHeight?e.cameraParameters.cameraHeight:i.cameraParams.heightFromGround,imageAspect:i.cameraParams.imageAspect,rotation:u.a.radToDeg(e.cameraParameters.yaw)};let h=e.cameraParameters.pitch;s&&(h=Object(y.d)(s[1],s[2],e.cameraParameters.pitch,o,this.canvasSize,e.imageSizeProcessing)),o.grade=u.a.radToDeg(h),i.cameraParams=o,i.imageSizeProcessing=e.imageSizeProcessing;const l=Object(y.e)();this.project.root.appendChild(l);const c=q.a.rr3RugToDTRug(t.rug,1);u.a.mat4RotZ(c.matrix,e.cameraParameters.yaw);const d=Object(y.g)(o),p=Object(y.u)(d,a,this.canvasSize);u.a.mat4Translate(c.matrix,p.x,p.y,0);const g=new r.c(c);this.project.root.appendChild(g),this.selection.set(g.id),this.project.projectChanged.notify({type:"PROJECT_BUILT"}),this.activityManager.blockingTaskCompleted(),this.end()}else this.activityManager.blockingTaskCompleted(),this.resourceManager.showMessageCallout(f.d.ERROR,f.c.NO_FLOOR_DETECTED),this.end()})).catch((t=>{console.debug("Segmentation error: "+t),this.activityManager.blockingTaskCompleted(),this.end()}))}onEnd(t){t()}}var ft=i(22);class yt{constructor(t,e=!0){this.gizmoCenter=t,this.inRug=e,this.type=n.EditRug}}class vt extends a.a{constructor(t,e,i,n,a,s,o,h,l,c,d,p){super(),this.project=t,this.selection=e,this.objectControls=i,this.sceneEntities=n,this.gizmoConfig=a,this.renderer=s,this.scene=o,this.camera=h,this.matManager=l,this.renderFrame=c,this.resourceManager=d,this.phScene=p,this.gizmoConfigChanged=t=>{console.debug("[EditRug] gizmoConfigChanged -------------------------------------"),this.updateGizmoPosition=!0;const e=this.getSelectedRug();if(e){if(this.gizmoControls.updateGizmoConfig(t),this.interactionObject=this.sceneEntities.get(e.id),t.position==ft.b.INSIDE&&null==this.worldThreePoint){const t=u.a.mat4GetPosition(this.activeRug.matrix);t.z=this.activeRug.bbox.max.z,this.updateCenterPoint(t,!1)}this.onEntityInteractionObjectChanged(this.interactionObject)}},this.onPointerDown=t=>{console.debug("[EditRug] POINTER DOWN intersections: "+t.intersections.length+" - pointer: "+JSON.stringify(t.pointer));for(const e of t.intersections)if(this.interactionObject=b.a.getSelfOrAncestorObject3D(e.object,(t=>nt.a.isGizmoPart(t))),this.interactionObject)return console.debug("[EditRug] gizmo clicked"),t.target=e,t.handled=!1,void(this.eventType=t.originalEvent.type);console.debug("[EditRug] checking rug intersection");for(const e of t.intersections)if(this.interactionObject=b.a.getSelfOrAncestorObject3D(e.object,(t=>{const e=t.userData,i=this.project.root.getIndexedNodeById(e.id);return!(!i||i.data.type!==r.r.DTRug)})),this.interactionObject){if("RUG-TOP"!==this.interactionObject.name&&"RUG-BORDER"!==this.interactionObject.name||(this.interactionObject=this.interactionObject.parent),console.debug("[EditRug] rug clicked"),t.target=e,t.handled=!0,this.gizmoConfig.value.position==ft.b.INSIDE){const t=new j.Vector3(e.point.x,e.point.y,e.point.z),i=Object(u.c)(t.applyMatrix4(C.c));this.updateCenterPoint(i,!1)}const i=this.project.root.getIndexedNodeById(this.interactionObject.userData.id);this.activeRug=i.data,this.activeRugId=i.id;const n=t.originalEvent.type;return this.resourceManager.setSelectedLayer(r.J.RUG,this.activeRug.surfaceIndex,n),void this.onEntityInteractionObjectChanged(this.interactionObject)}},this.onPointerUp=t=>{if((this.isDragEnd||this.isRotationEnd||this.startFingerRotation)&&this.gizmoConfig.value.autoReposition){this.gizmoControls.setVisibility(!1);const e=this.renderer.getSize(new j.Vector2),i=Math.round(e.x/8),n=Math.round(e.y/8);this.matManager.setMatResolution(i,n),this.renderer.setSize(i,n),this.renderer.setPixelRatio(1),this.renderer.autoClear=!0,this.renderer.render(this.scene,this.camera);const a=this.renderer.domElement.toDataURL("image/"+R.r,1);this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setSize(e.width,e.height),this.matManager.setMatResolution(e.width*window.devicePixelRatio,e.height*window.devicePixelRatio),this.gizmoControls.setVisibility(!0);const s=new Image;s.crossOrigin="anonymous",s.onload=()=>{const e=s.width,i=s.height;let n=document.createElement("canvas");n.width=e,n.height=i;const a=n.getContext("2d",{alpha:!1});a.imageSmoothingEnabled=!1,a.clearRect(0,0,e,i),a.drawImage(s,0,0,e,i);const o=a.getImageData(0,0,e,i);let h=0;for(let t=0;t<o.data.length;t+=4)0!==o.data[t]&&(h+=o.data[t]);if(a.clearRect(0,0,e,i),n=null,h<50){const t=this.sceneEntities.get(this.activeRugId);if(this.isDragEnd){const t=u.a.mat4Clone(this.activeRug.matrix);u.a.mat4SetPosition(t,this.startPosition),this.activeRug.matrix=t}else this.isRotationEnd&&(this.activeRug.matrix=this.startMatrix);b.a.setObject3DTransform(t,Object(C.e)(this.activeRug.matrix,C.c,C.a)),this.gizmoControls.update(),this.renderFrame.value=!0}else this.interactionObject=null;this.eventType=null,this.startFingerRotation=null;const l=t.originalEvent.type;this.resourceManager.setSelectedLayer(r.J.RUG,this.activeRug.surfaceIndex,l)},s.src=a}else{this.interactionObject=null,this.eventType=null,this.startFingerRotation=null;const e=t.originalEvent.type;this.resourceManager.setSelectedLayer(r.J.RUG,this.activeRug.surfaceIndex,e)}},this.onClick=t=>{if(this.interactionObject){const e=this.interactionObject.userData.id,i=this.getSelectedRug();if(i&&i.id===e){if(this.gizmoConfig.value.position==ft.b.INSIDE){let e;for(const i of t.intersections)if(i.object.name.includes("RUG-TOP")||i.object.name.includes("RUG-BORDER")){const t=new j.Vector3(i.point.x,i.point.y,i.point.z);e=Object(u.c)(t.applyMatrix4(C.c));break}this.updateCenterPoint(e,!1)}t.handled=!0,this.attachGizmo(this.interactionObject),this.renderFrame.value=!0}else this.gizmoControls.detach()}},this.onDragStart=t=>{if(this.interactionObject){const e=this.interactionObject.userData.id,i=this.getSelectedRug();i&&i.id===e&&(t.handled=!0,this.activeRug=i.data,this.activeRugId=i.id,this.gizmoConfig.value.position==ft.b.INSIDE&&(this.currGizmoPos=this.worldThreePoint.clone()),this.startPosition=u.a.mat4GetPosition(this.activeRug.matrix),this.resourceManager.userInteractionStart&&this.resourceManager.userInteractionStart())}},this.onDrag=t=>{if(this.interactionObject&&this.selection.has(this.interactionObject.userData.id)){t.handled=!0;const e=u.a.mat4GetIdentity();u.a.mat4SetPosition(e,Object(u.c)(t.delta.clone().applyMatrix4(C.c))),this.transformMatrix=u.a.mat4Clone(this.activeRug.matrix),u.a.mat4Mult(e,this.transformMatrix),u.a.mat4SetPositionZ(this.transformMatrix,0),b.a.setObject3DTransform(this.interactionObject,Object(C.e)(this.transformMatrix,C.c,C.a)),this.gizmoConfig.value.position==ft.b.INSIDE?(this.gizmoControls.update(this.worldThreePoint.clone().add(t.delta.clone())),this.currGizmoPos=this.worldThreePoint.clone().add(t.delta.clone())):this.gizmoControls.update(),this.renderFrame.value=!0}},this.onDragEnd=t=>{this.interactionObject&&this.selection.has(this.interactionObject.userData.id)&&(t.handled=!0,this.activeRug.matrix=this.transformMatrix,this.gizmoConfig.value.position==ft.b.INSIDE&&(this.worldThreePoint=this.currGizmoPos.clone()),this.isDragEnd=!0,this.isRotationEnd=!1,this.resourceManager.userInteractionEnd&&this.resourceManager.userInteractionEnd(),this.renderFrame.value=!0)},this.onGizmoChanged=t=>{switch(t.type){case"BEGIN":{this.activeRugId=t.target.userData.id;const e=this.project.root.getIndexedNodeById(this.activeRugId);this.activeRug=e.data,this.gizmoConfig.value.detailedEvents&&this.resourceManager.setSelectedLayer(r.J.RUG,this.activeRug.surfaceIndex,this.eventType),this.resourceManager.userInteractionStart&&this.resourceManager.userInteractionStart(),this.startMatrix=u.a.mat4Clone(this.activeRug.matrix);break}case"CHANGED":this.updateGizmoTargetTransform(t),this.renderFrame.value=!0;break;case"END":this.activeRug.matrix=this.getObject3DMat4(t.target),this.isRotationEnd=!0,this.isDragEnd=!1,this.resourceManager.userInteractionEnd&&this.resourceManager.userInteractionEnd()}},this.updateGizmoTargetTransform=t=>{if(this.gizmoConfig.value.position==ft.b.INSIDE){const e=t.deltaRotation-this.lastRotation,i=this.worldThreePoint.clone(),n=new j.Vector3(0,1,0);t.target.position.sub(i),t.target.position.applyAxisAngle(n,e),t.target.position.add(i),t.target.rotateOnAxis(n,e),this.lastRotation=t.deltaRotation}else t.target.position.copy(t.targetPosition),t.target.rotation.copy(t.targetRotation),t.target.scale.copy(t.targetScale)},this.onTwoFingerStart=t=>{if(!this.interactionObject){const t=this.getSelectedRug();t&&(this.interactionObject=this.sceneEntities.get(t.id),this.activeRug=t.data,this.activeRugId=t.id)}if(this.interactionObject){const e=this.project.root.getIndexedNodeById(this.interactionObject.userData.id);this.activeRug=e.data,this.activeRugId=e.id,this.startMatrix=u.a.mat4Clone(this.activeRug.matrix),this.startFingerRotation=u.a.vec2Angle(t.startFingerPositions[1],t.startFingerPositions[0]),this.transformMatrix=u.a.mat4Clone(this.activeRug.matrix),this.resourceManager.setSelectedLayer(r.J.RUG,this.activeRug.surfaceIndex,t.originalEvent.type),this.resourceManager.userInteractionStart&&this.resourceManager.userInteractionStart(),t.handled=!0}},this.onTwoFingerMove=t=>{if(this.startFingerRotation&&this.interactionObject&&this.activeRug){const e=u.a.vec2Angle(t.fingerPositions[1],t.fingerPositions[0]),i=this.startFingerRotation-e;let n;this.startFingerRotation=e,n=this.gizmoConfig.value.position==ft.b.INSIDE?Object(u.c)(this.worldThreePoint.clone().applyMatrix4(C.c)):u.a.mat4GetPosition(this.transformMatrix),u.a.mat4Translate(this.transformMatrix,-n.x,-n.y,-n.z);const a=u.a.mat4GetIdentity();u.a.mat4RotZ(a,i),u.a.mat4Mult(a,this.transformMatrix),u.a.mat4Translate(this.transformMatrix,n.x,n.y,n.z);const s=this.sceneEntities.get(this.activeRugId);b.a.setObject3DTransform(s,Object(C.e)(this.transformMatrix,C.c,C.a)),this.gizmoControls.update(),this.renderFrame.value=!0,t.handled=!0}},this.onTwoFingerEnd=t=>{this.startFingerRotation&&this.interactionObject&&this.activeRug&&(this.isRotationEnd=!0,this.isDragEnd=!1,this.activeRug.matrix=this.transformMatrix,this.resourceManager.userInteractionEnd&&this.resourceManager.userInteractionEnd())},this.phScene.children=[],this.gizmoControls=new nt.a(this.objectControls,this.gizmoConfig.value,this.phScene),this.isDragEnd=!1,this.isRotationEnd=!1,this.updateGizmoPosition=!1,this.lastRotation=0,this.gizmoConfig.Changed.on(this.gizmoConfigChanged)}updateCenterPoint(t,e=!0){if(t){if(e)this.centerModelPoint=u.a.vec3Clone(t);else{const e=u.a.mat4GetInverted(this.activeRug.matrix);this.centerModelPoint=u.a.pnt3Transform(e,t)}this.centerModelPoint.x=0,this.gizmoConfig.value.centerPositionChanged&&this.gizmoConfig.value.position==ft.b.INSIDE&&this.gizmoConfig.value.centerPositionChanged(this.centerModelPoint);const i=u.a.pnt3Transform(this.activeRug.matrix,this.centerModelPoint);this.worldThreePoint=Object(u.f)(i).applyMatrix4(C.a),this.updateGizmoPosition=!0}}attachGizmo(t){if(this.gizmoControls.targetObject===t&&!this.updateGizmoPosition)return;(null!=this.gizmoControls.targetObject||this.updateGizmoPosition)&&(this.gizmoControls.detach(),this.updateGizmoPosition=!1);const e=this.project.root.getIndexedNodeById(t.userData.id);if(this.activeRug=e.data,this.activeRugId=e.id,this.gizmoConfig.value.position==ft.b.INSIDE){const e=(this.activeRug.bbox.max.x-this.activeRug.bbox.min.x)/2,i={min:{x:-e,y:this.centerModelPoint.y-e,z:0},max:{x:e,y:this.centerModelPoint.y+e,z:this.activeRug.bbox.max.z}},n=Object(C.d)(i,C.a);this.gizmoControls.attach(t,this.gizmoConfig.value.gizmoRotationEnabled,n,this.worldThreePoint.clone())}else{const e=Object(C.d)(this.activeRug.bbox,C.a);this.gizmoControls.attach(t,this.gizmoConfig.value.gizmoRotationEnabled,e)}this.gizmoControls.setVisibility(!0),this.renderFrame.value=!0}attachEventHandlers(){this.objectControls.addEventListener(M.b.POINTERDOWN,this.onPointerDown),this.objectControls.addEventListener(M.b.POINTERUP,this.onPointerUp),this.objectControls.addEventListener(M.b.DRAGSTART,this.onDragStart),this.objectControls.addEventListener(M.b.DRAG,this.onDrag),this.objectControls.addEventListener(M.b.DRAGEND,this.onDragEnd),this.objectControls.addEventListener(M.b.CLICK,this.onClick),this.objectControls.addEventListener(M.b.TWOFINGERSTART,this.onTwoFingerStart),this.objectControls.addEventListener(M.b.TWOFINGERMOVE,this.onTwoFingerMove),this.objectControls.addEventListener(M.b.TWOFINGEREND,this.onTwoFingerEnd),this.gizmoControls.onChange.attach(this.onGizmoChanged)}detachEventHandlers(){this.objectControls.removeEventListener(M.b.POINTERDOWN,this.onPointerDown),this.objectControls.removeEventListener(M.b.POINTERUP,this.onPointerUp),this.objectControls.removeEventListener(M.b.DRAGSTART,this.onDragStart),this.objectControls.removeEventListener(M.b.DRAG,this.onDrag),this.objectControls.removeEventListener(M.b.DRAGEND,this.onDragEnd),this.objectControls.removeEventListener(M.b.CLICK,this.onClick),this.objectControls.removeEventListener(M.b.TWOFINGERSTART,this.onTwoFingerStart),this.objectControls.removeEventListener(M.b.TWOFINGERMOVE,this.onTwoFingerMove),this.objectControls.removeEventListener(M.b.TWOFINGEREND,this.onTwoFingerEnd),this.gizmoControls.onChange.detach(this.onGizmoChanged)}getObject3DMat4(t){return t.updateMatrix(),Object(C.g)(t.matrix,C.c,C.a)}onEntityInteractionObjectChanged(t){if(t){const e=t.userData.id;this.selection.has(e)&&this.attachGizmo(t)}}getSelectedRug(){return Object(y.p)(this.project,this.selection,r.r.DTRug)}onStart(){this.attachEventHandlers();const t=this.getSelectedRug();if(t){this.interactionObject=this.sceneEntities.get(t.id),this.activeRug=t.data,this.activeRugId=t.id;const e=this.command;if(this.gizmoConfig.value.position==ft.b.INSIDE){const t=null==e.gizmoCenter?u.a.mat4GetPosition(this.activeRug.matrix):e.gizmoCenter;t.z=this.activeRug.bbox.max.z,this.updateCenterPoint(t,e.inRug)}this.onEntityInteractionObjectChanged(this.interactionObject)}else this.end()}onEnd(t){this.detachEventHandlers(),this.gizmoControls.detach(),this.renderFrame.value=!0,this.gizmoConfig.Changed.off(this.gizmoConfigChanged),this.phScene.children=[],this.gizmoControls=null,this.interactionObject=null,this.activeRug=null,this.transformMatrix=null,this.startPosition=null,this.startMatrix=null,t()}}function xt(t,e){const i=q.a.rr3RugToDTRug(t,0),n=e.data;n.id=t.id,n.texture=t.mapUrl,n.objModel=i.objModel;const a=Math.abs(n.bbox.max.x-n.bbox.min.x)/Math.abs(n.bbox.max.y-n.bbox.min.y),s=Math.abs(i.bbox.max.x-i.bbox.min.x)/Math.abs(i.bbox.max.y-i.bbox.min.y);if(a>=1&&s<1||a<1&&s>=1){const t=u.a.mat4GetPosition(n.matrix);u.a.mat4Translate(n.matrix,-t.x,-t.y,-t.z),u.a.mat4RotZ(n.matrix,u.a.degToRad(90)),u.a.mat4Translate(n.matrix,t.x,t.y,t.z)}n.bbox=i.bbox,n.shape=i.shape,n.textureWidth=i.textureWidth,n.textureHeight=i.textureHeight}class Tt{constructor(t,e){this.rug=t,this.replaceExisting=e,this.type=n.AddRug}}class Mt extends a.a{constructor(t,e,i,n,a,s){super(),this.project=t,this.selection=e,this.canvasSize=i,this.camera=n,this.activityManager=a,this.userInteractionEnabled=s}onStart(){const t=this.command;if(t.replaceExisting){const e=this.project.root.countAllChildrenByType(r.r.DTRug,!1);if(0===e)this.addRug(t.rug);else if(1===e){const e=this.project.root.getFirstChildOfType(r.r.DTRug);this.replaceRug(t.rug,e)}else{const e=this.selection.getSelectionSet().values().next().value,i=this.project.root.getIndexedNodeById(e);i&&i.data.type===r.r.DTRug?this.replaceRug(t.rug,i):(this.errorMsg="SELECT_ONE_RUG",this.end())}}else this.addRug(t.rug)}addRug(t){let e;if(this.activityManager.addBlockingTask(),this.project.root.walkOnAllChildrenByType(r.r.DTTiledLayer,!1,(t=>{const i=t.data;i.surfaceType===r.J.FLOOR&&(e=i)})),e){const i=q.a.rr3RugToDTRug(t,e.surfaceIndex),n=Object(y.u)(this.camera,e.hotspot,this.canvasSize);u.a.mat4Translate(i.matrix,n.x,n.y,0);const a=new r.c(i);this.project.addRug(a),this.selection.set(a.id),this.activityManager.blockingTaskCompleted(),this.end(this.userInteractionEnabled?new yt(n,!1):null)}else console.log("NO FLOOR LAYER, WHERE DO I PLACE THE RUG?"),this.activityManager.blockingTaskCompleted(),this.end()}replaceRug(t,e){this.activityManager.addBlockingTask(),xt(t,e),this.selection.set(e.id);const i=e.data,n=u.a.mat4GetPosition(i.matrix);this.activityManager.blockingTaskCompleted(),this.project.projectChanged.notify({type:"RUG_UPDATED",node:e}),this.end(this.userInteractionEnabled?new yt(n,!1):null)}onEnd(t){t()}}class Ct{constructor(t,e,i,a){this.pattern=t,this.tiles=e,this.groutSize=i,this.rotation=a,this.type=n.ApplyPatternExt}}class bt extends a.a{constructor(t,e,i,n,a,s,o){super(),this.project=t,this.selection=e,this.tileClient=i,this.patternManager=n,this.resourceManager=a,this.matManager=s,this.activityManager=o}onStart(){const t=this.command,e=this.selection.getSelectionSet().values().next().value;if(this.activityManager.addBlockingTask(),e){const i=this.project.root.getIndexedNodeById(e);if(i&&i.data.type===r.r.DTTiledLayer)if(null!=v.patterns[t.pattern.toLowerCase()]){const e=v.patterns[t.pattern.toLowerCase()];this.applyPattern(e,i,t.tiles,t.groutSize,t.rotation)}else this.tileClient.getPosFile(t.pattern).then((e=>{this.applyPattern(e,i,t.tiles,t.groutSize,t.rotation)})).catch((t=>{this.activityManager.blockingTaskCompleted(),"core"!==t.message&&(this.errorMsg=JSON.stringify(t.stack)),this.end()}));else this.errorMsg="Cannot find node",this.activityManager.blockingTaskCompleted(),this.end()}else this.errorMsg="No surface selected",this.activityManager.blockingTaskCompleted(),this.end()}applyPattern(t,e,i,n,a){if(this.canceled)this.activityManager.blockingTaskCompleted(),this.end();else{-1===t.xDir0.indexOf("SF_HWFIX")&&-1===t.xDir0.indexOf("SF_HWRAND")||(this.errorMsg=ht.MessageCode.PATTERN_NOT_SUPPORTED,this.end()),t.tiles.length!==i.length&&(this.errorMsg=ht.MessageCode.PATTERN_CONSTRAINTS_VIOLATION,this.end());const s=e.data,o=Object(y.r)(i,s.surfaceIndex,this.matManager),h=m.g.createPatternStructureWithTiles(t,o,n);if(h){const t=e.getFirstChildOfType(r.r.DTFace3D);this.patternManager.removeTileListNodes(t);let i={x:0,y:0};e.data.type===r.r.DTPattern&&(i=u.a.vec2Clone(e.data.origin));let o=a;s.arData&&s.arData.rotation&&(o+=s.arData.rotation);const l=this.patternManager.addPattern(t,null,16777215,n,o,h,i,!0);this.activityManager.blockingTaskCompleted(),this.end(new E(l))}else this.activityManager.blockingTaskCompleted(),this.errorMsg=ht.MessageCode.PATTERN_CONSTRAINTS_VIOLATION,this.end()}}onEnd(t){t()}}class Pt{constructor(t){this.corridor=t,this.type=n.AddCorridor}}class Et extends a.a{constructor(t,e,i,n,a){super(),this.project=t,this.canvasSize=e,this.camera=i,this.activityManager=n,this.selection=a}onStart(){const t=this.command;this.activityManager.addBlockingTask();const e=[{x:t.corridor.width/2,y:-R.i/2,z:R.h},{x:-t.corridor.width/2,y:-R.i/2,z:R.h},{x:-t.corridor.width/2,y:R.i/2,z:R.h},{x:t.corridor.width/2,y:R.i/2,z:R.h}];let i=1;const n=this.project.root.getFirstChildOfType(r.r.DTMaskList);for(const t of n.childNodes){const e=t.data;if(e.id==r.F.FLOOR&&e.indexes){i=e.indexes[0];break}}const a=new r.e(t.corridor.id,t.corridor.width,t.corridor.height,i,e,t.corridor.mapUrl);let s,o=this.project.root.getFirstChildOfType(r.r.DTCorridor);if(o){this.project.root.removeChildById(o.id),this.project.projectChanged.notify({type:"CORRIDOR_REMOVED",node:o});const t=o.data;a.matrix=u.a.mat4Clone(t.matrix),s=u.a.mat4GetPosition(a.matrix)}else{let t,e=0;this.project.root.walkOnAllChildrenByType(r.r.DTTiledLayer,!1,(i=>{const n=i.data;n.surfaceType==r.J.FLOOR&&(t=n.hotspot,n.arData&&n.arData.rotation&&(e=n.arData.rotation))})),s=Object(y.u)(this.camera,t,this.canvasSize);const i=this.project.root.getFirstChildOfType(r.r.DTPrjData);if(i){const t=i.data;e=t.cameraRotation}u.a.mat4RotZ(a.matrix,e),u.a.mat4SetPosition(a.matrix,s)}o=new r.c(a),this.project.root.appendChild(o),this.project.projectChanged.notify({type:"CORRIDOR_ADDED",node:o}),this.selection.set(o.id),this.activityManager.blockingTaskCompleted(),this.end(new at(s))}onEnd(t){t()}}class Dt{constructor(t,e,i,a){this.imageFile=t,this.corridor=e,this.tiles=i,this.pattern=a,this.type=n.CalcSegmentationCorridor}}class wt extends a.a{constructor(t,e,i,n,a,s,o,h,l,c){super(),this.project=t,this.aiClient=e,this.activityManager=i,this.canvasSize=n,this.aiConfig=a,this.matManager=s,this.patternManager=o,this.selection=h,this.resourceManager=l,this.tileClient=c,this.addFloorLayer=(t,e,i,n,a,s)=>new Promise(((o,h)=>{const l=new r.A;l.surfaceType=t.surfaceType,l.surfaceIndex=t.surfaceIndex,l.hotspot=t.hotspot;const c=Object(y.f)(t.surfaceType),d=c.data;l.arData={gridPoints:t.gridPoints,alignPoints:t.alignPoints,rotation:n},d.classId=r.h.CLASSID_FLOOR_AI;const p=Object(y.j)(t.gridPoints,e,i,this.canvasSize);let g=0;if(p){d.points=p;const t=u.a.box3FromPoints(p);g=Math.max(Math.abs(t.max.x-t.min.x),Math.abs(t.max.y-t.min.y))}else{const t=u.a.mat4GetIdentity();u.a.mat4RotZ(t,n);const e=u.a.pnt3TransformArray(t,d.points);d.points=e}const m=new r.c(l);if(m.appendChild(c),this.project.root.appendChild(m),null!=v.patterns[s.toLowerCase()]){const t=v.patterns[s.toLowerCase()];this.applyTile(t,c,l.surfaceIndex,a),o(g)}else this.tileClient.getPosFile(s).then((t=>{this.applyTile(t,c,l.surfaceIndex,a),o(g)})).catch((t=>{console.debug("CalcSegmentationCorridor error: "+JSON.stringify(t)),o(g)}))}))}onStart(){this.activityManager.addBlockingTask(),this.startSegmentation()}startSegmentation(){const t=this.command;this.aiClient.getMasks(t.imageFile,!0).then((e=>{if(e.sessionId&&this.aiClient.setSessionId(e.sessionId),0===e.surfaces.length)return this.activityManager.blockingTaskCompleted(),this.resourceManager.showMessageCallout(f.d.ERROR,f.c.NO_FLOOR_DETECTED),void this.end();const i=new r.q,n=new r.c(i);let a,s,o=!1;for(const t of e.surfaces)if(t.surfaceType===r.J.FLOOR){o=!0,a=t.hotspot,s=t.gridPoints;break}if(o){if(e.masks[0].id===r.F.ALL){const t=e.masks[0],i=new r.p(t.id,t.maskUrl,t.indexes,this.aiConfig.defaultReflection,this.aiConfig.defaultShading);t.contour2d&&(i.contour2d=t.contour2d);const a=new r.c(i);n.appendChild(a)}else for(const t of e.masks){if(this.aiConfig.onlyFloor&&"MaskFloor"!==t.id)continue;t.maskUrl=this.aiClient.getEndpoint()+"/api/segmentation/files?id="+encodeURIComponent(t.maskUrl);const e=new r.p(t.id,t.maskUrl,t.indexes,this.aiConfig.defaultReflection,this.aiConfig.defaultShading);t.contour2d&&(e.contour2d=t.contour2d);const i=new r.c(e);n.appendChild(i)}this.project.root.appendChild(n);const i=this.project.root.getFirstChildOfType(r.r.DTBackgroundImage).data,o={fov:u.a.radToDeg(e.cameraParameters.fovRadY),grade:u.a.radToDeg(e.cameraParameters.pitch),roll:Math.abs(e.cameraParameters.roll)>.52?0:u.a.radToDeg(e.cameraParameters.roll),heightFromGround:e.cameraParameters.cameraHeight?e.cameraParameters.cameraHeight:i.cameraParams.heightFromGround,imageAspect:i.cameraParams.imageAspect,rotation:u.a.radToDeg(e.cameraParameters.yaw)};let h=e.cameraParameters.pitch;s&&(h=Object(y.d)(s[1],s[2],e.cameraParameters.pitch,o,this.canvasSize,e.imageSizeProcessing)),o.grade=u.a.radToDeg(h),i.cameraParams=o,i.imageSizeProcessing=e.imageSizeProcessing;const l=Object(y.g)(o);let c,d=1;for(const t of e.surfaces)if(c=t,c.surfaceType===r.J.FLOOR){a=c.hotspot,s=c.gridPoints,d=c.surfaceIndex;break}if(null!=t.tiles&&null!=t.pattern)this.addFloorLayer(c,l,i.imageSizeProcessing,e.cameraParameters.yaw,t.tiles,t.pattern).then((i=>{this.addCorridorAndLights(t,e,d,a,i,l)})).catch((t=>{console.debug("[CalcSegmentationCorridor] addFloorLayer error: "+JSON.stringify(t))}));else{const i=Object(y.j)(s,l,e.imageSizeProcessing,this.canvasSize),n=u.a.box3FromPoints(i),o=Math.max(Math.abs(n.max.x-n.min.x),Math.abs(n.max.y-n.min.y));this.addCorridorAndLights(t,e,d,a,o,l)}}else this.activityManager.blockingTaskCompleted(),this.resourceManager.showMessageCallout(f.d.ERROR,f.c.NO_FLOOR_DETECTED),this.end()})).catch((t=>{console.debug("Segmentation error: "+t),this.activityManager.blockingTaskCompleted(),this.end()}))}addCorridorAndLights(t,e,i,n,a,s){const o=Object(y.e)();this.project.root.appendChild(o);const h=a>R.i?a:R.i,l=[{x:t.corridor.width/2,y:-h/2,z:R.h},{x:-t.corridor.width/2,y:-h/2,z:R.h},{x:-t.corridor.width/2,y:h/2,z:R.h},{x:t.corridor.width/2,y:h/2,z:R.h}],c=new r.e(t.corridor.id,t.corridor.width,t.corridor.height,i,l,t.corridor.mapUrl),d=Object(y.u)(s,n,this.canvasSize);u.a.mat4RotZ(c.matrix,e.cameraParameters.yaw),u.a.mat4Translate(c.matrix,d.x,d.y,0);const p=new r.c(c);this.project.root.appendChild(p),this.selection.set(p.id),this.project.projectChanged.notify({type:"PROJECT_BUILT"}),this.activityManager.blockingTaskCompleted(),this.end(new at(d))}applyTile(t,e,i,n){if(-1!==t.xDir0.indexOf("SF_HWFIX")||-1!==t.xDir0.indexOf("SF_HWRAND"))return;const a=Object(y.r)(n,i,this.matManager),s=e.parentNode.data;let o=0;s.arData&&s.arData.rotation&&(o+=s.arData.rotation);const r=m.g.createPatternStructureWithTiles(t,a,1);this.patternManager.addPattern(e,null,16777215,1,o,r,null,!1,!1)}onEnd(t){t()}}class St{constructor(){this.type=n.RemoveCorridor}}class It extends a.a{constructor(t){super(),this.project=t}onStart(){let t=this.project.root.getFirstChildOfType(r.r.DTCorridor);t&&(this.project.root.removeChildById(t.id),this.project.projectChanged.notify({type:"CORRIDOR_REMOVED",node:t})),this.end()}onEnd(t){t()}}var Lt=function(t,e,i,n){return new(i||(i=Promise))((function(a,s){function o(t){try{h(n.next(t))}catch(t){s(t)}}function r(t){try{h(n.throw(t))}catch(t){s(t)}}function h(t){var e;t.done?a(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,r)}h((n=n.apply(t,e||[])).next())}))};class At{constructor(t,e,i){this.rugs=t,this.size=e,this.onImageReady=i,this.type=n.GetSceneRugImage}}class Ot extends a.a{constructor(t,e,i,n,a,s){super(),this.project=t,this.imageManager=e,this.modelToThreeMap=i,this.maskTextures=n,this.rugLoader=a,this.activityManager=s}onStart(){return Lt(this,void 0,void 0,(function*(){const t=this.command,e=this.project.save(),i=this.project.root.getFirstChildOfType(r.r.DTRug),n=[];for(const e of t.rugs){const a=yield this.replaceRug(e,t.size,i);n.push(a)}this.project.loadNew(e),t.onImageReady(n),this.end()}))}replaceRug(t,e,i){return Lt(this,void 0,void 0,(function*(){return new Promise(((n,a)=>{xt(t,i);const s=i.data,o=this.modelToThreeMap.get(i.id);b.a.setObject3DTransform(o,Object(C.e)(s.matrix,C.c,C.a));const h=Object(y.m)(r.J.FLOOR,this.maskTextures);this.rugLoader.updateRug(o,i,s.surfaceIndex,h,!1).then((()=>{this.imageManager.getImage(e.x,e.y,!1).then((t=>{n(t.img)})).catch((()=>{console.debug("getImage error"),a()}))})).catch((()=>{console.debug("updateRug error"),a()}))}))}))}onEnd(t){t()}}var Rt=i(48),_t=i(45);class kt{constructor(t,e){this.perspectiveEndpoint=t,this.apiToken=e,this.type=n.CalcPerspective}}class jt extends a.a{constructor(t,e,i,n,a,s,o,h,l,c){super(),this.project=t,this.phScene=e,this.resourceManager=i,this.perspectiveCanvasManager=n,this.activityManager=a,this.renderFrame=s,this.inputDomElement=o,this.camera=h,this.width=l,this.height=c,this.allLinesMovedCallBack=()=>{this.perspectiveProps.calcPerspButtonEnable=!0,this.resourceManager.loadPerspectiveSetup(this.perspectiveProps)},this.calcPerspective=()=>{const t=this.perspectiveCanvasManager.getVanishingLineData();this.perspectiveCanvasManager.removePerspectiveCanvas(),this.activityManager.addBlockingTask(),this.perspectiveClient.perspectiveFromVanishingLine(t).then((t=>{const e=this.project.root.getFirstChildOfType(r.r.DTBackgroundImage),i=e.data;i.cameraParams.fov=u.a.radToDeg(t.fovRadY),i.cameraParams.grade=u.a.radToDeg(t.pitch),i.cameraParams.roll=u.a.radToDeg(t.roll),i.cameraParams.rotation=u.a.radToDeg(t.yaw),this.project.projectChanged.notify({type:"CAMERAPARAMS_UPDATED",node:e}),this.gridHelper.rotation.y=t.yaw,this.gridHelper.visible=!0,this.alignPlaneGridHelper.rotation.y=t.yaw,this.alignPlaneGridHelper.visible=!0;const n=new r.t;n.cameraRotation=t.yaw,n.alignPlaneHeight=0;const a=new r.c(n);this.project.root.appendChild(a),this.perspectiveProps.perspParams.fov=u.a.round(i.cameraParams.fov,2),this.perspectiveProps.perspParams.grade=u.a.round(i.cameraParams.grade,2),this.perspectiveProps.perspParams.rotation=u.a.round(u.a.radToDeg(t.yaw),2),this.perspectiveProps.perspParams.roll=u.a.round(u.a.radToDeg(t.roll),2),this.perspectiveProps.perspParams.heightFromGround=i.cameraParams.heightFromGround,this.perspectiveProps.advancedControlsEnable=!0,this.perspectiveProps.nextButtonEnabled=!0,this.resourceManager.loadPerspectiveSetup(this.perspectiveProps),this.activityManager.blockingTaskCompleted()})).catch((t=>{console.debug("perspectiveFromVanishingLine error: "+JSON.stringify(t)),this.gridHelper.visible=!0,this.alignPlaneGridHelper.visible=!0,this.perspectiveProps.advancedControlsEnable=!0,this.perspectiveProps.nextButtonEnabled=!0,this.resourceManager.loadPerspectiveSetup(this.perspectiveProps),this.activityManager.blockingTaskCompleted()}))},this.editPerspectiveParam=t=>{const e=this.project.root.getFirstChildOfType(r.r.DTBackgroundImage),i=e.data;i.cameraParams.fov=t.fov,i.cameraParams.grade=t.grade,i.cameraParams.roll=t.roll,i.cameraParams.heightFromGround=t.heightFromGround,i.cameraParams.rotation=t.rotation,this.project.projectChanged.notify({type:"CAMERAPARAMS_UPDATED",node:e}),this.gridHelper.rotation.y=u.a.degToRad(t.rotation),this.alignPlaneGridHelper.rotation.y=u.a.degToRad(t.rotation),this.alignPlaneGridHelper.position.y=t.alignPlaneHeight*_t.a;const n=this.project.root.getFirstChildOfType(r.r.DTPrjData);if(n){const e=n.data;e.cameraRotation=u.a.degToRad(t.rotation),e.alignPlaneHeight=t.alignPlaneHeight}},this.pointerDownEventHandler=t=>{this.mouseClick=!0},this.pointerMoveEventHandler=t=>{if(this.gridHelper&&this.gridHelper.visible&&this.mouseClick){const e=W.a.getPointerCoordinates(t,this.inputDomElement.parentElement.id),i=b.a.viewportToPlaneWorldPosition(e,this.camera,this.width,this.height,this.planeNormal,this.planePoint);null!=i&&(this.alignPlaneGridHelper.position.x=i.x,this.alignPlaneGridHelper.position.z=i.z,this.gridHelper.position.x=i.x,this.gridHelper.position.z=i.z,this.renderFrame.value=!0)}},this.pointerUpEventHandler=t=>{this.mouseClick=!1},this.nextButtonCallBack=()=>{this.resourceManager.perspectiveSetupFinished(),this.phScene.remove(this.gridHelper),this.phScene.remove(this.alignPlaneGridHelper),this.renderFrame.value=!0,this.end()},this.mouseClick=!1,this.planeNormal=new j.Vector3(0,1,0),this.planePoint=new j.Vector3(0,0,1),this.gridHelper=new j.GridHelper(200,200,16711680,65280),this.gridHelper.visible=!1,this.phScene.add(this.gridHelper),this.alignPlaneGridHelper=new j.GridHelper(200,200,16711680,255),this.alignPlaneGridHelper.visible=!1,this.phScene.add(this.alignPlaneGridHelper),this.perspectiveProps={calcPerspButtonEnable:!0,nextButtonEnabled:!1,advancedControlsEnable:!1,perspParams:{fov:35,grade:2.5,roll:0,rotation:0,heightFromGround:1500,alignPlaneHeight:0},calcPerspectiveCallback:this.calcPerspective,editPerspectiveParamCallback:this.editPerspectiveParam,nextButtonCallback:this.nextButtonCallBack},this.attachEventHandlers()}onStart(){if(this.command.type!==n.CalcPerspective)throw new Error(`Invalid command type ${this.command.type}`);const t=this.command;this.perspectiveClient=new Rt.b(t.perspectiveEndpoint,t.apiToken),this.resourceManager.loadPerspectiveSetup(this.perspectiveProps),this.perspectiveCanvasManager.addXLines(this.allLinesMovedCallBack),this.perspectiveCanvasManager.showPerspectiveCanvas()}attachEventHandlers(){this.inputDomElement.addEventListener("mousedown",this.pointerDownEventHandler),this.inputDomElement.addEventListener("mousemove",this.pointerMoveEventHandler),this.inputDomElement.addEventListener("mouseup",this.pointerUpEventHandler)}detachEventHandlers(){this.inputDomElement.removeEventListener("mousedown",this.pointerDownEventHandler),this.inputDomElement.removeEventListener("mousemove",this.pointerMoveEventHandler),this.inputDomElement.removeEventListener("mouseup",this.pointerUpEventHandler)}onEnd(t){this.detachEventHandlers(),t()}}const Nt=.2,Ft=.05,zt=.025;class Bt{constructor(t,e,i,n){this.id=t,this.CUBE_DIM=e,this.modelToThree=n;const a=16776960;this.helperMaterial=new j.MeshBasicMaterial({color:new j.Color(a),transparent:i,opacity:i?.5:1}),this.helperLineMaterial=new j.LineBasicMaterial({color:a}),this.helperLineMaterial.onBeforeCompile=b.a.disableTonemapping,this.helperAnimationMaterial=new j.MeshBasicMaterial({color:new j.Color(128)}),this.helperAnimationLineMaterial=new j.LineBasicMaterial({color:128}),this.helperAnimationLineMaterial.onBeforeCompile=b.a.disableTonemapping,this.lightHelper=new j.Group}toggleVisibility(){this.lightHelper.visible=!this.lightHelper.visible}addLightHelper(t,e){this.pos=new j.Vector3(e.pnt.x,e.pnt.y,e.pnt.z),this.pos.applyMatrix4(this.modelToThree),this.lightHelper.name=this.id,this.lightHelper.position.set(0,zt,0);const i=new j.BoxGeometry(this.CUBE_DIM,Ft,this.CUBE_DIM),n=new j.Mesh(i,this.helperMaterial);let a,s;switch(n.name="CUBE",this.lightHelper.add(n),e.areaType){case r.m.Sphere:a=new j.SphereGeometry(.05,7,7),s="SPHERE";break;case r.m.Rect:a=new j.BoxGeometry(e.areaDim1*R.s,e.areaDim2*R.s,Ft),s="RECT"}if(a){const t=new j.Mesh(a,this.helperMaterial);t.position.set(0,this.pos.y,0),e.areaType===r.m.Rect&&(t.rotation.y=e.angle),t.name=s,this.lightHelper.add(t)}const o=[new j.Vector3(0,0,0),new j.Vector3(0,this.pos.y,0)],h=(new j.BufferGeometry).setFromPoints(o),l=new j.Line(h,this.helperLineMaterial);if(l.name="LINE",this.lightHelper.add(l),e.animationPositions&&e.animationPositions.length>0){this.animPos=new j.Vector3(e.animationPositions[0].x,e.animationPositions[0].y,e.animationPositions[0].z),this.animPos.applyMatrix4(this.modelToThree);const t=this.animPos.x-this.pos.x,i=this.animPos.z-this.pos.z,n=new j.BoxGeometry(Nt,Ft,Nt),s=new j.Mesh(n,this.helperAnimationMaterial);s.position.set(t,zt,i),s.name="ANIM_CUBE",this.lightHelper.add(s);const o=[new j.Vector3(0,Ft,0),new j.Vector3(t,Ft,i)],r=(new j.BufferGeometry).setFromPoints(o),h=new j.Line(r,this.helperAnimationLineMaterial);h.name="ANIM_GROUND_LINE",this.lightHelper.add(h);const l=new j.Mesh(a,this.helperAnimationMaterial);l.position.set(t,this.animPos.y,i),l.name="ANIM_BULB",this.lightHelper.add(l);const c=[new j.Vector3(t,0,i),new j.Vector3(t,this.animPos.y,i)],d=(new j.BufferGeometry).setFromPoints(c),u=new j.Line(d,this.helperAnimationLineMaterial);u.name="ANIM_LINE",this.lightHelper.add(u)}this.lightHelper.position.set(this.pos.x,0,this.pos.z),t.add(this.lightHelper)}removeLightHelper(t){t.remove(this.lightHelper),b.a.disposeObject3D(this.lightHelper,!1),this.helperMaterial.dispose(),this.helperLineMaterial.dispose(),this.helperAnimationMaterial.dispose(),this.helperAnimationLineMaterial.dispose()}setLightHelperPosition(t){this.pos.x=t.x,this.pos.z=t.z,this.lightHelper.position.x=this.pos.x,this.lightHelper.position.z=this.pos.z}updateLightHelper(t){this.pos.y=t.pnt.z*R.s,t.animationPositions&&t.animationPositions.length>0&&(this.animPos.y=t.animationPositions[0].z*R.s);for(const e of this.lightHelper.children){const i=e;if("SPHERE"===i.name||"RECT"===i.name){if(i.position.y=this.pos.y,"RECT"===i.name){i.geometry.dispose();const e=new j.BoxGeometry(t.areaDim1*R.s,t.areaDim2*R.s,Ft);i.geometry=e,i.rotation.y=t.angle}}else if("ANIM_BULB"===i.name)i.position.y=this.animPos.y;else if("LINE"===i.name){this.lightHelper.remove(i);const t=[new j.Vector3(0,0,0),new j.Vector3(0,this.pos.y,0)],e=(new j.BufferGeometry).setFromPoints(t),n=new j.Line(e,this.helperLineMaterial);n.name="LINE",this.lightHelper.add(n)}else if("ANIM_LINE"===i.name){this.lightHelper.remove(i);const t=this.animPos.x-this.pos.x,e=this.animPos.z-this.pos.z,n=[new j.Vector3(t,0,e),new j.Vector3(t,this.animPos.y,e)],a=(new j.BufferGeometry).setFromPoints(n),s=new j.Line(a,this.helperAnimationLineMaterial);s.name="ANIM_LINE",this.lightHelper.add(s)}}}addAnimationHelper(t){this.animPos=new j.Vector3(t.animationPositions[0].x,t.animationPositions[0].y,t.animationPositions[0].z),this.animPos.applyMatrix4(this.modelToThree);const e=new j.BoxGeometry(Nt,Ft,Nt),i=this.animPos.x-this.pos.x,n=this.animPos.z-this.pos.z,a=new j.Mesh(e,this.helperAnimationMaterial);a.position.set(i,zt,n),a.name="ANIM_CUBE",this.lightHelper.add(a);const s=[new j.Vector3(0,Ft,0),new j.Vector3(i,Ft,n)],o=(new j.BufferGeometry).setFromPoints(s),r=new j.Line(o,this.helperAnimationLineMaterial);r.name="ANIM_GROUND_LINE",this.lightHelper.add(r);const h=new j.SphereGeometry(.05,7,7),l=new j.Mesh(h,this.helperAnimationMaterial);l.position.set(i,this.animPos.y,n),l.name="ANIM_BULB",this.lightHelper.add(l);const c=[new j.Vector3(i,0,n),new j.Vector3(i,this.animPos.y,n)],d=(new j.BufferGeometry).setFromPoints(c),u=new j.Line(d,this.helperAnimationLineMaterial);u.name="ANIM_LINE",this.lightHelper.add(u)}removeAnimationHelper(){for(let t=this.lightHelper.children.length-1;t>=0;t--){const e=this.lightHelper.children[t];"ANIM_CUBE"!==e.name&&"ANIM_GROUND_LINE"!==e.name&&"ANIM_BULB"!==e.name&&"ANIM_LINE"!==e.name||(this.lightHelper.remove(e),b.a.disposeObject3D(e,!0))}}updateLightAnimation(t){for(const e of this.lightHelper.children){const i=e;this.animPos.x=t.x,this.animPos.z=t.z;const n=this.animPos.x-this.pos.x,a=this.animPos.z-this.pos.z;if("ANIM_CUBE"===i.name||"ANIM_BULB"===i.name)i.position.x=n,i.position.z=a;else if("ANIM_GROUND_LINE"===i.name){this.lightHelper.remove(i);const t=[new j.Vector3(0,Ft,0),new j.Vector3(n,Ft,a)],e=(new j.BufferGeometry).setFromPoints(t),s=new j.Line(e,this.helperAnimationLineMaterial);s.name="ANIM_GROUND_LINE",this.lightHelper.add(s)}else if("ANIM_LINE"===i.name){this.lightHelper.remove(i);const t=[new j.Vector3(n,0,a),new j.Vector3(n,this.animPos.y,a)],e=(new j.BufferGeometry).setFromPoints(t),s=new j.Line(e,this.helperAnimationLineMaterial);s.name="ANIM_LINE",this.lightHelper.add(s)}}}}class Ht{constructor(){this.type=n.EditLights}}class Ut extends a.a{constructor(t,e,i,n,a,s,o,h,l,c,d,p,g){super(),this.project=t,this.phScene=e,this.resourceManager=i,this.animationManager=n,this.inputDomElement=a,this.layerSelectionEnabled=s,this.camera=o,this.width=h,this.height=l,this.tileClient=c,this.matManager=d,this.patternManager=p,this.renderFrame=g,this.createLightsHelpers=t=>{t.walkOnAllChildrenByType(r.r.DTLight,!1,(t=>{const e=t.data;if(e.lightType!==r.o.Ambient){const i=new Bt(t.id,10,!0,C.a);i.addLightHelper(this.phScene,e),this.lightHelpers.set(t.id,i)}}))},this.toggleLightHelper=()=>{for(const t of Array.from(this.lightHelpers.keys())){this.lightHelpers.get(t).toggleVisibility()}},this.editShadowAndReflection=(t,e)=>{this.matManager.updateMaskShadingReflection(t,e),this.lightProps.shading=t,this.lightProps.reflection=e,this.resourceManager.loadLightsSetup(this.lightProps)},this.pointerDownEventHandler=t=>{const e=W.a.getPointerCoordinates(t,this.inputDomElement.parentElement.id);if(this.addingLight)this.addLightNode(e),this.addingLight=!1;else if(this.addingAnimation)this.addAnimationPoint(e),this.addingAnimation=!1;else{const t=b.a.createRaycaster(this.camera,this.width,this.height,e.x,e.y).intersectObjects(this.phScene.children,!0);if(t.length>0)for(const e of t){const t=e;if("CUBE"===t.object.name||"ANIM_CUBE"===t.object.name){this.intersectionPoint=t.point.clone(),this.intersectionName=t.object.name;const e=t.object.parent.name;console.debug("lightHelperId: "+e),this.currentLightHelper=this.lightHelpers.get(e),this.startPosition=t.object.parent.position.clone();break}}}},this.pointerMoveEventHandler=t=>{if(this.currentLightHelper){const e=W.a.getPointerCoordinates(t,this.inputDomElement.parentElement.id),i=b.a.viewportToPlaneWorldPosition(e,this.camera,this.width,this.height,this.planeNormal,this.planePoint);if(null!=i){const t=i.clone().sub(this.intersectionPoint),e=this.startPosition.clone().add(t),n=this.project.root.getFirstChildOfType(r.r.DTLightList).getIndexedNodeById(this.currentLightHelper.id),a=n.data;if("CUBE"===this.intersectionName){this.currentLightHelper.setLightHelperPosition(e);const t=e.clone();t.applyMatrix4(C.c),a.pnt.x=t.x,a.pnt.y=t.y,this.project.projectChanged.notify({type:"LIGHT_CHANGED",node:n})}else if("ANIM_CUBE"===this.intersectionName){const t=i.clone();t.applyMatrix4(C.c),a.animationPositions[0].x=t.x,a.animationPositions[0].y=t.y,this.currentLightHelper.updateLightAnimation(i)}}}},this.pointerUpEventHandler=t=>{if(this.currentLightHelper){if("CUBE"===this.intersectionName){const e=this.project.root.getFirstChildOfType(r.r.DTLightList).getIndexedNodeById(this.currentLightHelper.id),i=e.data;if(i.animationPositions&&i.animationPositions.length>0){const e=W.a.getPointerCoordinates(t,this.inputDomElement.parentElement.id),n=b.a.viewportToPlaneWorldPosition(e,this.camera,this.width,this.height,this.planeNormal,this.planePoint);if(null!=n){const t=n.clone().sub(this.intersectionPoint);t.applyMatrix4(C.c),i.animationPositions[0].x+=t.x,i.animationPositions[0].y+=t.y}}this.project.projectChanged.notify({type:"LIGHT_CHANGED",node:e})}this.currentLightHelper=null}},this.addLightCallback=t=>{this.addingLight=!0,this.currentLightType=t},this.toggleLightAnimation=()=>{this.animationManager.animateLights()},this.removeLightCallback=t=>{const e=this.project.root.getFirstChildOfType(r.r.DTLightList).removeChildById(t);if(e){const i=this.lightHelpers.get(t);i&&(i.removeLightHelper(this.phScene),this.lightHelpers.delete(t));const n=this.lightProps.lightList.map((t=>t.lightId)).indexOf(t);n>-1&&(this.lightProps.lightList.splice(n,1),this.resourceManager.loadLightsSetup(this.lightProps)),this.project.projectChanged.notify({type:"LIGHT_REMOVED",node:e})}},this.editLightParamsCallback=t=>{if("ENVMAP"===t.lightId)this.matManager.updateDefaultEnvMap(null,t.intensity),this.lightProps.lightList[0]=t,this.resourceManager.loadLightsSetup(this.lightProps);else{const e=this.project.root.getFirstChildOfType(r.r.DTLightList).getIndexedNodeById(t.lightId),i=e.data;if(i.power=t.intensity,i.lightType!==r.o.Ambient){i.pnt.z=t.elevation,i.animationPositions&&i.animationPositions.length>0&&(i.animationPositions[0].z=t.elevationAnimation);this.lightHelpers.get(t.lightId).updateLightHelper(i)}i.lightType===r.o.Rect&&(i.angle=u.a.degToRad(t.rotation),i.areaDim1=t.width,i.areaDim2=t.height);const n=this.lightProps.lightList.map((t=>t.lightId)).indexOf(t.lightId);n>-1&&(this.lightProps.lightList[n]=t,this.resourceManager.loadLightsSetup(this.lightProps)),this.project.projectChanged.notify({type:"LIGHT_CHANGED",node:e})}},this.editLightsDoneCallback=()=>{this.resourceManager.lightsSetupFinished(),this.end()},this.addLightAnimationCallback=t=>{this.addingAnimation=!0,this.animationLightId=t},this.removeLightAnimationCallback=t=>{this.project.root.getFirstChildOfType(r.r.DTLightList).getIndexedNodeById(t).data.animationPositions=null;this.lightHelpers.get(t).removeAnimationHelper();const e=this.lightProps.lightList.map((t=>t.lightId)).indexOf(t);e>-1&&(this.lightProps.lightList[e].elevationAnimation=-1,this.resourceManager.loadLightsSetup(this.lightProps))},this.addLightNode=t=>{const e=b.a.viewportToPlaneWorldPosition(t,this.camera,this.width,this.height,this.planeNormal,this.planePoint);if(null!=e){e.applyMatrix4(C.c);const t={x:e.x,y:e.y,z:R.l};let i;switch(this.currentLightType){case r.o.Omni:i=new r.l(this.currentLightType,0,t,null,R.m,null,null,r.m.Sphere,25,null);break;case r.o.Directional:{const e={x:0,y:0,z:0};i=new r.l(this.currentLightType,0,t,e,R.m,null,null,r.m.None,null,null);break}case r.o.Rect:i=new r.l(this.currentLightType,0,t,null,R.m,0,null,r.m.Rect,500,500)}const n=new r.c(i);this.project.root.getFirstChildOfType(r.r.DTLightList).appendChild(n),this.project.projectChanged.notify({type:"LIGHT_ADDED",node:n});const a=new Bt(n.id,10,!0,C.a);a.addLightHelper(this.phScene,i),this.lightHelpers.set(n.id,a),this.lightProps.lightList.push({lightId:n.id,type:i.lightType,elevation:i.pnt.z,intensity:i.power,elevationAnimation:i.animationPositions?i.animationPositions[0].z:-1,rotation:i.angle,width:i.areaDim1,height:i.areaDim2}),this.resourceManager.loadLightsSetup(this.lightProps)}else this.resourceManager.showMessageCallout(f.d.ERROR,f.c.NO_FLOOR_DETECTED)},this.addAnimationPoint=t=>{const e=b.a.viewportToPlaneWorldPosition(t,this.camera,this.width,this.height,this.planeNormal,this.planePoint);if(null!=e){const t=e.clone();t.applyMatrix4(C.c),t.z=R.l;const i=this.project.root.getFirstChildOfType(r.r.DTLightList).getIndexedNodeById(this.animationLightId),n=i.data;n.animationPositions||(n.animationPositions=[]),n.animationPositions.push(t);this.lightHelpers.get(this.animationLightId).addAnimationHelper(n),this.project.projectChanged.notify({type:"LIGHT_CHANGED",node:i});const a=this.lightProps.lightList.map((t=>t.lightId)).indexOf(this.animationLightId);a>-1&&(this.lightProps.lightList[a].elevationAnimation=R.l,this.resourceManager.loadLightsSetup(this.lightProps))}else this.resourceManager.showMessageCallout(f.d.ERROR,f.c.NO_FLOOR_DETECTED);this.animationLightId=null},this.applyTile=t=>{this.tileClient.getPosFile("pieno_01").then((e=>{const i=new r.f;i.key=new r.H(t.idManuf,t.idProduct,1),q.a.fillMaterialData(0,i,t.material),this.project.root.walkOnAllChildrenByType(r.r.DTTiledLayer,!1,(i=>{const n=i.data,a=i.getFirstChildOfType(r.r.DTFace3D);this.patternManager.removeTileListNodes(a);const s=Object(y.r)([t],n.surfaceIndex,this.matManager),o=m.g.createPatternStructureWithTiles(e,s,0);let h=0;n.arData&&n.surfaceType===r.J.FLOOR&&(h=n.arData.rotation),this.patternManager.applyPatternStructure(a,r.z.Full,16777215,1,h,o,null,null,null,null,!0),console.log("updated tiledLayer: "+i.id)})),console.log("updated all tiled layers")}))}}onStart(){this.addingLight=!1,this.addingAnimation=!1,this.layerSelectionEnabled.value=!1,this.planeNormal=new j.Vector3(0,1,0),this.planePoint=new j.Vector3(0,0,1);const t=[],e=this.project.root.getFirstChildOfType(r.r.DTLightList);e.walkOnAllChildrenByType(r.r.DTLight,!1,(e=>{const i=e.data,n={lightId:e.id,type:i.lightType,elevation:i.pnt?i.pnt.z:-1,intensity:i.power,elevationAnimation:i.animationPositions?i.animationPositions[0].z:-1};i.lightType===r.o.Rect&&(n.rotation=u.a.radToDeg(i.angle),n.width=i.areaDim1,n.height=i.areaDim2),t.push(n)}));const i=this.project.root.getFirstChildOfType(r.r.DTMaskList).getFirstChildOfType(r.r.DTMask).data;this.lightProps={lightList:t,shading:i.shading,reflection:i.reflection,addLightCallback:this.addLightCallback,toggleAnimation:this.toggleLightAnimation,editLightsDoneCallback:this.editLightsDoneCallback,removeLightCallback:this.removeLightCallback,editLightParamsCallback:this.editLightParamsCallback,addLightAnimationCallback:this.addLightAnimationCallback,removeLightAnimationCallback:this.removeLightAnimationCallback,applyTile:this.applyTile,editShadowAndReflection:this.editShadowAndReflection,toggleLightHelper:this.toggleLightHelper},this.resourceManager.loadLightsSetup(this.lightProps),this.lightHelpers=new Map,this.createLightsHelpers(e),this.attachEventHandlers()}attachEventHandlers(){this.inputDomElement.addEventListener("mousedown",this.pointerDownEventHandler),this.inputDomElement.addEventListener("touchstart",this.pointerDownEventHandler),this.inputDomElement.addEventListener("mousemove",this.pointerMoveEventHandler),this.inputDomElement.addEventListener("touchmove",this.pointerMoveEventHandler),this.inputDomElement.addEventListener("mouseup",this.pointerUpEventHandler),this.inputDomElement.addEventListener("touchend",this.pointerUpEventHandler),this.inputDomElement.addEventListener("touchcancel",this.pointerUpEventHandler)}detachEventHandlers(){this.inputDomElement.removeEventListener("mousedown",this.pointerDownEventHandler),this.inputDomElement.removeEventListener("touchstart",this.pointerDownEventHandler),this.inputDomElement.removeEventListener("mousemove",this.pointerMoveEventHandler),this.inputDomElement.removeEventListener("touchmove",this.pointerMoveEventHandler),this.inputDomElement.removeEventListener("mouseup",this.pointerUpEventHandler),this.inputDomElement.removeEventListener("touchend",this.pointerUpEventHandler),this.inputDomElement.removeEventListener("touchcancel",this.pointerUpEventHandler)}onEnd(t){this.detachEventHandlers(),this.animationManager.stopAnimation();for(const t of Array.from(this.lightHelpers.keys())){this.lightHelpers.get(t).removeLightHelper(this.phScene)}this.renderFrame.value=!0,this.lightHelpers.clear(),this.layerSelectionEnabled.value=!0,t()}}class Gt{constructor(){this.type=n.EditPerspective}}class Vt extends a.a{constructor(t,e,i,n,a,s,o,h,l){super(),this.project=t,this.phScene=e,this.resourceManager=i,this.gridCanvasManager=n,this.renderFrame=a,this.inputDomElement=s,this.camera=o,this.width=h,this.height=l,this.editPerspectiveParam=t=>{const e=this.backgroundImageNode.data;e.cameraParams.fov=t.fov,e.cameraParams.grade=t.grade,e.cameraParams.roll=t.roll,e.cameraParams.heightFromGround=t.heightFromGround,e.cameraParams.rotation=t.rotation;let i=!1;const n=this.project.root.getFirstChildOfType(r.r.DTPrjData);if(n){const e=n.data;e.cameraRotation=u.a.degToRad(t.rotation),e.alignPlaneHeight!==t.alignPlaneHeight&&(e.alignPlaneHeight=t.alignPlaneHeight,i=!0)}t.rotation!==this.perspectiveProps.perspParams.rotation&&this.project.root.walkOnAllChildrenByType(r.r.DTTiledLayer,!1,(e=>{const i=e.data;if(i.surfaceType===r.J.FLOOR||i.surfaceType===r.J.HPLANE){const i=u.a.mat4GetIdentity();u.a.mat4RotZ(i,u.a.degToRad(t.rotation));const n=e.getFirstChildOfType(r.r.DTFace3D),a=n.data,s=u.a.mat4GetIdentity();u.a.mat4RotZ(s,-u.a.degToRad(this.perspectiveProps.perspParams.rotation));const o=u.a.pnt3TransformArray(s,a.points),h=u.a.pnt3TransformArray(i,o);a.points=h,this.project.projectChanged.notify({type:"FACE3D_UPDATE",node:n})}})),this.gridHelper.rotation.y=u.a.degToRad(t.rotation),this.alignPlaneGridHelper.rotation.y=u.a.degToRad(t.rotation),this.alignPlaneGridHelper.position.y=t.alignPlaneHeight*R.s,this.perspectiveProps.perspParams.rotation=t.rotation,this.project.projectChanged.notify({type:"CAMERAPARAMS_UPDATED",node:this.backgroundImageNode}),i&&this.project.root.walkOnAllChildrenByType(r.r.DTTiledLayer,!1,(e=>{const i=e.data,n=e.getFirstChildOfType(r.r.DTFace3D),a=n.data;i.surfaceType!==r.J.WALL&&i.surfaceType!==r.J.BACKSPLASH||this.gridCanvasManager.updateAlignment(i,a,t.alignPlaneHeight),this.project.projectChanged.notify({type:"FACE3D_UPDATE",node:n})}));const a=new j.Vector3(0,0,1),s=new j.Vector3(0,1,0);let o=0;const h=this.project.root.getFirstChildOfType(r.r.DTLightList);h&&h.walkOnAllChildrenByType(r.r.DTLight,!1,(t=>{const e=t.data;if(e.lightType!==r.o.Ambient){let i=this.gridCanvasManager.projectPointsIn3D([this.light2dPositions[o]],s,a);if(i.length>0){const t=i[0],n=u.a.pnt3TransformArray(this.threeToModelMat4,[t]);e.pnt.x=n[0].x,e.pnt.y=n[0].y}if(o++,e.animationPositions&&e.animationPositions.length>0){if(i=this.gridCanvasManager.projectPointsIn3D([this.light2dPositions[o]],s,a),i.length>0){const t=i[0],n=u.a.pnt3TransformArray(this.threeToModelMat4,[t]);e.animationPositions[0].x=n[0].x,e.animationPositions[0].y=n[0].y}o++}this.project.projectChanged.notify({type:"LIGHT_CHANGED",node:t})}}))},this.pointerDownEventHandler=t=>{this.mouseClick=!0},this.pointerMoveEventHandler=t=>{if(this.gridHelper&&this.gridHelper.visible&&this.mouseClick){const e=W.a.getPointerCoordinates(t,this.inputDomElement.parentElement.id),i=b.a.viewportToPlaneWorldPosition(e,this.camera,this.width,this.height,this.planeNormal,this.planePoint);null!=i&&(this.alignPlaneGridHelper.position.x=i.x,this.alignPlaneGridHelper.position.z=i.z,this.gridHelper.position.x=i.x,this.gridHelper.position.z=i.z,this.renderFrame.value=!0)}},this.pointerUpEventHandler=t=>{this.mouseClick=!1},this.nextButtonCallBack=()=>{this.end()},this.mouseClick=!1,this.planeNormal=new j.Vector3(0,1,0),this.planePoint=new j.Vector3(0,0,1),this.gridHelper=new j.GridHelper(100,100,16711680,65280),this.gridHelper.visible=!0,this.phScene.add(this.gridHelper),this.alignPlaneGridHelper=new j.GridHelper(100,100,16711680,255),this.alignPlaneGridHelper.visible=!0,this.phScene.add(this.alignPlaneGridHelper),console.log("[EditPerspective] created gridHelper"),this.backgroundImageNode=this.project.root.getFirstChildOfType(r.r.DTBackgroundImage);const c=this.backgroundImageNode.data,d={fov:c.cameraParams.fov,grade:c.cameraParams.grade,roll:c.cameraParams.roll,rotation:null!=c.cameraParams.rotation?c.cameraParams.rotation:0,heightFromGround:c.cameraParams.heightFromGround,alignPlaneHeight:0},p=this.project.root.getFirstChildOfType(r.r.DTPrjData);if(p){const t=p.data;d.rotation=u.a.radToDeg(t.cameraRotation),d.alignPlaneHeight=t.alignPlaneHeight,this.alignPlaneGridHelper.position.y=t.alignPlaneHeight*R.s}this.gridHelper.rotation.y=u.a.degToRad(d.rotation),this.alignPlaneGridHelper.rotation.y=u.a.degToRad(d.rotation),this.threeToModelMat4=Object(u.b)(C.c),this.light2dPositions=[];const g=this.project.root.getFirstChildOfType(r.r.DTLightList);g&&g.walkOnAllChildrenByType(r.r.DTLight,!1,(t=>{const e=t.data;if(e.lightType!==r.o.Ambient){let t=u.a.vec3Clone(e.pnt);t.z=0,this.light2dPositions.push(this.gridCanvasManager.projectPointsIn2D([t])[0]),e.animationPositions&&e.animationPositions.length>0&&(t=u.a.vec3Clone(e.animationPositions[0]),t.z=0,this.light2dPositions.push(this.gridCanvasManager.projectPointsIn2D([t])[0]))}})),this.perspectiveProps={calcPerspButtonEnable:!1,nextButtonEnabled:!0,advancedControlsEnable:!0,perspParams:d,calcPerspectiveCallback:null,editPerspectiveParamCallback:this.editPerspectiveParam,nextButtonCallback:this.nextButtonCallBack},this.attachEventHandlers()}onStart(){if(this.command.type!==n.EditPerspective)throw new Error(`Invalid command type ${this.command.type}`);this.resourceManager.loadPerspectiveSetup(this.perspectiveProps)}attachEventHandlers(){this.inputDomElement.addEventListener("mousedown",this.pointerDownEventHandler),this.inputDomElement.addEventListener("mousemove",this.pointerMoveEventHandler),this.inputDomElement.addEventListener("mouseup",this.pointerUpEventHandler)}detachEventHandlers(){this.inputDomElement.removeEventListener("mousedown",this.pointerDownEventHandler),this.inputDomElement.removeEventListener("mousemove",this.pointerMoveEventHandler),this.inputDomElement.removeEventListener("mouseup",this.pointerUpEventHandler)}onEnd(t){this.detachEventHandlers(),this.resourceManager.perspectiveSetupFinished(),this.phScene.remove(this.gridHelper),this.phScene.remove(this.alignPlaneGridHelper),this.renderFrame.value=!0,t()}}class Wt{constructor(t,e){this.id=t,this.showGrid=e,this.type=n.EditTiledLayer}}class Jt extends a.a{constructor(t,e,i,n,a,s){super(),this.project=t,this.gridCanvasManager=e,this.resourceManager=i,this.objectControls=n,this.layerSelectionEnabled=a,this.selection=s,this.floorBoxChanged=t=>{console.debug("[EditTiledLayer] floorBoxChanged: "+JSON.stringify(t));const e=[{x:t.min.x,y:t.min.y,z:0},{x:t.min.x,y:t.max.y,z:0},{x:t.max.x,y:t.max.y,z:0},{x:t.max.x,y:t.min.y,z:0}],i=this.tiledLayerNode.getFirstChildOfType(r.r.DTFace3D),n=i.data,a=u.a.mat4GetIdentity(),s=this.project.root.getFirstChildOfType(r.r.DTPrjData);if(s){const t=s.data;u.a.mat4RotZ(a,t.cameraRotation)}const o=u.a.pnt3TransformArray(a,e);n.points=o,this.project.projectChanged.notify({type:"FACE3D_UPDATE",node:i})},this.onSetHotspotCallback=t=>{this.insertingHotspot=t},this.onAlignCallback=t=>{this.layerSetupProps.surfaceType!==r.J.WALL&&this.layerSetupProps.surfaceType!==r.J.BACKSPLASH||(t?this.gridCanvasManager.showGridCanvas(this.tiledLayerNode):this.gridCanvasManager.removeGridCanvas())},this.onEditMaskCallback=t=>{this.project.root.getFirstChildOfType(r.r.DTMaskList).walkOnAllChildrenByType(r.r.DTMask,!1,(e=>{const i=e.data;i.id===t.id&&(i.src=t.src,i.reflection=t.reflection,i.shading=t.shading,i.contour2d=t.contour2d,this.project.projectChanged.notify({type:"MASK_UPDATED",node:e}))}))},this.onDeleteLayerCallback=()=>{const t=this.command,e=this.project.root.getIndexedNodeById(t.id);this.project.removeTiledLayer(e),this.resourceManager.deleteLayer(t.id),this.end()},this.planeHeightChange=t=>{this.planeHeight=t,this.updatePlanePoints()},this.planeRotationChange=t=>{this.planeRotation=u.a.degToRad(t),this.updatePlanePoints()},this.updatePlanePoints=()=>{const t=this.tiledLayerNode.getFirstChildOfType(r.r.DTFace3D),e=t.data,i=u.a.mat4GetIdentity();u.a.mat4Translate(i,0,0,this.planeHeight),u.a.mat4RotZ(i,this.planeRotation);const n=u.a.pnt3TransformArray(i,R.k);e.points=n;const a=this.project.root.getFirstChildOfType(r.r.DTPrjData);if(a){const t=a.data;for(const e of t.hPlanesData)if(e.surfaceIndex===this.tiledLayerNode.data.surfaceIndex){e.rotation=this.planeRotation,e.heightFromGround=this.planeHeight;break}}this.project.projectChanged.notify({type:"FACE3D_UPDATE",node:t})},this.onClick=t=>{if(this.insertingHotspot){const e=W.a.getPointerCoordinates(t.originalEvent,this.objectControls.domElement.parentElement.id);t.handled=!0;const i=this.gridCanvasManager.getSize(),n=this.tiledLayerNode.data;n.hotspot={x:100*e.x/i.x,y:100*e.y/i.y},this.resourceManager.setHotspot&&this.resourceManager.setHotspot(this.tiledLayerNode.id,e.x,e.y,n.surfaceType,n.surfaceIndex,null,n.label)}else if(this.insertingOriginPose){const e=W.a.getPointerCoordinates(t.originalEvent,this.objectControls.domElement.parentElement.id),i=this.gridCanvasManager.getSize();this.tiledLayerNode.data.origin={x:100*e.x/i.x,y:100*e.y/i.y},this.resourceManager.setOriginPoseById&&this.resourceManager.setOriginPoseById(this.tiledLayerNode.id,e)}},this.nextButtonCallBack=()=>{this.end()},this.onSetHotspotLabelCallback=t=>{if(this.tiledLayerNode){const e=this.tiledLayerNode.data;if(null!==t&&this.resourceManager.setHotspot){e.label=t;const i=this.gridCanvasManager.getSize(),n={x:e.hotspot.x*i.x/100,y:e.hotspot.y*i.y/100};this.resourceManager.setHotspot(this.tiledLayerNode.id,n.x,n.y,e.surfaceType,e.surfaceIndex,null,e.label)}}},this.onSetOriginPoseCallback=t=>{this.insertingOriginPose=t},this.onEditOriginPoseCallback=t=>{const e=this.command;this.tiledLayerNode=this.project.root.getIndexedNodeById(e.id);const i=this.tiledLayerNode.data,n=this.gridCanvasManager.getSize();i.origin={x:100*t.x/n.x,y:100*t.y/n.y},this.resourceManager.setOriginPoseById&&this.resourceManager.setOriginPoseById(this.tiledLayerNode.id,t)},this.layerSetupProps={surfaceType:r.J.FLOOR,imageSizeProcessing:{x:0,y:0},alignButtonEnabled:!0,nextButtonEnabled:!0,onSetHotspotCallback:this.onSetHotspotCallback,onAlignCallback:this.onAlignCallback,onEditMaskCallback:this.onEditMaskCallback,onDeleteLayerCallback:this.onDeleteLayerCallback,nextButtonCallback:this.nextButtonCallBack,onSetHotspotLabelCallback:this.onSetHotspotLabelCallback,onSetOriginPoseCallback:this.onSetOriginPoseCallback,onEditOriginPoseCallback:this.onEditOriginPoseCallback,layerMask:null,layerMaskIndex:0,planeHeightChange:this.planeHeightChange,planeRotationChange:this.planeRotationChange,floorBoxChanged:this.floorBoxChanged,hotspotLabel:null,originPose:null},this.insertingHotspot=!1,this.insertingOriginPose=!1,this.planeHeight=0,this.planeRotation=0}onStart(){if(this.command.type!==n.EditTiledLayer)throw new Error(`Invalid command type ${this.command.type}`);this.layerSelectionEnabled.value=!1,this.attachEventHandlers();const t=this.command;this.tiledLayerNode=this.project.root.getIndexedNodeById(t.id);const e=this.tiledLayerNode.data;this.layerSetupProps.surfaceType=e.surfaceType;const i=this.project.root.getFirstChildOfType(r.r.DTPrjData);let a;if(e.surfaceType===r.J.FLOOR||e.surfaceType===r.J.HPLANE){a=r.F.FLOOR;const t=this.tiledLayerNode.getFirstChildOfType(r.r.DTFace3D).data,e=u.a.mat4GetIdentity();if(i){const t=i.data;u.a.mat4RotZ(e,-t.cameraRotation)}const n=u.a.pnt3TransformArray(e,t.points);this.layerSetupProps.floorBox={min:{x:n[0].x,y:n[0].y},max:{x:n[2].x,y:n[2].y}}}else e.surfaceType!==r.J.WALL&&e.surfaceType!==r.J.BACKSPLASH||(a=r.F.WALL);this.project.root.getFirstChildOfType(r.r.DTMaskList).walkOnAllChildrenByType(r.r.DTMask,!1,(t=>{const e=t.data;e.id!=r.F.ALL&&e.id!==a||(this.layerSetupProps.layerMask={id:e.id,src:e.src,reflection:e.reflection,shading:e.shading,indexes:e.indexes,contour2d:e.contour2d})})),this.layerSetupProps.hotspotLabel=e.label,this.layerSetupProps.layerMaskIndex=e.surfaceIndex;let s=null;if(e.origin){const t=this.gridCanvasManager.getSize();s={x:e.origin.x*t.x/100,y:e.origin.y*t.y/100}}if(this.layerSetupProps.originPose=s,e.surfaceType===r.J.HPLANE&&i){const t=i.data;for(const e of t.hPlanesData)if(e.surfaceIndex===this.tiledLayerNode.data.surfaceIndex){this.planeRotation=e.rotation,this.planeHeight=e.heightFromGround,this.layerSetupProps.planeHeight=this.planeHeight,this.layerSetupProps.planeRotation=this.planeRotation;break}}const o=this.project.root.getFirstChildOfType(r.r.DTBackgroundImage).data;this.layerSetupProps.imageSizeProcessing=o.imageSizeProcessing,this.resourceManager.loadLayerSetup(this.layerSetupProps),t.showGrid&&this.onAlignCallback(!0)}attachEventHandlers(){this.objectControls.enabled=!0,this.objectControls.addEventListener(M.b.CLICK,this.onClick)}detachEventHandlers(){this.objectControls.enabled=!1,this.objectControls.removeEventListener(M.b.CLICK,this.onClick)}onEnd(t){this.resourceManager.layerSetupFinished(),this.detachEventHandlers(),this.layerSelectionEnabled.value=!0,this.gridCanvasManager.removeGridCanvas(),this.selection.clear(),t()}}class qt{constructor(t){this.imageFile=t,this.type=ht.CommandsEnum.CalcPerspectiveAI}}class Kt extends a.a{constructor(t,e,i,n){super(),this.project=t,this.aiClient=e,this.activityManager=i,this.resourceManager=n}onStart(){this.activityManager.addBlockingTask(),this.startSegmentation()}startSegmentation(){const t=this.command;this.aiClient.getMasks(t.imageFile,!0).then((t=>{if(t.sessionId&&this.aiClient.setSessionId(t.sessionId),console.debug("fovX: "+u.a.radToDeg(t.cameraParameters.fovRadX)+" - fovY: "+u.a.radToDeg(t.cameraParameters.fovRadY)+" - rotation: "+u.a.radToDeg(t.cameraParameters.yaw)+" - grade: "+u.a.radToDeg(t.cameraParameters.pitch)+" - roll: "+u.a.radToDeg(t.cameraParameters.roll)+" - CAMERA HEIGHT: "+t.cameraParameters.cameraHeight),0===t.surfaces.length)return this.activityManager.blockingTaskCompleted(),this.resourceManager.showMessageCallout(f.d.ERROR,f.c.NO_FLOOR_DETECTED),void this.end();const e=this.project.root.getFirstChildOfType(r.r.DTBackgroundImage).data,i={fov:u.a.radToDeg(t.cameraParameters.fovRadY),grade:u.a.radToDeg(t.cameraParameters.pitch),roll:Math.abs(t.cameraParameters.roll)>.52?0:u.a.radToDeg(t.cameraParameters.roll),heightFromGround:t.cameraParameters.cameraHeight?t.cameraParameters.cameraHeight:e.cameraParams.heightFromGround,imageAspect:e.cameraParams.imageAspect,rotation:u.a.radToDeg(t.cameraParameters.yaw)};e.cameraParams=i,e.imageSizeProcessing=t.imageSizeProcessing,this.project.projectChanged.notify({type:"PROJECT_BUILT"}),this.activityManager.blockingTaskCompleted(),this.end(null)})).catch((t=>{console.debug("Segmentation error: "+t),this.activityManager.blockingTaskCompleted(),this.end()}))}onEnd(t){t()}}class Yt{constructor(t){this.tile=t,this.type=n.LoadExternalTile}}class $t extends a.a{constructor(t,e,i,n){super(),this.project=t,this.matManager=e,this.defaultThickness=i,this.analyticsManager=n}onStart(){const t=this.command;this.analyticsManager&&this.analyticsManager.externalTileLoaded();const e=t.tile,i=this.project.getMaterialList(),n=new r.f;n.key=new r.H(e.idManuf,e.idProduct,1),q.a.fillMaterialData(0,n,e.material),this.matManager.createExternalTileMat(e.idManuf,e.idProduct,"0",1,-1,n).then((n=>{var a,s;const o=this.matManager.getMaterialExtendedData(n);if((null===(a=t.tile)||void 0===a?void 0:a.borderMaterial)&&(null===(s=t.tile)||void 0===s?void 0:s.borderMaterial.maps)&&t.tile.borderMaterial.maps.length>0){const t=new r.f;t.key=new r.H(e.idManuf,"BORDER",1),q.a.fillMaterialData(0,t,e.borderMaterial),this.matManager.createMat(e.idManuf,"BORDER",t).then((n=>{const a=new r.c(t);i.appendChild(a);const s=this.matManager.getMaterialExtendedData(n);this.buildTile(e,o.id,s.id)})).catch((t=>{console.debug("[LoadExternalTile] createMat error: "+JSON.stringify(t))}))}else this.buildTile(e,o.id,-1)})).catch((t=>{console.debug("[LoadExternalTile] createExternalTile error: "+JSON.stringify(t))}))}buildTile(t,e,i){const n=new m.f({idProduct:t.idProduct,idManufacturer:t.idManuf,colorVar:"0",width:t.width,height:t.height,diagonal:t.diagonal,formatType:t.formatType,offshaded:t.offshaded,numImages:t.material.maps.length,dominantColor:null!=t.material.dominantColor?t.material.dominantColor:16777215,offshadedRot:t.offshadedRot,polygon:J.b.getTilePolygon(t.formatType,t.width,t.height,t.diagonal),borderFlags:-1!==i?m.d.MATERIAL:m.d.COLOR});let a;if(n.polygon.polySet.contours.length>1){const t=n.polygon.boundingBox;a=[],a.push({x:t.min.x,y:t.min.y}),a.push({x:t.min.x,y:t.max.y}),a.push({x:t.max.x,y:t.max.y}),a.push({x:t.max.x,y:t.min.y})}else a=u.a.vec2ArrayClone(n.polygon.polySet.contours[0].vertices);const s=u.a.poly2PoleOfInaccessibility([a],10),o=u.a.mat3GetIdentity();u.a.mat3Translate(o,-s.x,-s.y);const h=u.a.pnt2TransformArray(o,a),l=[];for(const t of h)l.push({x:t.x,y:t.y,z:0});const c=this.project.addMaterialKey(r.C),d=new r.g(r.i.FF_FILLED|r.i.FF_COVER,0,l,r.h.CLASSID_TILE,c,[]);d.materialId=e;const p=new r.c(d),g=0!==t.thickness?t.thickness:this.defaultThickness,f={x:0,y:0,z:-1},y=n.polygon.polySet,v=[];let x=i;n.borderFlags===m.d.COLOR&&(x=0);for(let t=0;t<y.contours.length;t++){let e=u.a.pnt2TransformArray(o,y.contours[t].vertices);y.holes[t]&&(e=e.reverse());const i=[];for(const t of e)i.push({x:t.x,y:t.y,z:0});const n=[];for(let t=e.length-1;t>=0;t--)n.push(u.a.pnt3Move(i[t],f,g));const a=i.length;for(let t=0;t<a;t++){const e=t,s=(t+1)%a,o=a-1-e,h=[n[(a-1-s)%a],i[s],i[e],n[o]];v.push(new r.g(r.i.FF_FILLED|r.i.FF_COVER,0,h,r.h.CLASSID_OBJECT_SIDE,x,[]))}}for(const t of v){n.borderFlags===m.d.COLOR&&(n.borderColor?t.color=n.borderColor:t.color=n.dominantColor);const e=new r.c(t);p.appendChild(e)}n.x=0,n.y=0;const T=new r.w(n.tileNum,n.idProduct,n.idManufacturer,n.colorVar,1,n.formatType,n.width,n.height,n.diagonal,0,n.x,n.y,0,n.offshaded,n.offshadedRot,n.tileCode,n.dominantColor,n.numImages,n.polygon.polySet,r.x.SINGLE,n.formatSize),M=new r.c(T);p.appendChild(M),this.project.root.appendChild(p),this.project.projectChanged.notify({type:"FACE3D_ADDED",node:p}),this.end()}onEnd(t){t()}}class Xt{constructor(t){this.relativePath=t,this.type=ht.CommandsEnum.PublishProject}}class Qt extends a.a{constructor(t){super(),this.project=t}onStart(){const t=this.command,e=this.project.save(),i=new r.G;i.root=JSON.parse(e,r.c.reviver);const n=i.root.getChildNodes(!1);for(;n.moveNext();)switch(n.current.data.type){case r.r.DTBackgroundImage:n.current.data.src=t.relativePath+"\\bg.jpg";break;case r.r.DTTiledLayer:n.current.getFirstChildOfType(r.r.DTFace3D).removeChildNodes();break;case r.r.DTMaskList:{const e=n.current.getChildNodes(!1);for(;e.moveNext();){const i=e.current.data;i.id===r.F.FLOOR?i.src=t.relativePath+"\\floor.png":i.id===r.F.WALL?i.src=t.relativePath+"\\wall.png":i.id===r.F.ALL&&(i.src=t.relativePath+"\\all.png")}break}case r.r.DTMaterialList:{const t=n.current.data,e=new Map;e.set(1,t.data.get(1)),e.set(2,t.data.get(2)),t.data=e;break}}const a=i.save();B.b.downloadFile(a,"scene.json","text/json"),this.end()}onEnd(t){t()}}class Zt{constructor(t,e,i){this.maxPreviewWidth=t,this.maxPreviewHeight=e,this.onSaveOk=i,this.type=n.SaveProject}}class te extends a.a{constructor(t,e,i){super(),this.project=t,this.imageManager=e,this.activityManager=i}onStart(){this.activityManager.addBlockingTask();const t=this.command;this.imageManager.getImage(t.maxPreviewWidth,t.maxPreviewHeight).then((e=>{const i=this.project.root.getFirstChildOfType(r.r.DTBackgroundImage).data.cameraParams.imageAspect,n=this.project.save(),a=this.project.root.data;this.activityManager.blockingTaskCompleted(),t.onSaveOk({id:a.sceneId,version:a.version,data:n,aspect:i,preview:e.img}),this.end()})).catch((()=>{console.log("[SaveProject] getImage error"),this.activityManager.blockingTaskCompleted(),this.end()}))}onEnd(t){t()}}class ee{constructor(){this.type=n.SaveProjectCustomization}}class ie extends a.a{constructor(t,e){super(),this.project=t,this.activityManager=e}onStart(){this.activityManager.addBlockingTask();const t=this.project.root.getChildNodes(!1),e=new Map;for(;t.moveNext();)switch(t.current.data.type){case r.r.DTTiledLayer:{const i=t.current.getFirstChildOfType(r.r.DTFace3D);i.childNodes.length>0&&e.set(t.current.id,JSON.stringify(i));break}}const i=Object.assign({},this,{data:Array.from(e.entries())});this.activityManager.blockingTaskCompleted(),this.end(null,{customization:JSON.stringify(i.data)})}onEnd(t){t()}}class ne{constructor(t){this.customizationString=t,this.type=n.ApplyProjectCustomization}}class ae extends a.a{constructor(t,e){super(),this.project=t,this.activityManager=e}onStart(){this.activityManager.addBlockingTask();let t=this.command,e=JSON.parse(t.customizationString),i=new Map(e),n=[],a=this.project.root.getChildNodes(!1);for(;a.moveNext();){let t=i.get(a.current.id);if(t)switch(a.current.data.type){case r.r.DTTiledLayer:if(Object(y.i)(this.project,a.current.id)){this.project.root.getFirstChildOfType(r.r.DTGroupList).walkOnAllChildrenByType(r.r.DTGroup,!1,(e=>{const s=e.data;if(s.layers.indexOf(a.current.id)>-1&&!n.find((t=>t.id===e.id))){a.current.getFirstChildOfType(r.r.DTFace3D).removeChildNodes();const o=JSON.parse(t,r.c.reviver).getFirstChildOfType(r.r.DTTileList).getFirstChildOfType(r.r.DTPattern),h=o.getFirstChildOfType(r.r.DTTileInst).data,l=o.data,c=s.tileDestination===m.e.FLOOR?r.J.FLOOR:r.J.WALL;n.push({id:e.id,tiles:[{code:h.idProduct,manufacturer:h.idManuf,color:h.colorVar}],surfaceType:c,surfaceIndex:null,groutSize:l.groutSize,groutColor:l.groutColor,pattern:l.id,formatSize:Object(y.k)(h.width,h.height,h.diagonal),rotation:u.a.radToDeg(l.rotation)});for(const e of s.layers)if(t=i.get(e),t){const i=this.project.root.getIndexedNodeById(e).getFirstChildOfType(r.r.DTFace3D);i.removeChildNodes();const n=JSON.parse(t,r.c.reviver);for(const t of n.childNodes)t.parentNode=null,i.appendChild(t),this.project.projectChanged.notify({type:"TILELIST_ADDED",node:t})}}}))}else{let e=a.current.getFirstChildOfType(r.r.DTFace3D);e.removeChildNodes();let i=JSON.parse(t,r.c.reviver),s=i.getFirstChildOfType(r.r.DTTileList).getFirstChildOfType(r.r.DTPattern),o=s.getFirstChildOfType(r.r.DTTileInst).data,h=s.data;n.push({id:a.current.id,tiles:[{code:o.idProduct,manufacturer:o.idManuf,color:o.colorVar}],surfaceType:a.current.data.surfaceType,surfaceIndex:a.current.data.surfaceIndex,groutSize:h.groutSize,groutColor:h.groutColor,pattern:h.id,formatSize:Object(y.k)(o.width,o.height,o.diagonal),rotation:u.a.radToDeg(h.rotation)});for(const t of i.childNodes)t.parentNode=null,e.appendChild(t),this.project.projectChanged.notify({type:"TILELIST_ADDED",node:t})}break}}this.activityManager.blockingTaskCompleted(),this.end(null,{appliedTiles:n})}onEnd(t){t()}}class se{}class oe{constructor(t){this.imageSize=t,this.type=n.Print}}class re extends a.a{constructor(t,e,i){super(),this.project=t,this.resourceManager=e,this.imageManager=i,this.onPrintDialogClose=()=>{this.end()}}getPrintConfig(t){const e=null==t,i={currentView:e,tileList:e};if(t)for(const e of t)switch(e.type){case"CurrentView":i.currentView=e.default;break;case"TileList":i.tileList=e.default}return i}showPrintDialog(t,e){this.resourceManager.showPrintModalDialog((()=>new Promise(((i,n)=>{const a=new se,s=this.getPrintConfig(e);a.image=null;const o=[];s.currentView&&o.push(this.imageManager.getImage(t.imageSize.width,t.imageSize.height)),Promise.all(o).then((t=>{if(t&&t.length>0&&(a.image=t[0].img),s.tileList){const t=new Set;this.project.root.walkOnAllChildrenByType(r.r.DTTiledLayer,!1,(e=>{const i=e.getFirstChildOfType(r.r.DTFace3D);this.addVisibleTiles(i,t)})),a.visibleTiles=Array.from(t)}i(a)})).catch((()=>{console.debug("[Print] image promises error"),n()}))}))),e,this.onPrintDialogClose)}addVisibleTiles(t,e){const i=t.getChildNodes(!0);for(;i.moveNextByType(r.r.DTTileInst);){const t=i.current.data;"SIST"!==t.idProduct&&"SIST"!==t.idManuf&&"SIST"!==t.colorVar&&e.add([t.idProduct,t.idManuf,t.colorVar].join("|"))}}onStart(){if(this.command.type!==n.Print)throw new Error(`Invalid command type ${this.command.type}`);const t=this.command;this.showPrintDialog(t,null)}onEnd(t){t()}}class he{constructor(t,e){this.rug=t,this.mask=e,this.type=n.SetupRug}}class le extends a.a{constructor(t,e,i,n,a,s){super(),this.project=t,this.objectControls=e,this.layerSelectionEnabled=i,this.resourceManager=n,this.canvasSize=a,this.camera=s,this.onEditMaskCallback=t=>{this.project.root.getFirstChildOfType(r.r.DTMaskList).walkOnAllChildrenByType(r.r.DTMask,!1,(e=>{const i=e.data;i.id===t.id&&(i.src=t.src,i.reflection=t.reflection,i.shading=t.shading,i.indexes=t.indexes,i.contour2d=t.contour2d,this.project.projectChanged.notify({type:"MASK_UPDATED",node:e}))}))},this.nextButtonCallBack=()=>{this.resourceManager.layerSetupFinished(),this.end()},this.onClick=t=>{if(this.rugPositionEnabled){t.handled=!0;const e=W.a.getPointerCoordinates(t.originalEvent,this.objectControls.domElement.parentElement.id),i={x:100*e.x/this.canvasSize.x,y:100*e.y/this.canvasSize.y};if(0===this.surfaceIndex&&this.project.root.walkOnAllChildrenByType(r.r.DTTiledLayer,!1,(t=>{const e=t.data;e.surfaceType===r.J.FLOOR&&(this.surfaceIndex=e.surfaceIndex)})),0===this.surfaceIndex)console.log("CANNOT GET CORRECT RUG SURFACE INDEX"),this.resourceManager.showMessageCallout(f.d.ERROR,f.c.GENERIC_ERROR),this.end();else{const t=q.a.rr3RugToDTRug(this.command.rug,this.surfaceIndex),e=Object(y.u)(this.camera,i,this.canvasSize);u.a.mat4Translate(t.matrix,e.x,e.y,0);const n=new r.c(t);this.project.addRug(n),this.rugPositionEnabled=!1,this.layerSetupProps.nextButtonEnabled=!0,this.resourceManager.loadLayerSetup(this.layerSetupProps)}}},this.checkAndAddMask=t=>{if(t){this.surfaceIndex=t.indexes[0];let e=this.project.root.getFirstChildOfType(r.r.DTMaskList);if(!e){const t=new r.q;e=new r.c(t),this.project.addMaskListNode(e)}let i=!1;if(e.walkOnAllChildrenByType(r.r.DTMask,!1,(e=>{e.data.id===t.id&&(i=!0)})),!i){const i=new r.p(t.id,t.src,t.indexes,t.reflection,t.shading);i.contour2d=t.contour2d;const n=new r.c(i);e.appendChild(n),this.project.projectChanged.notify({type:"MASK_ADDED",node:n})}}},this.layerSetupProps={surfaceType:r.J.RUG,imageSizeProcessing:{x:0,y:0},nextButtonEnabled:!1,onEditMaskCallback:this.onEditMaskCallback,nextButtonCallback:this.nextButtonCallBack,layerMask:null},this.rugPositionEnabled=!0,this.surfaceIndex=0}attachEventHandlers(){this.objectControls.addEventListener(M.b.CLICK,this.onClick)}detachEventHandlers(){this.objectControls.removeEventListener(M.b.CLICK,this.onClick)}onStart(){this.layerSelectionEnabled.value=!1,this.attachEventHandlers();const t=this.command;t.mask&&(this.layerSetupProps.layerMask=t.mask);const e=this.project.root.getFirstChildOfType(r.r.DTBackgroundImage).data;this.layerSetupProps.imageSizeProcessing=e.imageSizeProcessing,this.resourceManager.loadLayerSetup(this.layerSetupProps),this.checkAndAddMask(t.mask),this.checkAndAddLights()}checkAndAddLights(){let t=this.project.root.getFirstChildOfType(r.r.DTLightList);if(!t){const e=new r.n;t=new r.c(e);const i=new r.l(r.o.Ambient,0,null,null,R.c,0,0,null),n=new r.c(i);t.appendChild(n),this.project.root.appendChild(t),this.project.projectChanged.notify({type:"LIGHT_ADDED",node:n})}}onEnd(t){this.detachEventHandlers(),this.layerSelectionEnabled.value=!0,t()}}class ce{constructor(t,e){this.corridor=t,this.mask=e,this.type=n.SetupCorridor}}class de extends a.a{constructor(t,e,i,n,a,s){super(),this.project=t,this.objectControls=e,this.layerSelectionEnabled=i,this.resourceManager=n,this.canvasSize=a,this.camera=s,this.onEditMaskCallback=t=>{this.project.root.getFirstChildOfType(r.r.DTMaskList).walkOnAllChildrenByType(r.r.DTMask,!1,(e=>{const i=e.data;i.id===t.id&&(i.src=t.src,i.reflection=t.reflection,i.shading=t.shading,i.indexes=t.indexes,i.contour2d=t.contour2d,this.project.projectChanged.notify({type:"MASK_UPDATED",node:e}))}))},this.nextButtonCallBack=()=>{this.resourceManager.layerSetupFinished(),this.end()},this.onClick=t=>{if(this.corridorPositionEnabled){t.handled=!0;const e=W.a.getPointerCoordinates(t.originalEvent,this.objectControls.domElement.parentElement.id),i={x:100*e.x/this.canvasSize.x,y:100*e.y/this.canvasSize.y};if(0==this.surfaceIndex&&this.project.root.walkOnAllChildrenByType(r.r.DTTiledLayer,!1,(t=>{const e=t.data;e.surfaceType==r.J.FLOOR&&(this.surfaceIndex=e.surfaceIndex)})),0==this.surfaceIndex)console.log("CANNOT GET CORRECT CORRIDOR SURFACE INDEX"),this.resourceManager.showMessageCallout(f.d.ERROR,f.c.GENERIC_ERROR),this.end();else try{const t=this.command.corridor,e=[{x:t.width/2,y:-R.i/2,z:R.h},{x:-t.width/2,y:-R.i/2,z:R.h},{x:-t.width/2,y:R.i/2,z:R.h},{x:t.width/2,y:R.i/2,z:R.h}],n=new r.e(t.id,t.width,t.height,this.surfaceIndex,e,t.mapUrl);let a=0;const s=this.project.root.getFirstChildOfType(r.r.DTPrjData);if(s){a=s.data.cameraRotation}const o=Object(y.u)(this.camera,i,this.canvasSize);u.a.mat4RotZ(n.matrix,a),u.a.mat4Translate(n.matrix,o.x,o.y,0);const h=new r.c(n);this.project.root.appendChild(h),this.project.projectChanged.notify({type:"CORRIDOR_ADDED",node:h}),this.corridorPositionEnabled=!1,this.layerSetupProps.nextButtonEnabled=!0,this.resourceManager.loadLayerSetup(this.layerSetupProps)}catch(t){console.log("[SetupCorridor] rr3CorridorToDTCorridor error")}}},this.checkAndAddMask=t=>{if(t){this.surfaceIndex=t.indexes[0];let e=this.project.root.getFirstChildOfType(r.r.DTMaskList);if(!e){const t=new r.q;e=new r.c(t),this.project.addMaskListNode(e)}let i=!1;if(e.walkOnAllChildrenByType(r.r.DTMask,!1,(e=>{e.data.id===t.id&&(i=!0)})),!i){const i=new r.p(t.id,t.src,t.indexes,t.reflection,t.shading);i.contour2d=t.contour2d;const n=new r.c(i);e.appendChild(n),this.project.projectChanged.notify({type:"MASK_ADDED",node:n})}}},this.layerSetupProps={surfaceType:r.J.CORRIDOR,imageSizeProcessing:{x:0,y:0},nextButtonEnabled:!1,onEditMaskCallback:this.onEditMaskCallback,nextButtonCallback:this.nextButtonCallBack,layerMask:null},this.corridorPositionEnabled=!0,this.surfaceIndex=0}attachEventHandlers(){this.objectControls.addEventListener(M.b.CLICK,this.onClick)}detachEventHandlers(){this.objectControls.removeEventListener(M.b.CLICK,this.onClick)}onStart(){this.layerSelectionEnabled.value=!1,this.attachEventHandlers();const t=this.command;t.mask&&(this.layerSetupProps.layerMask=t.mask);const e=this.project.root.getFirstChildOfType(r.r.DTBackgroundImage).data;this.layerSetupProps.imageSizeProcessing=e.imageSizeProcessing,this.resourceManager.loadLayerSetup(this.layerSetupProps),this.checkAndAddMask(t.mask),this.checkAndAddLights()}checkAndAddLights(){let t=this.project.root.getFirstChildOfType(r.r.DTLightList);if(!t){const e=new r.n;t=new r.c(e);const i=new r.l(r.o.Ambient,0,null,null,R.c,0,0,null),n=new r.c(i);t.appendChild(n),this.project.root.appendChild(t),this.project.projectChanged.notify({type:"LIGHT_ADDED",node:n})}}onEnd(t){this.detachEventHandlers(),this.layerSelectionEnabled.value=!0,t()}}class ue{constructor(t,e,i=null){this.id=t,this.animate=e,this.callback=i,this.type=n.SetSelectedNode}}class pe extends a.a{constructor(t,e,i){super(),this.project=t,this.selection=e,this.selectCallback=i}onStart(){let t=this.command,e=null;this.selection.clear();const i=this.project.root.getFirstChildOfType(r.r.DTGroupList);if(i&&(i.walkOnAllChildrenByType(r.r.DTGroup,!1,(i=>{i.id===t.id&&(e=i)})),e)){const i=e.data,n=this.project.root.getIndexedNodeById(i.layers[0]);this.selection.set(...i.layers),t.animate&&this.selectCallback(n)}let n;if(!e&&(e=this.project.root.getIndexedNodeById(t.id),e)){switch(this.selection.set(t.id),e.data.type){case r.r.DTRug:{const t=e.data,i=u.a.mat4GetPosition(t.matrix);n=new yt(i,!1);break}case r.r.DTCorridor:{const t=e.data,i=u.a.mat4GetPosition(t.matrix);n=new at(i);break}}t.animate&&this.selectCallback(e)}t.callback&&t.callback(),this.end(n)}onEnd(t){t()}}class ge{constructor(){this.type=n.AlignTiledLayer}}class me extends a.a{constructor(t,e,i){super(),this.project=t,this.selection=e,this.gridCanvasManager=i,this.onGridCanvasChanged=t=>{"DETACH"===t.type&&this.end()}}onStart(){if(this.command.type!==n.AlignTiledLayer)throw new Error(`Invalid command type ${this.command.type}`);const t=this.project.root.getIndexedNodeById(this.selection.getSelectionSet().values().next().value);let e;t.data.type===r.r.DTPattern?e=t.parentNode.parentNode.parentNode:t.data.type===r.r.DTFace3D?e=t.parentNode:t.data.type===r.r.DTTiledLayer&&(e=t),e&&(this.gridCanvasManager.attachExternalEventHandlers(this.onGridCanvasChanged),this.gridCanvasManager.showGridCanvas(e))}onEnd(t){this.gridCanvasManager.detachExternalEventHandlers(this.onGridCanvasChanged),this.gridCanvasManager.removeGridCanvas(),t()}}var fe=i(43);class ye{constructor(t,e){this.imageSize=t,this.screenshotConfig=e,this.type=n.RequestInfo}}class ve extends a.a{constructor(t,e,i){super(),this.project=t,this.resourceManager=e,this.imageManager=i,this.onRequestInfoDialogClose=()=>{this.end()}}onStart(){if(this.command.type!==n.RequestInfo)throw new Error(`Invalid command type ${this.command.type}`);this.resourceManager.showRequestInfoDialog((()=>new Promise(((t,e)=>{const i=new fe.b;i.image=null;const n=this.command;this.imageManager.getImage(n.imageSize.width,n.imageSize.height).then((a=>{this.imageManager.applyWatermark(a,n.screenshotConfig).then((e=>{i.image=e;const n=new Set;this.project.root.walkOnAllChildrenByType(r.r.DTTiledLayer,!1,(t=>{const e=t.getFirstChildOfType(r.r.DTFace3D);Object(y.a)(e,n)})),i.visibleTiles=Array.from(n),t(i)})).catch((t=>{console.log("[RequestInfo] applyWatermark error"),e()}))})).catch((t=>{console.log("[RequestInfo] getImage error"),e()}))}))),this.onRequestInfoDialogClose)}onEnd(t){t()}}class xe{constructor(t){this.shareInfo=t,this.type=n.ShareProjectLink}}class Te extends a.a{constructor(t,e,i,n,a){super(),this.project=t,this.resourceManager=e,this.shareClient=i,this.activityManager=n,this.analyticsManager=a,this.onSetPasswordClick=t=>{console.log("onSetPasswordClick")},this.onClose=()=>{this.end()}}onStart(){if(this.command.type!==n.ShareProjectLink)throw new Error(`Invalid command type ${this.command.type}`);this.activityManager.addBlockingTask();const t=this.command,e=Object(y.q)(this.project,t.shareInfo.azureStorageAccountName),i=this.project.root.data,a={storageAccount:t.shareInfo.azureStorageAccountName,prjId:i.sceneId,prjType:r.I[i.sceneType],baseLink:t.shareInfo.baseLink,prjData:e.prjDataString,bgImage:e.bgMask,floorMask:e.floorMask,wallMask:e.wallMask};this.shareClient.shareProjectLink(a).then((t=>{t=t.substring(1,t.length-1),this.activityManager.blockingTaskCompleted();const e=t.split("/");this.analyticsManager&&this.analyticsManager.projectShared(e[e.length-1]),this.resourceManager.showShareProjectLinkDialog(t,this.onSetPasswordClick,this.onClose)})).catch((t=>{console.log("[Share link] error: "+JSON.stringify(t)),this.activityManager.blockingTaskCompleted(),this.resourceManager.showMessageCallout(ht.MessageType.ERROR,ht.MessageCode.SHARE_LINK_ERROR),this.end()}))}onEnd(t){t()}}class Me{constructor(t,e,i){this.shareInfo=t,this.imageSize=e,this.screenshotConfig=i,this.type=n.ShareProjectLinkMail}}class Ce extends a.a{constructor(t,e,i,n,a,s){super(),this.project=t,this.resourceManager=e,this.shareClient=i,this.activityManager=n,this.analyticsManager=a,this.imageManager=s,this.onDialogClose=()=>{this.end()}}onStart(){if(this.command.type!==n.ShareProjectLinkMail)throw new Error(`Invalid command type ${this.command.type}`);this.resourceManager.showShareProjectLinkMailDialog((()=>new Promise(((t,e)=>{const i=this.command,n=new fe.b;n.image=null;const a=Object(y.q)(this.project,i.shareInfo.azureStorageAccountName),s=this.project.root.data,o={storageAccount:i.shareInfo.azureStorageAccountName,prjId:s.sceneId,prjType:ht.SceneType[s.sceneType],baseLink:i.shareInfo.baseLink,prjData:a.prjDataString,bgImage:a.bgMask,floorMask:a.floorMask,wallMask:a.wallMask};this.shareClient.shareProjectLink(o).then((a=>{if(this.analyticsManager){const t=a.split("/");this.analyticsManager.projectShared(t[t.length-1])}a=a.substring(1,a.length-1),n.sharedLink=a,this.imageManager.getImage(i.imageSize.width,i.imageSize.height).then((a=>{this.imageManager.applyWatermark(a,i.screenshotConfig).then((e=>{n.image=e;const i=new Set;this.project.root.walkOnAllChildrenByType(r.r.DTTiledLayer,!1,(t=>{const e=t.getFirstChildOfType(r.r.DTFace3D);Object(y.a)(e,i)})),n.visibleTiles=Array.from(i),t(n)})).catch((t=>{console.log("[ShareProjectLinkMail] applyWatermark error"),e()}))})).catch((t=>{console.log("[ShareProjectLinkMail] getImage error"),e()}))})).catch((t=>{console.log("[ShareProjectLinkMail] getLink error"),e()}))}))),this.onDialogClose)}onEnd(t){t()}}class be{constructor(t){this.shareInfo=t,this.type=n.ShareOnFacebook}}class Pe extends a.a{constructor(t,e,i,n,a){super(),this.project=t,this.resourceManager=e,this.shareClient=i,this.activityManager=n,this.analyticsManager=a}onStart(){if(this.command.type!==n.ShareOnFacebook)throw new Error(`Invalid command type ${this.command.type}`);this.activityManager.addBlockingTask();const t=this.project.root.data,e=this.command,i=Object(y.q)(this.project,e.shareInfo.azureStorageAccountName),a={storageAccount:e.shareInfo.azureStorageAccountName,prjId:t.sceneId,prjType:r.I[t.sceneType],baseLink:e.shareInfo.baseLink,prjData:i.prjDataString,bgImage:i.bgMask,floorMask:i.floorMask,wallMask:i.wallMask};this.shareClient.shareProjectLink(a).then((t=>{const e=(t=t.substring(1,t.length-1)).split("/");this.analyticsManager&&this.analyticsManager.projectShared(e[e.length-1]),this.activityManager.blockingTaskCompleted(),this.end(null,{link:t})})).catch((t=>{console.log("[Share fb] error: "+JSON.stringify(t)),this.activityManager.blockingTaskCompleted(),this.resourceManager.showMessageCallout(ht.MessageType.ERROR,ht.MessageCode.SHARE_LINK_ERROR),this.end()}))}onEnd(t){t()}}class Ee{constructor(t){this.blobId=t,this.type=n.LoadSharedProject}}class De extends a.a{constructor(t,e,i,n,a,s){super(),this.project=t,this.resourceManager=e,this.shareClient=i,this.activityManager=n,this.analyticsManager=a,this.projectLoaded=s,this.onProjectLoaded=()=>{this.activityManager.blockingTaskCompleted();const t=this.project.root.getFirstChildOfType(r.r.DTBackgroundImage).data.cameraParams.imageAspect,e=this.project.root.data;this.end(null,{aspect:t,sceneType:e.sceneType,sceneId:e.sceneId})}}onStart(){if(this.command.type!==n.LoadSharedProject)throw new Error(`Invalid command type ${this.command.type}`);this.activityManager.addBlockingTask(),this.projectLoaded.Changed.on(this.onProjectLoaded);const t=this.command;this.shareClient.getSharedProject(t.blobId).then((e=>{this.analyticsManager&&this.analyticsManager.projectSharedOpened(t.blobId);try{this.project.loadNew(e)}catch(t){console.debug("CANNOT PARSE SHARED PROJECT: "+JSON.stringify(t)),this.activityManager.blockingTaskCompleted(),this.end()}})).catch((()=>{this.activityManager.blockingTaskCompleted(),this.resourceManager.showMessageCallout(f.d.ERROR,f.c.LOAD_SHARED_PROJECT_ERROR),this.end()}))}onEnd(t){t()}}class we{constructor(t,e){this.lightId=t,this.intensity=e,this.type=n.EditLightIntensity}}class Se extends a.a{constructor(t){super(),this.project=t}onStart(){const t=this.project.root.getFirstChildOfType(r.r.DTLightList),e=this.command;let i;for(i=0;i<t.childNodes.length;i++)if(t.childNodes[i].id===e.lightId){t.childNodes[i].data.power=e.intensity;break}this.project.projectChanged.notify({type:"LIGHT_CHANGED",node:t.childNodes[i]}),this.end()}onEnd(t){t()}}class Ie{constructor(t,e){this.lightId=t,this.visible=e,this.type=n.ShowLightPlaceholder}}class Le extends a.a{constructor(t,e,i,n,a,s,o,r){super(),this.project=t,this.phScene=e,this.camera=i,this.width=n,this.height=a,this.layerSelectionEnabled=s,this.inputDomElement=o,this.renderFrame=r,this.pointerDownEventHandler=t=>{const e=W.a.getPointerCoordinates(t,this.inputDomElement.parentElement.id),i=b.a.createRaycaster(this.camera,this.width,this.height,e.x,e.y).intersectObjects(this.phScene.children,!0);if(i.length>0)for(const t of i){const e=t;"CUBE"!==e.object.name&&"ANIM_CUBE"!==e.object.name||(this.intersectionName=e.object.name)}},this.pointerMoveEventHandler=t=>{if(this.intersectionName){const e=W.a.getPointerCoordinates(t,this.inputDomElement.parentElement.id),i=b.a.viewportToPlaneWorldPosition(e,this.camera,this.width,this.height,this.planeNormal,this.planePoint);if(null!=i){const t=this.command,e=this.project.root.getIndexedNodeById(t.lightId),n=e.data;if("CUBE"===this.intersectionName){this.lightHelper.setLightHelperPosition(i);const t=i.clone();t.applyMatrix4(C.c),n.pnt.x=t.x,n.pnt.y=t.y,this.project.projectChanged.notify({type:"LIGHT_CHANGED",node:e})}else if("ANIM_CUBE"===this.intersectionName){const t=i.clone();t.applyMatrix4(C.c),n.animationPositions[0].x=t.x,n.animationPositions[0].y=t.y,this.lightHelper.updateLightAnimation(i)}}this.renderFrame.value=!0}},this.pointerUpEventHandler=t=>{if(this.intersectionName&&"ANIM_CUBE"===this.intersectionName){const t=this.command,e=this.project.root.getIndexedNodeById(t.lightId);this.project.projectChanged.notify({type:"LIGHT_CHANGED",node:e})}this.intersectionName=null}}onStart(){const t=this.command;if(t.visible){this.layerSelectionEnabled.value=!1,this.attachEventHandlers(),this.planeNormal=new j.Vector3(0,1,0),this.planePoint=new j.Vector3(0,0,1);const e=this.project.root.getIndexedNodeById(t.lightId).data;this.lightHelper=new Bt(t.lightId,.2,!1,C.a),this.lightHelper.addLightHelper(this.phScene,e),this.renderFrame.value=!0}else{for(const e of this.phScene.children)if(e.name===t.lightId){this.phScene.remove(e);break}this.renderFrame.value=!0,this.layerSelectionEnabled.value=!0}}attachEventHandlers(){this.inputDomElement.addEventListener("mousedown",this.pointerDownEventHandler),this.inputDomElement.addEventListener("touchstart",this.pointerDownEventHandler),this.inputDomElement.addEventListener("mousemove",this.pointerMoveEventHandler),this.inputDomElement.addEventListener("touchmove",this.pointerMoveEventHandler),this.inputDomElement.addEventListener("mouseup",this.pointerUpEventHandler),this.inputDomElement.addEventListener("touchend",this.pointerUpEventHandler),this.inputDomElement.addEventListener("touchcancel",this.pointerUpEventHandler)}detachEventHandlers(){this.inputDomElement.removeEventListener("mousedown",this.pointerDownEventHandler),this.inputDomElement.removeEventListener("touchstart",this.pointerDownEventHandler),this.inputDomElement.removeEventListener("mousemove",this.pointerMoveEventHandler),this.inputDomElement.removeEventListener("touchmove",this.pointerMoveEventHandler),this.inputDomElement.removeEventListener("mouseup",this.pointerUpEventHandler),this.inputDomElement.removeEventListener("touchend",this.pointerUpEventHandler),this.inputDomElement.removeEventListener("touchcancel",this.pointerUpEventHandler)}onEnd(t){this.command.visible&&this.detachEventHandlers(),t()}}var Ae=i(62),Oe=i(32),Re=i(33);class _e{constructor(t,e,i){this.preview=t,this.onImageReady=e,this.dpi=i,this.type=n.DownloadVignetteImage}}const ke="image/jpeg";class je extends a.a{constructor(t,e,i,n,a,s,o){super(),this.project=t,this.renderer=e,this.scene=i,this.vignetteType=n,this.lineMaterial=a,this.activityManager=s,this.analyticsManager=o}onStart(){const t=this.command,e=t.dpi?t.dpi:24;let i,n,a,s;switch(this.activityManager.addBlockingTask(),this.analyticsManager&&this.analyticsManager.vignetteDownloaded(),this.vignetteType){case dt.g.Tile:{const t=this.project.root.getFirstChildOfType(r.r.DTFace3D);if(t){const e=t.data;i=e.points[0].x-e.points[3].x,n=e.points[0].y-e.points[1].y}}break;case dt.g.Rug:{const t=this.project.root.getFirstChildOfType(r.r.DTRug);if(t){const e=t.data;i=e.bbox.max.x-e.bbox.min.x,n=e.bbox.max.y-e.bbox.min.y}}break;case dt.g.Corridor:{const t=this.project.root.getFirstChildOfType(r.r.DTCorridor);if(t){const e=t.data;i=e.width,n=e.height}}break;case dt.g.Broadloom:{const t=this.project.root.getFirstChildOfType(r.r.DTCorridor);if(t){const e=t.data;i=e.width,n=e.height}else{const t=this.project.root.getFirstChildOfType(r.r.DTFace3D);if(t){const e=t.data;i=e.points[0].x-e.points[3].x,n=e.points[0].y-e.points[1].y}}}}if(null!=i&&null!=n||(this.activityManager.blockingTaskCompleted(),console.log("[DownloadVignetteImage] error getting vignette size"),this.end()),t.preview){const e=i/n,o=2048;i>n?(a=o,s=o/e):(s=o,a=e*o),this.getImage(a,s,i,n).then((e=>{this.activityManager.blockingTaskCompleted(),t.onImageReady(e),this.end()})).catch((t=>{this.activityManager.blockingTaskCompleted(),console.log("[DownloadVignetteImage] getImage error: "+JSON.stringify(t)),this.end()}))}else{const o=new ht.Qt(i,ht.UNITS.MM).to(ht.UNITS.IN),r=new ht.Qt(n,ht.UNITS.MM).to(ht.UNITS.IN);a=Math.round(e*o.value),s=Math.round(e*r.value),console.log("vignette size: "+i+"x"+n+"mm - image size: "+a+"x"+s+"px - dpi: "+e),this.getImageFromSlices(a,s,i,n).then((i=>{const n=this.changeDpiDataUrl(i,e);this.activityManager.blockingTaskCompleted(),t.onImageReady(n),this.end()})).catch((t=>{this.activityManager.blockingTaskCompleted(),console.log("[DownloadVignetteImage] getImage error: "+JSON.stringify(t)),this.end()}))}}getImage(t,e,i,n){return new Promise(((a,s)=>{const o=this.renderer.getSize(new j.Vector2);this.lineMaterial.visible=!1;const r=Oe.a;r.size.x=i,r.size.y=n;const h=Object(Oe.b)(r,C.a,C.b),l=new j.OrthographicCamera(-1,1,1,-1,0,1),c=new Re.b(t,e);c.marginPixels=new Re.a(0,0,0,0),c.configureCamera(l,h),l.updateProjectionMatrix(),this.renderer.setSize(t,e),this.renderer.setPixelRatio(1),this.renderer.render(this.scene,l);const d=this.renderer.domElement.toDataURL("image/"+R.r,1);this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setSize(o.width,o.height),this.lineMaterial.visible=!0,a(d)}))}getImageFromSlices(t,e,i,n){return new Promise(((a,s)=>{const o=this.renderer.getSize(new j.Vector2);this.lineMaterial.visible=!1;const r=Oe.a;r.size.x=i,r.size.y=n;const h=Object(Oe.b)(r,C.a,C.b),l=new j.OrthographicCamera(-1,1,1,-1,0,1);t%2!=0&&(t-=1),e%2!=0&&(e-=1);const c=new Re.b(t,e);c.marginPixels=new Re.a(0,0,0,0),c.configureCamera(l,h),l.updateProjectionMatrix();const d=[];d.push(this.loadImage(this.renderSlice(l,t,e,0,0,t/2,e/2))),d.push(this.loadImage(this.renderSlice(l,t,e,t/2,0,t/2,e/2))),d.push(this.loadImage(this.renderSlice(l,t,e,0,e/2,t/2,e/2))),d.push(this.loadImage(this.renderSlice(l,t,e,t/2,e/2,t/2,e/2))),this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setSize(o.width,o.height),this.lineMaterial.visible=!0,Promise.all(d).then((i=>{const n=document.createElement("canvas");n.width=t,n.height=e;const s=n.getContext("2d");s.drawImage(i[0],0,0,t/2,e/2),s.drawImage(i[1],t/2,0,t/2,e/2),s.drawImage(i[2],0,e/2,t/2,e/2),s.drawImage(i[3],t/2,e/2,t/2,e/2);const o=n.toDataURL("image/"+R.r,1);a(o)})).catch((t=>{console.log("[DownloadVignetteImage] images generation error: "+JSON.stringify(t)),s()}))}))}loadImage(t){return new Promise(((e,i)=>{const n=new Image;n.onload=()=>e(n),n.src=t}))}renderSlice(t,e,i,n,a,s,o){t.setViewOffset(e,i,n,a,s,o),this.renderer.setSize(s,o),this.renderer.setPixelRatio(1),this.renderer.render(this.scene,t);return this.renderer.domElement.toDataURL("image/"+R.r,1)}changeDpiDataUrl(t,e){const i=t.split(","),n=i[0],a=i[1];let s,o;-1!==n.indexOf(ke)&&(s=ke,o=24);const r=a.substring(0,o),h=a.substring(o),l=atob(r),c=new Uint8Array(l.length);for(let t=0;t<c.length;t++)c[t]=l.charCodeAt(t);const d=this.changeDpiOnArray(c,e,s,!1);return[n,",",btoa(String.fromCharCode(...d)),h].join("")}changeDpiOnArray(t,e,i,n){if(i===ke)return t[13]=1,t[14]=e>>8,t[15]=255&e,t[16]=e>>8,t[17]=255&e,t}onEnd(t){t()}}var Ne=i(54);class Fe{constructor(t){this.rug=t,this.type=n.LoadRugVignette}}class ze extends a.a{constructor(t,e,i){super(),this.project=t,this.activityManager=e,this.analyticsManager=i}onStart(){const t=this.command;this.activityManager.addBlockingTask(),this.analyticsManager&&this.analyticsManager.vignetteCreated("Rug");const e=q.a.rr3RugToDTRug(t.rug,1);u.a.mat4Translate(e.matrix,0,0,0);const i=new r.c(e);this.project.addRug(i),this.activityManager.blockingTaskCompleted(),this.end(new Ne.a(t.rug.width,t.rug.height))}onEnd(t){t()}}class Be{constructor(t){this.corridor=t,this.type=n.LoadCorridorVignette}}class He extends a.a{constructor(t,e,i){super(),this.project=t,this.activityManager=e,this.analyticsManager=i}onStart(){const t=this.command;this.activityManager.addBlockingTask(),this.analyticsManager&&this.analyticsManager.vignetteCreated("Corridor");const e=[{x:t.corridor.width/2,y:-t.corridor.height/2,z:R.h},{x:-t.corridor.width/2,y:-t.corridor.height/2,z:R.h},{x:-t.corridor.width/2,y:t.corridor.height/2,z:R.h},{x:t.corridor.width/2,y:t.corridor.height/2,z:R.h}],i=new r.e(t.corridor.id,t.corridor.width,t.corridor.height,-1,e,t.corridor.mapUrl),n=new r.c(i);this.project.root.appendChild(n),this.project.projectChanged.notify({type:"CORRIDOR_ADDED",node:n}),this.activityManager.blockingTaskCompleted(),this.end(new Ne.a(t.corridor.width,t.corridor.height))}onEnd(t){t()}}class Ue{constructor(t){this.broadloom=t,this.type=n.LoadBroadloomVignette}}class Ge extends a.a{constructor(t,e,i,n,a,s){super(),this.project=t,this.activityManager=e,this.matManager=i,this.patternManager=n,this.lineMaterial=a,this.analyticsManager=s}onStart(){const t=this.command;if(this.activityManager.addBlockingTask(),this.analyticsManager&&this.analyticsManager.vignetteCreated("Broadloom"),t.broadloom.halfDrop){this.lineMaterial.visible=!0;const e=[];e.push({x:t.broadloom.width,y:t.broadloom.height/2,z:0}),e.push({x:t.broadloom.width,y:-t.broadloom.height/2,z:0}),e.push({x:-t.broadloom.width,y:-t.broadloom.height/2,z:0}),e.push({x:-t.broadloom.width,y:t.broadloom.height/2,z:0});const i=r.i.FF_COVER|r.i.FF_FILLED,n=new r.g(i,R.j,e,r.h.CLASSID_FLOOR,-1,[]),a=new r.c(n),s=this.getTileInfoAndCreateThreeMaterials(t.broadloom,-1),o=v.patterns.pieno_02,h=m.g.createPatternStructureWithTiles(o,[s],0);if(h){const e={x:0,y:0};this.patternManager.addPattern(a,null,16777215,0,u.a.degToRad(90),h,e,!1,!1),this.project.root.appendChild(a),this.project.projectChanged.notify({type:"FACE3D_ADDED",node:a}),this.activityManager.blockingTaskCompleted(),this.end(new Ne.a(2*t.broadloom.width,t.broadloom.height))}else console.log("PATTERN_CONSTRAINTS_VIOLATION"),this.activityManager.blockingTaskCompleted(),this.end()}else{this.lineMaterial.visible=!1;const e=[{x:t.broadloom.width/2,y:-t.broadloom.height/2,z:R.h},{x:-t.broadloom.width/2,y:-t.broadloom.height/2,z:R.h},{x:-t.broadloom.width/2,y:t.broadloom.height/2,z:R.h},{x:t.broadloom.width/2,y:t.broadloom.height/2,z:R.h}],i=new r.e(t.broadloom.id,t.broadloom.width,t.broadloom.height,-1,e,t.broadloom.mapUrl),n=new r.c(i);this.project.root.appendChild(n),this.project.projectChanged.notify({type:"CORRIDOR_ADDED",node:n}),this.activityManager.blockingTaskCompleted(),this.end(new Ne.a(t.broadloom.width,t.broadloom.height))}}getTileInfoAndCreateThreeMaterials(t,e){const i=new m.f({idProduct:t.id,idManufacturer:t.idManuf,colorVar:"0",width:t.width,height:t.height,diagonal:0,formatType:"RETT",offshaded:!1,numImages:1,dominantColor:null!=t.dominantColor?t.dominantColor:16777215,offshadedRot:!1,polygon:J.b.getTilePolygon("RETT",t.width,t.height,0)}),n=new r.f;return n.key=new r.H(t.idManuf,t.id,1),n.map=t.mapUrl,this.matManager.createExternalTileMat(t.idManuf,t.id,"0",1,e,n),i}onEnd(t){t()}}class Ve{constructor(){this.type=ht.CommandsEnum.AddGroups}}class We extends a.a{constructor(t,e,i,n,a){super(),this.project=t,this.resourceManager=e,this.inputDomElement=i,this.width=n,this.height=a,this.closeGroupsDialog=t=>{let e=t.label;const i=t.layers;if(i.length>0&&null!=t.tileDestination){let n=this.project.root.getFirstChildOfType(r.r.DTGroupList);if(!n){const t=new r.k;n=new r.c(t),this.project.addGroupListNode(n)}let a=!0;if(n.childNodes.length>0&&(a=Object(y.A)(n.childNodes,i)),a){e&&(e=e.trim());const a=new r.j(i.map((t=>t.id)),this.hotspot,e,t.tileDestination),s=new r.c(a);n.appendChild(s);const o={x:this.hotspot.x*this.width/100,y:this.hotspot.y*this.height/100};this.resourceManager.setHotspot(s.id,o.x,o.y,null,null,null,e,t.tileDestination,f.b.GROUP),this.resourceManager.showMessageCallout(f.d.SUCCESS,f.c.ADD_GROUP_OK)}else this.resourceManager.showMessageCallout(f.d.ERROR,f.c.ADD_GROUP_ERROR)}this.resourceManager.groupsSetupFinished(),this.end()},this.pointerDownEventHandler=t=>{const e=W.a.getPointerCoordinates(t,this.inputDomElement.parentElement.id);this.hotspot={x:100*e.x/this.width,y:100*e.y/this.height},this.showGroupsDialog()}}showGroupsDialog(){this.resourceManager.showAddGroupsDialog(Object(y.l)(this.project),this.closeGroupsDialog)}attachEventHandlers(){this.inputDomElement.addEventListener("mousedown",this.pointerDownEventHandler)}detachEventHandlers(){this.inputDomElement.removeEventListener("mousedown",this.pointerDownEventHandler)}onStart(){if(this.command.type!==ht.CommandsEnum.AddGroups)throw new Error(`Invalid command type ${this.command.type}`);this.resourceManager.loadGroupsSetup(),this.attachEventHandlers()}onEnd(t){this.detachEventHandlers(),t()}}class Je{constructor(t){this.id=t,this.type=ht.CommandsEnum.EditGroups}}class qe extends a.a{constructor(t,e,i,n){super(),this.project=t,this.resourceManager=e,this.width=i,this.height=n,this.getGroupById=t=>{let e=null;return this.project.root.getFirstChildOfType(r.r.DTGroupList).walkOnAllChildrenByType(r.r.DTGroup,!1,(i=>{if(i.id===t){const t=i.data,n=[];for(const e of t.layers)n.push({id:e});e={id:i.id,tileDestination:t.tileDestination,label:t.label,layers:n}}})),e},this.onClose=t=>{let e=!1;const i=this.project.root.getFirstChildOfType(r.r.DTGroupList);if(i&&t.layers.length>0&&null!=t.tileDestination){const n=i.childNodes.filter((e=>e.id!==t.id));Object(y.A)(n,t.layers)&&i.walkOnAllChildrenByType(r.r.DTGroup,!1,(i=>{if(i.id===t.id){const n=i.data;n.label=t.label;const a=[];for(const e of t.layers)a.push(e.id);n.layers=a;const s={x:n.hotspot.x*this.width/100,y:n.hotspot.y*this.height/100};this.resourceManager.showMessageCallout(ht.MessageType.SUCCESS,ht.MessageCode.EDIT_GROUP_OK),this.resourceManager.setHotspot(i.id,s.x,s.y,null,null,null,n.label,t.tileDestination,f.b.GROUP),e=!0}})),e||this.resourceManager.showMessageCallout(ht.MessageType.ERROR,ht.MessageCode.NO_EXIST_GROUP_TO_EDIT)}}}onStart(){if(this.command.type!==ht.CommandsEnum.EditGroups)throw new Error(`Invalid command type ${this.command.type}`);const t=this.command;this.resourceManager.showEditGroupsDialog(Object(y.l)(this.project),this.getGroupById(t.id),this.onClose),this.end()}onEnd(t){t()}}class Ke{constructor(t){this.id=t,this.type=ht.CommandsEnum.DeleteGroups}}class Ye extends a.a{constructor(t,e){super(),this.project=t,this.resourceManager=e,this.deleteGroupById=t=>{const e=this.project.root.getFirstChildOfType(r.r.DTGroupList);if(e){const i=e.removeChildById(t);i&&(this.resourceManager.deleteGroup(i.id),this.resourceManager.showMessageCallout(ht.MessageType.SUCCESS,ht.MessageCode.DELETE_GROUP_OK))}}}onStart(){if(this.command.type!==ht.CommandsEnum.DeleteGroups)throw new Error(`Invalid command type ${this.command.type}`);const t=this.command;this.deleteGroupById(t.id),this.end()}onEnd(t){t()}}},function(t,e,i){"use strict";i.d(e,"b",(function(){return p})),i.d(e,"a",(function(){return g})),i.d(e,"c",(function(){return m})),i.d(e,"g",(function(){return f})),i.d(e,"e",(function(){return y})),i.d(e,"d",(function(){return v})),i.d(e,"f",(function(){return x}));var n=i(1),a=i(28),s=i(34),o=i(7),r=i(21),h=i(2);class l{static calcTexCoordSpace(t,e,i=null){const n=h.a.vec3Diff(t[1],t[0]);h.a.vec3Normalize(n)||console.warn("Error normalizing dirU"),null===i&&(i=h.a.poly3Normal(t));const a=h.a.vec3MultVect(i,n);h.a.vec3Normalize(a)||console.warn("Error normalizing dirV");const s=[],o=[];for(let i=0;i<t.length;i++){const r={x:h.a.vec3MultScal(t[i],n),y:h.a.vec3MultScal(t[i],a)};s.push({x:r.x,y:r.y,z:e[i].x}),o.push({x:r.x,y:r.y,z:e[i].y})}return{dirU:n,dirV:a,planeU:h.a.planeFromCoplanarPoints(s),planeV:h.a.planeFromCoplanarPoints(o)}}static calcTexCoordAt(t,e){const i={x:h.a.vec3MultScal(t,e.dirU),y:h.a.vec3MultScal(t,e.dirV),z:0};return{x:h.a.vec3ProjectTo(i,{x:0,y:0,z:1},h.a.planeGetNormal(e.planeU),e.planeU.d).z,y:h.a.vec3ProjectTo(i,{x:0,y:0,z:1},h.a.planeGetNormal(e.planeV),e.planeV.d).z}}static calc2DTexCoordSpace(t,e){const i=h.a.vec2Diff(t[1],t[0]);h.a.vec2Normalize(i)||console.warn("Error normalizing dirU");const n=h.a.vec2PerpCounterClockwise(i);h.a.vec2Normalize(n)||console.warn("Error normalizing dirV");const a=[],s=[];for(let o=0;o<t.length;o++){const r={x:h.a.vec2MultScal(t[o],i),y:h.a.vec2MultScal(t[o],n)};a.push({x:r.x,y:r.y,z:e[o].x}),s.push({x:r.x,y:r.y,z:e[o].y})}return{dirU:i,dirV:n,planeU:h.a.planeFromCoplanarPoints(a),planeV:h.a.planeFromCoplanarPoints(s)}}static calc2DTexCoordAt(t,e){const i={x:h.a.vec2MultScal(t,e.dirU),y:h.a.vec2MultScal(t,e.dirV),z:0};return{x:h.a.vec3ProjectTo(i,{x:0,y:0,z:1},h.a.planeGetNormal(e.planeU),e.planeU.d).z,y:h.a.vec3ProjectTo(i,{x:0,y:0,z:1},h.a.planeGetNormal(e.planeV),e.planeV.d).z}}}const c=.05;function d(t,e,i){const n=c,a=h.a.pnt3TransformArray(e._2DMatrix,t.points);let s=!0,o=!1;for(const t of a)if(!h.a.floatEquals(t.z,0,n)){s=!1;break}if(s){const e=h.a.poly3Normal(t.points);h.a.vec3Normalize(e),h.a.floatEquals(e.x,i.x,n)&&h.a.floatEquals(e.y,i.y,n)&&h.a.floatEquals(e.z,i.z,n)&&(o=!0)}return s&&o?a:null}var u=i(56);const p=.001,g=(new n.Matrix4).set(1,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1).scale(new n.Vector3(p,p,p)),m=new n.Matrix4;function f(t,e,i){const s=(new n.Matrix4).multiplyMatrices(t,i).premultiply(e);return a.e(s)}function y(t,e,i){return a.a(t).multiply(e).premultiply(i)}function v(t,e){const i=new n.Box3(a.i(t.min),a.i(t.max));return i.applyMatrix4(e),i}function x(t,e,i,h=[],c=!1,p=null,g=null,m=[]){const f=p&&g,y=m&&m.length>0,v=t.length,x=[],T=[],M=[],C=[],b={isConvex:i&&i.isConvex},P=i&&i.normal?i.normal:s.a.getPolygonNormal(t,b).normalize().negate();if(3!==v||f||y||0!==h.length){if(4!==v||f||y||0!==h.length||!b.isConvex){const i=Object(r.c)(t,r.a.Default,P),s=[];for(const t of h){const e=d(t,i,P);null!=e&&s.push(e)}const v=Object(u.b)(i.points,s),x=a.d(v),T=new n.ShapeGeometry(x);if(c){const t=o.a.getPositionAttibute(T),s=o.a.getUvAttibute(T),r=T.getIndex();if(y){const e=l.calc2DTexCoordSpace(i.points,m);for(let i=0;i<r.count;i++){const n=r.getX(i),a={x:t.getX(n),y:t.getY(n)},o=l.calc2DTexCoordAt({x:a.x,y:a.y},e);s.setXY(n,o.x,o.y)}}else{T.computeBoundingBox();const e=T.boundingBox,i={x:0-e.min.x,y:0-e.min.y},n=f?{x:p,y:g}:{x:e.max.x-e.min.x,y:e.max.y-e.min.y};for(let e=0;e<r.count;e++){const a=r.getX(e),o={x:t.getX(a),y:t.getY(a)};s.setXY(a,(o.x+i.x)/n.x,(o.y+i.y)/n.y)}}s.needsUpdate=!0,T.applyMatrix4((new n.Matrix4).multiplyMatrices(e,a.a(i._3DMatrix)))}else T.applyMatrix4((new n.Matrix4).multiplyMatrices(e,a.a(i._3DMatrix)));return T}{const i=new n.BufferGeometry;for(let e=0;e<4;e++)x.push(t[e].x,t[e].y,t[e].z),M.push(P.x,P.y,P.z);return T.push(3,2,1),T.push(1,0,3),i.setIndex(T),i.setAttribute("position",new n.Float32BufferAttribute(x,3)),i.setAttribute("normal",new n.Float32BufferAttribute(M,3)),c&&(C.push(0,0),C.push(0,1),C.push(1,1),C.push(1,0),i.setAttribute("uv",new n.Float32BufferAttribute(C,2))),i.applyMatrix4(e),i}}{const i=new n.BufferGeometry;for(let e=0;e<3;e++)x.push(t[e].x,t[e].y,t[e].z),M.push(P.x,P.y,P.z);return T.push(2,1,0),i.setIndex(T),i.setAttribute("position",new n.Float32BufferAttribute(x,3)),i.setAttribute("normal",new n.Float32BufferAttribute(M,3)),c&&(C.push(0,0),C.push(0,1),C.push(1,0),i.setAttribute("uv",new n.Float32BufferAttribute(C,2))),i.applyMatrix4(e),i}}m.copy(g).invert()},function(t,e,i){"use strict";i.d(e,"w",(function(){return n})),i.d(e,"q",(function(){return a})),i.d(e,"s",(function(){return s})),i.d(e,"a",(function(){return o})),i.d(e,"b",(function(){return r})),i.d(e,"f",(function(){return h})),i.d(e,"e",(function(){return l})),i.d(e,"d",(function(){return c})),i.d(e,"g",(function(){return d})),i.d(e,"c",(function(){return u})),i.d(e,"m",(function(){return p})),i.d(e,"l",(function(){return g})),i.d(e,"o",(function(){return m})),i.d(e,"k",(function(){return f})),i.d(e,"p",(function(){return y})),i.d(e,"i",(function(){return v})),i.d(e,"h",(function(){return x})),i.d(e,"j",(function(){return T})),i.d(e,"r",(function(){return M})),i.d(e,"u",(function(){return C})),i.d(e,"v",(function(){return b})),i.d(e,"t",(function(){return P})),i.d(e,"n",(function(){return E}));const n="3.1.4",a="G-ESBTNJNZQ9",s=.001,o=4e4,r=.01,h=1500,l=45,c=45,d=0,u=12,p=1200,g=1900,m=7e3,f=[{x:-1e4,y:0,z:0},{x:-1e4,y:2e4,z:0},{x:1e4,y:2e4,z:0},{x:1e4,y:0,z:0}],y=[{x:1e4,y:0,z:0},{x:-1e4,y:0,z:0},{x:-1e4,y:0,z:1e4},{x:1e4,y:0,z:1e4}],v=3e4,x=10,T=15790320,M="jpeg",C="png",b=900,P=4,E=-1},function(t,e,i){"use strict";i.d(e,"a",(function(){return a}));var n=i(27);class a{constructor(){this.operationCompleted=new n.a}execute(t){this.command=t,this.canceled=!1,this.onStart()}end(t,e){this.onEnd((()=>{this.operationCompleted.notify({command:this.command,canceled:this.canceled,nextCommand:t,errorMsg:this.errorMsg,params:e})}))}cancel(){this.canceled=!0,this.end()}}},function(t,e,i){"use strict";i.d(e,"a",(function(){return a}));var n=i(1);class a{static getNormalAttibute(t){return t.getAttribute("normal")}static getPositionAttibute(t){return t.getAttribute("position")}static getUvAttibute(t){return t.getAttribute("uv")}static createCircleLineBufferGeometry(t){const e=new n.BufferGeometry,i=[];for(let e=0;e<=64;++e)i.push(Math.cos(e/32*Math.PI)*t,0,Math.sin(e/32*Math.PI)*t);return e.setAttribute("position",new n.Float32BufferAttribute(i,3)),e}static createEllipseLineBufferGeometry(t,e){const i=new n.EllipseCurve(0,0,e,t,0,2*Math.PI,!1,0).getPoints(150),a=(new n.BufferGeometry).setFromPoints(i);return a.rotateX(Math.PI/2),a}static computeOBB(t){const e=t.position.clone(),i=t.rotation.clone();t.position.set(0,0,0),t.rotation.set(0,0,0),t.updateMatrixWorld(!0);const a=(new n.Box3).setFromObject(t);return t.position.copy(e),t.rotation.copy(i),a}static disableTonemapping(t){t.fragmentShader=t.fragmentShader.replace("#include <tonemapping_fragment>","")}static getSelfOrAncestorObject3D(t,e){let i=null;return a.traverseSelfAndAncestors(t,(t=>{null==i&&e(t)&&(i=t)})),i}static traverseSelfAndAncestors(t,e){e(t),t.traverseAncestors(e)}static worldToViewportPosition(t,e,i,a,s){s=s||1;const o=new n.Matrix4;o.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse);const r=t.clone().applyMatrix4(o);return new n.Vector2((r.x+1)*i*s/2,(1-r.y)*a*s/2)}static viewportToPlaneWorldPosition(t,e,i,s,o,r){const h=(new n.Plane).setFromNormalAndCoplanarPoint(o,r);return a.getPlaneIntersection(h,t,e,i,s)}static createRaycaster(t,e,i,a,s){const o=new n.Raycaster,r=new n.Vector2(a/e*2-1,-s/i*2+1);return o.setFromCamera(r,t),o}static getPlaneIntersection(t,e,i,s,o){return a.createRaycaster(i,s,o,e.x,e.y).ray.intersectPlane(t,new n.Vector3)}static setObject3DTransform(t,e){const i=new n.Vector3,a=new n.Quaternion,s=new n.Vector3;e.decompose(i,a,s),t.position.copy(i),t.quaternion.copy(a),t.scale.copy(s)}static clearScene(t){for(let e=t.children.length-1;e>=0;e--){let i=t.children[e];t.remove(i),a.disposeObject3D(i,!0),i=null}}static disposeObject3D(t,e){for(let i=t.children.length-1;i>=0;i--){let n=t.children[i];t.remove(n),a.disposeObject3D(n,e),n=null}if(a.isMesh(t)){if(t.geometry&&t.geometry.dispose(),e&&t.material)if(Array.isArray(t.material)){for(const e of t.material)a.disposeMaterial(e);t.material=null}else a.disposeMaterial(t.material),t.material=null;t=null}}static isMesh(t){return t.isMesh}static isMeshBasicMaterial(t){return t.isMeshBasicMaterial}static isMeshStandardMaterial(t){return t.isMeshStandardMaterial}static isHemisphereLight(t){return t.isHemisphereLight}static isDirectionalLight(t){return t.isDirectionalLight}static isAmbientLight(t){return t.isAmbientLight}static isPointLight(t){return t.isPointLight}static isSpotLight(t){return t.isSpotLight}static isRectAreaLight(t){return t.isRectAreaLight}static isPerspectiveCamera(t){return t.isPerspectiveCamera}static isOrthographicCamera(t){return t.isOrthographicCamera}static isIBLStandardMaterial(t){return t.isIBLStandardMaterial}static isCTShaderMaterial(t){return t.isCTShaderMaterial}static disposeMaterial(t){if(a.isMeshBasicMaterial(t))t.alphaMap&&t.alphaMap.dispose(),t.aoMap&&t.aoMap.dispose(),t.map&&t.map.dispose(),t.specularMap&&t.specularMap.dispose(),t.lightMap&&t.lightMap.dispose();else if(a.isIBLStandardMaterial(t)||a.isCTShaderMaterial(t))t.alphaMap&&t.alphaMap.dispose(),t.aoMap&&t.aoMap.dispose(),t.bumpMap&&t.bumpMap.dispose(),t.displacementMap&&t.displacementMap.dispose(),t.emissiveMap&&t.emissiveMap.dispose(),t.lightMap&&t.lightMap.dispose(),t.map&&t.map.dispose(),t.metalnessMap&&t.metalnessMap.dispose(),t.normalMap&&t.normalMap.dispose(),t.roughnessMap&&t.roughnessMap.dispose(),t.shadingMap&&t.shadingMap.dispose();else if(a.isMeshStandardMaterial(t))t.alphaMap&&t.alphaMap.dispose(),t.aoMap&&t.aoMap.dispose(),t.bumpMap&&t.bumpMap.dispose(),t.displacementMap&&t.displacementMap.dispose(),t.emissiveMap&&t.emissiveMap.dispose(),t.lightMap&&t.lightMap.dispose(),t.map&&t.map.dispose(),t.metalnessMap&&t.metalnessMap.dispose(),t.normalMap&&t.normalMap.dispose(),t.roughnessMap&&t.roughnessMap.dispose();else if("ShaderMaterial"===t.type);else if("ShadowMaterial"===t.type);else if("LineMaterial"!==t.type)throw new Error(`Disposal of material type '${t.type}' is not supported`);t.dispose()}static isAnyLayerShared(t,e){return null!=t&&null!=e&&(t.layers.mask&e.layers.mask)>0}}},function(t,e,i){"use strict";i.d(e,"t",(function(){return g})),i.d(e,"p",(function(){return m})),i.d(e,"s",(function(){return f})),i.d(e,"f",(function(){return y})),i.d(e,"c",(function(){return v})),i.d(e,"b",(function(){return x})),i.d(e,"g",(function(){return T})),i.d(e,"u",(function(){return M})),i.d(e,"y",(function(){return b})),i.d(e,"x",(function(){return P})),i.d(e,"w",(function(){return E})),i.d(e,"v",(function(){return D})),i.d(e,"d",(function(){return w})),i.d(e,"j",(function(){return S})),i.d(e,"o",(function(){return I})),i.d(e,"h",(function(){return L})),i.d(e,"e",(function(){return A})),i.d(e,"q",(function(){return O})),i.d(e,"m",(function(){return R})),i.d(e,"n",(function(){return _})),i.d(e,"r",(function(){return k})),i.d(e,"k",(function(){return j})),i.d(e,"l",(function(){return N})),i.d(e,"A",(function(){return F})),i.d(e,"B",(function(){return z})),i.d(e,"i",(function(){return B})),i.d(e,"z",(function(){return H})),i.d(e,"a",(function(){return U}));var n=i(1),a=i(9),s=i(7),o=i(0),r=i(5),h=i(2),l=i(10),c=i(17),d=i(20),u=i(4);class p{static init(){const t=[1,0,0,2e-5,1,0,0,503905e-9,1,0,0,.00201562,1,0,0,.00453516,1,0,0,.00806253,1,0,0,.0125978,1,0,0,.018141,1,0,0,.0246924,1,0,0,.0322525,1,0,0,.0408213,1,0,0,.0503999,1,0,0,.0609894,1,0,0,.0725906,1,0,0,.0852058,1,0,0,.0988363,1,0,0,.113484,1,0,0,.129153,1,0,0,.145839,1,0,0,.163548,1,0,0,.182266,1,0,0,.201942,1,0,0,.222314,1,0,0,.241906,1,0,0,.262314,1,0,0,.285754,1,0,0,.310159,1,0,0,.335426,1,0,0,.361341,1,0,0,.387445,1,0,0,.412784,1,0,0,.438197,1,0,0,.466966,1,0,0,.49559,1,0,0,.523448,1,0,0,.549938,1,0,0,.57979,1,0,0,.608746,1,0,0,.636185,1,0,0,.664748,1,0,0,.69313,1,0,0,.71966,1,0,0,.747662,1,0,0,.774023,1,0,0,.799775,1,0,0,.825274,1,0,0,.849156,1,0,0,.873248,1,0,0,.89532,1,0,0,.917565,1,0,0,.937863,1,0,0,.958139,1,0,0,.976563,1,0,0,.994658,1,0,0,1.0112,1,0,0,1.02712,1,0,0,1.04189,1,0,0,1.05568,1,0,0,1.06877,1,0,0,1.08058,1,0,0,1.09194,1,0,0,1.10191,1,0,0,1.11161,1,0,0,1.1199,1,0,0,1.12813,.999547,-4.48815e-7,.0224417,199902e-10,.999495,-113079e-10,.0224406,503651e-9,.999496,-452317e-10,.0224406,.00201461,.999496,-101772e-9,.0224406,.00453287,.999495,-180928e-9,.0224406,.00805845,.999497,-282702e-9,.0224406,.0125914,.999496,-407096e-9,.0224406,.0181319,.999498,-554114e-9,.0224406,.02468,.999499,-723768e-9,.0224406,.0322363,.999495,-916058e-9,.0224405,.0408009,.999499,-.00113101,.0224408,.050375,.999494,-.00136863,.0224405,.0609586,.999489,-.00162896,.0224401,.0725537,.999489,-.00191201,.0224414,.0851619,.999498,-.00221787,.0224413,.0987867,.999492,-.00254642,.0224409,.113426,.999507,-.00289779,.0224417,.129088,.999494,-.0032716,.0224386,.145767,.999546,-.0036673,.0224424,.163472,.999543,-.00408166,.0224387,.182182,.999499,-.00450056,.0224338,.201843,.999503,-.00483661,.0224203,.222198,.999546,-.00452928,.022315,.241714,.999508,-.00587403,.0224329,.262184,.999509,-.00638806,.0224271,.285609,.999501,-.00691028,.0224166,.309998,.999539,-.00741979,.0223989,.335262,.999454,-.00786282,.0223675,.361154,.999529,-.00811928,.0222828,.387224,.999503,-.00799941,.0221063,.41252,.999561,-.00952753,.0223057,.438006,.999557,-.0099134,.0222065,.466735,.999541,-.0100935,.0220402,.495332,.999562,-.00996821,.0218067,.523197,.999556,-.0105031,.0217096,.550223,.999561,-.0114191,.0217215,.579498,.999588,-.0111818,.0213357,.608416,.999633,-.0107725,.0208689,.635965,.999527,-.0121671,.0210149,.664476,.999508,-.0116005,.020431,.692786,.999568,-.0115604,.0199791,.719709,.999671,-.0121117,.0197415,.74737,.999688,-.0110769,.0188846,.773692,.99962,-.0122368,.0188452,.799534,.999823,-.0110325,.0178001,.825046,.999599,-.0114923,.0174221,.849075,.999619,-.0105923,.0164345,.872999,.999613,-.0105988,.0158227,.895371,.99964,-.00979861,.0148131,.917364,.99977,-.00967238,.0140721,.938002,.999726,-.00869175,.0129543,.957917,.99973,-.00866872,.0122329,.976557,.999773,-.00731956,.0108958,.994459,.999811,-.00756027,.0102715,1.01118,.999862,-.00583732,.00878781,1.02701,.999835,-.00631438,.00827529,1.04186,.999871,-.00450785,.00674583,1.05569,.999867,-.00486079,.00621041,1.06861,.999939,-.00322072,.00478301,1.08064,.999918,-.00318199,.00406395,1.09181,1.00003,-.00193348,.00280682,1.10207,.999928,-.00153729,.00198741,1.11152,.999933,-623666e-9,917714e-9,1.12009,1,-102387e-11,9.07581e-7,1.12813,.997866,-8.96716e-7,.0448334,199584e-10,.997987,-225945e-10,.0448389,502891e-9,.997987,-903781e-10,.0448388,.00201156,.997985,-203351e-9,.0448388,.00452602,.997986,-361514e-9,.0448388,.00804629,.997987,-56487e-8,.0448389,.0125724,.997988,-813423e-9,.0448389,.0181045,.997984,-.00110718,.0448387,.0246427,.997985,-.00144616,.0448388,.0321875,.997987,-.00183038,.044839,.0407392,.997983,-.00225987,.0448387,.0502986,.997991,-.00273467,.0448389,.0608667,.997984,-.00325481,.0448384,.0724444,.998002,-.00382043,.044839,.0850348,.997997,-.00443145,.0448396,.0986372,.998007,-.00508796,.0448397,.113255,.998008,-.00578985,.04484,.128891,.998003,-.00653683,.0448384,.145548,.997983,-.00732713,.0448358,.163221,.997985,-.00815454,.0448358,.181899,.998005,-.00898985,.0448286,.201533,.998026,-.00964404,.0447934,.221821,.998055,-.00922677,.044611,.241282,.99804,-.0117361,.0448245,.261791,.998048,-.0127628,.0448159,.285181,.998088,-.0138055,.0447996,.30954,.998058,-.0148206,.0447669,.334751,.998099,-.0156998,.044697,.36061,.998116,-.0161976,.0445122,.386603,.998195,-.015945,.0441711,.411844,.998168,-.0183947,.0444255,.43773,.998184,-.0197913,.0443809,.466009,.998251,-.0201426,.0440689,.494574,.998305,-.0198847,.0435632,.522405,.998273,-.0210577,.043414,.549967,.998254,-.0227901,.0433943,.578655,.998349,-.0223108,.0426529,.60758,.99843,-.0223088,.042,.635524,.998373,-.0241141,.0418987,.663621,.998425,-.0231446,.0408118,.691906,.998504,-.0233684,.0400565,.719339,.998443,-.0241652,.0394634,.74643,.99848,-.0228715,.0380002,.773086,.998569,-.023519,.0372322,.798988,.998619,-.0223108,.0356468,.824249,.998594,-.0223105,.034523,.848808,.998622,-.0213426,.0328887,.87227,.998669,-.0207912,.0314374,.895157,.998705,-.0198416,.0296925,.916769,.998786,-.0189168,.0279634,.937773,.998888,-.0178811,.0261597,.957431,.99906,-.0166845,.0242159,.976495,.999038,-.0155464,.0222638,.994169,.999237,-.0141349,.0201967,1.01112,.999378,-.0129324,.0181744,1.02692,.999433,-.0113192,.0159898,1.04174,.999439,-.0101244,.0140385,1.05559,.999614,-.00837456,.0117826,1.06852,.999722,-.00721769,.00983745,1.08069,.999817,-.00554067,.00769002,1.09176,.99983,-.00426961,.005782,1.10211,.999964,-.00273904,.00374503,1.11152,1.00001,-.00136739,.00187176,1.12031,.999946,393227e-10,-28919e-9,1.12804,.995847,-13435e-10,.0671785,19916e-9,.995464,-338387e-10,.0671527,501622e-9,.99547,-135355e-9,.0671531,.00200649,.995471,-30455e-8,.0671532,.00451461,.99547,-541423e-9,.0671531,.008026,.995471,-84598e-8,.0671531,.0125407,.99547,-.00121823,.0671531,.0180589,.99547,-.00165817,.0671531,.0245806,.995463,-.00216583,.0671526,.0321062,.995468,-.00274127,.0671527,.0406366,.995474,-.00338447,.0671534,.0501717,.995473,-.00409554,.0671533,.0607131,.995478,-.00487451,.0671531,.0722618,.995476,-.00572148,.0671532,.0848191,.995477,-.00663658,.0671539,.0983882,.995498,-.00761986,.0671541,.112972,.995509,-.00867094,.0671542,.128568,.995509,-.00978951,.0671531,.145183,.995503,-.0109725,.0671491,.162808,.995501,-.012211,.0671465,.181441,.99553,-.0134565,.0671371,.201015,.99555,-.014391,.0670831,.221206,.99558,-.014351,.0668883,.240813,.995577,-.0173997,.0671055,.261257,.995602,-.0191111,.0671178,.284467,.995623,-.0206705,.0670946,.308765,.995658,-.022184,.0670472,.333905,.995705,-.0234832,.0669417,.359677,.995719,-.0241933,.0666714,.385554,.995786,-.0243539,.066266,.410951,.995887,-.0271866,.0664367,.437163,.995944,-.0296012,.0664931,.464842,.996004,-.0301045,.0660105,.49332,.996128,-.0298311,.0652694,.521131,.996253,-.0316426,.0650739,.549167,.996244,-.0339043,.0649433,.57737,.996309,-.033329,.0638926,.606073,.996417,-.0338935,.0630849,.634527,.996372,-.0353104,.0625083,.66256,.996542,-.0348942,.0611986,.690516,.996568,-.0351614,.060069,.718317,.996711,-.0354317,.0588522,.74528,.996671,-.0349513,.0571902,.772061,.996865,-.0345622,.0555321,.798089,.996802,-.0342566,.0537816,.823178,.996992,-.0330862,.0516095,.847949,.996944,-.0324666,.0495537,.871431,.997146,-.0309544,.0470302,.894357,.997189,-.0299372,.0446043,.916142,.997471,-.0281389,.0418812,.937193,.997515,-.0268702,.0391823,.957,.997812,-.0247166,.0361338,.975936,.998027,-.0233525,.0333945,.99391,.998233,-.0209839,.0301917,1.01075,.998481,-.0194309,.027271,1.02669,.998859,-.0169728,.0240162,1.04173,.99894,-.0152322,.0210517,1.05551,.999132,-.0127497,.0178632,1.06856,.999369,-.0108282,.014787,1.08054,.999549,-.00845886,.0116185,1.09185,.999805,-.0063937,.00867209,1.10207,.99985,-.00414582,.00566823,1.1117,.999912,-.00207443,.00277562,1.12022,1.00001,870226e-10,-53766e-9,1.12832,.991943,-178672e-11,.0893382,198384e-10,.991952,-450183e-10,.089339,499849e-9,.991956,-180074e-9,.0893394,.0019994,.991955,-405167e-9,.0893393,.00449867,.991953,-720298e-9,.0893391,.00799764,.991955,-.00112548,.0893393,.0124964,.991957,-.0016207,.0893395,.0179951,.991958,-.00220601,.0893396,.0244939,.991947,-.00288137,.0893385,.0319929,.991962,-.00364693,.0893399,.0404933,.991965,-.00450264,.0893399,.049995,.99198,-.00544862,.0893411,.0604995,.99197,-.00648491,.0893397,.0720074,.991976,-.00761164,.089341,.0845207,.99198,-.00882891,.0893405,.0980413,.991982,-.0101367,.0893396,.112571,.992008,-.011535,.0893415,.128115,.992026,-.0130228,.0893414,.144672,.992064,-.0145966,.0893418,.162241,.992041,-.0162421,.0893359,.180801,.992086,-.0178888,.0893214,.200302,.992157,-.0190368,.0892401,.220332,.992181,-.0195584,.0890525,.240144,.992175,-.0227257,.0892153,.260728,.99221,-.0254195,.089304,.283473,.99222,-.0274883,.0892703,.307673,.992317,-.0294905,.0892027,.332729,.992374,-.0311861,.0890577,.358387,.992505,-.0320656,.0886994,.384102,.992568,-.0329715,.0883198,.409767,.992675,-.036006,.0883602,.436145,.992746,-.0392897,.0884591,.463217,.992873,-.0399337,.0878287,.491557,.992934,-.040231,.0870108,.519516,.993091,-.0422013,.0865857,.547741,.993259,-.0443503,.0861937,.575792,.993455,-.0446368,.0851187,.604233,.993497,-.0454299,.0840576,.632925,.993694,-.0463296,.0829671,.660985,.993718,-.0470619,.0817185,.688714,.993973,-.0468838,.0800294,.716743,.994207,-.046705,.0781286,.74377,.994168,-.0469698,.0763337,.77042,.9945,-.0456816,.0738184,.796659,.994356,-.0455518,.0715545,.821868,.994747,-.0439488,.0686085,.846572,.994937,-.0430056,.065869,.870435,.995142,-.0413414,.0626446,.893272,.995451,-.0396521,.05929,.915376,.995445,-.0378453,.0558503,.936196,.995967,-.0355219,.0520949,.956376,.996094,-.0335146,.048377,.975327,.996622,-.030682,.0442575,.993471,.996938,-.0285504,.0404693,1.01052,.997383,-.0253399,.0360903,1.02637,.997714,-.0231651,.0322176,1.04139,.998249,-.0198138,.0278433,1.05542,.998596,-.0174337,.0238759,1.06846,.998946,-.0141349,.0195944,1.08056,.99928,-.0115603,.0156279,1.09181,.999507,-.00839065,.0114607,1.10213,.999697,-.005666,.00763325,1.11169,.999869,-.00269902,.00364946,1.12042,1.00001,623836e-10,-319288e-10,1.12832,.987221,-222675e-11,.111332,197456e-10,.98739,-561116e-10,.111351,497563e-9,.987448,-224453e-9,.111357,.00199031,.987441,-505019e-9,.111357,.0044782,.987442,-897816e-9,.111357,.00796129,.987442,-.00140284,.111357,.0124396,.987444,-.00202012,.111357,.0179132,.987442,-.00274964,.111357,.0243824,.987446,-.00359147,.111357,.0318474,.987435,-.00454562,.111356,.0403086,.987461,-.00561225,.111358,.0497678,.987458,-.00679125,.111358,.0602239,.987443,-.0080828,.111356,.0716792,.987476,-.0094872,.111358,.0841364,.98749,-.0110044,.111361,.097597,.987508,-.0126344,.111362,.112062,.987494,-.0143767,.111357,.127533,.987526,-.0162307,.111359,.144015,.987558,-.0181912,.111361,.161502,.987602,-.0202393,.111355,.179979,.987692,-.022273,.111346,.199386,.987702,-.0235306,.111215,.219183,.987789,-.0247628,.111061,.239202,.987776,-.0280668,.111171,.259957,.987856,-.0316751,.111327,.282198,.987912,-.0342468,.111282,.306294,.988,-.0367205,.111198,.331219,.988055,-.0387766,.110994,.356708,.988241,-.0397722,.110547,.382234,.988399,-.0416076,.110198,.408227,.988539,-.0448192,.110137,.434662,.988661,-.0483793,.110143,.461442,.988967,-.0495895,.109453,.489318,.989073,-.0506797,.108628,.517516,.989274,-.0526953,.108003,.545844,.989528,-.054578,.107255,.573823,.989709,-.0561503,.106294,.601944,.989991,-.056866,.104896,.630855,.990392,-.0572914,.103336,.658925,.990374,-.0586224,.10189,.686661,.990747,-.0584764,.099783,.714548,.991041,-.0582662,.0974309,.74186,.991236,-.0584118,.0951678,.768422,.991585,-.0573055,.0921581,.794817,.991984,-.0564241,.0891167,.820336,.9921,-.0553608,.085805,.84493,.992749,-.0533816,.0820354,.868961,.99288,-.0518661,.0782181,.891931,.993511,-.0492492,.0738935,.914186,.993617,-.0471956,.0696402,.93532,.99411,-.044216,.0649659,.95543,.994595,-.0416654,.0603177,.974685,.994976,-.0384314,.0553493,.992807,.995579,-.0353491,.0503942,1.00996,.996069,-.0319787,.0452123,1.02606,.996718,-.028472,.0400112,1.04114,.997173,-.0250789,.0349456,1.05517,.997818,-.0213326,.029653,1.0683,.998318,-.0178509,.024549,1.0805,.998853,-.0141118,.0194197,1.09177,.999218,-.0105914,.0143869,1.1022,.999594,-.00693474,.00943517,1.11175,.99975,-.00340478,.00464051,1.12056,1.00001,109172e-9,-112821e-9,1.12853,.983383,-266524e-11,.133358,196534e-10,.981942,-671009e-10,.133162,494804e-9,.981946,-268405e-9,.133163,.00197923,.981944,-603912e-9,.133163,.00445326,.981941,-.00107362,.133162,.00791693,.981946,-.00167755,.133163,.0123703,.981944,-.00241569,.133162,.0178135,.981945,-.00328807,.133163,.0242466,.981945,-.00429472,.133162,.03167,.981955,-.00543573,.133164,.0400846,.981951,-.00671105,.133163,.0494901,.981968,-.00812092,.133165,.0598886,.981979,-.00966541,.133166,.0712811,.981996,-.0113446,.133168,.083669,.982014,-.0131585,.133169,.0970533,.982011,-.0151073,.133167,.111438,.982062,-.0171906,.133172,.126826,.9821,-.0194067,.133175,.143215,.982149,-.0217502,.133176,.160609,.982163,-.0241945,.133173,.178981,.982247,-.0265907,.133148,.198249,.982291,-.027916,.132974,.217795,.982396,-.0299663,.132868,.238042,.982456,-.0334544,.132934,.258901,.982499,-.0378636,.133137,.280639,.982617,-.0409274,.133085,.304604,.98274,-.0438523,.132985,.329376,.982944,-.0462288,.132728,.354697,.98308,-.0475995,.132228,.380102,.983391,-.0501901,.131924,.406256,.983514,-.0535899,.131737,.432735,.98373,-.0571858,.131567,.459359,.984056,-.0592353,.130932,.486637,.984234,-.0610488,.130092,.51509,.984748,-.0630758,.12923,.543461,.985073,-.0647398,.128174,.571376,.985195,-.0671941,.127133,.599414,.985734,-.0681345,.125576,.628134,.986241,-.0686089,.123639,.656399,.986356,-.0698511,.121834,.684258,.986894,-.0700931,.119454,.711818,.987382,-.0698321,.116718,.739511,.988109,-.0693975,.113699,.766267,.988363,-.0689584,.110454,.792456,.989112,-.0672353,.106602,.81813,.989241,-.0662034,.10267,.842889,.990333,-.0638938,.0981381,.867204,.990591,-.0618534,.0935388,.89038,.991106,-.0593117,.088553,.912576,.991919,-.0562676,.0832187,.934118,.992111,-.0534085,.0778302,.954254,.992997,-.0495459,.0720453,.973722,.993317,-.0463707,.0663458,.991949,.994133,-.0421245,.0601883,1.00936,.994705,-.0384977,.0542501,1.02559,.995495,-.0340956,.0479862,1.04083,.996206,-.030105,.041887,1.05497,.996971,-.0256095,.0355355,1.06824,.997796,-.0213932,.0293655,1.08056,.998272,-.0169612,.0232926,1.09182,.998857,-.0126756,.0172786,1.10219,.99939,-.00832486,.0113156,1.11192,.999752,-.00410826,.00557892,1.12075,1,150957e-9,-119101e-9,1.12885,.975169,-309397e-11,.154669,195073e-10,.975439,-779608e-10,.154712,491534e-9,.975464,-311847e-9,.154716,.00196617,.975464,-701656e-9,.154716,.00442387,.975462,-.0012474,.154715,.0078647,.975461,-.00194906,.154715,.0122886,.975464,-.00280667,.154715,.0176959,.975468,-.00382025,.154716,.0240867,.975471,-.00498985,.154716,.0314612,.975472,-.00631541,.154717,.0398199,.975486,-.00779719,.154718,.0491639,.975489,-.00943505,.154718,.0594932,.975509,-.0112295,.154721,.0708113,.97554,-.0131802,.154724,.0831176,.975557,-.0152876,.154726,.096415,.975585,-.0175512,.154728,.110705,.975605,-.0199713,.154729,.125992,.975645,-.0225447,.154729,.142272,.975711,-.0252649,.154735,.159549,.975788,-.0280986,.154736,.177805,.975872,-.0308232,.154704,.196911,.975968,-.0324841,.154525,.216324,.976063,-.0351281,.154432,.236628,.976157,-.0388618,.15446,.257539,.976204,-.0437704,.154665,.278975,.976358,-.047514,.154652,.302606,.976571,-.0508638,.154535,.327204,.976725,-.0534995,.154221,.352276,.977013,-.0555547,.153737,.377696,.977294,-.0586728,.153403,.403855,.977602,-.0622715,.15312,.430333,.977932,-.0658166,.152755,.456855,.978241,-.0689877,.152233,.483668,.978602,-.0712805,.15132,.512097,.979234,-.0732775,.150235,.540455,.97977,-.075163,.148978,.568486,.979995,-.0778026,.147755,.596524,.98078,-.0791854,.146019,.624825,.981628,-.0799666,.143906,.653403,.982067,-.0808532,.141561,.681445,.98271,-.0816024,.139025,.708918,.983734,-.0812511,.135764,.736594,.98431,-.0806201,.132152,.763576,.985071,-.0801605,.12846,.789797,.98618,-.0784208,.124084,.815804,.986886,-.0766643,.1193,.840869,.987485,-.0747744,.114236,.864952,.988431,-.0716701,.108654,.888431,.988886,-.0691609,.102994,.910963,.990024,-.0654048,.0967278,.932629,.990401,-.0619765,.090384,.95313,.991093,-.0579296,.0837885,.972587,.992018,-.0536576,.0770171,.991184,.992536,-.0493719,.0701486,1.00863,.993421,-.0444813,.062953,1.02494,.993928,-.040008,.0560455,1.04017,.994994,-.0347982,.04856,1.05463,.995866,-.0301017,.0416152,1.06807,.996916,-.0248225,.0342597,1.08039,.997766,-.0199229,.0271668,1.09177,.998479,-.0147422,.0201387,1.10235,.99921,-.00980173,.0131944,1.11206,.999652,-.0047426,.00640712,1.12104,.999998,891673e-10,-10379e-8,1.12906,.967868,-351885e-11,.175947,193569e-10,.968001,-886733e-10,.175972,487782e-9,.96801,-354697e-9,.175973,.00195115,.968012,-798063e-9,.175974,.00439006,.968011,-.00141879,.175973,.00780461,.968011,-.00221686,.175973,.0121948,.968016,-.00319231,.175974,.0175607,.968019,-.00434515,.175974,.0239027,.968018,-.00567538,.175974,.0312208,.968033,-.00718308,.175977,.0395158,.968049,-.00886836,.175979,.0487885,.968047,-.0107312,.175978,.0590394,.968072,-.0127719,.175981,.0702705,.968108,-.0149905,.175986,.0824836,.968112,-.0173866,.175985,.0956783,.968173,-.0199611,.175993,.109862,.96827,-.0227128,.176008,.125033,.968292,-.025639,.17601,.141193,.968339,-.0287299,.176007,.158336,.968389,-.0319399,.176001,.176441,.968501,-.034941,.175962,.195359,.968646,-.0370812,.175793,.214686,.968789,-.0402329,.175708,.234973,.96886,-.0442601,.1757,.255871,.969013,-.049398,.175876,.277238,.969242,-.0539932,.17594,.300326,.969419,-.0577299,.175781,.324702,.969763,-.0605643,.175432,.349527,.970093,-.0634488,.174992,.374976,.970361,-.0670589,.174611,.401097,.970825,-.0708246,.174226,.427496,.971214,-.0742871,.173684,.453858,.971622,-.0782608,.173186,.480637,.972175,-.0813151,.172288,.508655,.972944,-.0832678,.170979,.536973,.973595,-.0855964,.169573,.565138,.974345,-.0882163,.168152,.593222,.975233,-.0901671,.166314,.621201,.976239,-.0912111,.163931,.649919,.977289,-.0916959,.161106,.678011,.978076,-.0927061,.158272,.705717,.979533,-.0925562,.15475,.733228,.980335,-.0918159,.150638,.760454,.981808,-.0908508,.146201,.786918,.983061,-.0896172,.141386,.812953,.984148,-.0871588,.135837,.838281,.985047,-.0850624,.130135,.862594,.986219,-.0818541,.123882,.88633,.987043,-.0784523,.117126,.908952,.988107,-.0749601,.110341,.930744,.988955,-.0703548,.102885,.951728,.989426,-.0662798,.0954167,.971166,.990421,-.0610834,.0876331,.989984,.991032,-.0562936,.0797785,1.00765,.992041,-.0508154,.0718166,1.02434,.992794,-.0454045,.0637125,1.03976,.993691,-.0398194,.0555338,1.05418,.994778,-.0341482,.0473388,1.06772,.995915,-.028428,.0391016,1.08028,.997109,-.022642,.0309953,1.09185,.998095,-.0168738,.0230288,1.10247,.998985,-.0111274,.0150722,1.11229,.999581,-.00543881,.00740605,1.12131,1.00003,162239e-9,-105549e-9,1.12946,.959505,-393734e-11,.196876,191893e-10,.959599,-992157e-10,.196895,483544e-9,.959641,-396868e-9,.196903,.0019342,.959599,-892948e-9,.196895,.00435193,.959603,-.00158747,.196896,.0077368,.959604,-.00248042,.196896,.0120888,.959605,-.00357184,.196896,.0174082,.959605,-.00486169,.196896,.0236949,.959613,-.00635008,.196897,.0309497,.959619,-.00803696,.196898,.0391725,.959636,-.00992255,.196901,.0483649,.959634,-.0120067,.1969,.0585266,.959675,-.0142898,.196906,.0696609,.959712,-.0167717,.196911,.0817678,.959752,-.0194524,.196918,.0948494,.959807,-.0223321,.196925,.10891,.959828,-.0254091,.196924,.123947,.959906,-.0286815,.196934,.139968,.960005,-.0321371,.196944,.156968,.960071,-.0357114,.196936,.17491,.960237,-.0389064,.196882,.193597,.960367,-.041623,.196731,.21285,.960562,-.0452655,.196654,.233075,.960735,-.0496207,.196643,.253941,.960913,-.0549379,.196774,.275278,.961121,-.0603414,.196893,.297733,.96139,-.0644244,.196717,.321877,.961818,-.067556,.196314,.346476,.962175,-.0712709,.195917,.371907,.96255,-.0752848,.1955,.397916,.963164,-.0792073,.195026,.424229,.963782,-.0828225,.194424,.450637,.964306,-.0873119,.193831,.477288,.964923,-.0911051,.192973,.504716,.966048,-.093251,.19151,.533053,.967024,-.0958983,.190013,.561366,.968038,-.09835,.188253,.589464,.969152,-.100754,.186257,.617433,.970557,-.102239,.183775,.645801,.972104,-.102767,.180645,.674278,.973203,-.103492,.177242,.702004,.975123,-.103793,.17345,.729529,.97641,-.102839,.168886,.756712,.978313,-.101687,.163892,.783801,.980036,-.100314,.158439,.809671,.981339,-.097836,.152211,.835402,.982794,-.0950006,.145679,.860081,.984123,-.0920994,.138949,.883757,.984918,-.0878641,.131283,.90685,.985999,-.083939,.123464,.928786,.987151,-.0791234,.115324,.94983,.987827,-.0739332,.106854,.96962,.988806,-.0688088,.0982691,.98861,.989588,-.0628962,.0893456,1.00667,.990438,-.0573146,.0805392,1.02344,.991506,-.0509433,.0713725,1.03933,.992492,-.0448724,.0623732,1.05378,.993663,-.0383497,.0530838,1.06747,.994956,-.0319593,.0439512,1.08007,.99634,-.025401,.0347803,1.09182,.99761,-.0189687,.0257954,1.1025,.99863,-.0124441,.0169893,1.11247,.99947,-.00614003,.00829498,1.12151,1.00008,216624e-9,-146107e-9,1.12993,.950129,-434955e-11,.217413,190081e-10,.950264,-10957e-8,.217444,47884e-8,.9503,-438299e-9,.217451,.00191543,.950246,-986124e-9,.21744,.00430951,.950246,-.00175311,.21744,.00766137,.950245,-.00273923,.21744,.011971,.950253,-.00394453,.217441,.0172385,.950258,-.00536897,.217442,.0234641,.950267,-.00701262,.217444,.030648,.950277,-.00887551,.217446,.038791,.950284,-.0109576,.217446,.0478931,.950312,-.0132591,.217451,.0579568,.950334,-.01578,.217454,.0689821,.950378,-.0185204,.217462,.0809714,.950417,-.0214803,.217467,.0939265,.950488,-.0246594,.217479,.10785,.950534,-.0280565,.217483,.122743,.950633,-.0316685,.217498,.138611,.950698,-.0354787,.217499,.155442,.950844,-.0394003,.217507,.173208,.950999,-.0426812,.217419,.191605,.951221,-.0461302,.217317,.21084,.951412,-.0502131,.217238,.230945,.951623,-.0549183,.21722,.251745,.951867,-.0604493,.217306,.273001,.952069,-.0665189,.217466,.294874,.952459,-.0709179,.217266,.318732,.952996,-.0746112,.216891,.34318,.953425,-.0789252,.216503,.36849,.953885,-.0833293,.216042,.394373,.954617,-.087371,.215469,.420505,.955429,-.0914054,.214802,.446907,.956068,-.0961671,.214146,.473522,.957094,-.10048,.213286,.50052,.958372,-.103248,.211796,.528715,.959654,-.106033,.21016,.557065,.961305,-.108384,.208149,.585286,.962785,-.111122,.206024,.613334,.964848,-.112981,.203442,.641334,.966498,-.113717,.19996,.669955,.968678,-.114121,.196105,.698094,.970489,-.114524,.191906,.725643,.972903,-.113792,.186963,.752856,.974701,-.112406,.181343,.780013,.976718,-.110685,.175185,.806268,.978905,-.108468,.168535,.832073,.980267,-.105061,.161106,.857149,.981967,-.101675,.153387,.881145,.983063,-.0974492,.145199,.904255,.984432,-.0925815,.136527,.926686,.985734,-.0877983,.127584,.947901,.986228,-.081884,.118125,.968111,.98719,-.0761208,.108594,.98719,.988228,-.0698196,.0989996,1.00559,.989046,-.0632739,.0890074,1.02246,.990242,-.056522,.0790832,1.03841,.991252,-.0495272,.0689182,1.05347,.992542,-.0425373,.0588592,1.06724,.994096,-.0353198,.0486833,1.08009,.995593,-.028235,.0385977,1.09177,.99711,-.0209511,.0286457,1.10274,.998263,-.0139289,.0188497,1.11262,.999254,-.0067359,.009208,1.12191,.999967,141846e-9,-657764e-10,1.13024,.935608,-474692e-11,.236466,187817e-10,.93996,-11971e-8,.237568,473646e-9,.939959,-478845e-9,.237567,.0018946,.939954,-.0010774,.237566,.00426284,.939956,-.00191538,.237566,.00757842,.939954,-.00299277,.237566,.0118413,.93996,-.00430961,.237567,.0170518,.939969,-.00586589,.237569,.02321,.939982,-.00766166,.237572,.0303164,.939987,-.00969686,.237572,.0383711,.939997,-.0119715,.237574,.0473751,.940031,-.0144858,.237581,.0573298,.940073,-.0172399,.237589,.0682366,.94012,-.0202335,.237598,.080097,.940162,-.0234663,.237604,.0929116,.940237,-.0269387,.237615,.106686,.940328,-.0306489,.237632,.121421,.940419,-.0345917,.237645,.137115,.940522,-.0387481,.237654,.153766,.940702,-.0429906,.237661,.17133,.940871,-.0465089,.237561,.189502,.941103,-.050531,.23748,.208616,.941369,-.0550657,.237423,.228595,.941641,-.0601337,.237399,.249287,.941903,-.0658804,.237443,.270467,.942224,-.0722674,.237597,.292024,.942633,-.0771788,.237419,.315272,.943172,-.0815623,.237068,.339579,.943691,-.0863973,.236682,.364717,.944382,-.0911536,.236213,.390435,.945392,-.0952967,.235562,.416425,.946185,-.0998948,.234832,.442772,.947212,-.104796,.234114,.469347,.948778,-.10928,.233222,.496162,.950149,-.113081,.231845,.523978,.951989,-.115893,.230005,.552295,.953921,-.11846,.227862,.580569,.955624,-.12115,.225439,.608698,.958234,-.123373,.222635,.636696,.960593,-.124519,.219093,.665208,.963201,-.124736,.214749,.693557,.965642,-.125012,.210059,.721334,.968765,-.124661,.204935,.748613,.971753,-.122996,.198661,.776224,.973751,-.120998,.191823,.802461,.976709,-.118583,.184359,.828399,.977956,-.115102,.176437,.853693,.979672,-.111077,.167681,.877962,.981816,-.10688,.158872,.901564,.98238,-.101469,.149398,.924057,.983964,-.0960013,.139436,.945751,.984933,-.0899626,.12943,.966272,.985694,-.0832973,.11894,.985741,.986822,-.0767082,.108349,1.00407,.987725,-.0693614,.0976026,1.02154,.98877,-.06211,.086652,1.03757,.990129,-.0544143,.0756182,1.05296,.991337,-.046744,.0645753,1.06683,.992978,-.0387931,.0534683,1.0798,.994676,-.030973,.0424137,1.09181,.99645,-.0230311,.0314035,1.10286,.997967,-.0152065,.0206869,1.11291,.99922,-.00744837,.010155,1.12237,1.00002,240209e-9,-752767e-10,1.13089,.922948,-515351e-11,.255626,186069e-10,.928785,-129623e-9,.257244,468009e-9,.928761,-51849e-8,.257237,.00187202,.928751,-.0011666,.257235,.00421204,.928751,-.00207395,.257234,.0074881,.928754,-.00324055,.257235,.0117002,.92876,-.00466639,.257236,.0168486,.928763,-.00635149,.257237,.0229334,.928774,-.00829584,.257239,.029955,.928791,-.0104995,.257243,.0379139,.928804,-.0129623,.257245,.0468108,.928847,-.0156846,.257255,.0566473,.92889,-.0186661,.257263,.0674246,.928924,-.0219067,.257268,.0791433,.928989,-.0254066,.257282,.0918076,.92909,-.0291651,.257301,.105419,.92918,-.0331801,.257316,.119978,.92929,-.0374469,.257332,.135491,.929453,-.041939,.257357,.151948,.929586,-.0464612,.257347,.169275,.929858,-.0503426,.257269,.187257,.930125,-.0548409,.257199,.206204,.930403,-.0598063,.257149,.22601,.930726,-.0652437,.257122,.246561,.931098,-.0712376,.257153,.267618,.931396,-.0777506,.257237,.288993,.931947,-.0832374,.257124,.311527,.932579,-.0883955,.25683,.335697,.933194,-.0937037,.256444,.360634,.934013,-.0987292,.255939,.386126,.935307,-.103215,.255282,.412018,.936374,-.108234,.254538,.438292,.93776,-.113234,.253728,.464805,.939599,-.118013,.25275,.491464,.941036,-.122661,.251404,.518751,.94337,-.125477,.249435,.547133,.945318,-.128374,.247113,.575456,.947995,-.130996,.244441,.60372,.950818,-.133438,.241352,.63174,.954378,-.135004,.237849,.659971,.957151,-.135313,.233188,.688478,.960743,-.13521,.228001,.716767,.964352,-.135007,.222249,.744349,.967273,-.133523,.21542,.771786,.969767,-.131155,.208039,.798639,.973195,-.128492,.200076,.824774,.975557,-.125094,.191451,.850222,.977692,-.120578,.18184,.874761,.98026,-.115882,.172102,.898497,.981394,-.110372,.161859,.921636,.982386,-.10415,.15108,.943467,.983783,-.0978128,.140407,.964045,.98422,-.0906171,.129058,.98398,.985447,-.0832921,.117614,1.00276,.986682,-.0754412,.10585,1.02047,.987326,-.0673885,.0940943,1.03678,.988707,-.0592565,.0822093,1.05218,.990185,-.050717,.070192,1.06652,.991866,-.0423486,.0582081,1.07965,.993897,-.0336118,.0460985,1.09188,.995841,-.0252178,.0342737,1.10307,.997605,-.0164893,.0224829,1.11324,.999037,-.00817112,.0110647,1.12262,1.00003,291686e-9,-168673e-9,1.13139,.915304,-552675e-11,.275999,183285e-10,.91668,-139285e-9,.276414,461914e-9,.916664,-55713e-8,.276409,.00184763,.916653,-.00125354,.276406,.00415715,.916651,-.00222851,.276405,.00739053,.916655,-.00348205,.276406,.0115478,.916653,-.00501414,.276405,.0166291,.916667,-.00682478,.276409,.0226346,.91668,-.00891398,.276412,.0295648,.91669,-.0112817,.276413,.0374199,.916727,-.013928,.276422,.0462016,.916759,-.0168528,.276429,.0559101,.916793,-.0200558,.276436,.0665466,.916849,-.0235373,.276448,.0781139,.916964,-.0272973,.276474,.0906156,.917047,-.0313344,.276491,.104051,.917152,-.0356465,.276511,.118424,.917286,-.0402271,.276533,.133736,.917469,-.0450408,.276564,.149978,.917686,-.0497872,.276563,.167057,.917953,-.0540937,.276493,.184846,.918228,-.0590709,.276437,.203614,.918572,-.0644277,.276398,.223212,.918918,-.0702326,.276362,.243584,.919356,-.076484,.276383,.264465,.919842,-.0830808,.276434,.285701,.920451,-.0892972,.276407,.307559,.921113,-.095016,.276128,.331501,.921881,-.100771,.275754,.356207,.923027,-.106029,.275254,.381477,.924364,-.111029,.274595,.40722,.925818,-.116345,.273841,.433385,.92746,-.121424,.272913,.459848,.929167,-.12657,.271837,.486493,.931426,-.131581,.270575,.513432,.934001,-.135038,.268512,.541502,.936296,-.138039,.266135,.569658,.939985,-.140687,.263271,.598375,.943516,-.143247,.260058,.626563,.94782,-.145135,.256138,.654711,.951023,-.145733,.251154,.683285,.955338,-.145554,.245562,.711831,.959629,-.145008,.239265,.739573,.963123,-.144003,.232064,.767027,.966742,-.141289,.224036,.794359,.969991,-.138247,.215305,.820361,.973403,-.134786,.206051,.846548,.975317,-.129966,.195914,.871541,.977647,-.12471,.185184,.895313,.980137,-.119086,.174161,.918398,.981031,-.112297,.162792,.940679,.982037,-.105372,.150952,.961991,.983164,-.097821,.138921,.981913,.983757,-.0897245,.126611,1.00109,.985036,-.0815974,.114228,1.01902,.986289,-.0727725,.101389,1.03604,.987329,-.0639323,.0886476,1.05149,.989193,-.0548109,.0756837,1.06619,.990716,-.045687,.0627581,1.07948,.992769,-.0364315,.0498337,1.09172,.99524,-.0271761,.0370305,1.1033,.997154,-.0179609,.0243959,1.11353,.998845,-.00878063,.0119567,1.12319,1.00002,259038e-9,-108146e-9,1.13177,.903945,-591681e-11,.295126,181226e-10,.903668,-148672e-9,.295037,455367e-9,.903677,-594683e-9,.29504,.00182145,.903673,-.00133805,.295039,.00409831,.903666,-.00237872,.295036,.00728584,.903668,-.00371676,.295037,.0113842,.903679,-.00535212,.29504,.0163936,.903684,-.00728479,.295041,.0223141,.903698,-.00951473,.295044,.0291462,.903718,-.0120419,.295049,.0368904,.903754,-.0148664,.295058,.0455477,.903801,-.017988,.29507,.0551194,.903851,-.0214064,.295082,.0656058,.903921,-.0251219,.295097,.0770109,.904002,-.0291337,.295116,.0893354,.904111,-.033441,.29514,.102583,.904246,-.0380415,.295169,.116755,.904408,-.0429258,.295202,.131853,.904637,-.0480468,.295245,.147869,.904821,-.0529208,.295214,.164658,.905163,-.0577748,.295185,.182274,.905469,-.0631763,.295143,.200828,.905851,-.068917,.295112,.2202,.906322,-.0750861,.295104,.240372,.906761,-.0815855,.295086,.261082,.90735,-.0882138,.295095,.282123,.908087,-.095082,.295139,.303563,.908826,-.101488,.29492,.327028,.909832,-.107577,.294577,.351464,.911393,-.113033,.294115,.376497,.912804,-.118629,.293446,.402115,.914081,-.124232,.292581,.428111,.91637,-.129399,.29166,.454442,.91814,-.134892,.290422,.481024,.921179,-.140069,.289194,.507924,.924544,-.144431,.287421,.535557,.927995,-.147498,.284867,.563984,.931556,-.150197,.281722,.5923,.935777,-.152711,.278207,.620832,.940869,-.154836,.274148,.649069,.945994,-.155912,.269057,.677746,.949634,-.155641,.262799,.706293,.955032,-.154809,.256097,.734278,.95917,-.153678,.248618,.761751,.962931,-.151253,.239794,.789032,.966045,-.147625,.230281,.815422,.96971,-.143964,.220382,.841787,.972747,-.139464,.209846,.867446,.975545,-.133459,.198189,.892004,.978381,-.127424,.186362,.915458,.979935,-.120506,.173964,.937948,.980948,-.11282,.161429,.959732,.982234,-.104941,.148557,.980118,.982767,-.0962905,.135508,.999463,.983544,-.0873625,.122338,1.01756,.984965,-.0783447,.108669,1.03492,.986233,-.0684798,.0949911,1.05087,.987796,-.0590867,.0811386,1.0656,.989885,-.0489145,.0673099,1.0794,.991821,-.0391,.0535665,1.09174,.99448,-.029087,.0397529,1.10341,.996769,-.019114,.0261463,1.11383,.998641,-.00947007,.0128731,1.1237,.999978,446316e-9,-169093e-9,1.13253,.888362,-627064e-11,.312578,178215e-10,.889988,-157791e-9,.313148,448451e-9,.889825,-631076e-9,.313092,.00179356,.88984,-.00141994,.313097,.00403554,.889828,-.0025243,.313092,.00717429,.889831,-.00394421,.313093,.0112099,.889831,-.00567962,.313093,.0161425,.889844,-.00773051,.313096,.0219724,.889858,-.0100968,.3131,.0286999,.889882,-.0127786,.313106,.0363256,.889918,-.0157757,.313116,.0448509,.889967,-.0190878,.313129,.0542758,.89003,-.022715,.313145,.0646032,.890108,-.0266566,.313165,.0758339,.890218,-.0309131,.313193,.0879729,.890351,-.0354819,.313226,.101019,.89051,-.0403613,.313263,.114979,.890672,-.0455385,.313294,.129848,.890882,-.0509444,.313333,.145616,.891189,-.0559657,.313324,.162122,.891457,-.0613123,.313281,.179524,.891856,-.0671488,.313281,.197855,.892312,-.0732732,.313268,.216991,.892819,-.0797865,.313263,.236924,.893369,-.0865269,.313247,.257433,.894045,-.0931592,.313205,.278215,.894884,-.100532,.313276,.299467,.895832,-.107716,.313205,.322276,.897043,-.114099,.312873,.34642,.898515,-.119941,.312331,.371187,.900191,-.126044,.311731,.396656,.90188,-.131808,.310859,.422488,.904359,-.137289,.309857,.448744,.906923,-.142991,.308714,.475239,.910634,-.148253,.307465,.501983,.914502,-.153332,.305774,.529254,.919046,-.156646,.303156,.557709,.923194,-.159612,.299928,.586267,.928858,-.162027,.296245,.614925,.934464,-.164203,.291832,.643187,.939824,-.165602,.286565,.671601,.944582,-.165383,.280073,.700213,.949257,-.164439,.272891,.728432,.954389,-.162953,.264771,.756082,.958595,-.161007,.255927,.78369,.962138,-.157243,.245769,.810769,.966979,-.152872,.235127,.836999,.969566,-.148209,.22347,.862684,.972372,-.142211,.211147,.887847,.975916,-.135458,.198606,.911843,.978026,-.128398,.185498,.934795,.979686,-.120313,.17171,.956787,.980748,-.11166,.158159,.978046,.981622,-.103035,.144399,.997693,.982356,-.0930328,.13001,1.01642,.983308,-.0834627,.115778,1.03366,.985037,-.0732249,.101327,1.05014,.986493,-.0628145,.086554,1.06507,.988484,-.0526556,.0720413,1.07907,.991051,-.0415744,.0571151,1.09189,.993523,-.0314275,.0426643,1.10369,.99628,-.0203603,.0279325,1.11423,.998344,-.0102446,.0138182,1.12421,.999997,42612e-8,-193628e-9,1.1333,.871555,-660007e-11,.329176,174749e-10,.875255,-166579e-9,.330571,441051e-9,.875644,-666394e-9,.330718,.00176441,.875159,-.00149903,.330536,.00396899,.87516,-.00266493,.330536,.007056,.875158,-.00416393,.330535,.0110251,.87516,-.00599598,.330535,.0158764,.875163,-.00816108,.330536,.0216101,.875174,-.0106591,.330538,.0282266,.875199,-.0134899,.330545,.0357266,.875257,-.0166538,.330563,.0441117,.875304,-.0201501,.330575,.0533821,.875373,-.0239785,.330595,.0635395,.875464,-.0281389,.330619,.0745872,.875565,-.0326301,.330645,.0865255,.875691,-.0374516,.330676,.0993599,.875897,-.0425993,.330733,.113093,.876091,-.0480576,.330776,.127722,.876353,-.0537216,.330826,.143227,.876649,-.0589807,.330809,.159462,.877034,-.0647865,.330819,.176642,.877443,-.0709789,.330817,.194702,.877956,-.0774782,.330832,.213577,.878499,-.0843175,.330822,.233246,.879144,-.0912714,.330804,.253512,.879982,-.0980824,.330766,.274137,.88097,-.105823,.330864,.295209,.882051,-.113671,.330896,.317226,.883397,-.120303,.330545,.341068,.884987,-.12667,.330068,.365613,.886789,-.133118,.329418,.390807,.889311,-.139024,.328683,.416494,.891995,-.144971,.327729,.442618,.895106,-.150747,.326521,.469131,.899527,-.156283,.325229,.495921,.90504,-.161707,.32378,.523162,.909875,-.165661,.32122,.55092,.91561,-.168755,.317942,.579928,.921225,-.171193,.313983,.608539,.927308,-.17319,.309636,.636854,.933077,-.174819,.304262,.66523,.938766,-.175002,.297563,.693609,.943667,-.173946,.289613,.722157,.949033,-.172221,.281227,.750021,.953765,-.169869,.271545,.777466,.95804,-.166578,.261034,.804853,.962302,-.161761,.249434,.831569,.966544,-.156636,.237484,.857779,.969372,-.150784,.224395,.883051,.972486,-.143672,.210786,.907864,.975853,-.135772,.196556,.931223,.977975,-.127942,.182307,.954061,.979122,-.118347,.167607,.97531,.980719,-.109112,.152739,.995666,.981223,-.0991789,.137932,1.01475,.98216,-.0883553,.122692,1.03253,.983379,-.0780825,.107493,1.04917,.985434,-.0665646,.0917791,1.06464,.987332,-.0557714,.0764949,1.07896,.990004,-.0442805,.060721,1.09199,.992975,-.0331676,.0452284,1.10393,.995811,-.0219547,.0297934,1.11476,.9982,-.0107613,.0146415,1.12484,1.00002,248678e-9,-14555e-8,1.13413,.859519,-693595e-11,.347264,171673e-10,.859843,-17503e-8,.347394,433219e-9,.859656,-700076e-9,.347319,.00173277,.859671,-.00157517,.347325,.00389875,.859669,-.00280028,.347324,.00693112,.85967,-.0043754,.347324,.01083,.859665,-.00630049,.347321,.0155954,.859685,-.0085755,.347328,.0212278,.859694,-.0112003,.347329,.0277273,.859718,-.0141747,.347336,.0350946,.85976,-.0174988,.347348,.0433314,.85982,-.0211722,.347366,.0524384,.859892,-.0251941,.347387,.0624168,.860006,-.0295649,.347422,.0732708,.860122,-.0342825,.347453,.0849999,.860282,-.0393462,.347499,.0976102,.860482,-.0447513,.347554,.111104,.860719,-.0504775,.347614,.125479,.860998,-.0563577,.347666,.140703,.861322,-.0619473,.347662,.156681,.861724,-.0681277,.347684,.173597,.862198,-.0746567,.347709,.191371,.862733,-.0815234,.347727,.209976,.863371,-.0886643,.347744,.229351,.86414,-.0957908,.347734,.24934,.865138,-.102912,.34772,.269797,.866182,-.110924,.3478,.290654,.867436,-.119223,.347911,.312074,.869087,-.126197,.347649,.335438,.870859,-.133145,.347222,.359732,.872997,-.139869,.346645,.38467,.875939,-.146089,.345935,.41019,.879012,-.152334,.345012,.436218,.883353,-.15821,.343924,.462641,.888362,-.164097,.342636,.489449,.895026,-.169528,.341351,.516629,.900753,-.174408,.339115,.544109,.906814,-.17751,.335809,.572857,.912855,-.180101,.331597,.601554,.919438,-.182116,.32698,.630198,.925962,-.183494,.321449,.658404,.931734,-.184159,.314595,.686625,.93762,-.18304,.306462,.71531,.943858,-.181323,.297514,.744272,.948662,-.178683,.287447,.771462,.953299,-.175379,.276166,.798593,.957346,-.170395,.263758,.8256,.962565,-.165042,.251019,.852575,.966075,-.158655,.237011,.878316,.969048,-.151707,.222518,.90329,.972423,-.143271,.207848,.927745,.975833,-.134824,.192463,.950859,.977629,-.125444,.1768,.972947,.978995,-.114949,.161033,.993263,.980533,-.104936,.145523,1.01337,.980745,-.0935577,.129799,1.03128,.981814,-.0822956,.113486,1.04825,.983943,-.0710082,.0972925,1.06405,.986141,-.0587931,.0808138,1.0785,.988878,-.0472755,.0644915,1.09204,.992132,-.0349128,.0478128,1.10413,.9953,-.0232407,.031621,1.11527,.998117,-.0112713,.0154935,1.12551,1.00003,339743e-9,-195763e-9,1.13504,.845441,-729126e-11,.364305,169208e-10,.843588,-183164e-9,.363506,425067e-9,.843412,-73253e-8,.36343,.00169999,.843401,-.00164818,.363426,.00382495,.843399,-.00293008,.363425,.00679993,.843401,-.00457822,.363425,.010625,.843394,-.00659249,.363421,.0153002,.843398,-.00897282,.363421,.0208258,.843415,-.0117191,.363426,.0272024,.843438,-.0148312,.363432,.0344305,.843483,-.018309,.363447,.0425116,.84356,-.0221521,.363472,.0514471,.843646,-.0263597,.363499,.061238,.843743,-.0309315,.363527,.0718873,.84388,-.0358658,.363569,.0833969,.844079,-.0411624,.363631,.0957742,.844279,-.0468128,.363688,.109015,.844549,-.0527923,.363761,.123124,.844858,-.0588204,.363817,.138044,.84522,-.0647573,.36383,.153755,.845669,-.0713181,.363879,.170394,.846155,-.0781697,.363908,.187861,.846789,-.0853913,.363969,.206176,.847502,-.0928086,.363999,.225244,.8484,-.10005,.363997,.244926,.849461,-.107615,.364008,.265188,.850562,-.115814,.364055,.28587,.851962,-.124334,.364179,.306926,.854326,-.131995,.364233,.329605,.856295,-.139338,.363856,.35359,.858857,-.146346,.363347,.37831,.862428,-.152994,.362807,.403722,.866203,-.159463,.361963,.429537,.871629,-.165623,.36112,.456,.877365,-.171649,.359917,.482773,.883744,-.177151,.35848,.509705,.890693,-.182381,.356523,.537215,.897278,-.186076,.3533,.565493,.903958,-.188602,.349095,.594293,.910908,-.190755,.344215,.623165,.918117,-.192063,.338606,.651573,.924644,-.192758,.331544,.679869,.931054,-.192238,.323163,.708668,.937303,-.190035,.313529,.737201,.943387,-.187162,.303152,.764977,.948494,-.183876,.29146,.792683,.952546,-.178901,.277917,.819228,.958077,-.173173,.264753,.846559,.962462,-.16645,.25002,.872962,.966569,-.159452,.234873,.898729,.969108,-.15074,.218752,.923126,.973072,-.141523,.202673,.947278,.975452,-.132075,.186326,.969938,.977784,-.121257,.169396,.991325,.97899,-.110182,.153044,1.01123,.979777,-.0989634,.136485,1.0299,.980865,-.0865894,.119343,1.04727,.982432,-.0746115,.102452,1.06341,.984935,-.0621822,.0852423,1.07834,.987776,-.0495694,.0678546,1.092,.99103,-.0372386,.0506917,1.1043,.99474,-.0244353,.0333316,1.11576,.997768,-.0121448,.0164348,1.12617,1.00003,31774e-8,-169504e-9,1.13598,.825551,-756799e-11,.378425,165099e-10,.82664,-190922e-9,.378923,416504e-9,.826323,-763495e-9,.378779,.0016656,.826359,-.00171789,.378795,.00374768,.82636,-.00305402,.378795,.00666259,.826368,-.00477185,.378798,.0104104,.826364,-.00687131,.378795,.0149912,.826368,-.00935232,.378795,.0204054,.826376,-.0122146,.378797,.0266532,.826399,-.0154581,.378803,.0337355,.82646,-.0190825,.378824,.0416537,.826525,-.0230873,.378846,.0504091,.826614,-.0274719,.378876,.0600032,.82674,-.0322355,.378917,.0704393,.826888,-.0373766,.378964,.0817195,.827078,-.0428936,.379024,.0938492,.827318,-.0487778,.379099,.106828,.82764,-.0549935,.379199,.120659,.827926,-.0611058,.379227,.13526,.828325,-.0675054,.379275,.150713,.828801,-.0743455,.379332,.167034,.8294,-.0815523,.379415,.184209,.830094,-.0890779,.379495,.202203,.8309,-.096736,.379555,.220945,.831943,-.104135,.379577,.240306,.833037,-.112106,.379604,.260317,.834278,-.120554,.379668,.2808,.836192,-.129128,.3799,.301654,.838671,-.137541,.380109,.323502,.840939,-.14523,.379809,.347176,.844575,-.15248,.379593,.371706,.848379,-.159607,.37909,.39688,.853616,-.166267,.378617,.422702,.858921,-.172698,.377746,.448919,.865324,-.178823,.376749,.475661,.872207,-.184542,.375363,.502599,.880018,-.189836,.373657,.529914,.88694,-.194294,.370673,.557683,.894779,-.197022,.36662,.586848,.902242,-.199108,.36138,.615831,.909914,-.200398,.355434,.644478,.917088,-.20094,.348173,.672905,.923888,-.200671,.339482,.701327,.930495,-.198773,.32956,.730101,.937247,-.195394,.318363,.758383,.943108,-.191956,.306323,.786539,.948296,-.187227,.292576,.813637,.953472,-.181165,.278234,.840793,.958485,-.174119,.263054,.867712,.962714,-.166564,.246756,.893635,.966185,-.158181,.229945,.919028,.970146,-.148275,.212633,.943413,.973491,-.138157,.195229,.966627,.975741,-.127574,.178048,.988817,.977238,-.11554,.160312,1.00924,.978411,-.10364,.142857,1.02845,.979811,-.0913122,.125317,1.04648,.98116,-.0782558,.107627,1.06284,.983543,-.0655957,.0895862,1.07798,.986789,-.0520411,.0713756,1.092,.990292,-.0389727,.053228,1.10484,.994187,-.025808,.0351945,1.11642,.997499,-.0126071,.0173198,1.12703,.999999,275604e-9,-148602e-9,1.13674,.81075,-78735e-10,.394456,161829e-10,.808692,-198293e-9,.393453,407564e-9,.80846,-792877e-9,.39334,.00162965,.808595,-.00178416,.393407,.00366711,.808597,-.00317182,.393408,.00651934,.808598,-.00495589,.393408,.0101866,.808591,-.00713627,.393403,.0146689,.808592,-.00971285,.393402,.0199667,.80861,-.0126855,.393407,.0260803,.808633,-.0160538,.393413,.0330107,.80868,-.0198175,.393429,.0407589,.808748,-.0239758,.393453,.0493264,.808854,-.0285286,.39349,.0587161,.808992,-.0334748,.39354,.0689304,.809141,-.0388116,.393588,.0799707,.809352,-.0445375,.39366,.0918432,.809608,-.0506427,.393742,.104549,.809915,-.0570708,.393834,.118085,.810253,-.0633526,.393885,.132377,.810687,-.0700966,.393953,.147537,.811233,-.0772274,.394047,.163543,.811865,-.0847629,.394148,.180394,.812648,-.0925663,.394265,.198051,.813583,-.100416,.394363,.216443,.814683,-.108119,.394402,.235502,.815948,-.11644,.394489,.255242,.817278,-.125036,.394542,.275441,.819605,-.133655,.39486,.296094,.822256,-.142682,.395248,.317309,.825349,-.150756,.395241,.340516,.829605,-.158392,.395285,.364819,.83391,-.165801,.394922,.389736,.839808,-.172677,.394691,.415409,.845708,-.179448,.394006,.441546,.853025,-.185746,.393279,.46832,.859666,-.191684,.391655,.495302,.86789,-.197146,.390068,.52262,.875845,-.201904,.38727,.550336,.882634,-.205023,.382688,.578825,.891076,-.207098,.377543,.608103,.900589,-.208474,.371752,.63723,.90791,-.209068,.364016,.665769,.915971,-.208655,.355593,.694428,.923455,-.20729,.345439,.723224,.931514,-.203821,.334099,.751925,.937885,-.19986,.321069,.780249,.943136,-.194993,.306571,.8077,.948818,-.189132,.291556,.83497,.954433,-.181617,.275745,.86188,.959078,-.173595,.258695,.888562,.962705,-.164855,.240825,.914008,.966753,-.155129,.22268,.939145,.970704,-.144241,.204542,.963393,.973367,-.133188,.185927,.985983,.975984,-.121146,.167743,1.00704,.976994,-.108366,.149218,1.02715,.978485,-.0956746,.13131,1.0455,.980074,-.0820733,.112513,1.06221,.98225,-.0684061,.0938323,1.07782,.98553,-.0549503,.0749508,1.09199,.989529,-.0407857,.055848,1.10508,.993536,-.0271978,.0368581,1.11684,.997247,-.0132716,.0181845,1.12789,1,431817e-9,-198809e-9,1.13792,.785886,-812608e-11,.405036,157669e-10,.790388,-205278e-9,.407355,398297e-9,.790145,-820824e-9,.407231,.00159263,.790135,-.00184681,.407226,.00358336,.790119,-.00328316,.407218,.00637039,.790126,-.00512988,.40722,.0099539,.79013,-.00738684,.407221,.0143339,.790135,-.0100538,.407221,.0195107,.790134,-.0131306,.407217,.0254848,.79016,-.0166169,.407224,.0322572,.790197,-.020512,.407236,.0398284,.790273,-.0248157,.407263,.0482014,.790381,-.029527,.407304,.0573777,.790521,-.0346446,.407355,.0673602,.790704,-.0401665,.40742,.0781522,.790925,-.0460896,.407499,.0897582,.791195,-.0524017,.407589,.10218,.791522,-.0590121,.407691,.11541,.791878,-.0654876,.407748,.12939,.792361,-.0725207,.407849,.144237,.792942,-.0799844,.407963,.159924,.79362,-.0877896,.408087,.176425,.794529,-.0958451,.408259,.193733,.795521,-.103827,.408362,.211756,.796778,-.111937,.408482,.230524,.798027,-.120521,.408547,.249967,.799813,-.129242,.408721,.269926,.802387,-.138048,.409148,.290338,.805279,-.147301,.409641,.311193,.809251,-.155895,.410154,.333611,.813733,-.163942,.410297,.357615,.819081,-.171666,.410373,.382339,.825427,-.178905,.410348,.407828,.83172,-.185812,.409486,.434034,.83877,-.192318,.408776,.460493,.845817,-.198249,.407176,.487346,.854664,-.204034,.405719,.514832,.863495,-.208908,.403282,.542401,.871883,-.212765,.399293,.570683,.88065,-.214911,.393803,.599947,.89004,-.216214,.387536,.62932,.898476,-.216745,.379846,.658319,.906738,-.216387,.370625,.687138,.914844,-.215053,.360139,.71601,.923877,-.212007,.348849,.745124,.931925,-.207481,.335639,.773366,.938054,-.202418,.320798,.801636,.943895,-.196507,.304772,.829055,.949468,-.189009,.288033,.856097,.955152,-.180539,.270532,.88301,.959403,-.171437,.251639,.909296,.963309,-.161661,.232563,.934868,.967399,-.150425,.213231,.959662,.972009,-.138659,.194247,.98302,.97433,-.126595,.174718,1.00517,.975823,-.113205,.155518,1.02566,.976371,-.0996096,.136709,1.04418,.978705,-.0860754,.117571,1.06146,.981477,-.0714438,.0980046,1.07777,.984263,-.0572304,.0782181,1.09214,.988423,-.0428875,.0584052,1.10553,.993,-.0282442,.038522,1.11758,.99704,-.0140183,.0190148,1.12864,.999913,369494e-9,-145203e-9,1.13901,.777662,-84153e-10,.423844,154403e-10,.770458,-211714e-9,.419915,38845e-8,.770716,-846888e-9,.420055,.00155386,.770982,-.00190567,.420202,.00349653,.770981,-.00338782,.420201,.00621606,.77098,-.00529338,.4202,.00971274,.770983,-.00762223,.4202,.0139867,.770985,-.0103741,.420198,.0190381,.770996,-.0135489,.4202,.0248677,.771029,-.0171461,.420212,.0314764,.771052,-.0211647,.420215,.0388648,.771131,-.0256048,.420245,.047036,.771235,-.0304647,.420284,.0559911,.771383,-.0357436,.420341,.0657346,.771591,-.0414392,.420423,.0762694,.771819,-.0475462,.420506,.0875984,.772123,-.0540506,.420617,.099727,.772464,-.060797,.42072,.112637,.772855,-.0675393,.420799,.126313,.773317,-.0748323,.420893,.140824,.773981,-.0825681,.421058,.15617,.774746,-.0906307,.421226,.172322,.77566,-.0988982,.421397,.189253,.776837,-.106994,.421569,.206912,.778097,-.115528,.421704,.225359,.779588,-.124317,.421849,.24447,.781574,-.133139,.422097,.264156,.784451,-.142179,.422615,.284318,.787682,-.15165,.423269,.304902,.792433,-.160771,.424396,.3265,.797359,-.169166,.424772,.35014,.803986,-.177149,.425475,.374768,.809504,-.184745,.424996,.399928,.815885,-.19173,.424247,.425796,.823513,-.198525,.423515,.452287,.832549,-.204709,.422787,.479321,.841653,-.210447,.421187,.506718,.850401,-.215501,.418519,.53432,.859854,-.219752,.414715,.56242,.869364,-.222305,.409462,.591558,.878837,-.223744,.402926,.621074,.888636,-.224065,.395043,.650538,.898132,-.223742,.38564,.679538,.907181,-.222308,.375378,.708674,.915621,-.219837,.363212,.737714,.9239,-.215233,.349313,.767014,.931644,-.209592,.334162,.795133,.938887,-.203644,.317943,.823228,.945282,-.196349,.300581,.850822,.950758,-.18742,.282195,.877594,.956146,-.177879,.262481,.904564,.960355,-.167643,.242487,.930741,.965256,-.156671,.222668,.955868,.968029,-.144123,.201907,.979869,.97251,-.131305,.18202,1.00291,.974925,-.118335,.161909,1.02392,.975402,-.103714,.142129,1.0433,.976987,-.089415,.122447,1.06089,.979677,-.0748858,.102248,1.07713,.983184,-.0596086,.0814851,1.09218,.987466,-.0447671,.0609484,1.10585,.992348,-.0295217,.0401835,1.11829,.996674,-.0143917,.0198163,1.12966,1.00003,321364e-9,-149983e-9,1.1402,.757901,-869074e-11,.436176,151011e-10,.751195,-217848e-9,.432317,378533e-9,.751178,-871373e-9,.432307,.0015141,.751195,-.00196061,.432317,.0034068,.751198,-.00348552,.432318,.00605659,.751195,-.00544599,.432315,.00946353,.751207,-.00784203,.43232,.013628,.751213,-.0106732,.43232,.0185499,.751221,-.0139393,.432319,.0242302,.751244,-.0176398,.432325,.0306694,.7513,-.0217743,.432348,.0378698,.751358,-.0263412,.432367,.0458321,.751458,-.0313396,.432404,.0545587,.751608,-.0367682,.432464,.0640543,.7518,-.0426246,.43254,.0743222,.752065,-.0489031,.432645,.0853668,.752376,-.0555828,.432762,.0971911,.752715,-.0623861,.432859,.109768,.753137,-.069415,.432958,.123126,.753676,-.0770039,.433099,.137308,.754345,-.084971,.433272,.15229,.755235,-.0932681,.433504,.168075,.756186,-.10171,.433693,.184625,.757363,-.110019,.433857,.201897,.75884,-.11887,.434102,.220014,.760467,-.127881,.434306,.238778,.762969,-.136766,.434751,.258172,.765823,-.14612,.43529,.278062,.769676,-.15566,.436236,.298437,.774909,-.165177,.437754,.319532,.77994,-.17402,.438343,.342505,.785757,-.182201,.438609,.366693,.792487,-.190104,.438762,.391668,.80038,-.197438,.438795,.417494,.808494,-.204365,.438226,.443933,.817695,-.210714,.437283,.470929,.828111,-.216651,.436087,.498569,.837901,-.221804,.433717,.526165,.847813,-.226318,.430133,.554155,.858314,-.229297,.425213,.582822,.868891,-.230999,.418576,.612847,.878941,-.231155,.410405,.642445,.888809,-.230935,.400544,.672024,.898089,-.229343,.389613,.701366,.908081,-.226886,.377197,.730763,.916819,-.222676,.363397,.759642,.924968,-.216835,.347437,.788775,.932906,-.210245,.32995,.817135,.940025,-.202992,.312262,.844912,.946101,-.19436,.293313,.872164,.952835,-.184125,.273638,.899443,.957347,-.173657,.252385,.926389,.961434,-.162204,.231038,.951947,.965522,-.14979,.209834,.976751,.969412,-.136307,.188821,1.00022,.973902,-.122527,.168013,1.02229,.974045,-.108213,.147634,1.04199,.975775,-.0927397,.12705,1.06019,.978383,-.0778212,.106309,1.07711,.98211,-.0621216,.0849279,1.09245,.986517,-.0463847,.0633519,1.10651,.991696,-.0309353,.0419698,1.11903,.996349,-.0150914,.0206272,1.13073,1.00003,442449e-9,-231396e-9,1.14146,.727498,-885074e-11,.441528,145832e-10,.730897,-223525e-9,.443589,368298e-9,.730796,-893996e-9,.443528,.00147303,.730805,-.00201149,.443533,.00331433,.730814,-.00357596,.443538,.00589222,.730815,-.00558734,.443538,.00920678,.730822,-.00804544,.44354,.0132582,.730836,-.0109501,.443545,.0180468,.730848,-.0143008,.443546,.0235732,.730871,-.0180969,.443552,.0298382,.730915,-.022338,.443567,.0368438,.730982,-.0270225,.443591,.044591,.731076,-.0321491,.443627,.0530831,.731245,-.0377166,.443699,.0623243,.73144,-.0437216,.443777,.0723181,.7317,-.0501576,.443881,.0830691,.732034,-.0569942,.444014,.0945809,.732388,-.0638756,.444113,.106825,.732853,-.071203,.444247,.119859,.733473,-.0790076,.444442,.13369,.734195,-.0871937,.444645,.148304,.735069,-.095696,.444877,.163702,.736169,-.10426,.445133,.179861,.73747,-.112853,.44537,.196778,.738991,-.12199,.445651,.214496,.740865,-.131153,.445958,.232913,.743637,-.140245,.446548,.251977,.746797,-.149722,.447246,.271551,.751517,-.159341,.448656,.291774,.756156,-.169106,.449866,.312455,.761519,-.178436,.450919,.334552,.768295,-.186904,.451776,.358491,.776613,-.195117,.452832,.383446,.783966,-.202695,.45249,.408945,.793542,-.20985,.452587,.435364,.803192,-.216403,.451852,.462336,.813892,-.22251,.450708,.48987,.824968,-.227676,.4486,.517697,.835859,-.232443,.445156,.545975,.846825,-.235775,.440351,.574483,.858085,-.237897,.433641,.604246,.868825,-.238074,.425354,.634101,.879638,-.237661,.415383,.664201,.889966,-.236186,.404136,.693918,.899479,-.233599,.390917,.723481,.908769,-.229737,.376352,.75258,.917966,-.223836,.360372,.781764,.926304,-.217067,.342551,.811139,.934626,-.209309,.324238,.839585,.941841,-.20071,.304484,.867044,.94789,-.190602,.283607,.894579,.954196,-.179253,.262205,.921743,.958383,-.167646,.239847,.948026,.963119,-.155073,.218078,.973296,.966941,-.141426,.195899,.998135,.970836,-.126849,.174121,1.02021,.973301,-.112296,.153052,1.04085,.97448,-.0964965,.131733,1.05946,.977045,-.080489,.10997,1.07693,.980751,-.064844,.0881657,1.09254,.985475,-.0481938,.0657987,1.10697,.991089,-.0319185,.0435215,1.12004,.996122,-.0158088,.0214779,1.13173,1.00001,372455e-9,-200295e-9,1.14291,.708622,-907597e-11,.45304,141962e-10,.711162,-228911e-9,.454662,358052e-9,.709812,-914446e-9,.453797,.00143034,.709865,-.00205819,.453834,.00321935,.709864,-.00365894,.453833,.00572331,.709855,-.00571692,.453826,.00894278,.709862,-.00823201,.453828,.012878,.709875,-.011204,.453832,.0175295,.709896,-.0146323,.453839,.0228978,.709925,-.0185163,.453847,.0289839,.709974,-.0228551,.453866,.0357894,.710045,-.0276473,.453892,.0433161,.710133,-.032891,.453924,.0515665,.710292,-.0385851,.453992,.0605458,.710485,-.0447254,.45407,.0702574,.710769,-.0513051,.454192,.0807077,.711106,-.0582733,.454329,.091896,.711516,-.0652866,.45446,.103814,.712071,-.0728426,.454653,.116508,.712676,-.0808307,.45484,.129968,.713476,-.0892216,.455096,.144206,.714377,-.0979047,.455346,.159212,.715579,-.106531,.455647,.174973,.716977,-.115492,.455961,.191504,.71862,-.124821,.456315,.208835,.72084,-.134079,.4568,.226869,.723786,-.143427,.457521,.245582,.727464,-.153061,.458475,.264957,.732771,-.162768,.460239,.284948,.736515,-.172627,.460899,.30522,.743519,-.182487,.463225,.326717,.750041,-.191295,.464027,.350113,.758589,-.199746,.465227,.374782,.767703,-.207584,.465877,.400226,.777484,-.214973,.465996,.426442,.788792,-.221796,.466019,.453688,.800194,-.228038,.465083,.481246,.811234,-.233346,.462506,.509086,.822859,-.238073,.459257,.537338,.835082,-.241764,.454863,.566108,.846332,-.244241,.448163,.595126,.858355,-.244736,.439709,.625574,.87034,-.244278,.429837,.65617,.881027,-.24255,.418002,.686029,.891007,-.239912,.404325,.716039,.900874,-.236133,.389222,.745518,.911072,-.230672,.373269,.775026,.920359,-.22356,.355083,.804521,.928604,-.215591,.335533,.834045,.937175,-.206503,.315278,.861612,.942825,-.196684,.293653,.889131,.949805,-.185116,.271503,.916853,.955535,-.172703,.248821,.943541,.959843,-.159978,.225591,.970132,.964393,-.146375,.202719,.994709,.968008,-.131269,.179928,1.0186,.971013,-.11569,.158007,1.03928,.973334,-.1003,.13624,1.05887,.975775,-.0833352,.1138,1.07652,.979579,-.0668981,.0913141,1.09297,.984323,-.0500902,.0683051,1.10734,.990351,-.0332377,.0451771,1.12084,.995823,-.0161491,.0221705,1.13296,1.0001,234083e-9,-108712e-9,1.14441,.683895,-924677e-11,.46015,137429e-10,.68833,-233383e-9,.463134,346865e-9,.688368,-933547e-9,.463159,.00138748,.688367,-.00210049,.463159,.00312187,.688369,-.00373415,.463159,.00555004,.688377,-.00583449,.463163,.00867216,.688386,-.00840128,.463166,.0124884,.688398,-.0114343,.463169,.0169993,.688418,-.0149329,.463175,.0222054,.688453,-.0188964,.463188,.028108,.688515,-.0233239,.463214,.0347085,.68857,-.0282136,.463231,.0420091,.688679,-.033564,.463276,.0500132,.688854,-.0393733,.463356,.0587255,.689038,-.0456354,.46343,.0681476,.689321,-.0523433,.463553,.0782897,.689662,-.059412,.463693,.0891501,.690188,-.0665736,.4639,.100735,.690755,-.0743106,.464107,.113074,.691405,-.0824722,.464329,.126161,.692198,-.0910484,.464585,.140007,.693196,-.0998778,.464893,.154612,.69454,-.108651,.465285,.169984,.695921,-.117855,.465596,.186106,.697749,-.12734,.466056,.203034,.700375,-.136714,.466771,.220703,.703395,-.146386,.467579,.239062,.707904,-.156096,.469067,.258188,.711673,-.165904,.469851,.277759,.717489,-.175812,.471815,.297935,.724051,-.185931,.47389,.318916,.731965,-.195238,.47587,.341591,.741151,-.204021,.477523,.366062,.751416,-.212113,.478881,.391396,.761848,-.21979,.479226,.417599,.771886,-.2267,.478495,.444401,.783998,-.232991,.477622,.472084,.796523,-.238645,.475833,.500193,.808851,-.243396,.472568,.52865,.821191,-.247226,.467857,.557362,.834261,-.250102,.461871,.586768,.846762,-.251056,.453543,.617085,.859867,-.250604,.443494,.647659,.871948,-.248783,.431711,.678119,.882967,-.245855,.417911,.708399,.892826,-.242168,.401993,.738256,.90332,-.237062,.385371,.767999,.913633,-.22997,.366837,.798191,.922774,-.221687,.346372,.827756,.931371,-.212345,.325682,.856425,.938929,-.20206,.303665,.884299,.944821,-.190981,.280786,.912023,.951792,-.178065,.2573,.939669,.957712,-.164634,.233448,.96655,.961912,-.150863,.209504,.992366,.966382,-.13577,.18597,1.01633,.969588,-.119593,.162905,1.03843,.971777,-.103203,.14053,1.05841,.97433,-.0865888,.117909,1.07632,.978686,-.0690829,.0944101,1.09326,.983281,-.0516568,.0705671,1.10796,.989562,-.034558,.0468592,1.12182,.995465,-.0167808,.0229846,1.1342,.999991,373016e-9,-235606e-9,1.1459,.662251,-939016e-11,.468575,132714e-10,.666634,-237624e-9,.471675,335842e-9,.666411,-950385e-9,.471516,.00134321,.666399,-.00213833,.471509,.00302221,.666386,-.0038014,.471499,.00537283,.666405,-.00593958,.471511,.00839533,.666406,-.00855253,.471508,.0120898,.666428,-.0116401,.471519,.0164569,.666444,-.0152015,.471522,.0214971,.66649,-.0192362,.471543,.027212,.666537,-.0237428,.471558,.033603,.666617,-.0287198,.471591,.0406728,.666718,-.0341647,.471631,.0484238,.666889,-.0400759,.47171,.0568621,.667104,-.0464479,.471805,.0659915,.667374,-.0532677,.471923,.0758178,.667772,-.0603805,.472098,.0863425,.668371,-.0677392,.472363,.0975917,.668971,-.0756028,.472596,.109567,.669696,-.0839293,.472869,.122272,.670481,-.0926683,.473126,.135718,.6715,-.1016,.473442,.149914,.672911,-.110566,.47389,.164882,.674512,-.119984,.474354,.180602,.67651,-.129574,.474922,.19711,.679292,-.139106,.475764,.214371,.682798,-.148993,.476886,.232405,.686955,-.158737,.478179,.251153,.691406,-.168754,.479432,.270436,.697438,-.178703,.481481,.290374,.704761,-.188955,.484143,.311044,.713599,-.198814,.487007,.333003,.723194,-.207869,.488962,.357144,.732601,-.216189,.489815,.382169,.744193,-.22398,.490888,.408227,.754907,-.231156,.490355,.434928,.767403,-.23747,.489548,.462599,.78107,-.243503,.488274,.490908,.793893,-.248114,.484843,.519421,.807296,-.25222,.4803,.548561,.820529,-.255265,.474097,.577772,.833716,-.256741,.466041,.607782,.848403,-.25637,.456547,.638807,.860755,-.254804,.443946,.670058,.874012,-.251834,.430852,.700749,.885619,-.247867,.414903,.731446,.896069,-.242634,.397276,.761191,.906266,-.236093,.378535,.791053,.916759,-.227543,.358038,.821298,.92523,-.21783,.335705,.850747,.93436,-.207534,.313797,.879258,.941631,-.195983,.289671,.907734,.947564,-.183567,.265319,.935206,.953681,-.169345,.240815,.962739,.960008,-.154909,.216119,.989227,.964145,-.140161,.192096,1.01465,.968171,-.123411,.167855,1.03737,.969859,-.106525,.144817,1.05767,.972666,-.0891023,.12149,1.0761,.977055,-.0718094,.0975306,1.09336,.982527,-.0534213,.0730217,1.10878,.989001,-.0355579,.0483366,1.12285,.99512,-.0176383,.023938,1.13548,1.00007,368831e-9,-211581e-9,1.14744,.651047,-960845e-11,.484101,12922e-9,.644145,-241347e-9,.478968,324578e-9,.64396,-965142e-9,.478831,.00129798,.64396,-.00217154,.47883,.00292046,.643968,-.00386049,.478835,.00519202,.643974,-.00603186,.478838,.0081128,.643977,-.0086854,.478836,.011683,.643982,-.0118207,.478834,.0159031,.644024,-.0154374,.478856,.0207743,.644059,-.0195343,.478868,.0262975,.644122,-.0241103,.478896,.0324747,.644207,-.0291638,.478933,.039309,.64432,-.0346919,.478981,.0468029,.644481,-.0406919,.479053,.0549614,.644722,-.047159,.479169,.0637909,.645013,-.0540748,.479302,.0732974,.645503,-.0612001,.479541,.0834898,.646117,-.0687303,.479829,.0943873,.646707,-.0767846,.480061,.105991,.647431,-.0852465,.480343,.11831,.64831,-.0940719,.48066,.131348,.649486,-.103056,.481083,.14514,.650864,-.112261,.481528,.159676,.652604,-.121852,.482102,.174979,.654825,-.131505,.482813,.191079,.657876,-.141189,.483876,.207927,.661339,-.151239,.48499,.225586,.665463,-.161091,.486279,.243947,.670542,-.171235,.487968,.262957,.677361,-.181347,.49053,.282781,.685672,-.191679,.493862,.303311,.694551,-.201781,.49699,.324607,.703753,-.211164,.498884,.347916,.713703,-.219675,.500086,.372628,.725911,-.227836,.501554,.398694,.73862,-.23533,.502193,.425529,.752118,-.241786,.501811,.453209,.76579,-.247865,.500185,.481381,.779568,-.252696,.497159,.51011,.793991,-.256802,.492765,.539322,.808182,-.259942,.486827,.569078,.821698,-.261703,.478386,.598818,.836009,-.262006,.468772,.629762,.849824,-.260333,.456352,.661366,.863888,-.257398,.442533,.69295,.876585,-.253264,.426573,.723608,.888665,-.248026,.408964,.754378,.899537,-.241487,.389677,.784761,.9094,-.233463,.368516,.814688,.920166,-.223397,.346624,.845009,.928899,-.21255,.322717,.874431,.937156,-.200869,.298698,.902922,.943861,-.188387,.273491,.931356,.949557,-.174341,.247866,.958854,.955862,-.158994,.222496,.986098,.961721,-.143664,.197522,1.01229,.965976,-.127412,.17302,1.03571,.968652,-.109798,.148954,1.05699,.971084,-.0916787,.125044,1.07587,.975584,-.0739634,.100577,1.09372,.98122,-.055322,.0753666,1.10948,.988253,-.0366825,.0498899,1.12394,.99482,-.0180389,.024611,1.13694,1.00001,229839e-9,-188283e-9,1.14919,.613867,-964198e-11,.479449,123452e-10,.621485,-244534e-9,.485399,313091e-9,.621429,-978202e-9,.485353,.00125245,.62112,-.00220004,.485114,.00281687,.621119,-.0039111,.485112,.00500783,.621122,-.00611091,.485112,.00782498,.621133,-.00879922,.485117,.0112687,.621152,-.0119756,.485125,.0153394,.621183,-.0156396,.485139,.0200382,.621227,-.0197898,.485158,.0253663,.621298,-.0244253,.485192,.0313261,.621388,-.0295441,.485233,.0379204,.621507,-.0351432,.485286,.0451523,.621693,-.0412198,.485378,.0530277,.621933,-.0477673,.485495,.0615522,.622232,-.0547574,.485635,.0707316,.622809,-.0619417,.485943,.0805883,.623407,-.069625,.486232,.0911267,.62406,-.077796,.486516,.102354,.624835,-.0863731,.486838,.114279,.625758,-.095251,.487188,.126902,.627043,-.104299,.487695,.140285,.628438,-.113724,.488163,.154397,.630325,-.123417,.488858,.169267,.632801,-.133137,.489754,.184941,.635784,-.143052,.490815,.20136,.639406,-.153132,.492048,.218643,.643872,-.163143,.49363,.236615,.6499,-.17333,.496009,.255449,.657201,-.183622,.498994,.275006,.666221,-.194019,.502888,.295354,.674419,-.204192,.505459,.316244,.683729,-.21406,.507771,.33849,.695584,-.222854,.510245,.363166,.708583,-.231315,.512293,.389071,.721233,-.238911,.512747,.415737,.735134,-.245657,.512482,.443331,.750179,-.251879,.511526,.471891,.765073,-.256911,.508935,.500892,.779794,-.261144,.504341,.530294,.794801,-.264316,.498515,.560144,.810339,-.266276,.491015,.590213,.824818,-.266981,.481126,.620865,.839375,-.265778,.468685,.652687,.853043,-.262748,.453925,.684759,.867335,-.258474,.437912,.716209,.88037,-.253187,.419648,.747508,.891711,-.246476,.39982,.77797,.902896,-.238735,.37879,.808586,.913601,-.22885,.355891,.838843,.923019,-.217656,.331773,.869014,.933432,-.205539,.307356,.898512,.939691,-.192595,.281321,.9269,.946938,-.178945,.255441,.955297,.952372,-.163587,.229013,.983231,.95909,-.147214,.203179,1.00971,.963675,-.13064,.17792,1.03438,.968247,-.113121,.152898,1.05625,.97001,-.0945824,.128712,1.07598,.974458,-.0755648,.103349,1.094,.980168,-.0571998,.0776731,1.1104,.987295,-.0377994,.0514445,1.12491,.994432,-.0186417,.025429,1.13851,.999975,542714e-9,-282356e-9,1.15108,.592656,-980249e-11,.486018,119532e-10,.598467,-247275e-9,.490781,301531e-9,.597934,-988317e-9,.490343,.00120517,.597903,-.00222366,.490319,.0027116,.597913,-.00395315,.490327,.00482077,.597919,-.00617653,.490329,.00753264,.597936,-.00889375,.490339,.0108478,.597956,-.0121043,.490347,.0147668,.597992,-.0158073,.490365,.0192905,.598032,-.0200017,.490382,.0244204,.598109,-.0246865,.49042,.0301593,.598215,-.0298594,.490474,.03651,.59833,-.0355167,.490524,.0434757,.598525,-.0416559,.490624,.0510629,.598778,-.0482692,.490753,.0592781,.599135,-.0553114,.49094,.0681304,.599802,-.062542,.491328,.0776467,.600361,-.0703638,.491598,.0878184,.60101,-.0786256,.491882,.0986573,.601811,-.0872962,.492232,.11018,.602861,-.0962284,.492684,.1224,.604167,-.10538,.493213,.135354,.605693,-.114896,.493799,.149034,.607682,-.124654,.494576,.163469,.610672,-.13456,.4959,.178747,.613313,-.144581,.496713,.194723,.617603,-.154703,.498499,.211617,.622174,-.16489,.500188,.229183,.628855,-.175164,.503072,.247786,.636963,-.185565,.506798,.267116,.644866,-.195911,.509719,.28702,.653741,-.206104,.512776,.307763,.664942,-.216447,.516812,.329631,.67633,-.22552,.519181,.353515,.690012,-.234316,.521681,.379226,.704243,-.242032,.523129,.405901,.719396,-.249172,.523768,.433585,.734471,-.255543,.522541,.462085,.750539,-.260697,.520217,.491233,.766365,-.26501,.516293,.521094,.781677,-.268409,.509708,.551014,.797132,-.270399,.501944,.581463,.812655,-.271247,.492025,.612402,.828592,-.270708,.480424,.643798,.844044,-.268085,.465955,.67682,.857305,-.263459,.448425,.708496,.87114,-.258151,.430243,.74046,.884936,-.251171,.410578,.771583,.895772,-.243305,.38862,.802234,.906961,-.234037,.365214,.833179,.917775,-.222714,.34116,.86353,.927883,-.210175,.31572,.893557,.936617,-.196925,.289159,.922976,.943384,-.182788,.261996,.951606,.949713,-.167965,.235324,.979958,.955818,-.151109,.208408,1.00765,.961344,-.133834,.182591,1.03329,.965469,-.115987,.156958,1.0557,.968693,-.09746,.132239,1.07583,.973165,-.0778514,.106195,1.09451,.979387,-.0585067,.0797669,1.11137,.98671,-.0390409,.0530263,1.12643,.994093,-.019408,.0263163,1.14016,1.00002,540029e-9,-194487e-9,1.15299,.574483,-989066e-11,.494533,114896e-10,.574478,-249127e-9,.494528,289403e-9,.574607,-996811e-9,.494637,.00115797,.574396,-.00224241,.494458,.00260498,.574377,-.00398632,.49444,.00463102,.574386,-.00622836,.494445,.00723623,.574401,-.0089683,.494453,.010421,.574419,-.0122056,.49446,.0141859,.574459,-.0159396,.494481,.0185322,.574525,-.0201692,.49452,.0234617,.574587,-.0248924,.494547,.0289762,.574697,-.0301074,.494604,.0350797,.574853,-.0358114,.494688,.0417767,.575027,-.041999,.494772,.0490718,.575294,-.0486618,.494915,.0569728,.575733,-.0557148,.495173,.0654955,.576356,-.0630489,.495537,.0746612,.576944,-.0709285,.495836,.0844615,.57765,-.0792723,.496177,.0949142,.578491,-.0880167,.496563,.10603,.579639,-.0969462,.497096,.117841,.580989,-.10622,.497684,.130367,.582587,-.115861,.498337,.143609,.584951,-.125605,.499414,.157625,.587602,-.135608,.500518,.172413,.59076,-.145742,.501767,.187999,.594992,-.155934,.503542,.20445,.600656,-.166303,.506135,.221764,.607816,-.176681,.509542,.24002,.61522,-.187071,.51263,.258992,.623702,-.197465,.516021,.278773,.634192,-.207816,.520422,.299377,.644936,-.218183,.524073,.320802,.657888,-.2278,.528049,.34384,.670666,-.236747,.52986,.36916,.685626,-.24484,.531892,.395867,.701304,-.252071,.532727,.423488,.717727,-.258714,.532146,.452201,.733914,-.264211,.529883,.481579,.750529,-.26859,.5259,.511558,.76747,-.272046,.51999,.542042,.785189,-.274225,.513083,.572799,.800954,-.275189,.502936,.603816,.816962,-.274946,.490921,.635461,.83336,-.272695,.47684,.6676,.848143,-.268223,.459405,.70051,.861818,-.262768,.440319,.732902,.876828,-.255872,.420123,.765084,.889312,-.247703,.398379,.796391,.900412,-.238381,.374496,.827333,.912251,-.227783,.349874,.858385,.921792,-.214832,.323181,.888652,.931273,-.200949,.296624,.917763,.940295,-.186537,.269211,.947878,.946812,-.171538,.241447,.977016,.953588,-.155254,.213829,1.00501,.958841,-.137156,.186807,1.03179,.963746,-.118699,.160706,1.05502,.966468,-.0998358,.135504,1.07568,.971178,-.0805186,.109131,1.09479,.97831,-.0599348,.0818293,1.1123,.985886,-.0399661,.0545872,1.12771,.994021,-.0198682,.0269405,1.14186,1.00009,271022e-9,-12989e-8,1.15514,.538716,-990918e-11,.486732,109675e-10,.550656,-250642e-9,.497518,277412e-9,.55057,-.00100265,.497441,.00110974,.550903,-.00225672,.497733,.00249779,.550568,-.00401046,.497438,.00443906,.550574,-.00626613,.49744,.00693637,.550591,-.0090226,.497449,.00998921,.550623,-.0122795,.497469,.0135984,.550667,-.0160361,.497495,.0177654,.550724,-.0202908,.497526,.0224915,.550792,-.0250421,.497557,.0277795,.550918,-.0302878,.49763,.0336334,.551058,-.0360241,.497701,.0400573,.551276,-.0422473,.497824,.0470585,.551551,-.0489441,.497977,.0546433,.552074,-.0559596,.498312,.0628367,.552681,-.0633978,.498679,.071646,.553324,-.0713176,.499031,.0810746,.554011,-.0797268,.499365,.091129,.55488,-.0885238,.499779,.101837,.556171,-.0974417,.500444,.113239,.557498,-.106841,.501025,.125316,.559299,-.116533,.501864,.138128,.561647,-.126298,.502967,.151695,.564347,-.136388,.504129,.16604,.567863,-.146576,.505713,.181207,.572569,-.156832,.507953,.197259,.578919,-.167323,.511186,.214258,.585387,-.177712,.514042,.232038,.593134,-.188184,.517484,.250733,.603295,-.198717,.522345,.270454,.613854,-.209177,.526751,.290807,.626092,-.219644,.531595,.312202,.637868,-.229494,.534721,.334435,.652458,-.238718,.538304,.359184,.666985,-.247061,.539875,.385637,.683301,-.254652,.541042,.41328,.69998,-.261376,.540735,.441903,.717824,-.267085,.539139,.471609,.734617,-.271465,.534958,.501446,.753663,-.27528,.53032,.532571,.770512,-.277617,.522134,.563641,.787356,-.278525,.51206,.595067,.806252,-.278512,.50119,.627226,.822061,-.277023,.486791,.659402,.838959,-.273175,.470467,.692874,.85379,-.267238,.450688,.725702,.868268,-.260327,.429741,.75832,.881994,-.251946,.407223,.790189,.893885,-.242432,.383214,.821625,.905118,-.231904,.357297,.853011,.916045,-.219545,.330733,.883773,.927614,-.205378,.303916,.914435,.936005,-.190388,.275941,.944502,.944533,-.1749,.247493,.974439,.950758,-.158588,.218996,1.00286,.957078,-.141027,.191559,1.0304,.962448,-.121507,.164457,1.05466,.964993,-.102068,.138636,1.0761,.970017,-.0822598,.111861,1.09541,.97661,-.062033,.0843438,1.11317,.985073,-.0409832,.0558496,1.12911,.993515,-.020146,.0275331,1.1438,1.00006,27329e-8,-107883e-9,1.15736,.525324,-999341e-11,.498153,105385e-10,.526513,-251605e-9,.499277,265329e-9,.526517,-.00100641,.499282,.0010613,.526588,-.00226466,.499337,.00238823,.526539,-.0040255,.499302,.00424535,.526547,-.00628954,.499306,.00663364,.526561,-.00905628,.499313,.00955337,.526593,-.0123253,.499334,.0130054,.526642,-.0160957,.499365,.0169911,.5267,-.0203661,.499396,.0215122,.526792,-.0251347,.499451,.0265718,.526904,-.0303985,.499511,.0321732,.527079,-.0361554,.499617,.0383231,.527285,-.0423982,.499731,.045026,.527602,-.0491121,.499924,.0522936,.528166,-.0561127,.500306,.0601528,.52879,-.0635988,.5007,.0686059,.529421,-.071581,.501048,.0776518,.530144,-.0799854,.501421,.0873148,.531062,-.0888032,.501884,.0976084,.532374,-.0977643,.50259,.108588,.533828,-.107197,.50329,.120234,.53581,-.116887,.504312,.132602,.538063,-.126755,.505365,.145721,.5409,-.136819,.506668,.159617,.544882,-.147117,.508731,.174369,.550238,-.157446,.511601,.190028,.556038,-.167988,.514431,.206587,.563031,-.178364,.517808,.224046,.571543,-.189007,.521937,.242503,.582255,-.199546,.527415,.261977,.59272,-.210084,.531682,.282162,.605648,-.220448,.537123,.303426,.61785,-.230593,.540664,.325323,.632223,-.240238,.544467,.348993,.648819,-.24887,.547594,.375462,.665825,-.256657,.54912,.403024,.683389,-.263711,.549294,.431773,.701495,-.269666,.547649,.461494,.719197,-.274169,.543786,.491623,.737906,-.278124,.538644,.522994,.756652,-.280632,.531057,.554775,.775279,-.281741,.521972,.586441,.792688,-.281652,.509613,.618596,.811894,-.280345,.496497,.651462,.827938,-.277128,.47968,.684023,.844837,-.271646,.460688,.718024,.859239,-.264397,.438872,.751207,.874088,-.256144,.41577,.784232,.887693,-.246311,.391369,.816191,.899402,-.235497,.365872,.847828,.910973,-.223631,.338618,.87934,.92204,-.209874,.310803,.910325,.930987,-.194265,.281802,.940695,.94,-.178125,.252836,.970958,.948018,-.161479,.224239,1.00078,.955141,-.144038,.195857,1.0288,.960513,-.124915,.168487,1.05371,.963964,-.104284,.141495,1.07596,.968713,-.0838732,.114437,1.09628,.975524,-.0635579,.0863105,1.11448,.98431,-.042291,.0574774,1.13069,.992916,-.0209131,.0284343,1.14568,.999926,743097e-9,-379265e-9,1.15955,.501042,-998428e-11,.498726,100306e-10,.502992,-252112e-9,.500665,253283e-9,.502417,-.00100791,.500092,.00101259,.502965,-.00226919,.500621,.00227978,.502318,-.00403109,.499994,.00405011,.502333,-.00629832,.500005,.00632868,.502362,-.00906907,.500027,.00911446,.502369,-.0123423,.500023,.0124078,.50243,-.0161178,.500066,.016211,.502493,-.0203937,.500103,.0205256,.502592,-.0251684,.500166,.0253548,.502707,-.0304389,.50023,.0307029,.502881,-.0362015,.500335,.0365753,.503124,-.0424507,.500488,.0429798,.503443,-.0491582,.500686,.0499268,.504083,-.0561476,.501155,.0574541,.504668,-.0636846,.501524,.0655408,.505319,-.0716834,.501904,.0742072,.50609,-.0800925,.502321,.0834699,.507122,-.0888425,.502896,.0933603,.508414,-.097855,.503603,.10391,.509955,-.107304,.504416,.115113,.512061,-.116921,.505565,.127054,.514419,-.12689,.506732,.139709,.517529,-.136934,.508338,.153173,.522085,-.147327,.510987,.167528,.526986,-.157612,.513527,.182708,.533122,-.168213,.516717,.198881,.540807,-.178688,.520832,.215986,.550687,-.189511,.52632,.234335,.560567,-.199998,.531009,.253375,.571698,-.210652,.535839,.273499,.584364,-.220917,.541091,.294355,.599066,-.23137,.546875,.316525,.614148,-.241206,.551306,.339671,.631157,-.250379,.555187,.36531,.647919,-.258397,.556595,.392767,.666112,-.265528,.556949,.421397,.686158,-.271827,.556617,.451433,.704838,-.27674,.552975,.482131,.723957,-.280733,.547814,.513458,.74262,-.283359,.53997,.545446,.762009,-.284541,.530422,.57775,.781314,-.284507,.518546,.610434,.799116,-.283309,.504178,.643178,.817604,-.280378,.48843,.676248,.83459,-.275619,.469457,.709698,.850974,-.26856,.447698,.744245,.866747,-.260094,.424791,.777695,.881412,-.249929,.399913,.810392,.8936,-.239137,.37308,.842872,.905943,-.226818,.345705,.874677,.916408,-.213699,.31706,.906257,.927215,-.198428,.288444,.936881,.935625,-.181643,.258329,.96795,.944076,-.164386,.228488,.998216,.951229,-.146339,.199763,1.02689,.958793,-.127709,.172153,1.0535,.963219,-.107244,.144989,1.07646,.967562,-.0857764,.11685,1.09675,.974866,-.0645377,.0880571,1.11576,.983353,-.0431732,.0587352,1.13227,.992503,-.0218356,.0294181,1.1478,1.00003,605203e-9,-231013e-9,1.16207,.482935,-101177e-10,.504695,968142e-11,.477554,-251521e-9,.499071,240676e-9,.477904,-.00100683,.499436,96342e-8,.478368,-.00226636,.499899,.0021687,.477977,-.00402719,.499513,.00385384,.477993,-.00629226,.499525,.0060221,.478011,-.00906011,.499536,.00867289,.478051,-.0123305,.499566,.0118074,.478089,-.016102,.499587,.0154269,.478171,-.0203736,.499645,.0195341,.478254,-.025143,.499692,.0241318,.47839,-.0304071,.499779,.0292247,.478588,-.0361631,.499911,.0348196,.478812,-.0424023,.500046,.0409231,.479208,-.0490724,.500326,.047552,.479841,-.0560722,.500805,.0547377,.480392,-.0636125,.501152,.0624607,.481068,-.0716134,.501561,.0707473,.481898,-.0800062,.502054,.0796118,.483022,-.0886568,.502728,.0890974,.484332,-.0977553,.503479,.0992099,.486126,-.107173,.504546,.10999,.488066,-.11677,.50557,.121476,.490521,-.126725,.506849,.133672,.494232,-.136793,.50911,.146731,.498302,-.147116,.511345,.160577,.503565,-.157446,.514344,.175335,.510902,-.168121,.518824,.191207,.519263,-.178799,.523666,.208058,.528204,-.189407,.528296,.225875,.538854,-.200145,.533724,.244782,.551278,-.210701,.539833,.264753,.565222,-.221303,.546131,.285745,.579403,-.231688,.551496,.307592,.595469,-.241718,.556809,.330582,.610929,-.250992,.559641,.354995,.629433,-.259602,.562379,.382471,.648504,-.267038,.563676,.411126,.66756,-.273388,.562092,.440924,.689143,-.278788,.560807,.472118,.709056,-.282783,.555701,.503774,.729855,-.285836,.548698,.536364,.748954,-.287078,.538544,.56895,.768373,-.287133,.526711,.601991,.78827,-.285839,.512511,.635403,.807465,-.283238,.496323,.668797,.825194,-.27906,.477638,.702584,.842203,-.272286,.456253,.736393,.857749,-.263854,.432412,.77096,.874799,-.253943,.407806,.80489,.887497,-.24237,.38033,.83771,.89966,-.230278,.352446,.870376,.911753,-.21646,.323268,.902256,.923011,-.202071,.294314,.933306,.932375,-.185519,.264104,.965177,.940537,-.167604,.234035,.996303,.948904,-.149068,.20412,1.0261,.955263,-.129539,.175431,1.05304,.960303,-.109932,.148116,1.07617,.965512,-.0880572,.119693,1.09742,.973466,-.0660548,.0901619,1.11721,.98284,-.0439228,.0599875,1.13436,.992216,-.0219588,.0298975,1.15006,.999946,119402e-9,-208547e-10,1.16471,.447827,-100414e-10,.491543,914833e-11,.454778,-251257e-9,.499172,22891e-8,.453519,-.00100342,.497787,914184e-9,.45357,-.00225776,.497847,.00205701,.453578,-.00401371,.497855,.00365705,.45357,-.00627107,.497841,.00571453,.453598,-.00902968,.497864,.00823019,.453627,-.0122888,.497882,.0112049,.453684,-.0160475,.497923,.0146405,.453764,-.0203044,.49798,.0185394,.453866,-.0250576,.498049,.0229054,.453996,-.0303028,.49813,.0277424,.454196,-.0360379,.498267,.0330587,.454457,-.0422521,.498445,.0388613,.454926,-.0488393,.498812,.0451767,.455525,-.0558653,.499272,.0520153,.456074,-.0633772,.499625,.0593754,.456752,-.0713606,.500049,.0672751,.457648,-.07971,.500615,.0757447,.458849,-.0883032,.501399,.0848231,.46029,-.0974095,.502293,.0945135,.462,-.106729,.503301,.104848,.464121,-.116354,.504533,.115884,.466889,-.126214,.506172,.127652,.470744,-.136324,.508667,.14024,.47488,-.146595,.510995,.153673,.480845,-.157027,.514832,.168053,.488262,-.167658,.519506,.183508,.496547,-.178343,.524347,.199948,.506254,-.188916,.52983,.217503,.517961,-.199975,.536357,.236272,.531484,-.210624,.543641,.256096,.545496,-.221227,.550048,.277085,.559497,-.231568,.555076,.298615,.575752,-.241698,.560541,.321547,.591999,-.251172,.564156,.345602,.610654,-.260178,.567607,.371851,.630484,-.268094,.56923,.40076,.651807,-.274661,.569779,.430801,.67239,-.280331,.566791,.461939,.693024,-.284501,.562007,.493854,.715473,-.287852,.555791,.526992,.736323,-.28929,.546345,.560102,.755771,-.289405,.534,.593543,.775424,-.2881,.519114,.627256,.795447,-.285562,.502543,.661464,.815319,-.281416,.484773,.695206,.831769,-.275523,.463445,.729044,.849464,-.267516,.440269,.764069,.866775,-.257584,.415049,.799089,.881252,-.245817,.388049,.831948,.894209,-.233127,.35889,.865526,.906922,-.219579,.329915,.89818,.919686,-.204491,.300441,.930013,.929044,-.188962,.269445,.962061,.938393,-.171079,.238402,.994214,.94661,-.15199,.208204,1.02533,.953095,-.131953,.178653,1.0529,.958644,-.111233,.150684,1.0771,.963925,-.0903098,.122359,1.09855,.971995,-.0680505,.0923342,1.11874,.981658,-.0448512,.0614195,1.13635,.991649,-.0221931,.0303582,1.15238,.999985,393403e-9,-111086e-9,1.16772,.396806,-971563e-11,.457671,842355e-11,.429186,-249421e-9,.495017,21625e-8,.429324,-998052e-9,.495173,865322e-9,.429175,-.00224487,.494999,.00194637,.429129,-.00399041,.494952,.00346004,.429153,-.00623476,.494974,.00540684,.429168,-.0089773,.494983,.00778714,.429207,-.0122175,.495012,.0106022,.429257,-.0159542,.495047,.0138535,.429338,-.0201864,.495106,.0175443,.429431,-.0249104,.495165,.0216774,.429587,-.0301252,.495279,.0262594,.429796,-.0358249,.495432,.0312968,.430065,-.0419972,.495621,.0367985,.430588,-.0485144,.496061,.042798,.43113,-.0555028,.496472,.0492914,.431743,-.0629852,.496904,.0562907,.432448,-.0709256,.497369,.0638056,.433414,-.0791942,.498032,.071885,.434638,-.0877346,.498854,.0805517,.43611,-.0968056,.499812,.0898047,.437859,-.106002,.500891,.0997142,.440017,-.115648,.502198,.110289,.443236,-.125427,.504389,.121644,.44697,-.135492,.506809,.133769,.451689,-.145746,.509858,.146787,.45811,-.156219,.514247,.160793,.465305,-.166834,.518816,.175791,.474085,-.177546,.524331,.191906,.484808,-.188262,.53104,.209199,.49732,-.199346,.538511,.227825,.509693,-.209951,.544554,.247269,.524367,-.220533,.551616,.267978,.539228,-.231082,.557368,.289672,.55644,-.241342,.563782,.31268,.574204,-.250964,.568851,.33651,.593388,-.260306,.57312,.362219,.613358,-.268667,.574916,.390322,.634512,-.275591,.575053,.420478,.65563,-.281328,.572404,.451614,.678265,-.285948,.568893,.484112,.70011,-.289408,.561878,.517348,.723005,-.291328,.55359,.551355,.743744,-.291418,.541099,.585109,.763949,-.290252,.526489,.619487,.784186,-.287648,.509496,.65404,.804304,-.283782,.491484,.688649,.823629,-.278067,.470517,.723133,.84094,-.270588,.44705,.757163,.857852,-.261188,.421252,.792816,.874934,-.249313,.394191,.827248,.888709,-.236492,.365359,.861074,.902589,-.222185,.336016,.894417,.914201,-.207314,.30527,.926825,.925978,-.191146,.274532,.9595,.93512,-.174135,.243393,.991583,.943656,-.155231,.212414,1.02356,.951719,-.134403,.182005,1.05239,.957164,-.113023,.153043,1.07754,.962656,-.0914493,.124186,1.09984,.970695,-.0694179,.0941654,1.12,.980749,-.0466199,.0629671,1.13849,.991205,-.0227032,.0311146,1.15494,.999884,632388e-9,-254483e-9,1.1706,.379821,-957289e-11,.460637,789337e-11,.405188,-247483e-9,.491396,204064e-9,.404796,-989434e-9,.490914,815853e-9,.40483,-.00222607,.490949,.00183559,.40473,-.00395723,.49084,.00326332,.404731,-.00618287,.490836,.00509945,.404768,-.00890258,.490871,.00734463,.404791,-.0121156,.490883,.00999992,.404857,-.0158214,.490938,.0130676,.404943,-.0200178,.491004,.0165503,.405059,-.0247027,.491093,.0204521,.405213,-.0298729,.491205,.0247788,.405399,-.0355226,.491333,.0295373,.405731,-.0416352,.491604,.034741,.406303,-.0480807,.492116,.0404255,.406814,-.0550458,.492506,.0465732,.407404,-.0624652,.492926,.0532058,.408149,-.0702958,.493442,.0603442,.409128,-.0784623,.494136,.0680297,.410408,-.087007,.495054,.0762786,.411813,-.0959639,.495962,.0851046,.413735,-.105075,.497257,.0945878,.416137,-.114646,.498882,.104725,.41934,-.124394,.501132,.11563,.423326,-.134328,.503883,.127325,.428419,-.14458,.50747,.139911,.43484,-.154979,.511964,.153481,.442641,-.165628,.517328,.168114,.452511,-.176365,.524258,.183995,.463473,-.187298,.531248,.200953,.475564,-.198244,.538367,.219176,.488664,-.208938,.545175,.238514,.504073,-.219599,.553227,.259129,.520832,-.230378,.560653,.280997,.538455,-.240703,.567523,.303821,.55709,-.250548,.573287,.327948,.576646,-.259964,.577795,.353362,.596705,-.268721,.580077,.380336,.618053,-.276054,.58018,.4101,.640303,-.282176,.578747,.44161,.662365,-.286931,.574294,.474106,.684542,-.290521,.567035,.507549,.707984,-.292672,.558687,.541853,.730913,-.293189,.547606,.576581,.752948,-.292199,.533471,.61172,.773452,-.289508,.516395,.646339,.794715,-.285716,.497873,.682131,.814251,-.280051,.476845,.716396,.833057,-.272873,.453449,.751503,.84959,-.263982,.427857,.786085,.867022,-.252745,.400335,.821355,.882277,-.239655,.371304,.85646,.895375,-.225386,.340397,.890828,.909347,-.209587,.310005,.923532,.921885,-.193433,.2796,.956419,.932127,-.176135,.247276,.989445,.941869,-.157872,.216186,1.02221,.949735,-.137577,.185602,1.05195,.956617,-.115285,.155767,1.07822,.961974,-.0928418,.126103,1.10149,.96972,-.0700592,.0956758,1.12207,.98012,-.0474671,.0643269,1.1408,.990825,-.0238113,.0320863,1.1577,.999876,381574e-9,-812203e-10,1.17403,.367636,-961342e-11,.469176,753287e-11,.380377,-244772e-9,.485434,191797e-9,.380416,-978857e-9,.485475,767015e-9,.380376,-.00220165,.485435,.00172522,.380419,-.00391408,.485487,.00306734,.380438,-.00611549,.485505,.00479332,.380462,-.00880558,.485525,.00690391,.380496,-.0119837,.485551,.00940039,.38056,-.0156487,.485605,.0122848,.38064,-.0197988,.485666,.0155601,.380767,-.0244324,.48577,.0192313,.380909,-.0295444,.485871,.0233032,.381142,-.0351321,.48606,.0277861,.381472,-.0411535,.486336,.0326939,.382015,-.0475408,.486833,.0380565,.382523,-.0544395,.487231,.0438615,.383129,-.061784,.487683,.0501332,.383952,-.0695085,.488313,.0568996,.38498,-.0775819,.489077,.0641952,.386331,-.0860443,.490113,.0720324,.387788,-.0948406,.491099,.0804379,.389808,-.103899,.492566,.0894899,.39252,-.113313,.494601,.0992098,.395493,-.123007,.496619,.109641,.399826,-.132859,.499912,.120919,.405341,-.143077,.504061,.133107,.411932,-.153465,.508905,.146263,.420591,-.164108,.515482,.160544,.43101,-.174893,.523191,.176123,.441881,-.185839,.53026,.192757,.453919,-.196633,.537295,.210535,.468715,-.207611,.546156,.229886,.485182,-.218517,.555173,.250543,.501926,-.229249,.562728,.27221,.51785,-.239481,.567494,.294892,.536947,-.249395,.573889,.318987,.557115,-.259,.578831,.344348,.577966,-.268075,.582055,.371223,.599489,-.276115,.583307,.399834,.62479,-.282523,.583902,.431415,.647504,-.287663,.57953,.464301,.670601,-.291538,.573103,.498123,.693539,-.293842,.563731,.532662,.717385,-.294681,.553169,.567925,.741533,-.293717,.539908,.603502,.762142,-.291156,.521902,.639074,.783014,-.28719,.502815,.674439,.805158,-.281773,.482598,.710497,.823646,-.274682,.458949,.7456,.841879,-.266184,.433129,.781085,.859515,-.255682,.406064,.816,.875335,-.242849,.376509,.851074,.890147,-.228329,.345502,.886473,.903144,-.212491,.31428,.920751,.916618,-.195695,.282994,.954606,.927953,-.178267,.251091,.988402,.937414,-.159549,.219107,1.02141,.946823,-.140022,.18896,1.05167,.954651,-.118154,.158667,1.07819,.959955,-.0946636,.128808,1.1025,.96858,-.0711792,.0973787,1.12391,.97938,-.0475046,.0650965,1.14322,.990498,-.024059,.0326267,1.16077,.999844,-512408e-10,112444e-9,1.17727,.316912,-934977e-11,.425996,695559e-11,.356423,-241372e-9,.479108,179562e-9,.356272,-965292e-9,.478897,71811e-8,.356262,-.00217182,.478894,.00161574,.356265,-.00386092,.478895,.00287261,.356278,-.0060324,.478905,.00448907,.356293,-.00868565,.478914,.00646572,.356346,-.0118207,.478965,.00880438,.356395,-.0154355,.479001,.0115066,.356484,-.019529,.479075,.0145762,.356609,-.0240991,.47918,.018018,.356766,-.0291413,.479305,.0218379,.357009,-.0346498,.479512,.0260454,.357424,-.0405462,.479909,.0306657,.357899,-.0468825,.480337,.0357054,.358424,-.0536887,.480771,.0411728,.359041,-.0609416,.481242,.0470841,.359903,-.0685239,.481943,.0534831,.360932,-.0764883,.482741,.0603795,.362196,-.0848364,.483688,.0678028,.363847,-.0935002,.484947,.0758086,.365972,-.102471,.486588,.0844173,.368741,-.111751,.488787,.0937199,.372146,-.121334,.491405,.103732,.377114,-.131147,.495604,.114608,.38226,-.141213,.499436,.126345,.389609,-.151632,.505334,.139116,.397925,-.162073,.51168,.152995,.407824,-.172819,.518876,.168071,.420014,-.183929,.527639,.184495,.434266,-.195032,.537588,.20232,.447352,-.205792,.544379,.221189,.463726,-.216704,.553422,.241616,.481406,-.227531,.562074,.263298,.498707,-.238017,.568227,.286116,.518039,-.247936,.574473,.3101,.538277,-.257437,.579191,.335401,.561166,-.266829,.584807,.362246,.583189,-.275329,.586476,.390609,.606024,-.28234,.585578,.420998,.632419,-.287924,.584496,.454357,.656128,-.291972,.577766,.488233,.679953,-.29456,.56875,.523248,.704654,-.295816,.558388,.559168,.729016,-.295157,.544826,.595326,.752062,-.292779,.528273,.631864,.773138,-.288681,.508482,.667793,.794869,-.283358,.487341,.704035,.815101,-.27608,.46354,.739925,.834212,-.26767,.438672,.775539,.852368,-.257397,.411239,.810895,.870207,-.245689,.3829,.846472,.884063,-.231452,.351496,.881788,.898284,-.215561,.31895,.917438,.912964,-.198208,.287367,.952422,.924666,-.180426,.254487,.987551,.934429,-.161525,.222226,1.02142,.943485,-.141197,.191143,1.05218,.9521,-.120085,.161112,1.07937,.957876,-.0975881,.130982,1.10403,.966943,-.0726842,.0990553,1.12616,.978313,-.0483705,.0662818,1.14619,.990048,-.0239072,.0329243,1.16413,.999984,461885e-9,-772859e-10,1.18099,.321287,-935049e-11,.455413,659662e-11,.332595,-237513e-9,.471437,167562e-9,.332729,-949964e-9,.471618,670192e-9,.332305,-.00213618,.471028,.00150712,.332326,-.00379765,.471055,.00267959,.332344,-.00593353,.471072,.00418751,.332356,-.00854349,.471077,.00603172,.332403,-.0116268,.471121,.00821362,.332461,-.0151824,.47117,.0107357,.332552,-.0192088,.471251,.0136014,.332657,-.0237024,.47133,.0168152,.332835,-.0286615,.471487,.0203853,.333083,-.0340765,.471708,.0243212,.333547,-.0398563,.47219,.0286518,.333989,-.0460916,.472587,.0333763,.334532,-.0527897,.473054,.0385084,.335167,-.0599284,.473568,.0440638,.33608,-.0673514,.474362,.0500962,.337146,-.0752237,.475231,.0566022,.338462,-.083418,.476282,.0636272,.34014,-.0919382,.477615,.0712153,.342341,-.100741,.479404,.079417,.345088,-.109905,.481618,.0882631,.349049,-.119369,.485081,.0978851,.353939,-.129033,.489317,.108336,.359893,-.139038,.494309,.119698,.366945,-.149411,.499983,.132024,.375814,-.159843,.507185,.145558,.387112,-.170664,.516392,.160433,.40023,-.181897,.526519,.176648,.412555,-.192785,.53423,.193922,.427023,-.203663,.542741,.212662,.443685,-.214695,.552066,.232944,.461499,-.225561,.560762,.254495,.480975,-.236257,.569421,.277531,.501,-.24639,.576101,.301724,.521691,-.256101,.581493,.327112,.543478,-.265289,.585221,.353917,.566094,-.273938,.587614,.381941,.589578,-.281679,.587991,.41172,.614583,-.287655,.585928,.444148,.641813,-.292228,.582092,.478617,.666189,-.295172,.57398,.51397,.690475,-.29648,.561676,.550118,.715543,-.296203,.548758,.586933,.740405,-.293999,.532792,.62384,.762183,-.28998,.512735,.660723,.786069,-.28478,.492402,.69807,.806812,-.277568,.469058,.734422,.826987,-.268951,.443017,.770946,.844588,-.259049,.415501,.80699,.863725,-.2471,.387328,.842107,.879137,-.234157,.356108,.878078,.894634,-.218719,.324315,.914058,.909162,-.201293,.291813,.949922,.92072,-.18267,.258474,.985337,.93158,-.163212,.225593,1.0205,.941238,-.142771,.193986,1.05273,.949293,-.120956,.163392,1.08075,.956226,-.0985743,.132934,1.10559,.96546,-.075118,.101255,1.12823,.977403,-.0497921,.0675441,1.149,.989648,-.0241574,.0334681,1.16765,1.00001,5762e-7,-184807e-9,1.18519,.303474,-916603e-11,.4542,61243e-10,.308894,-232869e-9,.462306,155592e-9,.309426,-931661e-9,.463093,622499e-9,.308643,-.0020949,.461933,.00139979,.308651,-.0037242,.461941,.00248874,.308662,-.00581873,.46195,.00388933,.308687,-.00837818,.461974,.00560247,.308728,-.0114016,.462011,.00762948,.308789,-.0148884,.462067,.00997326,.308882,-.0188369,.462151,.0126375,.309007,-.0232436,.462263,.0156271,.30918,-.0281054,.462417,.0189498,.309442,-.0334065,.462667,.0226167,.309901,-.0390589,.463162,.0266614,.310331,-.0452042,.463555,.0310715,.310858,-.0517735,.464019,.0358698,.311576,-.0587359,.464669,.0410848,.312436,-.0660383,.465406,.0467453,.313526,-.0737266,.466339,.0528718,.314903,-.0817574,.467504,.0595039,.316814,-.090167,.469226,.0666888,.318965,-.0987555,.470981,.0744658,.322077,-.107792,.473814,.082912,.325947,-.117098,.477241,.0920846,.331008,-.126602,.48184,.102137,.337893,-.136619,.488334,.113135,.345106,-.146838,.494415,.12511,.355111,-.157357,.503275,.138356,.365095,-.167955,.510966,.152686,.378344,-.179157,.521508,.16856,.391599,-.190143,.530455,.18561,.407786,-.20123,.541275,.204308,.425294,-.212456,.551784,.224623,.444021,-.223568,.561493,.246172,.463418,-.234154,.569886,.268979,.484077,-.244546,.577116,.293411,.505513,-.254301,.582914,.318936,.527672,-.263564,.587208,.345856,.550565,-.272332,.589277,.374054,.573656,-.280011,.588426,.403276,.59827,-.286924,.587504,.43474,.624731,-.291994,.583401,.468767,.652396,-.295159,.576997,.504411,.67732,-.296954,.565863,.54114,.703147,-.296877,.552316,.57816,.728715,-.295147,.536773,.616124,.752448,-.291275,.51771,.653885,.775169,-.285905,.496087,.691537,.799307,-.279064,.474232,.729251,.819482,-.270294,.447676,.766267,.837659,-.260032,.419656,.802616,.856903,-.248497,.391328,.838583,.873325,-.235252,.360285,.874711,.889788,-.221126,.329215,.91077,.904486,-.204304,.296392,.94653,.917711,-.185562,.262159,.983828,.928969,-.165635,.229142,1.01955,.939707,-.14442,.19673,1.05317,.948167,-.122147,.165095,1.0823,.955222,-.099098,.13451,1.10791,.964401,-.0755332,.102476,1.1312,.976605,-.0513817,.0689667,1.15218,.989085,-.0258499,.034506,1.17129,.999908,617773e-9,-271268e-9,1.18961,.285803,-905752e-11,.452348,572272e-11,.284689,-22732e-8,.450581,143626e-9,.285263,-910214e-9,.451482,575099e-9,.285302,-.00204784,.451553,.00129395,.285318,-.00364057,.451574,.0023006,.28533,-.00568813,.451585,.00359547,.285361,-.00819001,.451618,.00517934,.285397,-.0111458,.45165,.007054,.285447,-.0145536,.451688,.00922167,.285527,-.0184127,.451758,.0116869,.285688,-.0227207,.451929,.0144555,.28584,-.0274712,.452055,.0175341,.286136,-.0326278,.452369,.0209406,.286574,-.0381792,.452853,.0246965,.287012,-.0441879,.453272,.0287996,.287542,-.0506096,.453752,.033268,.288299,-.0573634,.454488,.0381504,.289186,-.0645458,.455294,.0434447,.290302,-.0720405,.456301,.0491973,.291776,-.0799046,.457648,.0554453,.29372,-.088117,.459483,.0622311,.296052,-.0965328,.461571,.0695992,.299563,-.105409,.465085,.077658,.30335,-.114553,.468506,.0864176,.309167,-.123917,.474423,.0961078,.31529,-.13381,.47995,.106643,.324163,-.144021,.488592,.118322,.333272,-.154382,.496461,.131133,.344224,-.165015,.50562,.145208,.357733,-.176168,.516719,.16073,.373046,-.187468,.528513,.177807,.38788,-.198488,.537713,.196072,.405133,-.209545,.547999,.21605,.423845,-.220724,.55759,.237484,.443777,-.231518,.566246,.26039,.464824,-.242035,.574326,.284835,.486635,-.251898,.58037,.310518,.51012,-.261304,.58568,.337678,.535301,-.270384,.590197,.366242,.559193,-.27841,.590569,.395873,.583544,-.285325,.588161,.426857,.608834,-.291113,.584249,.459477,.635753,-.294882,.57763,.494734,.664367,-.297088,.569479,.532023,.689688,-.297364,.555064,.569629,.715732,-.295949,.539522,.608124,.741307,-.292259,.521613,.646231,.764949,-.287063,.49969,.684938,.788599,-.28012,.476747,.723548,.81048,-.27153,.45116,.761135,.831372,-.261289,.424101,.798916,.850092,-.249559,.39443,.835952,.867777,-.236348,.363849,.871606,.884632,-.221569,.332477,.907843,.90047,-.20618,.300667,.944187,.914524,-.188771,.266552,.981371,.926892,-.168362,.232349,1.01841,.937951,-.146761,.199359,1.05308,.947236,-.123813,.1675,1.0839,.954367,-.099984,.136166,1.11047,.963907,-.0759278,.103808,1.13414,.976218,-.0511367,.0697061,1.15575,.988772,-.0267415,.0352529,1.17531,.999888,-520778e-9,289926e-9,1.19389,.263546,-883274e-11,.441896,526783e-11,.262352,-221849e-9,.439889,132311e-9,.262325,-886683e-9,.439848,528824e-9,.26228,-.00199476,.439765,.00118975,.262372,-.00354671,.439922,.00211568,.26239,-.00554141,.439941,.00330652,.262412,-.00797888,.439961,.00476346,.262453,-.0108584,.440002,.00648818,.262528,-.0141788,.440085,.0084835,.262615,-.017938,.440166,.0107533,.262744,-.0221346,.440291,.0133044,.262939,-.026762,.440493,.0161445,.263277,-.0317573,.440889,.0192974,.26368,-.0371832,.441338,.0227699,.264106,-.0430371,.441753,.0265698,.264624,-.0493035,.442227,.0307178,.265378,-.0558669,.442985,.0352616,.266253,-.0628718,.443795,.0401968,.267478,-.0701569,.445008,.04559,.269062,-.077845,.446599,.0514539,.270926,-.0857941,.448349,.0578382,.273693,-.0940773,.451221,.0648363,.276746,-.102704,.454097,.0724389,.281693,-.111735,.459517,.0808744,.287335,-.121004,.46531,.0901551,.29448,-.130734,.472605,.100371,.30257,-.140777,.480251,.111644,.312465,-.15111,.489444,.124111,.324856,-.16189,.500919,.137979,.33774,-.172946,.511317,.153163,.35255,-.184152,.522684,.169817,.367786,-.19522,.53248,.187886,.385474,-.20632,.543326,.207634,.404976,-.217744,.554109,.229165,.425203,-.228691,.563395,.252068,.446704,-.239299,.571565,.276471,.468951,-.249348,.577935,.302323,.493487,-.258933,.584309,.329882,.517861,-.268009,.58773,.358525,.543309,-.276238,.589612,.388585,.569704,-.28356,.589294,.419787,.594871,-.289497,.585137,.452114,.622555,-.294452,.580356,.486466,.651167,-.296918,.57185,.523079,.677332,-.297647,.558428,.5611,.703718,-.296321,.542232,.599592,.730262,-.293339,.524541,.639138,.754304,-.288036,.502691,.677978,.778051,-.281018,.479212,.716537,.801557,-.272414,.454071,.75586,.822559,-.262419,.425952,.794477,.843051,-.250702,.397313,.832664,.86232,-.237264,.366534,.869876,.879044,-.222716,.334816,.906973,.896362,-.206827,.303143,.943558,.910342,-.189659,.269699,.979759,.924119,-.171108,.236411,1.01718,.935374,-.149579,.202224,1.05289,.944295,-.126295,.16989,1.08496,.952227,-.101511,.138089,1.11256,.962041,-.0766392,.105053,1.1375,.97528,-.0511967,.070329,1.15983,.988476,-.025463,.0351268,1.17987,.999962,286808e-10,145564e-10,1.19901,.227089,-841413e-11,.404216,472707e-11,.239725,-215083e-9,.426708,120833e-9,.239904,-860718e-9,.427028,483555e-9,.239911,-.00193661,.427039,.00108806,.239914,-.00344276,.42704,.00193457,.239933,-.00537907,.427064,.00302363,.239944,-.00774482,.427065,.00435604,.239993,-.01054,.427122,.00593398,.240052,-.0137626,.427179,.00775987,.240148,-.0174115,.427279,.00983854,.240278,-.021484,.42741,.0121763,.240472,-.0259729,.427618,.0147827,.240839,-.0308131,.428086,.0176837,.241201,-.0360893,.428482,.0208775,.241626,-.0417723,.428907,.0243821,.242207,-.0478337,.42952,.0282228,.24298,-.0542199,.430332,.0324333,.243881,-.0610015,.431222,.0370252,.245123,-.0680874,.432512,.0420535,.24667,-.0755482,.434088,.0475414,.248779,-.0832873,.436323,.0535542,.251665,-.0913546,.439509,.0601716,.255305,-.0998489,.443478,.0674282,.260049,-.108576,.448713,.0754673,.266192,-.117754,.455524,.084339,.273158,-.127294,.4627,.0941683,.282131,-.137311,.472068,.10515,.293332,-.147736,.483565,.117402,.304667,-.158357,.493702,.130824,.317785,-.169274,.504708,.145724,.333245,-.180595,.517107,.16215,.349843,-.191892,.528849,.180149,.367944,-.203168,.540301,.199746,.387579,-.214443,.551514,.221047,.408247,-.225624,.560906,.243981,.43014,-.236422,.56959,.268513,.452669,-.24654,.576098,.294409,.476196,-.256157,.580925,.322002,.501157,-.265289,.584839,.351052,.527632,-.273671,.587614,.3812,.555754,-.281254,.589119,.412994,.581682,-.287448,.585204,.445498,.608196,-.292614,.579006,.479505,.635661,-.296068,.571297,.514643,.664999,-.297395,.560855,.552213,.691039,-.296645,.544525,.591365,.7179,-.293785,.526535,.630883,.744059,-.289089,.50545,.670932,.76863,-.282239,.482514,.710904,.793273,-.273688,.457246,.750259,.814731,-.26328,.428872,.78948,.835603,-.251526,.399384,.828597,.85489,-.238339,.368811,.866892,.872828,-.223607,.336617,.90563,.889462,-.207538,.303997,.943538,.904929,-.190297,.270812,.980591,.919101,-.172034,.237453,1.01935,.930536,-.152058,.204431,1.05498,.941223,-.129515,.172495,1.08717,.94982,-.104263,.140175,1.11551,.960592,-.0781944,.106465,1.14098,.974629,-.051688,.0711592,1.16418,.98811,-.0253929,.0354432,1.18465,1.00004,804378e-9,-330876e-9,1.20462,.214668,-821282e-11,.406619,433582e-11,.218053,-208144e-9,.413025,109887e-9,.217987,-832212e-9,.412901,439362e-9,.217971,-.00187246,.412876,988623e-9,.217968,-.00332855,.41286,.00175772,.217985,-.00520055,.412882,.00274729,.218014,-.00748814,.412916,.00395842,.218054,-.0101901,.412957,.00539274,.218106,-.0133057,.413005,.00705348,.218217,-.0168342,.413139,.00894581,.218338,-.0207707,.413258,.0110754,.21855,-.0251001,.413509,.0134551,.218913,-.0297861,.413992,.0161081,.219265,-.0348956,.414383,.0190307,.219696,-.0403909,.414839,.0222458,.220329,-.0462003,.415567,.025792,.220989,-.0524208,.41621,.0296637,.222027,-.058948,.417385,.0339323,.223301,-.0658208,.418779,.0386055,.224988,-.0730347,.420665,.0437355,.227211,-.0805274,.423198,.0493844,.230131,-.088395,.426566,.0556135,.233908,-.0966208,.43091,.0624829,.239092,-.105223,.437148,.0701636,.245315,-.11424,.444302,.0786949,.253166,-.12368,.453262,.0882382,.262374,-.133569,.463211,.0988682,.273145,-.143836,.474271,.110727,.285512,-.154577,.4863,.123945,.299512,-.165501,.498817,.138581,.314287,-.176698,.510341,.154676,.331083,-.188066,.522583,.172459,.349615,-.199597,.534879,.191979,.369318,-.210843,.546083,.21309,.390377,-.222068,.5562,.235998,.412411,-.233059,.564704,.260518,.435715,-.24357,.572314,.286795,.461196,-.253356,.579395,.314559,.485587,-.262362,.581985,.343581,.511908,-.270895,.584347,.374367,.539798,-.278452,.58505,.406015,.567974,-.284877,.583344,.439168,.594303,-.290124,.577348,.473005,.622951,-.294183,.570751,.508534,.652404,-.296389,.561541,.544764,.679291,-.296605,.546426,.582927,.706437,-.294095,.528599,.622681,.734485,-.28978,.508676,.663567,.758841,-.283363,.484768,.704092,.78537,-.275015,.460434,.745101,.807315,-.264689,.432166,.784712,.8271,-.252597,.401807,.824241,.849191,-.239154,.371458,.863803,.867046,-.224451,.338873,.903063,.8852,-.208342,.306175,.942763,.901771,-.190684,.272759,.981559,.915958,-.172105,.239306,1.02048,.928046,-.152214,.206071,1.05765,.939961,-.130247,.17367,1.08999,.948711,-.10672,.142201,1.11829,.959305,-.0808688,.108454,1.14467,.973009,-.0539145,.0728109,1.16839,.987631,-.0262947,.0360625,1.19004,.999978,.00132758,-559424e-9,1.21058,.193925,-793421e-11,.391974,392537e-11,.196746,-200315e-9,.397675,991033e-10,.19667,-801099e-9,.397521,396342e-9,.196633,-.00180246,.397445,891829e-9,.196654,-.00320443,.397482,.00158582,.196659,-.00500647,.39748,.00247867,.196683,-.0072086,.397506,.00357167,.196728,-.00981001,.397562,.00486675,.196792,-.0128096,.397633,.00636707,.19689,-.0162055,.397746,.00807752,.197017,-.0199943,.397884,.0100052,.19729,-.024139,.39827,.0121691,.197583,-.0286671,.398639,.0145755,.197927,-.0335858,.399034,.0172355,.198383,-.0388806,.399554,.0201718,.199002,-.0444736,.400289,.0234194,.199739,-.0504583,.401111,.026984,.200784,-.056729,.402349,.0309217,.202075,-.0633643,.403841,.0352496,.203898,-.0703247,.406076,.0400313,.206199,-.0775565,.408841,.0453282,.209252,-.085184,.41259,.0511794,.213638,-.0931994,.418288,.0577459,.21881,-.101617,.424681,.0650508,.225642,-.11052,.433429,.0732759,.233717,-.119772,.442897,.0824683,.242823,-.129505,.452888,.0927484,.254772,-.139906,.466407,.104417,.266603,-.150402,.477413,.117211,.28073,-.161395,.490519,.131598,.295399,-.172465,.50201,.147407,.312705,-.183982,.515311,.165031,.331335,-.195532,.52786,.184336,.351037,-.206971,.5392,.205361,.372175,-.218117,.54941,.228043,.394548,-.229327,.558642,.25267,.419598,-.240052,.567861,.279071,.443922,-.249937,.573332,.306882,.471495,-.259407,.58013,.33661,.496769,-.267749,.580564,.367328,.524951,-.275524,.581696,.399753,.55318,-.282148,.579885,.433134,.581577,-.287533,.575471,.467534,.609231,-.291612,.567445,.502943,.637478,-.293911,.557657,.53871,.667795,-.295096,.546535,.576568,.694272,-.294073,.529561,.614929,.722937,-.290386,.510561,.655909,.749682,-.284481,.487846,.697663,.774754,-.276188,.462487,.738515,.799301,-.266215,.43481,.779802,.820762,-.254116,.404879,.820045,.843231,-.240393,.374559,.860294,.861857,-.225503,.341582,.900965,.880815,-.209382,.308778,.941727,.89766,-.19155,.275232,.980916,.912926,-.172346,.240938,1.02162,.926391,-.151799,.207223,1.0597,.938429,-.129968,.17484,1.09291,.947834,-.10651,.142984,1.12248,.958432,-.0824098,.109902,1.149,.972402,-.0565242,.0744454,1.1733,.987191,-.028427,.0373794,1.19538,.999975,385685e-10,-4203e-8,1.21676,.178114,-766075e-11,.385418,354027e-11,.176074,-191966e-9,.381002,887135e-10,.17601,-767549e-9,.380861,354715e-9,.17598,-.00172696,.380798,798168e-9,.175994,-.00307012,.380824,.00141928,.176017,-.00479684,.380858,.00221859,.176019,-.00690648,.380839,.00319714,.176072,-.00939888,.380913,.0043572,.176131,-.0122726,.380979,.005702,.176239,-.0155264,.38112,.00723689,.176371,-.0191551,.381272,.00896907,.176638,-.023117,.381669,.0109194,.176912,-.0274633,.382015,.0130903,.177279,-.032173,.382476,.0154949,.17774,-.0372219,.383041,.0181669,.178344,-.0426132,.38378,.0211209,.179153,-.0483309,.384773,.0243899,.180197,-.0543447,.386076,.0280062,.181581,-.0607122,.387809,.032004,.18344,-.0673855,.390205,.036453,.186139,-.0743989,.393944,.0414162,.189432,-.0817731,.39832,.0469394,.193795,-.0895464,.404188,.0531442,.199641,-.0978264,.4121,.0601374,.206679,-.106499,.421425,.0680078,.214865,-.115654,.431504,.076919,.224406,-.125268,.442526,.0868835,.235876,-.135475,.455465,.0981875,.248335,-.146023,.4681,.110759,.262868,-.157016,.482069,.124885,.278962,-.168245,.496182,.140645,.295082,-.17958,.507401,.157838,.313738,-.191227,.520252,.17695,.333573,-.202718,.531708,.197817,.356433,-.214424,.544509,.220785,.378853,-.225492,.55373,.245306,.402717,-.236236,.561348,.271593,.428375,-.246568,.568538,.299776,.454724,-.255941,.573462,.329433,.482291,-.264511,.576356,.360598,.509706,-.272129,.576446,.393204,.538805,-.278979,.575298,.427227,.568919,-.284528,.572154,.462157,.596804,-.288801,.564691,.497997,.625987,-.291334,.555134,.534467,.656414,-.292722,.545051,.571736,.683916,-.292185,.528813,.610158,.711809,-.290043,.51106,.649061,.739547,-.285246,.490103,.690081,.766914,-.277647,.465523,.732554,.791375,-.267603,.437718,.773982,.814772,-.256109,.40882,.81609,.836691,-.242281,.377823,.856849,.856984,-.227155,.34496,.898363,.876332,-.210395,.311335,.939471,.894988,-.192612,.277703,.980799,.911113,-.173236,.243019,1.02215,.924092,-.152258,.209037,1.06139,.936828,-.129575,.175909,1.09635,.946869,-.10594,.143852,1.12707,.958284,-.081318,.110289,1.15419,.972325,-.0556133,.0747232,1.17909,.986878,-.0297899,.0383149,1.20163,.999936,-.00197169,912402e-9,1.22338,.151174,-720365e-11,.351531,309789e-11,.155594,-18279e-8,.361806,78608e-9,.156099,-731569e-9,.362982,314615e-9,.156053,-.00164578,.362869,707845e-9,.156093,-.0029261,.362961,.00125884,.156099,-.00457155,.362959,.00196783,.15612,-.00658224,.362982,.00283622,.156168,-.00895774,.363048,.00386625,.156221,-.0116962,.363101,.00506109,.156324,-.0147973,.363241,.00642675,.156476,-.0182503,.363448,.00797175,.156731,-.0220266,.36384,.00971484,.156994,-.026176,.364179,.0116575,.157341,-.0306701,.36462,.0138207,.157867,-.0354591,.365364,.0162356,.15846,-.0406141,.366111,.0189092,.159308,-.0460519,.367248,.021885,.160426,-.0518096,.368767,.0252004,.161877,-.0578906,.370745,.0288825,.163995,-.0642812,.373831,.0330139,.16655,-.0710067,.377366,.0376283,.170237,-.0781522,.382799,.0428493,.175096,-.0857172,.389915,.0487324,.181069,-.0938025,.398487,.0554214,.188487,-.102363,.408799,.0630189,.197029,-.111343,.419991,.071634,.206684,-.120812,.431455,.0812797,.218698,-.131033,.445746,.0923651,.230726,-.141373,.457471,.104545,.245516,-.152387,.472388,.118449,.261551,-.163628,.486671,.133923,.277437,-.174814,.49762,.150849,.296662,-.186713,.51162,.169924,.31795,-.198513,.525435,.190848,.339422,-.210119,.536267,.213504,.362143,-.221354,.545982,.237947,.387198,-.23224,.555364,.264427,.412349,-.24257,.561489,.292519,.439274,-.252284,.566903,.322561,.466779,-.261023,.569614,.353952,.496011,-.26899,.571589,.387278,.524964,-.275498,.570325,.421356,.556518,-.281449,.568792,.457314,.584363,-.285526,.560268,.493199,.614214,-.28844,.55205,.530276,.645684,-.289777,.541906,.56855,.673446,-.289722,.526464,.606927,.701924,-.287792,.509872,.645945,.73037,-.284315,.490649,.685564,.757405,-.278804,.467964,.726511,.784025,-.269543,.441468,.768601,.808255,-.258117,.41216,.811321,.830739,-.244728,.380606,.853496,.851914,-.229428,.348111,.895374,.872586,-.212508,.314732,.937674,.891581,-.194025,.280338,.979869,.907641,-.174711,.245203,1.02253,.922233,-.153509,.21077,1.06371,.935878,-.130418,.177399,1.09972,.946338,-.105558,.144507,1.13124,.957265,-.080059,.110508,1.15973,.971668,-.0539766,.0742311,1.18515,.9866,-.0277101,.0375224,1.20858,1.00021,-515531e-9,135226e-9,1.23135,.137468,-686011e-11,.345041,273315e-11,.13703,-173378e-9,.343936,690761e-10,.136986,-693048e-9,.34383,276126e-9,.136964,-.00155931,.343761,621337e-9,.137003,-.00277211,.343863,.00110494,.137012,-.00433103,.343868,.00172744,.137043,-.00623606,.343916,.00249022,.13709,-.0084868,.343986,.00339559,.137145,-.0110814,.344045,.00444687,.137242,-.0140187,.344177,.00565007,.137431,-.0172713,.344491,.00701868,.137644,-.0208605,.344805,.00856042,.13791,-.024792,.345172,.0102863,.138295,-.0290461,.345734,.0122185,.138764,-.0335957,.346371,.0143771,.139415,-.038467,.347298,.0167894,.140272,-.0436176,.348527,.0194895,.141457,-.0491016,.350276,.0225043,.14303,-.0548764,.352646,.0258962,.145289,-.0610096,.356206,.0297168,.148502,-.0674777,.361488,.0340562,.152188,-.074345,.367103,.0389534,.157359,-.0817442,.375247,.0445541,.16379,-.0896334,.385064,.0509535,.171376,-.098005,.396082,.0582611,.179901,-.106817,.407418,.06654,.189892,-.116239,.420031,.075994,.201838,-.12627,.434321,.0867239,.214311,-.136701,.447631,.0987517,.228902,-.147616,.462046,.112353,.245107,-.158871,.476942,.127605,.262292,-.170261,.490285,.144469,.281215,-.182017,.503783,.163282,.301058,-.193729,.515505,.183873,.322752,-.205512,.52682,.206466,.347547,-.217214,.539473,.231194,.370969,-.227966,.546625,.257288,.397533,-.238555,.55472,.285789,.42398,-.248278,.559468,.315746,.452928,-.257422,.564095,.347724,.482121,-.265306,.565426,.380922,.510438,-.272043,.563205,.415639,.541188,-.277614,.561087,.451702,.571667,-.281927,.554922,.48845,.602432,-.285015,.546838,.526442,.634126,-.286512,.537415,.564896,.662816,-.286388,.522906,.604037,.692411,-.284734,.507003,.643795,.720946,-.281297,.488398,.68298,.748293,-.276262,.466353,.723466,.776931,-.269978,.443573,.764565,.801065,-.260305,.415279,.805838,.825843,-.247426,.384773,.849985,.84807,-.232437,.352555,.893174,.869122,-.215806,.318642,.936564,.888963,-.197307,.28381,.980253,.905547,-.177203,.247888,1.02463,.918554,-.155542,.212904,1.06714,.931395,-.131948,.1787,1.10451,.941749,-.106723,.145902,1.13694,.954551,-.0804939,.111193,1.1666,.970279,-.0534239,.0744697,1.19249,.986117,-.0257452,.0368788,1.21665,.999938,.00190634,-.0010291,1.23981,.118493,-647439e-11,.32272,23772e-10,.118765,-163023e-9,.323456,598573e-10,.118772,-65212e-8,.323477,239447e-9,.118843,-.00146741,.323657,538881e-9,.118804,-.00260846,.323553,95826e-8,.118826,-.00407576,.323595,.00149845,.118846,-.00586826,.323617,.00216047,.118886,-.00798578,.32367,.00294679,.118947,-.0104273,.323753,.00386124,.119055,-.0131909,.323922,.00490999,.119241,-.0162444,.324251,.00610804,.11944,-.0196339,.324544,.00745805,.119739,-.0233378,.325026,.00897805,.12011,-.0273179,.325586,.0106895,.120571,-.0316143,.326231,.0126073,.12124,-.0361939,.327264,.0147654,.122162,-.0410511,.328733,.0172001,.123378,-.0462233,.330659,.0199375,.125183,-.0517109,.333754,.0230498,.127832,-.0575652,.338507,.026597,.130909,-.0637441,.343666,.0306345,.135221,-.0704302,.351063,.035273,.14082,-.0776364,.360604,.0406137,.146781,-.0852293,.369638,.0466788,.155121,-.0935351,.3827,.0537628,.16398,-.102234,.39522,.0617985,.173926,-.111465,.40793,.07097,.185137,-.121296,.42105,.0813426,.19826,-.13169,.435735,.0931596,.212938,-.142614,.450932,.106547,.229046,-.153884,.465726,.121575,.246246,-.165382,.479461,.138286,.264637,-.176806,.492106,.15666,.284959,-.188793,.504774,.17728,.308157,-.200763,.518805,.19988,.330951,-.21239,.528231,.224293,.3549,-.223521,.536376,.250541,.381502,-.234169,.544846,.278902,.409529,-.244077,.551717,.309227,.437523,-.253363,.55517,.341426,.467624,-.261659,.557772,.37518,.497268,-.268498,.556442,.41007,.528294,-.274018,.553915,.446445,.559053,-.278169,.549153,.483779,.589329,-.281229,.539878,.522249,.622503,-.282902,.53162,.561754,.652382,-.282815,.518119,.601544,.681847,-.281247,.502187,.641574,.712285,-.277986,.484824,.682633,.740094,-.273017,.463483,.723426,.768478,-.266692,.441299,.763747,.794556,-.258358,.415238,.805565,.819408,-.248807,.386912,.847254,.843411,-.236214,.356165,.891091,.862397,-.219794,.320562,.936174,.883113,-.201768,.285322,.982562,.90023,-.181672,.249713,1.02862,.915192,-.159279,.214546,1.07163,.928458,-.134725,.180285,1.10995,.94069,-.10913,.147119,1.14354,.953409,-.0821315,.112492,1.17372,.969537,-.0542677,.0752014,1.20043,.985612,-.0259096,.0370361,1.22528,.999835,.00298198,-.00151801,1.24959,.10097,-602574e-11,.300277,202619e-11,.101577,-152164e-9,.302077,511662e-10,.101572,-608889e-9,.302066,204751e-9,.101566,-.00136997,.302047,460753e-9,.101592,-.00243557,.302114,819497e-9,.101608,-.0038053,.30214,.00128154,.101627,-.00547906,.30216,.0018483,.101669,-.00745647,.302224,.00252223,.101732,-.00973615,.302318,.00330716,.101844,-.0123097,.302513,.00421061,.102025,-.0151681,.30285,.00524481,.102224,-.0183334,.303166,.0064154,.102515,-.0217819,.303654,.00774063,.102886,-.0255067,.304243,.0092398,.103395,-.029514,.305089,.0109339,.104109,-.0337912,.306301,.0128561,.105074,-.0383565,.30798,.0150338,.10654,-.0432132,.310726,.0175228,.108478,-.0484244,.314351,.0203648,.111015,-.0539339,.319032,.0236325,.114682,-.0598885,.32605,.0274188,.11911,-.0663375,.334109,.0317905,.124736,-.0733011,.344013,.0368502,.131479,-.0807744,.355358,.0427104,.139283,-.0888204,.367614,.0494788,.148054,-.0973394,.380072,.0572367,.159037,-.10665,.395678,.0662704,.169794,-.116221,.40795,.0763192,.18314,-.126632,.423546,.087956,.197515,-.137383,.438213,.101042,.213514,-.148641,.453248,.115827,.23065,-.160117,.46688,.132283,.249148,-.171807,.479962,.150644,.270219,-.183695,.494618,.171073,.292338,-.195574,.506937,.193378,.314999,-.207205,.516463,.217585,.340991,-.218955,.528123,.24428,.367982,-.229917,.537025,.272784,.39432,-.239737,.541627,.302742,.423364,-.249048,.546466,.335112,.453751,-.257329,.549466,.369032,.48416,-.264623,.549503,.404577,.515262,-.270411,.547008,.441337,.547036,-.274581,.542249,.479162,.576614,-.277266,.533015,.517904,.611143,-.279144,.525512,.558508,.640989,-.279001,.51154,.598995,.671182,-.277324,.495641,.639935,.700848,-.273908,.477526,.681017,.729862,-.269063,.457955,.722764,.758273,-.262282,.434846,.764349,.784121,-.254281,.409203,.806206,.809798,-.24505,.382694,.848617,.834953,-.233861,.354034,.892445,.856817,-.221308,.321764,.936263,.877609,-.205996,.288118,.982401,.897489,-.186702,.253277,1.02975,.913792,-.164618,.217963,1.07488,.92785,-.140023,.183221,1.11487,.940378,-.11328,.149385,1.14947,.95273,-.0853958,.114152,1.1807,.969059,-.0568698,.0769845,1.20912,.985574,-.0276502,.0381186,1.23498,.999943,.00239052,-.00126861,1.25987,.0852715,-560067e-11,.279021,171162e-11,.0854143,-140871e-9,.279483,430516e-10,.0854191,-563385e-9,.2795,172184e-9,.0854188,-.00126753,.279493,387464e-9,.0854229,-.00225337,.279501,68918e-8,.0854443,-.00352086,.279549,.00107803,.0854697,-.00506962,.279591,.00155536,.0855093,-.00689873,.279652,.00212354,.0855724,-.00900821,.279752,.00278703,.0856991,-.0113799,.280011,.0035551,.085855,-.0140314,.280297,.00443449,.0860682,-.016963,.280682,.00543636,.086344,-.0201438,.281159,.0065788,.0867426,-.0235999,.281886,.00787977,.087239,-.0273069,.282745,.0093606,.0879815,-.031269,.284139,.011056,.0891258,-.035531,.28647,.0130065,.0906909,-.0400947,.289708,.0152495,.0927624,-.0449638,.293904,.0178454,.0958376,-.0502427,.300471,.0208915,.0995827,-.0559514,.30806,.0244247,.104526,-.0622152,.317874,.0285721,.110532,-.0690046,.329332,.0334227,.117385,-.0763068,.341217,.0390466,.12522,-.084184,.353968,.0455786,.134037,-.0925248,.366797,.0530773,.144014,-.101487,.380209,.0617424,.156013,-.111273,.395956,.071777,.168872,-.121431,.41053,.0830905,.183089,-.132105,.425073,.0959341,.198763,-.143286,.439833,.110448,.216159,-.154841,.454507,.126769,.234859,-.166588,.468368,.14495,.255879,-.178626,.482846,.165233,.27677,-.190218,.493489,.187217,.301184,-.202227,.506549,.211659,.325852,-.213764,.5158,.237922,.352824,-.22487,.525442,.26632,.380882,-.235246,.532487,.296691,.410137,-.244847,.537703,.329179,.439787,-.253122,.540361,.363135,.472291,-.260517,.542734,.399222,.501856,-.266519,.538826,.436352,.534816,-.270905,.535152,.474505,.565069,-.273826,.525979,.513988,.597154,-.275333,.516394,.554852,.630473,-.275314,.506206,.596592,.660574,-.273323,.489769,.638117,.692015,-.270008,.472578,.680457,.720647,-.265001,.452134,.723008,.750528,-.258311,.430344,.765954,.777568,-.250046,.405624,.809012,.80387,-.240114,.378339,.852425,.828439,-.228737,.349877,.895346,.851472,-.216632,.318968,.940695,.873906,-.202782,.287489,.987235,.89467,-.187059,.254394,1.03348,.912281,-.168818,.221294,1.07812,.927358,-.146494,.18675,1.11928,.940385,-.120009,.152322,1.15609,.952672,-.0917183,.117514,1.18875,.968496,-.0620321,.0797405,1.21821,.985236,-.0314945,.0402383,1.24523,.99998,-575153e-9,110644e-9,1.27133,.0702429,-512222e-11,.255273,140947e-11,.0702981,-128826e-9,.255469,354488e-10,.0703691,-515562e-9,.255727,141874e-9,.0703805,-.00116,.255754,31929e-8,.0703961,-.00206224,.255813,567999e-9,.0704102,-.00322223,.255839,88871e-8,.0704298,-.00463928,.255863,.00128272,.0704759,-.00631375,.255953,.00175283,.0705434,-.00824317,.256079,.00230342,.0706693,-.010412,.25636,.0029443,.0708189,-.0128439,.256647,.00368031,.0710364,-.0155177,.257084,.00452614,.0713223,-.0184374,.257637,.00549706,.0717182,-.0216002,.258416,.00661246,.072321,-.0249966,.259699,.00790147,.0731446,-.0286566,.261475,.0093884,.0743352,-.0325888,.264132,.0111186,.0760676,-.036843,.26815,.013145,.078454,-.0414292,.273636,.0155251,.0818618,-.0464634,.281653,.0183525,.0857382,-.0519478,.289992,.0216642,.0908131,-.0579836,.30066,.0255956,.0967512,-.0645124,.312204,.0301954,.103717,-.0716505,.325001,.0356017,.111596,-.0793232,.338129,.041896,.120933,-.087645,.352853,.0492447,.130787,-.096492,.366192,.0576749,.142311,-.105973,.380864,.0673969,.155344,-.116182,.396575,.0785899,.169535,-.126815,.411443,.0912377,.185173,-.138015,.426256,.105607,.201755,-.149325,.439607,.121551,.221334,-.161207,.455467,.139608,.241461,-.173162,.469096,.159591,.26294,-.18504,.481014,.18156,.286776,-.196881,.493291,.205781,.311596,-.208311,.503556,.231819,.338667,-.219671,.513268,.260274,.366021,-.230451,.519414,.290862,.395875,-.240131,.526766,.323196,.425564,-.248566,.52905,.357071,.457094,-.256195,.530796,.393262,.488286,-.262331,.528703,.430797,.522291,-.267141,.52727,.470231,.554172,-.270411,.519848,.510477,.586427,-.271986,.510307,.551594,.619638,-.27192,.499158,.593849,.650656,-.269817,.483852,.636314,.68284,-.266267,.467515,.679679,.714356,-.26113,.44931,.723884,.742717,-.254067,.425789,.767245,.770894,-.245652,.401144,.811819,.797358,-.235554,.374224,.856315,.823377,-.223896,.346167,.901077,.847456,-.210865,.316056,.946502,.870697,-.196574,.284503,.993711,.891068,-.180814,.251628,1.04134,.909267,-.163314,.219065,1.08609,.925653,-.143304,.186446,1.12702,.940017,-.121322,.153416,1.16371,.952398,-.0973872,.120334,1.19712,.967568,-.0698785,.08352,1.22791,.984772,-.0390031,.0439209,1.25672,1.00026,-.0070087,.00315668,1.28428,.0556653,-459654e-11,.227325,112556e-11,.0565238,-116382e-9,.230826,284985e-10,.0565717,-465666e-9,.231026,114036e-9,.0565859,-.00104773,.231079,256656e-9,.0565761,-.00186255,.231025,45663e-8,.0565913,-.00291002,.231058,714664e-9,.0566108,-.00418998,.231085,.00103224,.0566532,-.00570206,.231169,.00141202,.0567473,-.00743666,.231417,.00186018,.0568567,-.00940298,.231661,.00238264,.0569859,-.0115991,.231895,.00298699,.0572221,-.0140096,.232456,.00368957,.057519,-.0166508,.233096,.00450303,.0579534,-.01951,.234094,.00544945,.0585922,-.0225991,.235629,.00655564,.0595647,-.0259416,.238106,.00785724,.0609109,-.0295661,.241557,.00939127,.0628751,-.0335126,.246652,.0112198,.0656908,-.0378604,.254091,.0134168,.0691347,-.0426543,.262666,.0160374,.0732165,-.0478967,.272029,.0191514,.0782863,-.0536716,.283007,.0228597,.0843973,-.0600683,.295732,.0272829,.0913598,-.0670095,.308779,.032484,.0994407,-.0745516,.322886,.0385886,.108189,-.082712,.336408,.0457133,.118574,-.0914927,.351692,.0539832,.129989,-.100854,.366502,.0635162,.142722,-.110837,.381675,.0744386,.156654,-.121353,.3963,.0868483,.172151,-.132414,.411477,.100963,.188712,-.143809,.42508,.116795,.208093,-.155765,.441328,.134715,.227936,-.167608,.454328,.154396,.249495,-.179579,.467235,.176179,.27362,-.191488,.480248,.200193,.296371,-.202618,.487886,.225775,.324234,-.214133,.499632,.25441,.353049,-.225212,.509532,.285077,.381785,-.234875,.514265,.317047,.414038,-.244205,.521282,.351874,.445251,-.252145,.522931,.388279,.476819,-.258433,.520947,.425825,.509209,-.263411,.517669,.465104,.542759,-.266732,.512841,.505741,.574822,-.268263,.503317,.547611,.609324,-.268489,.493035,.590953,.641772,-.266941,.478816,.63488,.674049,-.263297,.462863,.679072,.705071,-.257618,.442931,.723487,.734709,-.250625,.421299,.768708,.763704,-.24179,.397085,.814375,.791818,-.231115,.370577,.859907,.817439,-.21922,.34232,.906715,.843202,-.205658,.312627,.953943,.866639,-.190563,.280933,1.00185,.888129,-.173978,.248393,1.05105,.907239,-.155485,.216007,1.09704,.923893,-.134782,.183233,1.13857,.938882,-.11249,.150376,1.17539,.952464,-.0890706,.117177,1.20924,.968529,-.0646523,.0813095,1.24055,.984763,-.038606,.0439378,1.27018,1.00053,-.01238,.00598668,1.29873,.0437928,-409594e-11,.204012,8.79224e-7,.0440166,-103395e-9,.205049,221946e-10,.0440529,-413633e-9,.205225,887981e-10,.0440493,-930594e-9,.2052,199858e-9,.0439884,-.00165352,.204901,355495e-9,.0440716,-.0025849,.205255,556983e-9,.0440968,-.00372222,.205311,805326e-9,.0441359,-.00506478,.205391,.00110333,.0442231,-.00660384,.205638,.00145768,.0443254,-.00835246,.205877,.00187275,.0444832,-.0102992,.20627,.00235938,.0447001,-.0124449,.206796,.0029299,.0450168,-.0147935,.207593,.0036005,.0454816,-.017336,.208819,.00439246,.0462446,-.0201156,.211036,.00533864,.0473694,-.0231568,.214388,.00646984,.0490191,-.0264941,.219357,.00783856,.0512776,-.030184,.226061,.00950182,.0541279,-.0342661,.234094,.0115156,.0578989,-.0388539,.244297,.0139687,.0620835,-.0438735,.254457,.0169015,.0673497,-.04951,.266706,.0204554,.0731759,-.0556263,.278753,.0246606,.0803937,-.0624585,.29309,.0297126,.0879287,-.0697556,.305856,.0355868,.0970669,-.0778795,.321059,.0425768,.106508,-.0863541,.333873,.05056,.11776,-.0955935,.349008,.0598972,.130081,-.105438,.363776,.0706314,.144454,-.115899,.380112,.0828822,.1596,-.126827,.394843,.0967611,.176097,-.138161,.409033,.112381,.194726,-.149904,.424257,.129952,.213944,-.161675,.436945,.149333,.235516,-.173659,.450176,.170892,.260564,-.185963,.466305,.194984,.285183,-.197582,.477328,.220805,.311095,-.208697,.486566,.248694,.338924,-.219519,.494811,.279015,.369757,-.229766,.504065,.311725,.3996,-.238879,.507909,.345844,.430484,-.246802,.509805,.381749,.46413,-.253924,.511436,.420251,.497077,-.259319,.508787,.459957,.530434,-.263297,.50394,.501356,.565725,-.265619,.49804,.544252,.599254,-.265842,.487346,.587856,.631251,-.263978,.472975,.631969,.663972,-.26043,.457135,.677471,.697724,-.255358,.439844,.723744,.727725,-.248308,.417872,.770653,.756417,-.239181,.39273,.817357,.785419,-.22814,.367839,.864221,.81266,-.215681,.339449,.912701,.839391,-.201623,.309279,.962419,.86366,-.185624,.278029,1.0122,.885028,-.16797,.245294,1.06186,.904639,-.148336,.212689,1.10934,.922048,-.12637,.179616,1.15063,.936952,-.102928,.146749,1.18885,.951895,-.0785268,.112733,1.22352,.967198,-.0530153,.0760056,1.25681,.984405,-.02649,.0383183,1.28762,1.00021,70019e-8,-20039e-8,1.31656,.0325964,-355447e-11,.176706,6.55682e-7,.0329333,-899174e-10,.178527,165869e-10,.0329181,-359637e-9,.178453,663498e-10,.0329085,-808991e-9,.178383,149332e-9,.0329181,-.00143826,.178394,265873e-9,.0329425,-.00224678,.178517,416597e-9,.0329511,-.00323575,.17849,603299e-9,.033011,-.00439875,.178695,829422e-9,.0330733,-.00574059,.178843,.00109908,.0331857,-.00725896,.179176,.00141933,.0333445,-.00895289,.179618,.0017999,.0335674,-.0108219,.180238,.00225316,.033939,-.0128687,.181417,.00279765,.0345239,-.015114,.183395,.0034564,.0354458,-.017596,.186616,.00425864,.0368313,-.0203524,.191547,.00524936,.0386115,-.0234105,.197508,.00647033,.0410303,-.0268509,.205395,.00798121,.0442245,-.0307481,.215365,.0098557,.0478659,-.0350863,.225595,.0121417,.0522416,-.0399506,.236946,.0149385,.0574513,-.045357,.249442,.0183189,.0631208,-.0512863,.261222,.0223644,.0701124,-.0579273,.275418,.0272418,.0777331,-.0650652,.288989,.0329458,.0862709,-.0728813,.302546,.0396819,.096103,-.081363,.317164,.04757,.106976,-.0904463,.331733,.0567012,.119175,-.100105,.34661,.067202,.132919,-.110375,.362249,.0792588,.147727,-.121115,.376978,.0928672,.163618,-.132299,.390681,.108228,.182234,-.143887,.406571,.125502,.201809,-.155827,.42042,.144836,.225041,-.168357,.438411,.166706,.247621,-.18004,.450368,.189909,.27097,-.191536,.460083,.215251,.296658,-.203024,.469765,.243164,.325892,-.214056,.481837,.273388,.35406,-.224104,.487474,.305344,.384372,-.233489,.492773,.339741,.41749,-.241874,.498451,.376287,.45013,-.248834,.499632,.414195,.481285,-.254658,.495233,.454077,.519183,-.259367,.496401,.496352,.551544,-.261818,.487686,.538798,.587349,-.262964,.479453,.583626,.621679,-.262128,.467709,.629451,.654991,-.258998,.452123,.67566,.686873,-.254119,.433495,.723248,.719801,-.246946,.413657,.771156,.750355,-.237709,.390366,.81989,.780033,-.226549,.364947,.868601,.809254,-.214186,.337256,.920034,.836576,-.199639,.307395,.971706,.861774,-.183169,.275431,1.02479,.885707,-.165111,.243431,1.07837,.904742,-.144363,.210921,1.12783,.915604,-.121305,.17647,1.17254,.930959,-.0962119,.143106,1.21012,.948404,-.069969,.108112,1.24474,.967012,-.0427586,.0708478,1.27718,.984183,-.0147043,.032335,1.3083,.999577,.0142165,-.00726867,1.3382,.0229227,-299799e-11,.148623,4.62391e-7,.0232194,-758796e-10,.15054,117033e-10,.0232315,-303636e-9,.15063,468397e-10,.0232354,-683189e-9,.150624,105472e-9,.0232092,-.0012136,.150445,187744e-9,.0232523,-.00189765,.150679,294847e-9,.0232828,-.00273247,.150789,428013e-9,.0233371,-.00371287,.150995,591134e-9,.0234015,-.00484794,.15118,787642e-9,.023514,-.00612877,.151562,.00102547,.023679,-.00756125,.152116,.00131351,.0239559,-.00914651,.153162,.00166594,.0244334,-.010904,.155133,.00210182,.025139,-.0128615,.158035,.00264406,.0262598,-.0150628,.162751,.00332923,.0277875,-.0175532,.168944,.00419773,.0298472,-.0203981,.176835,.00530034,.0325444,-.023655,.186686,.00669777,.0355581,-.0272982,.196248,.00842661,.0392841,-.0314457,.207352,.0105854,.0436815,-.0361157,.219279,.0132458,.0485272,-.0412932,.230728,.0164736,.0541574,-.0470337,.242994,.0203715,.0609479,-.0535002,.257042,.0250953,.0685228,-.0605409,.27102,.0306856,.0768042,-.0680553,.28406,.037193,.0864844,-.0765011,.299186,.0449795,.0969415,-.0852674,.3132,.0538316,.108478,-.0947333,.327138,.0641149,.121705,-.10481,.342345,.0759185,.136743,-.115474,.358472,.0894116,.152986,-.126536,.374067,.104562,.170397,-.138061,.388267,.121632,.191392,-.150203,.406467,.140996,.211566,-.161751,.418641,.161696,.233567,-.173407,.430418,.184557,.257769,-.185397,.44277,.210092,.28531,-.197048,.457191,.237827,.311726,-.20784,.464712,.267253,.340537,-.218345,.472539,.299332,.372921,-.228306,.482331,.333988,.402924,-.236665,.484378,.369722,.434475,-.244097,.484717,.407836,.469736,-.250547,.487093,.448465,.505045,-.25511,.485575,.490263,.540262,-.258444,.481225,.534495,.576347,-.259903,.473481,.579451,.608656,-.259572,.4603,.625604,.646679,-.257908,.450341,.674511,.679902,-.253663,.431561,.723269,.714159,-.247419,.412684,.773263,.745345,-.239122,.389388,.824182,.778248,-.228837,.365361,.876634,.807208,-.216197,.337667,.92945,.835019,-.201772,.307197,.985261,.860261,-.185291,.274205,1.04299,.877601,-.165809,.240178,1.09816,.898211,-.143897,.207571,1.14694,.915789,-.119513,.174904,1.19008,.931831,-.0932919,.141423,1.2297,.949244,-.0656528,.105603,1.26553,.967527,-.0370262,.0679551,1.29986,.984139,-.00730117,.0283133,1.33252,.999713,.0234648,-.0121785,1.36397,.0152135,-245447e-11,.122795,3.04092e-7,.0151652,-615778e-10,.122399,76292e-10,.0151181,-245948e-9,.122023,304802e-10,.0151203,-553394e-9,.12203,686634e-10,.015125,-983841e-9,.122037,122463e-9,.0151427,-.00153774,.12214,192706e-9,.0151708,-.0022103,.122237,281219e-9,.0152115,-.00300741,.12238,390804e-9,.0152877,-.00392494,.1227,526317e-9,.015412,-.00496597,.123244,69443e-8,.0156201,-.00613314,.124228,90547e-8,.0159658,-.00744113,.125945,.0011732,.0165674,-.00892546,.129098,.00151888,.017487,-.010627,.133865,.00197007,.018839,-.0126043,.140682,.0025637,.020554,-.0148814,.148534,.00333637,.0226727,-.0175123,.157381,.00433738,.0251879,-.0205266,.166685,.00561664,.0283635,-.0240319,.177796,.00725563,.0318694,-.0279432,.188251,.00928811,.0361044,-.0324313,.200038,.011835,.0406656,-.0373527,.210685,.0149146,.0463846,-.0430132,.224182,.0187254,.0525696,-.0491013,.23634,.0232283,.0598083,-.0559175,.250013,.0286521,.0679437,-.0633657,.263981,.0350634,.0771181,-.0714602,.278072,.0425882,.0881273,-.0803502,.29511,.0514487,.0996628,-.0896903,.309976,.0615766,.112702,-.099644,.325611,.0732139,.126488,-.109829,.339321,.0862324,.142625,-.120859,.35574,.101275,.15953,-.131956,.369845,.117892,.176991,-.143145,.38146,.136205,.199715,-.155292,.40052,.157252,.220787,-.167066,.412055,.179966,.243697,-.178396,.423133,.204418,.272106,-.190433,.439524,.232141,.297637,-.201265,.447041,.261109,.325273,-.211834,.454488,.292627,.357219,-.221889,.465004,.326669,.387362,-.230729,.468527,.362426,.423131,-.23924,.475836,.401533,.45543,-.246067,.475017,.441902,.493393,-.251557,.478017,.484239,.526253,-.255571,.4709,.528586,.560554,-.257752,.463167,.574346,.599306,-.258076,.456452,.621655,.634541,-.256471,.443725,.670492,.668907,-.253283,.428719,.721943,.705619,-.247562,.411348,.772477,.739034,-.240626,.388939,.8264,.771408,-.231493,.36425,.881702,.803312,-.220125,.337321,.9385,.828457,-.206645,.305364,.997437,.854819,-.190664,.273715,1.05693,.878666,-.171429,.242218,1.11251,.898404,-.149235,.209556,1.16398,.917416,-.12435,.176863,1.21014,.933133,-.0972703,.142775,1.25178,.95066,-.0683607,.106735,1.29028,.968589,-.0378724,.0681609,1.32703,.984776,-.00605712,.0273966,1.36158,.99994,.0263276,-.0138124,1.3943,.00867437,-186005e-11,.0928979,1.73682e-7,.00864003,-466389e-10,.0925237,435505e-11,.00864593,-186594e-9,.0925806,174322e-10,.00864095,-419639e-9,.0924903,392862e-10,.00863851,-746272e-9,.0924589,702598e-10,.00868531,-.00116456,.0929,111188e-9,.00869667,-.00167711,.0928529,163867e-9,.00874332,-.00228051,.0930914,23104e-8,.00882709,-.00297864,.0935679,31741e-8,.00898874,-.00377557,.0946165,430186e-9,.00929346,-.00469247,.0967406,580383e-9,.00978271,-.00575491,.100084,783529e-9,.0105746,-.00701514,.105447,.00106304,.0116949,-.00851797,.112494,.00144685,.0130419,-.0102757,.119876,.00196439,.0148375,-.012381,.129034,.00266433,.0168725,-.01482,.137812,.00358364,.0193689,-.0176563,.147696,.00478132,.0222691,-.0209211,.157795,.00631721,.0256891,-.0246655,.168431,.00826346,.0294686,-.0288597,.178587,.0106714,.0340412,-.0336441,.190251,.0136629,.0393918,-.039033,.202999,.0173272,.0453947,-.0450087,.215655,.0217448,.0521936,-.0515461,.228686,.0269941,.0600279,-.058817,.242838,.033272,.0692398,-.0667228,.258145,.0406457,.0793832,-.0752401,.273565,.0492239,.0902297,-.0841851,.287735,.0590105,.102014,-.0936479,.301161,.0702021,.116054,-.103967,.317438,.0832001,.13191,-.114622,.334166,.0977951,.148239,-.125452,.348192,.113985,.165809,-.136453,.361094,.131928,.184616,-.147648,.373534,.151811,.207491,-.159607,.39101,.174476,.230106,-.171119,.402504,.198798,.257036,-.182906,.418032,.225796,.281172,-.193605,.425468,.254027,.312034,-.204771,.440379,.285713,.340402,-.214988,.445406,.319196,.370231,-.224711,.44968,.35537,.407105,-.233516,.460747,.393838,.439037,-.240801,.460624,.433747,.47781,-.24762,.465957,.477234,.510655,-.251823,.460054,.52044,.550584,-.255552,.459172,.567853,.585872,-.257036,.450311,.615943,.620466,-.257535,.437763,.667693,.660496,-.255248,.426639,.718988,.695578,-.251141,.409185,.772503,.732176,-.244718,.39015,.827023,.760782,-.236782,.362594,.885651,.79422,-.225923,.33711,.943756,.824521,-.213855,.308272,1.00874,.854964,-.197723,.278529,1.06764,.878065,-.179209,.246208,1.12836,.899834,-.157569,.21329,1.18318,.918815,-.133206,.181038,1.23161,.934934,-.106545,.146993,1.27644,.952115,-.0780574,.111175,1.31842,.96906,-.0478279,.0728553,1.35839,.985178,-.0160014,.032579,1.39697,1.00039,.0173126,-.0095256,1.43312,.00384146,-124311e-11,.0613583,7.78271e-8,.00390023,-314043e-10,.0622919,196626e-11,.00389971,-125622e-9,.0622632,787379e-11,.00389491,-282352e-9,.0620659,1778e-8,.00391618,-502512e-9,.0624687,320918e-10,.00392662,-784458e-9,.0625113,515573e-10,.00396053,-.00112907,.0628175,778668e-10,.00401911,-.00153821,.0633286,113811e-9,.00414994,-.0020208,.0646443,16445e-8,.00441223,-.00260007,.0673886,237734e-9,.00484427,-.0033097,.0716528,345929e-9,.00549109,-.00418966,.0774998,505987e-9,.00636293,-.00527331,.0844758,739208e-9,.00746566,-.00660428,.0921325,.00107347,.00876625,-.00818826,.0997067,.00153691,.0103125,-.0100811,.107433,.00217153,.0123309,-.0123643,.117088,.00303427,.0146274,-.0150007,.126438,.00416018,.0172295,-.0180531,.135672,.00561513,.0204248,-.0215962,.146244,.007478,.0241597,-.0256234,.157481,.00981046,.0284693,-.0302209,.169125,.0127148,.033445,-.0353333,.181659,.0162453,.0391251,-.0410845,.1944,.0205417,.0454721,-.0473451,.207082,.0256333,.0530983,-.0542858,.221656,.0317036,.0615356,-.0618384,.236036,.0388319,.0703363,-.0697631,.248398,.046974,.0810391,-.0784757,.263611,.0565246,.0920144,-.0873488,.275857,.0671724,.105584,-.0973652,.292555,.0798105,.119506,-.107271,.306333,.0935945,.134434,-.117608,.318888,.109106,.153399,-.128938,.337552,.127074,.171258,-.139944,.349955,.14643,.191059,-.151288,.361545,.168,.215069,-.163018,.378421,.192082,.237838,-.174226,.38879,.217838,.266965,-.186063,.405857,.246931,.292827,-.196909,.414146,.277505,.324352,-.207473,.426955,.310711,.354427,-.217713,.433429,.346794,.389854,-.227183,.443966,.385237,.420749,-.235131,.44471,.424955,.459597,-.242786,.451729,.468446,.495316,-.248767,.45072,.513422,.534903,-.253351,.450924,.560618,.572369,-.256277,.445266,.609677,.612383,-.2576,.438798,.660995,.644037,-.256931,.421693,.713807,.686749,-.254036,.4109,.767616,.719814,-.249785,.390151,.82533,.754719,-.244283,.367847,.888311,.792022,-.235076,.345013,.948177,.822404,-.225061,.316193,1.01661,.853084,-.211113,.287013,1.08075,.879871,-.19449,.255424,1.14501,.901655,-.174023,.222879,1.20203,.919957,-.1509,.18989,1.25698,.938412,-.124923,.15606,1.30588,.953471,-.0968139,.120512,1.3529,.970451,-.066734,.0828515,1.3986,.985522,-.034734,.0424458,1.44148,1.00099,-.00102222,678929e-9,1.48398,965494e-9,-6.27338e-7,.0306409,1.97672e-8,99168e-8,-158573e-10,.0314638,4.99803e-7,991068e-9,-634012e-10,.031363,200682e-11,974567e-9,-14144e-8,.03036,457312e-11,998079e-9,-252812e-9,.031496,860131e-11,.00102243,-396506e-9,.0319955,148288e-10,.00107877,-577593e-9,.0331376,249141e-10,.00121622,-816816e-9,.0359396,423011e-10,.0014455,-.00113761,.0399652,724613e-10,.00178791,-.00156959,.0450556,123929e-9,.00225668,-.00214064,.0508025,208531e-9,.00285627,-.00287655,.0568443,341969e-9,.0035991,-.00380271,.0630892,544158e-9,.00455524,-.00496264,.0702204,842423e-9,.00569143,-.0063793,.0773426,.00126704,.00716928,-.00813531,.0860839,.00186642,.00885307,-.0101946,.0944079,.00267014,.0109316,-.0126386,.103951,.00374033,.0133704,-.0154876,.113786,.0051304,.0161525,-.0187317,.123477,.00688858,.0194267,-.0224652,.133986,.00910557,.0230967,-.0265976,.143979,.0118074,.0273627,-.0312848,.154645,.0151266,.0323898,-.0365949,.166765,.0191791,.0379225,-.0422914,.177932,.0239236,.0447501,-.0487469,.19167,.0296568,.0519391,-.0556398,.203224,.0362924,.0599464,-.0631646,.215652,.0440585,.0702427,-.0714308,.232089,.0531619,.0806902,-.0800605,.245258,.0634564,.0923194,-.0892815,.258609,.0752481,.106938,-.09931,.276654,.0888914,.121238,-.109575,.289847,.104055,.138817,-.120461,.307566,.121266,.15595,-.131209,.320117,.139944,.178418,-.143049,.339677,.161591,.197875,-.154074,.349886,.184303,.224368,-.166307,.369352,.210669,.252213,-.178051,.386242,.238895,.277321,-.189335,.395294,.269182,.310332,-.200683,.412148,.302508,.338809,-.210856,.418266,.337264,.372678,-.220655,.428723,.374881,.405632,-.230053,.433887,.415656,.442293,-.237993,.439911,.457982,.477256,-.244897,.440175,.502831,.515592,-.250657,.441079,.550277,.550969,-.255459,.435219,.601102,.592883,-.257696,.432882,.651785,.629092,-.259894,.421054,.708961,.672033,-.258592,.41177,.763806,.709147,-.256525,.395267,.824249,.745367,-.254677,.375013,.8951,.784715,-.247892,.353906,.959317,.818107,-.240162,.327801,1.03153,.847895,-.229741,.298821,1.10601,.879603,-.213084,.269115,1.164,.902605,-.195242,.236606,1.22854,.922788,-.174505,.203442,1.29017,.944831,-.150169,.169594,1.34157,.959656,-.124099,.135909,1.3956,.972399,-.0960626,.0990563,1.45128,.986549,-.0657097,.0602348,1.50312,1.00013,-.0333558,.0186694,1.55364,619747e-11,-1e-7,.00778326,796756e-16,2.37499e-8,-9.99999e-8,282592e-10,1.14596e-10,100292e-11,-166369e-11,250354e-9,6.77492e-9,350752e-11,-637769e-11,357289e-9,6.31655e-8,826445e-11,-174689e-10,516179e-9,3.1851e-7,242481e-10,-450868e-10,.0010223,130577e-11,455631e-10,-89044e-9,.00144302,374587e-11,971222e-10,-178311e-9,.00241912,102584e-10,171403e-9,-313976e-9,.00354938,236481e-10,292747e-9,-520026e-9,.00513765,496014e-10,789827e-9,-.00118187,.0238621,139056e-9,.00114093,-.00171827,.0286691,244093e-9,.00176119,-.00249667,.0368565,420623e-9,.0022233,-.00333742,.0400469,65673e-8,.00343382,-.00481976,.0535751,.00109323,.00427602,-.00600755,.057099,.00155268,.00461435,-.00737637,.0551084,.00215031,.00695698,-.00971401,.0715767,.00316529,.00867619,-.0120943,.0793314,.00436995,.0106694,-.0148202,.0869391,.0058959,.0140351,-.0183501,.101572,.00798757,.0168939,-.022006,.11018,.0104233,.020197,-.0261568,.119041,.0134167,.0254702,-.0312778,.135404,.0173009,.0298384,-.0362469,.1437,.0215428,.035159,-.042237,.15512,.0268882,.0427685,-.0488711,.17128,.033235,.0494848,-.0557997,.181813,.0404443,.0592394,-.0635578,.198745,.0490043,.0681463,-.071838,.210497,.0588239,.0804753,-.0809297,.228864,.0702835,.0942205,-.0906488,.247008,.0834012,.106777,-.100216,.258812,.0975952,.124471,-.110827,.278617,.114162,.138389,-.121193,.287049,.131983,.159543,-.13253,.307151,.152541,.176432,-.143611,.31564,.174673,.201723,-.15548,.33538,.199842,.229721,-.167166,.355256,.227097,.250206,-.178238,.360047,.256014,.282118,-.189905,.378761,.28855,.312821,-.201033,.39181,.323348,.341482,-.211584,.397716,.360564,.377368,-.221314,.410141,.400004,.418229,-.230474,.423485,.442371,.444881,-.239443,.418874,.488796,.488899,-.245987,.427545,.535012,.520317,-.253948,.422147,.589678,.568566,-.256616,.42719,.637683,.599607,-.26376,.415114,.703363,.64222,-.268687,.408715,.771363,.685698,-.2694,.399722,.83574,.732327,-.266642,.388651,.897764,.769873,-.267712,.369198,.983312,.806733,-.263479,.346802,1.06222,.843466,-.254575,.321368,1.13477,.873008,-.242749,.29211,1.20712,.908438,-.22725,.262143,1.27465,.936321,-.207621,.228876,1.33203,.950353,-.187932,.19484,1.40439,.96442,-.165154,.163178,1.4732,.979856,-.139302,.127531,1.53574,.982561,-.11134,.0903457,1.59982,.996389,-.0808124,.0489007,1.6577],e=[1,0,0,0,1,791421e-36,0,0,1,104392e-29,0,0,1,349405e-26,0,0,1,109923e-23,0,0,1,947414e-22,0,0,1,359627e-20,0,0,1,772053e-19,0,0,1,108799e-17,0,0,1,110655e-16,0,0,1,865818e-16,0,0,.999998,5.45037e-10,0,0,.999994,2.85095e-9,0,0,.999989,1.26931e-8,0,0,.999973,4.89938e-8,0,0,.999947,1.66347e-7,0,0,.999894,5.02694e-7,0,0,.999798,136532e-11,0,0,.999617,335898e-11,0,0,.999234,752126e-11,0,0,.998258,152586e-10,0,0,.99504,266207e-10,0,0,.980816,236802e-10,0,0,.967553,207684e-11,0,0,.966877,403733e-11,0,0,.965752,741174e-11,0,0,.96382,127746e-10,0,0,.960306,202792e-10,0,0,.953619,280232e-10,0,0,.941103,278816e-10,0,0,.926619,160221e-10,0,0,.920983,235164e-10,0,0,.912293,311924e-10,0,.0158731,.899277,348118e-10,0,.0476191,.880884,26041e-9,0,.0793651,.870399,338726e-10,0,.111111,.856138,392906e-10,0,.142857,.837436,372874e-10,0,.174603,.820973,392558e-10,0,.206349,.803583,434658e-10,0,.238095,.782168,40256e-9,0,.269841,.764107,448159e-10,0,.301587,.743092,457627e-10,0,.333333,.721626,455314e-10,0,.365079,.700375,477335e-10,0,.396825,.677334,461072e-10,0,.428571,.655702,484393e-10,0,.460317,.632059,464583e-10,0,.492064,.610125,483923e-10,0,.52381,.58653,464342e-10,0,.555556,.564508,477033e-10,0,.587302,.541405,459263e-10,0,.619048,.519556,46412e-9,0,.650794,.497292,448913e-10,0,.68254,.475898,445789e-10,0,.714286,.454722,433496e-10,0,.746032,.434042,423054e-10,0,.777778,.414126,413737e-10,0,.809524,.394387,397265e-10,0,.84127,.375841,390709e-10,0,.873016,.357219,369938e-10,0,.904762,.340084,365618e-10,0,.936508,.322714,342533e-10,0,.968254,.306974,339596e-10,0,1,1,101524e-23,0,0,1,10292e-22,0,0,1,130908e-23,0,0,1,473331e-23,0,0,1,625319e-22,0,0,1,107932e-20,0,0,1,163779e-19,0,0,1,203198e-18,0,0,1,204717e-17,0,0,.999999,168995e-16,0,0,.999998,1.15855e-10,0,0,.999996,6.6947e-10,0,0,.999991,3.30863e-9,0,0,.999983,1.41737e-8,0,0,.999968,5.32626e-8,0,0,.99994,1.77431e-7,0,0,.999891,5.28835e-7,0,0,.999797,142169e-11,0,0,.999617,347057e-11,0,0,.999227,77231e-10,0,0,.998239,155753e-10,0,0,.994937,268495e-10,0,0,.980225,213742e-10,0,0,.967549,21631e-10,0,0,.966865,417989e-11,0,0,.965739,763341e-11,0,0,.963794,130892e-10,0,0,.960244,206456e-10,0,0,.953495,282016e-10,0,148105e-9,.940876,271581e-10,0,.002454,.926569,164159e-10,0,.00867491,.920905,239521e-10,0,.01956,.912169,315127e-10,0,.035433,.899095,346626e-10,0,.056294,.882209,290223e-10,0,.0818191,.870272,342992e-10,0,.111259,.855977,394164e-10,0,.142857,.837431,372343e-10,0,.174603,.820826,396691e-10,0,.206349,.803408,435395e-10,0,.238095,.782838,419579e-10,0,.269841,.763941,450953e-10,0,.301587,.742904,455847e-10,0,.333333,.721463,458833e-10,0,.365079,.700197,477159e-10,0,.396825,.677501,470641e-10,0,.428571,.655527,484732e-10,0,.460317,.6324,476834e-10,0,.492064,.609964,484213e-10,0,.52381,.586839,475541e-10,0,.555556,.564353,476951e-10,0,.587302,.541589,467611e-10,0,.619048,.519413,463493e-10,0,.650794,.497337,453994e-10,0,.68254,.475797,445308e-10,0,.714286,.454659,435787e-10,0,.746032,.434065,424839e-10,0,.777778,.414018,41436e-9,0,.809524,.39455,401902e-10,0,.84127,.375742,390813e-10,0,.873016,.357501,377116e-10,0,.904762,.339996,36535e-9,0,.936508,.323069,351265e-10,0,.968254,.306897,339112e-10,0,1,1,10396e-19,0,0,1,104326e-20,0,0,1,110153e-20,0,0,1,144668e-20,0,0,1,34528e-19,0,0,1,175958e-19,0,0,1,12627e-17,0,0,1,936074e-18,0,0,1,645742e-17,0,0,.999998,401228e-16,0,0,.999997,2.22338e-10,0,0,.999995,1.0967e-9,0,0,.999991,4.82132e-9,0,0,.999981,1.89434e-8,0,0,.999967,6.67716e-8,0,0,.999938,2.12066e-7,0,0,.999886,6.0977e-7,0,0,.999792,159504e-11,0,0,.999608,381191e-11,0,0,.999209,833727e-11,0,0,.998179,165288e-10,0,0,.994605,274387e-10,0,0,.979468,167316e-10,0,0,.967529,242877e-11,0,0,.966836,461696e-11,0,0,.96569,830977e-11,0,0,.963706,140427e-10,0,244659e-11,.960063,217353e-10,0,760774e-9,.953113,286606e-10,0,.00367261,.940192,247691e-10,0,.00940263,.927731,195814e-10,0,.018333,.920669,252531e-10,0,.0306825,.911799,324277e-10,0,.0465556,.89857,340982e-10,0,.0659521,.883283,319622e-10,0,.0887677,.86989,35548e-9,0,.114784,.855483,397143e-10,0,.143618,.837987,391665e-10,0,.174606,.820546,411306e-10,0,.206349,.802878,436753e-10,0,.238095,.783402,444e-7,0,.269841,.763439,458726e-10,0,.301587,.742925,467097e-10,0,.333333,.721633,478887e-10,0,.365079,.69985,481251e-10,0,.396825,.67783,491811e-10,0,.428571,.655126,488199e-10,0,.460318,.632697,496025e-10,0,.492064,.609613,48829e-9,0,.52381,.587098,492754e-10,0,.555556,.564119,482625e-10,0,.587302,.541813,482807e-10,0,.619048,.519342,471552e-10,0,.650794,.497514,466765e-10,0,.68254,.475879,455582e-10,0,.714286,.454789,446007e-10,0,.746032,.434217,435382e-10,0,.777778,.414086,421753e-10,0,.809524,.394744,412093e-10,0,.84127,.375782,396634e-10,0,.873016,.357707,386419e-10,0,.904762,.340038,370345e-10,0,.936508,.323284,359725e-10,0,.968254,.306954,3436e-8,0,1,1,599567e-19,0,0,1,600497e-19,0,0,1,614839e-19,0,0,1,686641e-19,0,0,1,972658e-19,0,0,1,221271e-18,0,0,1,833195e-18,0,0,1,403601e-17,0,0,.999999,206001e-16,0,0,.999998,1.01739e-10,0,0,.999997,4.70132e-10,0,0,.999993,2.00436e-9,0,0,.999988,7.83682e-9,0,0,.999979,2.80338e-8,0,0,.999962,9.17033e-8,0,0,.999933,2.74514e-7,0,0,.999881,7.53201e-7,0,0,.999783,189826e-11,0,0,.999594,440279e-11,0,0,.999178,93898e-10,0,0,.998073,181265e-10,0,0,.993993,280487e-10,0,0,.979982,149422e-10,0,0,.968145,378481e-11,0,0,.966786,53771e-10,0,0,.965611,947508e-11,0,388934e-10,.963557,156616e-10,0,9693e-7,.959752,235144e-10,0,.00370329,.952461,291568e-10,0,.00868428,.940193,240102e-10,0,.0161889,.929042,231235e-10,0,.0263948,.920266,273968e-10,0,.0394088,.911178,337915e-10,0,.0552818,.897873,333629e-10,0,.0740138,.884053,351405e-10,0,.0955539,.869455,378034e-10,0,.119795,.854655,399378e-10,0,.14656,.838347,419108e-10,0,.175573,.820693,440831e-10,0,.206388,.802277,445599e-10,0,.238095,.783634,472691e-10,0,.269841,.763159,476984e-10,0,.301587,.742914,491487e-10,0,.333333,.721662,502312e-10,0,.365079,.699668,502817e-10,0,.396825,.677839,51406e-9,0,.428571,.655091,511095e-10,0,.460317,.632665,516067e-10,0,.492064,.609734,512255e-10,0,.52381,.587043,510263e-10,0,.555556,.564298,50565e-9,0,.587302,.541769,497951e-10,0,.619048,.519529,492698e-10,0,.650794,.497574,482066e-10,0,.68254,.476028,473689e-10,0,.714286,.454961,461941e-10,0,.746032,.434341,450618e-10,0,.777778,.414364,438355e-10,0,.809524,.394832,424196e-10,0,.84127,.376109,412563e-10,0,.873016,.35779,396226e-10,0,.904762,.340379,384886e-10,0,.936508,.323385,368214e-10,0,.968254,.307295,356636e-10,0,1,1,106465e-17,0,0,1,106555e-17,0,0,1,107966e-17,0,0,1,114601e-17,0,0,1,137123e-17,0,0,1,21243e-16,0,0,.999999,489653e-17,0,0,.999999,160283e-16,0,0,.999998,62269e-15,0,0,.999997,2.51859e-10,0,0,.999996,9.96192e-10,0,0,.999992,3.74531e-9,0,0,.999986,1.32022e-8,0,0,.999975,4.33315e-8,0,0,.999959,1.31956e-7,0,0,.999927,3.72249e-7,0,0,.999871,9.72461e-7,0,0,.999771,235343e-11,0,0,.999572,52768e-10,0,0,.999133,109237e-10,0,0,.997912,203675e-10,0,0,.993008,279396e-10,0,0,.980645,139604e-10,0,0,.970057,646596e-11,0,0,.966717,65089e-10,0,474145e-10,.965497,111863e-10,0,89544e-8,.96334,179857e-10,0,.0032647,.959294,259045e-10,0,.0075144,.951519,292327e-10,0,.0138734,.940517,249769e-10,0,.0224952,.93014,26803e-9,0,.0334828,.91972,303656e-10,0,.0468973,.910294,353323e-10,0,.0627703,.897701,351002e-10,0,.0811019,.884522,388104e-10,0,.10186,.869489,412932e-10,0,.124985,.853983,415781e-10,0,.150372,.838425,454066e-10,0,.177868,.820656,471624e-10,0,.207245,.801875,475243e-10,0,.238143,.783521,505621e-10,0,.269841,.763131,50721e-9,0,.301587,.74261,523293e-10,0,.333333,.72148,528699e-10,0,.365079,.699696,538677e-10,0,.396825,.677592,539255e-10,0,.428571,.65525,546367e-10,0,.460317,.632452,541348e-10,0,.492064,.609903,544976e-10,0,.52381,.586928,536201e-10,0,.555556,.564464,535185e-10,0,.587302,.541801,524949e-10,0,.619048,.519681,51812e-9,0,.650794,.497685,507687e-10,0,.68254,.47622,496243e-10,0,.714286,.455135,485714e-10,0,.746032,.4346,471847e-10,0,.777778,.414564,459294e-10,0,.809524,.395165,444705e-10,0,.84127,.376333,430772e-10,0,.873016,.358197,416229e-10,0,.904762,.34064,401019e-10,0,.936508,.323816,386623e-10,0,.968254,.307581,370933e-10,0,1,1,991541e-17,0,0,1,992077e-17,0,0,1,100041e-16,0,0,1,10385e-15,0,0,1,115777e-16,0,0,1,150215e-16,0,0,.999999,254738e-16,0,0,.999999,598822e-16,0,0,.999998,1.79597e-10,0,0,.999997,6.02367e-10,0,0,.999994,2.06835e-9,0,0,.99999,6.94952e-9,0,0,.999984,2.23363e-8,0,0,.999972,6.78578e-8,0,0,.999952,1.93571e-7,0,0,.999919,5.16594e-7,0,0,.99986,128739e-11,0,0,.999753,299298e-11,0,0,.999546,648258e-11,0,0,.999074,129985e-10,0,0,.997671,232176e-10,0,0,.991504,256701e-10,0,0,.981148,131141e-10,0,0,.971965,869048e-11,0,280182e-10,.966624,808301e-11,0,695475e-9,.965344,135235e-10,0,.00265522,.963048,210592e-10,0,.00622975,.958673,287473e-10,0,.0116234,.950262,281379e-10,0,.018976,.940836,271089e-10,0,.0283844,.930996,30926e-9,0,.0399151,.919848,348359e-10,0,.0536063,.909136,366092e-10,0,.0694793,.897554,384162e-10,0,.0875342,.884691,430971e-10,0,.107749,.869414,447803e-10,0,.130087,.853462,452858e-10,0,.154481,.838187,495769e-10,0,.180833,.820381,502709e-10,0,.209005,.801844,522713e-10,0,.238791,.783061,541505e-10,0,.269869,.763205,553712e-10,0,.301587,.742362,564909e-10,0,.333333,.721393,572646e-10,0,.365079,.699676,581012e-10,0,.396825,.677395,58096e-9,0,.428571,.655208,585766e-10,0,.460317,.632451,583602e-10,0,.492064,.609839,580234e-10,0,.52381,.587093,577161e-10,0,.555556,.564467,568447e-10,0,.587302,.542043,563166e-10,0,.619048,.519826,55156e-9,0,.650794,.497952,541682e-10,0,.68254,.476477,528971e-10,0,.714286,.455412,514952e-10,0,.746032,.434926,502222e-10,0,.777778,.4149,485779e-10,0,.809524,.395552,472242e-10,0,.84127,.376712,454891e-10,0,.873016,.358622,440924e-10,0,.904762,.341048,422984e-10,0,.936508,.324262,408582e-10,0,.968254,.308013,390839e-10,0,1,1,613913e-16,0,0,1,614145e-16,0,0,1,617708e-16,0,0,1,633717e-16,0,0,1,681648e-16,0,0,1,808291e-16,0,0,1,1.14608e-10,0,0,.999998,2.10507e-10,0,0,.999997,4.99595e-10,0,0,.999995,1.39897e-9,0,0,.999994,4.19818e-9,0,0,.999988,1.27042e-8,0,0,.999979,3.75153e-8,0,0,.999965,1.06206e-7,0,0,.999945,2.85381e-7,0,0,.999908,7.23611e-7,0,0,.999846,17255e-10,0,0,.999733,386104e-11,0,0,.999511,808493e-11,0,0,.998993,156884e-10,0,0,.997326,265538e-10,0,0,.989706,206466e-10,0,0,.981713,130756e-10,0,70005e-10,.973636,106473e-10,0,464797e-9,.966509,10194e-9,0,.00201743,.965149,165881e-10,0,.00497549,.962669,249147e-10,0,.00953262,.95786,317449e-10,0,.0158211,.949334,281045e-10,0,.0239343,.941041,303263e-10,0,.0339372,.931575,356754e-10,0,.0458738,.920102,397075e-10,0,.059772,.908002,384886e-10,0,.075645,.897269,43027e-9,0,.0934929,.884559,479925e-10,0,.113302,.869161,48246e-9,0,.135045,.853342,509505e-10,0,.158678,.837633,542846e-10,0,.184136,.820252,554139e-10,0,.211325,.801872,581412e-10,0,.240113,.782418,585535e-10,0,.270306,.7631,610923e-10,0,.301594,.742183,613678e-10,0,.333333,.721098,627275e-10,0,.365079,.699512,629413e-10,0,.396825,.677372,636351e-10,0,.428571,.655059,633555e-10,0,.460317,.632567,636513e-10,0,.492064,.609784,628965e-10,0,.52381,.587237,625546e-10,0,.555556,.564525,615825e-10,0,.587302,.542181,605048e-10,0,.619048,.520017,596329e-10,0,.650794,.498204,581516e-10,0,.68254,.476742,569186e-10,0,.714286,.455803,553833e-10,0,.746032,.435251,537807e-10,0,.777778,.415374,522025e-10,0,.809524,.395921,503421e-10,0,.84127,.377253,488211e-10,0,.873016,.359021,468234e-10,0,.904762,.341637,453269e-10,0,.936508,.3247,433014e-10,0,.968254,.308625,418007e-10,0,1,1,2.86798e-10,0,0,1,2.86877e-10,0,0,1,2.88094e-10,0,0,1,2.93506e-10,0,0,1,3.09262e-10,0,0,.999999,3.48593e-10,0,0,.999999,4.44582e-10,0,0,.999998,6.88591e-10,0,0,.999996,1.34391e-9,0,0,.999993,3.17438e-9,0,0,.999989,8.35609e-9,0,0,.999983,2.28677e-8,0,0,.999974,6.23361e-8,0,0,.999959,1.65225e-7,0,0,.999936,4.19983e-7,0,0,.999896,101546e-11,0,0,.99983,232376e-11,0,0,.999709,50156e-10,0,0,.999469,10167e-9,0,0,.998886,190775e-10,0,0,.996819,300511e-10,0,0,.988837,185092e-10,0,1.68222e-7,.982178,134622e-10,0,259622e-9,.975017,125961e-10,0,.00142595,.967101,13507e-9,0,.00382273,.964905,205003e-10,0,.00764164,.96218,29546e-9,0,.0130121,.956821,343738e-10,0,.0200253,.948829,305063e-10,0,.0287452,.941092,346487e-10,0,.039218,.931883,412061e-10,0,.0514748,.920211,444651e-10,0,.0655351,.907307,431252e-10,0,.0814082,.89684,490382e-10,0,.0990939,.884119,53334e-9,0,.118583,.869148,54114e-9,0,.139856,.853377,578536e-10,0,.162882,.836753,592285e-10,0,.187615,.820063,622787e-10,0,.213991,.801694,645492e-10,0,.241918,.782116,65353e-9,0,.271267,.762673,674344e-10,0,.301847,.742133,682788e-10,0,.333333,.720779,691959e-10,0,.365079,.699386,696817e-10,0,.396826,.67732,699583e-10,0,.428572,.654888,698447e-10,0,.460318,.632499,694063e-10,0,.492064,.609825,691612e-10,0,.52381,.587287,681576e-10,0,.555556,.564743,674138e-10,0,.587302,.542409,661617e-10,0,.619048,.520282,647785e-10,0,.650794,.498506,633836e-10,0,.68254,.477102,615905e-10,0,.714286,.456167,601013e-10,0,.746032,.435728,581457e-10,0,.777778,.415809,564215e-10,0,.809524,.396517,544997e-10,0,.84127,.377737,525061e-10,0,.873016,.359698,506831e-10,0,.904762,.342164,48568e-9,0,.936508,.325417,467826e-10,0,.968254,.309186,446736e-10,0,1,1,1.09018e-9,0,0,1,1.0904e-9,0,0,1,1.09393e-9,0,0,1,1.1095e-9,0,0,1,1.154e-9,0,0,1,1.26089e-9,0,0,.999999,1.5059e-9,0,0,.999997,2.07899e-9,0,0,.999994,3.48164e-9,0,0,.999993,7.05728e-9,0,0,.999987,1.63692e-8,0,0,.999981,4.06033e-8,0,0,.999969,1.0245e-7,0,0,.999953,2.55023e-7,0,0,.999925,6.1511e-7,0,0,.999881,142218e-11,0,0,.99981,313086e-11,0,0,.99968,653119e-11,0,0,.999418,12832e-9,0,0,.998748,232497e-10,0,0,.996066,329522e-10,0,0,.988379,179613e-10,0,108799e-9,.982567,143715e-10,0,921302e-9,.976097,148096e-10,0,.00280738,.968475,178905e-10,0,.00596622,.964606,253921e-10,0,.0105284,.961564,348623e-10,0,.0165848,.955517,357612e-10,0,.0242,.948381,343493e-10,0,.03342,.941095,405849e-10,0,.0442777,.931923,475394e-10,0,.0567958,.91996,484328e-10,0,.0709879,.907419,502146e-10,0,.086861,.89618,561654e-10,0,.104415,.88337,587612e-10,0,.123643,.869046,618057e-10,0,.144531,.853278,657392e-10,0,.167057,.836091,66303e-9,0,.191188,.819644,704445e-10,0,.216878,.801246,714071e-10,0,.244062,.782031,740093e-10,0,.272649,.762066,74685e-9,0,.302509,.741964,766647e-10,0,.333442,.720554,766328e-10,0,.365079,.699098,777857e-10,0,.396826,.677189,774633e-10,0,.428572,.65484,776235e-10,0,.460318,.632496,770316e-10,0,.492064,.609908,762669e-10,0,.52381,.587312,753972e-10,0,.555556,.564938,739994e-10,0,.587302,.542577,728382e-10,0,.619048,.52062,71112e-9,0,.650794,.498819,694004e-10,0,.68254,.477555,675575e-10,0,.714286,.456568,653449e-10,0,.746032,.436278,636068e-10,0,.777778,.41637,613466e-10,0,.809524,.397144,594177e-10,0,.84127,.378412,570987e-10,0,.873016,.360376,550419e-10,0,.904762,.342906,527422e-10,0,.936508,.326136,506544e-10,0,.968254,.30997,484307e-10,0,1,1,3.54014e-9,0,0,1,3.54073e-9,0,0,1,3.54972e-9,0,0,1,3.58929e-9,0,0,1,3.70093e-9,0,0,.999999,3.96194e-9,0,0,.999998,4.53352e-9,0,0,.999997,5.78828e-9,0,0,.999994,8.63812e-9,0,0,.999991,1.53622e-8,0,0,.999985,3.16356e-8,0,0,.999977,7.12781e-8,0,0,.999964,1.66725e-7,0,0,.999945,3.90501e-7,0,0,.999912,8.95622e-7,0,0,.999866,198428e-11,0,0,.999786,421038e-11,0,0,.999647,850239e-11,0,0,.999356,162059e-10,0,0,.998563,282652e-10,0,0,.994928,336309e-10,0,244244e-10,.987999,178458e-10,0,523891e-9,.982893,159162e-10,0,.00194729,.977044,178056e-10,0,.00451099,.969972,230624e-10,0,.00835132,.964237,313922e-10,0,.013561,.960791,406145e-10,0,.0202056,.954292,372796e-10,0,.0283321,.948052,403199e-10,0,.0379739,.940938,479537e-10,0,.0491551,.931689,545292e-10,0,.0618918,.91987,54038e-9,0,.0761941,.907665,589909e-10,0,.0920672,.895281,642651e-10,0,.109511,.882621,659707e-10,0,.12852,.86873,709973e-10,0,.149085,.853008,742221e-10,0,.171189,.835944,761754e-10,0,.194809,.818949,797052e-10,0,.21991,.800951,812434e-10,0,.246447,.781847,838075e-10,0,.274352,.761649,84501e-9,0,.303535,.74152,860258e-10,0,.333857,.720495,866233e-10,0,.365104,.698742,868326e-10,0,.396826,.677096,87133e-9,0,.428572,.654782,863497e-10,0,.460318,.632335,860206e-10,0,.492064,.610031,849337e-10,0,.52381,.587457,838279e-10,0,.555556,.56513,82309e-9,0,.587302,.542877,803542e-10,0,.619048,.5209,786928e-10,0,.650794,.499291,765171e-10,0,.68254,.477971,744753e-10,0,.714286,.457221,72209e-9,0,.746032,.436803,697448e-10,0,.777778,.417083,675333e-10,0,.809524,.397749,648058e-10,0,.84127,.379177,625759e-10,0,.873016,.361061,598584e-10,0,.904762,.343713,575797e-10,0,.936508,.326894,549999e-10,0,.968254,.310816,527482e-10,0,1,1,1.0153e-8,0,0,1,1.01544e-8,0,0,1,1.01751e-8,0,0,1,1.02662e-8,0,0,1,1.0521e-8,0,0,.999999,1.11049e-8,0,0,.999999,1.23408e-8,0,0,.999996,1.4924e-8,0,0,.999992,2.04471e-8,0,0,.999989,3.26539e-8,0,0,.99998,6.03559e-8,0,0,.999971,1.23936e-7,0,0,.999955,2.69058e-7,0,0,.999933,5.93604e-7,0,0,.999901,129633e-11,0,0,.999847,275621e-11,0,0,.999761,564494e-11,0,0,.999607,110485e-10,0,0,.999282,204388e-10,0,0,.99831,341084e-10,0,2.2038e-7,.993288,294949e-10,0,242388e-9,.987855,192736e-10,0,.0012503,.983167,182383e-10,0,.0032745,.977908,218633e-10,0,.00646321,.971194,290662e-10,0,.0109133,.963867,386401e-10,0,.0166927,.95982,462827e-10,0,.0238494,.953497,420705e-10,0,.0324178,.947621,477743e-10,0,.0424225,.940611,568258e-10,0,.0538808,.931174,618061e-10,0,.0668047,.919919,627098e-10,0,.0812014,.907856,694714e-10,0,.0970745,.894509,735008e-10,0,.114424,.881954,763369e-10,0,.133246,.868309,821896e-10,0,.153534,.852511,83769e-9,0,.175275,.835821,881615e-10,0,.198453,.817981,896368e-10,0,.223042,.800504,930906e-10,0,.249009,.78141,945056e-10,0,.276304,.761427,963605e-10,0,.304862,.74094,968088e-10,0,.334584,.720233,981481e-10,0,.365322,.698592,979122e-10,0,.396826,.676763,981057e-10,0,.428571,.654808,973956e-10,0,.460318,.632326,962619e-10,0,.492064,.610049,952996e-10,0,.52381,.58763,933334e-10,0,.555556,.565261,917573e-10,0,.587302,.543244,896636e-10,0,.619048,.521273,873304e-10,0,.650794,.499818,852648e-10,0,.68254,.478536,823961e-10,0,.714286,.457826,79939e-9,0,.746032,.437549,77126e-9,0,.777778,.41776,743043e-10,0,.809524,.39863,716426e-10,0,.84127,.379954,686456e-10,0,.873016,.362025,660514e-10,0,.904762,.344581,630755e-10,0,.936508,.327909,605439e-10,0,.968254,.311736,576345e-10,0,1,1,2.63344e-8,0,0,1,2.63373e-8,0,0,1,2.63815e-8,0,0,1,2.65753e-8,0,0,1,2.71132e-8,0,0,.999999,2.83279e-8,0,0,.999997,3.0833e-8,0,0,.999995,3.58711e-8,0,0,.999992,4.61266e-8,0,0,.999985,6.7574e-8,0,0,.999977,1.1358e-7,0,0,.999966,2.13657e-7,0,0,.999948,4.31151e-7,0,0,.999923,8.96656e-7,0,0,.999884,186603e-11,0,0,.999826,381115e-11,0,0,.999732,754184e-11,0,0,.999561,143192e-10,0,0,.999191,257061e-10,0,0,.997955,405724e-10,0,744132e-10,.992228,276537e-10,0,716477e-9,.987638,208885e-10,0,.0022524,.983395,215226e-10,0,.00484816,.978614,270795e-10,0,.00860962,.972389,365282e-10,0,.0136083,.964392,474747e-10,0,.0198941,.95861,509141e-10,0,.0275023,.952806,48963e-9,0,.0364584,.94712,571119e-10,0,.04678,.940104,671704e-10,0,.0584799,.930398,687586e-10,0,.0715665,.919866,738161e-10,0,.086045,.907853,813235e-10,0,.101918,.894078,834582e-10,0,.119186,.881177,892093e-10,0,.137845,.867575,944548e-10,0,.157891,.852107,969607e-10,0,.179316,.835502,101456e-9,0,.202106,.81756,103256e-9,0,.226243,.79984,106954e-9,0,.251704,.780998,108066e-9,0,.278451,.761132,110111e-9,0,.306436,.740429,110459e-9,0,.335586,.719836,111219e-9,0,.365796,.698467,11145e-8,0,.3969,.676446,110393e-9,0,.428571,.654635,110035e-9,0,.460318,.632411,108548e-9,0,.492064,.609986,106963e-9,0,.52381,.587872,105238e-9,0,.555556,.565528,102665e-9,0,.587302,.543563,100543e-9,0,.619048,.52176,976182e-10,0,.650794,.500188,947099e-10,0,.68254,.479204,919929e-10,0,.714286,.458413,886139e-10,0,.746032,.438314,857839e-10,0,.777778,.418573,82411e-9,0,.809524,.39947,792211e-10,0,.84127,.380892,759546e-10,0,.873016,.362953,727571e-10,0,.904762,.345601,695738e-10,0,.936508,.328895,664907e-10,0,.968254,.312808,634277e-10,0,1,1,6.28647e-8,0,0,1,6.28705e-8,0,0,1,6.29587e-8,0,0,1,6.33441e-8,0,0,.999999,6.44087e-8,0,0,.999998,6.67856e-8,0,0,.999997,7.15889e-8,0,0,.999995,8.09577e-8,0,0,.999989,9.92764e-8,0,0,.999983,1.35834e-7,0,0,.999974,2.10482e-7,0,0,.999959,3.65215e-7,0,0,.999939,6.86693e-7,0,0,.999911,13472e-10,0,0,.999868,26731e-10,0,0,.999804,524756e-11,0,0,.9997,100403e-10,0,0,.99951,185019e-10,0,0,.999078,322036e-10,0,620676e-11,.997428,470002e-10,0,341552e-9,.99162,287123e-10,0,.00143727,.987479,234706e-10,0,.00349201,.983582,260083e-10,0,.0066242,.979186,337927e-10,0,.0109113,.97325,454689e-10,0,.0164064,.965221,573759e-10,0,.0231463,.957262,544114e-10,0,.0311571,.952211,587006e-10,0,.0404572,.946631,692256e-10,0,.0510592,.939391,787819e-10,0,.0629723,.929795,792368e-10,0,.0762025,.91965,875075e-10,0,.090753,.907737,950903e-10,0,.106626,.893899,972963e-10,0,.123822,.880239,10459e-8,0,.142337,.866562,107689e-9,0,.16217,.85164,113081e-9,0,.183314,.835021,116636e-9,0,.20576,.817311,120074e-9,0,.229496,.798845,121921e-9,0,.254502,.780479,12475e-8,0,.280753,.760694,125255e-9,0,.308212,.740142,126719e-9,0,.336825,.719248,12636e-8,0,.366517,.698209,126712e-9,0,.397167,.676398,125769e-9,0,.428578,.654378,124432e-9,0,.460318,.632484,123272e-9,0,.492064,.610113,12085e-8,0,.52381,.587931,118411e-9,0,.555556,.565872,11569e-8,0,.587302,.543814,112521e-9,0,.619048,.522265,109737e-9,0,.650794,.500835,106228e-9,0,.68254,.479818,102591e-9,0,.714286,.459258,991288e-10,0,.746032,.439061,952325e-10,0,.777778,.419552,91895e-9,0,.809524,.400399,879051e-10,0,.84127,.381976,844775e-10,0,.873016,.364009,806316e-10,0,.904762,.346761,771848e-10,0,.936508,.330049,735429e-10,0,.968254,.314018,702103e-10,0,1,1,1.39968e-7,0,0,1,1.39979e-7,0,0,1,1.40145e-7,0,0,1,1.4087e-7,0,0,.999999,1.42865e-7,0,0,.999998,1.47279e-7,0,0,.999997,1.56057e-7,0,0,.999992,1.7276e-7,0,0,.999989,2.04352e-7,0,0,.99998,2.6494e-7,0,0,.999969,3.83435e-7,0,0,.999953,6.18641e-7,0,0,.999929,108755e-11,0,0,.999898,201497e-11,0,0,.999849,381346e-11,0,0,.999778,719815e-11,0,0,.999661,133215e-10,0,0,.999451,238313e-10,0,0,.998936,401343e-10,0,113724e-9,.99662,517346e-10,0,820171e-9,.991094,304323e-10,0,.00238143,.987487,281757e-10,0,.00493527,.983731,320048e-10,0,.00856859,.979647,423905e-10,0,.0133393,.973837,562935e-10,0,.0192863,.96584,677442e-10,0,.0264369,.956309,623073e-10,0,.03481,.951523,704131e-10,0,.0444184,.946003,836594e-10,0,.0552713,.938454,911736e-10,0,.0673749,.929279,938264e-10,0,.0807329,.919239,103754e-9,0,.0953479,.907293,109928e-9,0,.111221,.893936,115257e-9,0,.128352,.879674,122265e-9,0,.14674,.865668,125733e-9,0,.166382,.850998,132305e-9,0,.187276,.834498,134844e-9,0,.209413,.816903,139276e-9,0,.232786,.798235,140984e-9,0,.257382,.779724,14378e-8,0,.283181,.760251,144623e-9,0,.310156,.739808,145228e-9,0,.338269,.718762,14539e-8,0,.367461,.697815,144432e-9,0,.397646,.67631,143893e-9,0,.428685,.654278,141846e-9,0,.460318,.632347,13935e-8,0,.492064,.610296,137138e-9,0,.52381,.588039,133806e-9,0,.555556,.566218,130755e-9,0,.587302,.544346,127128e-9,0,.619048,.522701,123002e-9,0,.650794,.501542,119443e-9,0,.68254,.480508,115055e-9,0,.714286,.460092,111032e-9,0,.746032,.440021,106635e-9,0,.777778,.420446,102162e-9,0,.809524,.401512,98184e-9,0,.84127,.38299,936497e-10,0,.873016,.365232,89813e-9,0,.904762,.347865,853073e-10,0,.936508,.331342,817068e-10,0,.968254,.315202,773818e-10,0,1,1,2.9368e-7,0,0,1,2.937e-7,0,0,1,2.93998e-7,0,0,1,2.95298e-7,0,0,.999999,2.98865e-7,0,0,.999998,3.067e-7,0,0,.999995,3.22082e-7,0,0,.999992,3.50767e-7,0,0,.999986,4.03538e-7,0,0,.999976,5.01372e-7,0,0,.999964,6.8562e-7,0,0,.999945,10374e-10,0,0,.999919,171269e-11,0,0,.999882,300175e-11,0,0,.999829,542144e-11,0,0,.999749,984182e-11,0,0,.99962,176213e-10,0,0,.999382,305995e-10,0,138418e-10,.998751,496686e-10,0,389844e-9,.995344,510733e-10,0,.00150343,.990768,345829e-10,0,.00352451,.987464,342841e-10,0,.00655379,.983846,399072e-10,0,.0106554,.980007,533219e-10,0,.0158723,.974494,696992e-10,0,.0222333,.96622,776754e-10,0,.029758,.956273,747718e-10,0,.0384596,.950952,864611e-10,0,.0483473,.945215,100464e-9,0,.0594266,.937287,103729e-9,0,.0717019,.928649,111665e-9,0,.0851752,.918791,12353e-8,0,.0998479,.906685,127115e-9,0,.115721,.893706,13628e-8,0,.132794,.879248,142427e-9,0,.151067,.864685,148091e-9,0,.170538,.850032,153517e-9,0,.191204,.833853,157322e-9,0,.213063,.816353,161086e-9,0,.236107,.797834,164111e-9,0,.260329,.778831,165446e-9,0,.285714,.759756,167492e-9,0,.312243,.739419,166928e-9,0,.339887,.718491,167e-6,0,.368604,.697392,165674e-9,0,.398329,.676102,163815e-9,0,.428961,.654243,162003e-9,0,.460331,.632176,158831e-9,0,.492064,.610407,155463e-9,0,.52381,.588394,152062e-9,0,.555556,.56645,147665e-9,0,.587302,.5449,14375e-8,0,.619048,.523276,138905e-9,0,.650794,.502179,134189e-9,0,.68254,.481359,129392e-9,0,.714286,.46092,124556e-9,0,.746032,.441084,11957e-8,0,.777778,.421517,114652e-9,0,.809524,.402721,109688e-9,0,.84127,.384222,104667e-9,0,.873016,.366534,999633e-10,0,.904762,.349205,950177e-10,0,.936508,.332702,907301e-10,0,.968254,.316599,859769e-10,0,1,1,5.85473e-7,0,0,1,5.85507e-7,0,0,1,5.8602e-7,0,0,.999999,5.88259e-7,0,0,.999999,5.94381e-7,0,0,.999998,6.07754e-7,0,0,.999995,6.33729e-7,0,0,.99999,6.8137e-7,0,0,.999984,7.67003e-7,0,0,.999973,9.21212e-7,0,0,.999959,120218e-11,0,0,.999936,172024e-11,0,0,.999907,268088e-11,0,0,.999866,445512e-11,0,0,.999806,768481e-11,0,0,.999716,1342e-8,0,0,.999576,232473e-10,0,0,.9993,391694e-10,0,129917e-9,.998498,608429e-10,0,845035e-9,.994132,489743e-10,0,.00237616,.99031,384644e-10,0,.00484456,.987409,421768e-10,0,.00832472,.983981,504854e-10,0,.0128643,.980268,671028e-10,0,.0184947,.974875,852749e-10,0,.025237,.966063,85531e-9,0,.0331046,.956779,900588e-10,0,.0421067,.950259,10577e-8,0,.0522487,.944239,119458e-9,0,.0635343,.936341,122164e-9,0,.0759654,.928047,134929e-9,0,.0895434,.918065,145544e-9,0,.104269,.906267,150531e-9,0,.120142,.893419,161652e-9,0,.137163,.878758,16593e-8,0,.15533,.863699,174014e-9,0,.174645,.848876,177877e-9,0,.195106,.833032,184049e-9,0,.21671,.815557,186088e-9,0,.239454,.797323,19054e-8,0,.263332,.778124,191765e-9,0,.288336,.758929,192535e-9,0,.314451,.738979,192688e-9,0,.341658,.718213,191522e-9,0,.369924,.696947,190491e-9,0,.399202,.675807,187913e-9,0,.429416,.654147,184451e-9,0,.460447,.63229,181442e-9,0,.492064,.610499,177139e-9,0,.523809,.588747,172596e-9,0,.555555,.566783,167457e-9,0,.587301,.545359,162518e-9,0,.619048,.523984,156818e-9,0,.650794,.502917,151884e-9,0,.68254,.482294,145514e-9,0,.714286,.461945,140199e-9,0,.746032,.442133,134101e-9,0,.777778,.422705,128374e-9,0,.809524,.403916,122996e-9,0,.84127,.38554,116808e-9,0,.873016,.367909,111973e-9,0,.904762,.350651,105938e-9,0,.936508,.334208,101355e-9,0,.968254,.318123,957629e-10,0,1,1,111633e-11,0,0,1,111639e-11,0,0,1,111725e-11,0,0,1,112096e-11,0,0,.999999,11311e-10,0,0,.999997,115315e-11,0,0,.999995,11956e-10,0,0,.999989,127239e-11,0,0,.999981,140772e-11,0,0,.999969,164541e-11,0,0,.999952,206607e-11,0,0,.999928,281783e-11,0,0,.999895,416835e-11,0,0,.999848,658728e-11,0,0,.999781,108648e-10,0,0,.999682,182579e-10,0,0,.999523,306003e-10,0,159122e-10,.999205,499862e-10,0,391184e-9,.998131,73306e-9,0,.00147534,.993334,513229e-10,0,.0034227,.99016,467783e-10,0,.00632232,.987321,523413e-10,0,.0102295,.984099,64267e-9,0,.0151794,.980432,843042e-10,0,.0211947,.974976,102819e-9,0,.0282899,.966429,996234e-10,0,.0364739,.957633,111074e-9,0,.0457522,.949422,128644e-9,0,.0561278,.943045,140076e-9,0,.0676023,.935448,146349e-9,0,.0801762,.927225,161854e-9,0,.0938499,.917033,169135e-9,0,.108623,.905762,179987e-9,0,.124496,.892879,189832e-9,0,.141469,.878435,195881e-9,0,.159541,.863114,20466e-8,0,.178713,.84776,209473e-9,0,.198985,.832084,214861e-9,0,.220355,.814915,217695e-9,0,.242823,.796711,220313e-9,0,.266385,.777603,22313e-8,0,.291036,.757991,222471e-9,0,.316767,.738371,222869e-9,0,.343563,.717872,221243e-9,0,.371402,.696619,218089e-9,0,.400248,.675379,21562e-8,0,.430047,.65411,21169e-8,0,.460709,.63241,206947e-9,0,.492079,.61046,201709e-9,0,.52381,.58903,196753e-9,0,.555556,.567267,189637e-9,0,.587302,.545886,184735e-9,0,.619048,.524714,177257e-9,0,.650794,.503789,171424e-9,0,.68254,.483204,164688e-9,0,.714286,.462976,157172e-9,0,.746032,.443294,151341e-9,0,.777778,.423988,143737e-9,0,.809524,.405325,138098e-9,0,.84127,.386981,130698e-9,0,.873016,.369436,125276e-9,0,.904762,.35219,118349e-9,0,.936508,.335804,11312e-8,0,.968254,.319749,106687e-9,0,1,1,204685e-11,0,0,1,204694e-11,0,0,1,204831e-11,0,0,.999999,205428e-11,0,0,.999999,207056e-11,0,0,.999997,210581e-11,0,0,.999993,21732e-10,0,0,.999987,229365e-11,0,0,.999979,250243e-11,0,0,.999965,286127e-11,0,0,.999947,348028e-11,0,0,.999918,455588e-11,0,0,.999881,643303e-11,0,0,.999828,970064e-11,0,0,.999753,153233e-10,0,0,.999642,24793e-9,0,0,.999464,402032e-10,0,122947e-9,.999089,635852e-10,0,807414e-9,.997567,857026e-10,0,.00227206,.992903,594912e-10,0,.00462812,.990011,578515e-10,0,.00794162,.987192,65399e-9,0,.0122534,.98418,819675e-10,0,.0175888,.980491,105514e-9,0,.0239635,.974779,121532e-9,0,.031387,.96675,119144e-9,0,.0398644,.958248,136125e-9,0,.0493982,.948884,155408e-9,0,.0599896,.941673,162281e-9,0,.0716382,.934521,176754e-9,0,.0843437,.926205,192873e-9,0,.0981056,.916089,200038e-9,0,.112923,.904963,213624e-9,0,.128796,.892089,221834e-9,0,.145725,.878028,232619e-9,0,.163709,.86249,238632e-9,0,.182749,.846587,247002e-9,0,.202847,.830988,250702e-9,0,.224001,.814165,255562e-9,0,.246214,.796135,257505e-9,0,.269482,.777052,258625e-9,0,.293805,.757201,258398e-9,0,.319176,.737655,256714e-9,0,.345587,.717477,255187e-9,0,.373021,.696433,251792e-9,0,.401454,.675084,247223e-9,0,.430844,.653907,242213e-9,0,.461125,.632561,237397e-9,0,.492187,.610658,229313e-9,0,.52381,.589322,224402e-9,0,.555556,.567857,216116e-9,0,.587302,.54652,209124e-9,0,.619048,.525433,201601e-9,0,.650794,.504679,192957e-9,0,.68254,.484203,186052e-9,0,.714286,.464203,177672e-9,0,.746032,.444549,170005e-9,0,.777778,.425346,162401e-9,0,.809524,.406706,1544e-7,0,.84127,.388576,147437e-9,0,.873016,.37094,139493e-9,0,.904762,.353996,133219e-9,0,.936508,.337391,125573e-9,0,.968254,.321648,119867e-9,0,1,1,362511e-11,0,0,1,362525e-11,0,0,1,362739e-11,0,0,.999999,363673e-11,0,0,.999998,366214e-11,0,0,.999996,371698e-11,0,0,.999992,382116e-11,0,0,.999986,400554e-11,0,0,.999976,432058e-11,0,0,.999961,485194e-11,0,0,.999938,574808e-11,0,0,.999908,726643e-11,0,0,.999865,984707e-11,0,0,.999807,142217e-10,0,0,.999723,215581e-10,0,0,.999602,336114e-10,0,119113e-10,.999398,527353e-10,0,355813e-9,.998946,805809e-10,0,.00137768,.996647,942908e-10,0,.00322469,.992298,668733e-10,0,.00597897,.989802,716564e-10,0,.00968903,.987019,821355e-10,0,.0143845,.984219,104555e-9,0,.0200831,.980425,131245e-9,0,.0267948,.974241,139613e-9,0,.034525,.967006,145931e-9,0,.0432757,.95893,167153e-9,0,.0530471,.949157,188146e-9,0,.0638386,.94062,194625e-9,0,.0756487,.933509,213721e-9,0,.0884762,.925088,229616e-9,0,.10232,.915178,239638e-9,0,.117178,.904093,254814e-9,0,.133051,.891337,263685e-9,0,.149939,.877326,274789e-9,0,.167841,.861794,280534e-9,0,.18676,.845758,289534e-9,0,.206696,.829792,294446e-9,0,.22765,.813037,296877e-9,0,.249625,.795285,300217e-9,0,.27262,.776323,299826e-9,0,.296636,.756673,299787e-9,0,.321671,.736856,297867e-9,0,.347718,.716883,294052e-9,0,.374768,.696089,289462e-9,0,.402804,.67505,285212e-9,0,.431796,.653509,27653e-8,0,.461695,.63258,271759e-9,0,.49242,.61104,262811e-9,0,.523822,.589567,255151e-9,0,.555556,.568322,246434e-9,0,.587302,.547235,237061e-9,0,.619048,.52616,228343e-9,0,.650794,.505716,219236e-9,0,.68254,.485274,209595e-9,0,.714286,.465411,201011e-9,0,.746032,.445854,19109e-8,0,.777778,.426911,182897e-9,0,.809524,.408222,173569e-9,0,.84127,.390307,165496e-9,0,.873016,.372624,156799e-9,0,.904762,.355804,14917e-8,0,.936508,.33924,140907e-9,0,.968254,.323534,134062e-9,0,1,1,622487e-11,0,0,1,62251e-10,0,0,1,622837e-11,0,0,.999999,624259e-11,0,0,.999998,628127e-11,0,0,.999996,636451e-11,0,0,.999991,65218e-10,0,0,.999984,679782e-11,0,0,.999973,726361e-11,0,0,.999955,803644e-11,0,0,.999931,931397e-11,0,0,.999896,114299e-10,0,0,.999847,149402e-10,0,0,.999784,207461e-10,0,0,.999692,302493e-10,0,0,.999554,454957e-10,0,997275e-10,.999326,690762e-10,0,724813e-9,.998757,101605e-9,0,.0020972,.995367,958745e-10,0,.00432324,.99209,832808e-10,0,.00746347,.989517,887601e-10,0,.0115534,.987008,10564e-8,0,.0166134,.98421,133179e-9,0,.0226552,.98021,161746e-9,0,.0296838,.973676,161821e-9,0,.0377016,.967052,178635e-9,0,.0467079,.959385,206765e-9,0,.0567013,.949461,22476e-8,0,.0676796,.939578,23574e-8,0,.0796403,.932416,25893e-8,0,.0925812,.923759,271228e-9,0,.106501,.914223,289165e-9,0,.121397,.902942,301156e-9,0,.13727,.890419,313852e-9,0,.15412,.876639,324408e-9,0,.171946,.861316,33249e-8,0,.190751,.84496,338497e-9,0,.210537,.828427,345861e-9,0,.231305,.811871,347863e-9,0,.253057,.794397,350225e-9,0,.275797,.775726,349915e-9,0,.299525,.75617,347297e-9,0,.324242,.736091,344232e-9,0,.349947,.716213,340835e-9,0,.376633,.695736,332369e-9,0,.404289,.674961,327943e-9,0,.432895,.653518,318533e-9,0,.462415,.632574,310391e-9,0,.492788,.61134,300755e-9,0,.523909,.590017,290506e-9,0,.555556,.568752,280446e-9,0,.587302,.548061,269902e-9,0,.619048,.52711,258815e-9,0,.650794,.506682,248481e-9,0,.68254,.486524,237141e-9,0,.714286,.466812,226872e-9,0,.746032,.44732,216037e-9,0,.777778,.428473,205629e-9,0,.809524,.409921,195691e-9,0,.84127,.392028,185457e-9,0,.873016,.374606,176436e-9,0,.904762,.357601,166508e-9,0,.936508,.341348,158385e-9,0,.968254,.32542,149203e-9,0,1,1,103967e-10,0,0,1,10397e-9,0,0,1,104019e-10,0,0,.999999,104231e-10,0,0,.999998,104806e-10,0,0,.999995,106042e-10,0,0,.999991,108366e-10,0,0,.999982,112415e-10,0,0,.999968,119174e-10,0,0,.99995,130227e-10,0,0,.999922,148176e-10,0,0,.999884,177303e-10,0,0,.99983,224564e-10,0,0,.999758,300966e-10,0,0,.999654,423193e-10,0,549083e-11,.999503,614848e-10,0,296087e-9,.999237,903576e-10,0,.00123144,.998491,1271e-7,0,.00295954,.994594,107754e-9,0,.00555829,.99178,103025e-9,0,.00907209,.989265,11154e-8,0,.0135257,.986998,136296e-9,0,.0189327,.984137,169154e-9,0,.0252993,.979798,196671e-9,0,.0326272,.97337,196678e-9,0,.0409157,.967239,223121e-9,0,.0501623,.959543,253809e-9,0,.0603638,.949466,265972e-9,0,.0715171,.939074,288372e-9,0,.0836187,.931118,310983e-9,0,.0966657,.922525,325561e-9,0,.110656,.912983,345725e-9,0,.125588,.901617,3556e-7,0,.141461,.889487,374012e-9,0,.158275,.875787,383445e-9,0,.176031,.860654,393972e-9,0,.19473,.844417,400311e-9,0,.214374,.82741,405004e-9,0,.234967,.810545,407378e-9,0,.256512,.793312,407351e-9,0,.279011,.774847,406563e-9,0,.302468,.755621,404903e-9,0,.326887,.735511,397486e-9,0,.352266,.715435,39357e-8,0,.378605,.695403,384739e-9,0,.405897,.674681,376108e-9,0,.43413,.65359,365997e-9,0,.463277,.632471,354957e-9,0,.493295,.61151,343593e-9,0,.524106,.59064,331841e-9,0,.555561,.569386,318891e-9,0,.587302,.548785,3072e-7,0,.619048,.528146,29361e-8,0,.650794,.507872,281709e-9,0,.68254,.487805,268627e-9,0,.714286,.468196,255887e-9,0,.746032,.448922,243997e-9,0,.777778,.430093,231662e-9,0,.809524,.411845,220339e-9,0,.84127,.393808,208694e-9,0,.873016,.376615,198045e-9,0,.904762,.359655,187375e-9,0,.936508,.343452,177371e-9,0,.968254,.32765,167525e-9,0,1,1,169351e-10,0,0,1,169356e-10,0,0,1,169427e-10,0,0,.999999,169736e-10,0,0,.999998,170575e-10,0,0,.999995,172372e-10,0,0,.99999,175739e-10,0,0,.999979,181568e-10,0,0,.999966,191206e-10,0,0,.999944,20677e-9,0,0,.999912,231644e-10,0,0,.999869,271268e-10,0,0,.999811,334272e-10,0,0,.99973,433979e-10,0,0,.999617,590083e-10,0,680315e-10,.999445,829497e-10,0,612796e-9,.999138,118019e-9,0,.00187408,.998095,156712e-9,0,.00395791,.993919,125054e-9,0,.00692144,.991333,126091e-9,0,.0107962,.989226,144912e-9,0,.0155986,.986954,175737e-9,0,.0213364,.983982,213883e-9,0,.0280114,.979128,234526e-9,0,.0356226,.973327,243725e-9,0,.0441668,.967416,2773e-7,0,.0536399,.959729,308799e-9,0,.0640376,.949758,322447e-9,0,.0753554,.939173,350021e-9,0,.0875893,.9296,370089e-9,0,.100736,.921181,391365e-9,0,.114793,.91164,413636e-9,0,.129759,.900435,427068e-9,0,.145632,.888183,441046e-9,0,.162412,.874772,454968e-9,0,.180101,.859566,461882e-9,0,.1987,.843579,471556e-9,0,.218213,.826453,474335e-9,0,.238641,.809164,477078e-9,0,.259989,.792179,47755e-8,0,.282262,.773866,472573e-9,0,.305464,.754944,469765e-9,0,.329599,.735133,462371e-9,0,.35467,.714858,453674e-9,0,.380678,.694829,443888e-9,0,.407622,.674453,432052e-9,0,.435493,.653685,420315e-9,0,.464275,.632666,406829e-9,0,.493938,.611676,392234e-9,0,.524422,.591193,379208e-9,0,.555624,.570145,36319e-8,0,.587302,.549566,349111e-9,0,.619048,.529278,334166e-9,0,.650794,.509026,318456e-9,0,.68254,.489186,30449e-8,0,.714286,.469662,289051e-9,0,.746032,.450691,275494e-9,0,.777778,.431841,261437e-9,0,.809524,.413752,247846e-9,0,.84127,.395951,235085e-9,0,.873016,.378633,222245e-9,0,.904762,.36194,210533e-9,0,.936508,.345599,198494e-9,0,.968254,.329999,188133e-9,0,1,1,269663e-10,0,0,1,26967e-9,0,0,1,269772e-10,0,0,.999999,270214e-10,0,0,.999998,271415e-10,0,0,.999994,27398e-9,0,0,.999988,278771e-10,0,0,.999977,287019e-10,0,0,.999961,300544e-10,0,0,.999937,322138e-10,0,0,.999904,356163e-10,0,0,.999854,409465e-10,0,0,.99979,492651e-10,0,0,.999699,621722e-10,0,8.8288e-7,.999572,819715e-10,0,223369e-9,.999381,111689e-9,0,.00105414,.999016,153862e-9,0,.0026493,.997437,187667e-9,0,.00508608,.993545,155672e-9,0,.00840554,.991135,161455e-9,0,.012629,.989157,188241e-9,0,.0177661,.986874,226229e-9,0,.0238198,.983714,268668e-9,0,.0307887,.978301,277109e-9,0,.0386688,.973227,303446e-9,0,.0474554,.967317,341851e-9,0,.0571428,.959477,370885e-9,0,.0677256,.950012,392753e-9,0,.0791988,.939484,42781e-8,0,.0915576,.928135,443866e-9,0,.104798,.919819,472959e-9,0,.118918,.910049,491551e-9,0,.133915,.899181,512616e-9,0,.149788,.886881,523563e-9,0,.166537,.87359,540183e-9,0,.184164,.858613,547386e-9,0,.202669,.842809,554809e-9,0,.222056,.825727,558316e-9,0,.242329,.808086,557824e-9,0,.263492,.790728,556346e-9,0,.285551,.772987,552672e-9,0,.30851,.7541,543738e-9,0,.332376,.734669,536107e-9,0,.357153,.714411,523342e-9,0,.382845,.694196,512238e-9,0,.409454,.674252,497465e-9,0,.436977,.65357,481096e-9,0,.465404,.632999,467054e-9,0,.494713,.611994,448771e-9,0,.524864,.591604,431889e-9,0,.555779,.571134,415238e-9,0,.587302,.550528,396369e-9,0,.619048,.530292,379477e-9,0,.650794,.510364,361488e-9,0,.68254,.490749,343787e-9,0,.714286,.471266,327822e-9,0,.746032,.452462,310626e-9,0,.777778,.433907,295352e-9,0,.809524,.415659,279179e-9,0,.84127,.398138,264685e-9,0,.873016,.380833,249905e-9,0,.904762,.364247,236282e-9,0,.936508,.348041,222905e-9,0,.968254,.332389,210522e-9,0,1,1,420604e-10,0,0,1,420614e-10,0,0,1,420757e-10,0,0,.999999,42138e-9,0,0,.999997,423067e-10,0,0,.999993,426668e-10,0,0,.999986,433372e-10,0,0,.999974,444857e-10,0,0,.999956,463554e-10,0,0,.99993,493105e-10,0,0,.999892,539077e-10,0,0,.999838,610005e-10,0,0,.999767,718822e-10,0,0,.999666,884581e-10,0,365471e-10,.999525,113398e-9,0,485623e-9,.999311,150043e-9,0,.00162096,.998865,200063e-9,0,.00355319,.996278,211014e-9,0,.00633818,.992956,189672e-9,0,.0100043,.991017,210262e-9,0,.0145648,.989055,244292e-9,0,.0200237,.986741,290481e-9,0,.0263798,.983288,334303e-9,0,.033629,.977784,340307e-9,0,.0417652,.973037,377864e-9,0,.0507821,.967181,4239e-7,0,.060673,.958971,443854e-9,0,.0714314,.950093,483039e-9,0,.0830518,.939552,517934e-9,0,.0955288,.927678,539449e-9,0,.108859,.918278,568604e-9,0,.123038,.908449,588505e-9,0,.138065,.897713,612473e-9,0,.153938,.885533,625575e-9,0,.170657,.872131,63854e-8,0,.188224,.857517,647034e-9,0,.20664,.841796,65209e-8,0,.225909,.824726,6544e-7,0,.246035,.807297,655744e-9,0,.267022,.789058,646716e-9,0,.288878,.77189,643898e-9,0,.311607,.753082,629973e-9,0,.335216,.7341,621564e-9,0,.359713,.714094,605171e-9,0,.385103,.693839,588752e-9,0,.41139,.673891,573294e-9,0,.438576,.653565,552682e-9,0,.466656,.633326,533446e-9,0,.495617,.612582,514635e-9,0,.525431,.59205,49303e-8,0,.556041,.571918,471842e-9,0,.587338,.551572,451713e-9,0,.619048,.531553,430049e-9,0,.650794,.51175,410445e-9,0,.68254,.49238,390098e-9,0,.714286,.473143,370033e-9,0,.746032,.45423,351205e-9,0,.777778,.435963,332049e-9,0,.809524,.41787,315021e-9,0,.84127,.400387,297315e-9,0,.873016,.383332,281385e-9,0,.904762,.366665,265397e-9,0,.936508,.350633,250601e-9,0,.968254,.334964,23589e-8,0,1,1,643736e-10,0,0,1,64375e-9,0,0,1,643947e-10,0,0,.999999,64481e-9,0,0,.999997,647143e-10,0,0,.999994,652119e-10,0,0,.999985,661359e-10,0,0,.999972,677116e-10,0,0,.999952,702599e-10,0,0,.999922,742517e-10,0,0,.99988,803906e-10,0,0,.99982,897315e-10,0,0,.999741,103838e-9,0,0,.999629,12496e-8,0,149024e-9,.999474,156161e-9,0,861027e-9,.999229,201034e-9,0,.00231198,.998662,259069e-9,0,.00458147,.995299,245439e-9,0,.00770895,.992732,24498e-8,0,.0117126,.990847,273211e-9,0,.0165989,.988911,316492e-9,0,.0223674,.98654,37161e-8,0,.0290135,.982636,410352e-9,0,.0365309,.977346,421756e-9,0,.0449117,.972909,475578e-9,0,.0541481,.966821,522482e-9,0,.0642326,.958686,545008e-9,0,.075158,.949754,589286e-9,0,.0869181,.939184,619995e-9,0,.0995074,.927505,654266e-9,0,.112922,.916606,682362e-9,0,.127157,.906707,704286e-9,0,.142212,.895937,725909e-9,0,.158085,.883913,743939e-9,0,.174776,.870642,755157e-9,0,.192287,.856241,764387e-9,0,.210619,.84069,771032e-9,0,.229775,.823728,765906e-9,0,.249761,.806481,767604e-9,0,.270582,.787924,754385e-9,0,.292243,.770588,749668e-9,0,.314753,.751991,731613e-9,0,.338118,.733407,717655e-9,0,.362347,.713688,700604e-9,0,.387447,.693595,678765e-9,0,.413424,.673426,657042e-9,0,.440284,.65359,635892e-9,0,.468027,.633576,611569e-9,0,.496645,.613144,586011e-9,0,.526122,.592711,563111e-9,0,.556417,.572722,537699e-9,0,.587451,.552762,512556e-9,0,.619048,.532985,489757e-9,0,.650794,.513219,464139e-9,0,.68254,.493992,442193e-9,0,.714286,.47509,418629e-9,0,.746032,.456287,397045e-9,0,.777778,.438152,375504e-9,0,.809524,.420294,35492e-8,0,.84127,.402749,335327e-9,0,.873016,.385879,316422e-9,0,.904762,.369352,298333e-9,0,.936508,.353301,281417e-9,0,.968254,.337781,265203e-9,0,1,1,968267e-10,0,0,1,968284e-10,0,0,1,968556e-10,0,0,.999999,969733e-10,0,0,.999997,972913e-10,0,0,.999993,979688e-10,0,0,.999984,992239e-10,0,0,.999969,101356e-9,0,0,.999946,104784e-9,0,0,.999913,110111e-9,0,0,.999868,118217e-9,0,0,.999801,130396e-9,0,0,.999712,148523e-9,0,124907e-10,.999589,175233e-9,0,355405e-9,.999416,213999e-9,0,.0013528,.999136,268529e-9,0,.00312557,.998367,333088e-9,0,.00573045,.994701,304757e-9,0,.00919397,.992497,318031e-9,0,.0135261,.990608,353863e-9,0,.0187278,.988715,409044e-9,0,.0247947,.986241,472967e-9,0,.0317196,.981696,495104e-9,0,.039494,.977097,532873e-9,0,.0481087,.972583,594447e-9,0,.0575549,.966142,636867e-9,0,.0678242,.95823,669899e-9,0,.0789089,.949677,719499e-9,0,.0908023,.939226,750584e-9,0,.103499,.927501,793183e-9,0,.116993,.915199,81995e-8,0,.131282,.90498,847654e-9,0,.146364,.894243,868929e-9,0,.162237,.882154,884278e-9,0,.178902,.869161,898108e-9,0,.196358,.854751,901254e-9,0,.21461,.839368,90679e-8,0,.23366,.822874,901541e-9,0,.253512,.805514,897297e-9,0,.274174,.78716,881856e-9,0,.29565,.769061,870032e-9,0,.31795,.751,851719e-9,0,.341081,.732614,830671e-9,0,.365053,.713171,806569e-9,0,.389874,.693472,78338e-8,0,.415553,.673528,756404e-9,0,.442098,.653397,726872e-9,0,.469512,.633781,700494e-9,0,.497794,.613877,67105e-8,0,.526935,.593506,640361e-9,0,.556908,.573667,613502e-9,0,.587657,.553932,583177e-9,0,.61906,.534345,554375e-9,0,.650794,.515042,527811e-9,0,.68254,.495674,499367e-9,0,.714286,.477132,47429e-8,0,.746032,.458609,447726e-9,0,.777778,.440354,424205e-9,0,.809524,.422765,399549e-9,0,.84127,.405472,378315e-9,0,.873016,.388482,355327e-9,0,.904762,.372191,336122e-9,0,.936508,.356099,315247e-9,0,.968254,.340737,29794e-8,0,1,1,143327e-9,0,0,1,14333e-8,0,0,1,143366e-9,0,0,.999999,143524e-9,0,0,.999996,143952e-9,0,0,.999991,144862e-9,0,0,.999981,146544e-9,0,0,.999966,149391e-9,0,0,.999941,153946e-9,0,0,.999905,160971e-9,0,0,.999852,171562e-9,0,0,.99978,18729e-8,0,0,.999681,210386e-9,0,826239e-10,.999546,243906e-9,0,664807e-9,.999352,291739e-9,0,.00196192,.999027,357419e-9,0,.00405941,.997886,422349e-9,0,.00699664,.99419,385008e-9,0,.0107896,.99214,409775e-9,0,.0154415,.990274,456418e-9,0,.0209488,.988455,527008e-9,0,.0273037,.985804,597685e-9,0,.0344969,.98103,613124e-9,0,.0425183,.976674,668321e-9,0,.0513575,.972021,736985e-9,0,.0610046,.965274,773789e-9,0,.0714508,.958046,830852e-9,0,.0826877,.949333,875766e-9,0,.0947085,.939135,917088e-9,0,.107507,.927119,952244e-9,0,.121078,.91469,990626e-9,0,.135419,.903006,.00101304,0,.150526,.892368,.00103834,0,.166399,.880231,.00105002,0,.183038,.867432,.00106331,0,.200443,.853208,.00106783,0,.218618,.837956,.00106458,0,.237566,.821772,.00105945,0,.257291,.804328,.00104685,0,.2778,.786465,.00103178,0,.2991,.768004,.00101077,0,.321199,.74972,985504e-9,0,.344106,.731682,962893e-9,0,.36783,.712813,932146e-9,0,.392383,.693139,89871e-8,0,.417774,.673566,869678e-9,0,.444013,.653483,835525e-9,0,.471107,.633891,799853e-9,0,.49906,.614433,766838e-9,0,.527869,.594586,732227e-9,0,.557517,.574769,696442e-9,0,.587966,.555149,663935e-9,0,.61913,.535898,629826e-9,0,.650794,.516753,596486e-9,0,.68254,.497816,567078e-9,0,.714286,.479034,534399e-9,0,.746032,.460975,507013e-9,0,.777778,.442935,477421e-9,0,.809524,.425263,451101e-9,0,.84127,.408248,424964e-9,0,.873016,.391339,39993e-8,0,.904762,.37513,377619e-9,0,.936508,.359172,354418e-9,0,.968254,.343876,334823e-9,0,1,1,209042e-9,0,0,1,209045e-9,0,0,1,209093e-9,0,0,.999999,209304e-9,0,0,.999996,209871e-9,0,0,.999991,211078e-9,0,0,.999979,213304e-9,0,0,.999963,217061e-9,0,0,.999933,223042e-9,0,0,.999894,232206e-9,0,0,.999837,245901e-9,0,0,.999756,266023e-9,0,102927e-11,.999648,295204e-9,0,233468e-9,.999499,336958e-9,0,.00108237,.999283,395563e-9,0,.00268832,.998896,473785e-9,0,.00511138,.997006,520008e-9,0,.00837705,.993819,497261e-9,0,.0124928,.991632,523722e-9,0,.0174561,.989875,587258e-9,0,.0232596,.988109,676329e-9,0,.0298932,.985155,747701e-9,0,.0373453,.980479,768803e-9,0,.0456045,.976271,841054e-9,0,.0546593,.971347,911469e-9,0,.0644994,.964528,953057e-9,0,.0751152,.957632,.00102221,0,.0864981,.948681,.00106122,0,.0986407,.938716,.00111857,0,.111537,.926629,.00114762,0,.125182,.914025,.00118995,0,.139571,.901026,.00121228,0,.154703,.890358,.00123946,0,.170576,.878283,.0012527,0,.18719,.865459,.00125536,0,.204547,.851407,.00126134,0,.222648,.836276,.00124759,0,.241498,.820436,.00124443,0,.261101,.803253,.00122071,0,.281465,.785562,.00120107,0,.302595,.76718,.00117762,0,.324501,.748551,.00114289,0,.347192,.730564,.00110872,0,.370679,.712253,.00107636,0,.394973,.692867,.00103646,0,.420085,.673695,996793e-9,0,.446027,.653912,95675e-8,0,.47281,.634129,916739e-9,0,.500441,.615004,874401e-9,0,.528921,.595587,833411e-9,0,.558244,.575965,794556e-9,0,.588384,.5566,75196e-8,0,.619281,.537428,716381e-9,0,.650795,.518623,676558e-9,0,.68254,.499964,64074e-8,0,.714286,.481356,605984e-9,0,.746032,.463279,570256e-9,0,.777778,.445673,540138e-9,0,.809524,.428032,507299e-9,0,.84127,.411112,479553e-9,0,.873016,.394444,450737e-9,0,.904762,.378247,424269e-9,0,.936508,.362415,399111e-9,0,.968254,.347103,375274e-9,0,1,1,300729e-9,0,0,1,300733e-9,0,0,1,300797e-9,0,0,.999998,301072e-9,0,0,.999996,301817e-9,0,0,.999989,303398e-9,0,0,.999977,306309e-9,0,0,.999958,311209e-9,0,0,.999927,318975e-9,0,0,.999884,330804e-9,0,0,.99982,34834e-8,0,0,.999733,373854e-9,0,326995e-10,.999613,410424e-9,0,477174e-9,.999447,462047e-9,0,.00161099,.999204,533322e-9,0,.00353153,.998725,624964e-9,0,.00627965,.995871,631786e-9,0,.0098693,.993194,632017e-9,0,.0143011,.991541,68923e-8,0,.019568,.989773,766892e-9,0,.0256593,.987647,863668e-9,0,.0325625,.984193,922089e-9,0,.0402647,.980016,970749e-9,0,.0487532,.975859,.00106027,0,.058016,.970514,.00112239,0,.0680419,.963625,.00117212,0,.0788208,.956959,.00125211,0,.0903439,.947956,.00129411,0,.102604,.93809,.00135879,0,.115594,.92659,.00139309,0,.129309,.913829,.00143253,0,.143745,.90005,.00145809,0,.158901,.888129,.0014748,0,.174774,.87607,.00148756,0,.191365,.863461,.00148714,0,.208674,.849594,.00148892,0,.226705,.834531,.00146496,0,.245461,.81903,.0014579,0,.264947,.802122,.00143039,0,.28517,.78445,.00139717,0,.306137,.766434,.00136312,0,.327857,.747816,.00132597,0,.350341,.729519,.00128323,0,.373598,.711454,.00123803,0,.397642,.692699,.00119097,0,.422485,.673723,.00114565,0,.448139,.654386,.00109552,0,.474619,.634673,.00104553,0,.501933,.615554,99985e-8,0,.530089,.596462,948207e-9,0,.559087,.577385,902299e-9,0,.588913,.558257,856448e-9,0,.619525,.5392,810395e-9,0,.650826,.520543,768558e-9,0,.68254,.502206,7239e-7,0,.714286,.48402,685794e-9,0,.746032,.465779,64471e-8,0,.777778,.448455,609583e-9,0,.809524,.431091,57227e-8,0,.84127,.414147,54042e-8,0,.873016,.39765,506545e-9,0,.904762,.381576,477635e-9,0,.936508,.365881,448446e-9,0,.968254,.350582,421424e-9,0,1,1,427144e-9,0,0,1,427151e-9,0,0,1,427232e-9,0,0,.999998,42759e-8,0,0,.999995,428555e-9,0,0,.999988,430603e-9,0,0,.999976,434368e-9,0,0,.999952,440688e-9,0,0,.999919,450667e-9,0,0,.999871,46578e-8,0,0,.999801,488024e-9,0,0,.999704,520092e-9,0,129791e-9,.999572,565553e-9,0,821056e-9,.999389,628906e-9,0,.00225241,.999114,714911e-9,0,.00449109,.998488,819218e-9,0,.00756249,.995234,80415e-8,0,.0114716,.993021,830181e-9,0,.0162131,.991407,902645e-9,0,.021776,.989625,996934e-9,0,.0281471,.987064,.00109707,0,.0353118,.983265,.00114353,0,.0432562,.979535,.0012272,0,.0519665,.975224,.00132642,0,.0614298,.969574,.00138092,0,.0716348,.963021,.00145896,0,.0825709,.956046,.00152834,0,.094229,.947136,.00158217,0,.106602,.937313,.0016347,0,.119682,.926073,.00168383,0,.133465,.913121,.00171627,0,.147947,.899165,.00174229,0,.163125,.885891,.00176137,0,.178998,.873783,.00176406,0,.195566,.861331,.00176156,0,.21283,.847569,.00175346,0,.230793,.832785,.00172753,0,.249459,.817442,.00170204,0,.268832,.800613,.00166576,0,.28892,.783597,.00162909,0,.30973,.76571,.0015826,0,.331271,.747021,.00153106,0,.353554,.728593,.00148036,0,.37659,.710661,.00142808,0,.400391,.692426,.00136906,0,.424973,.673623,.00131066,0,.450347,.65494,.00125569,0,.476531,.635448,.00119517,0,.503535,.616221,.00113828,0,.531372,.597531,.0010816,0,.560047,.578795,.00102673,0,.589554,.559892,970985e-9,0,.619869,.541307,919773e-9,0,.650923,.522608,868479e-9,0,.68254,.504484,82137e-8,0,.714286,.486603,772916e-9,0,.746032,.468802,730353e-9,0,.777778,.451172,684955e-9,0,.809524,.434348,647565e-9,0,.84127,.417445,605863e-9,0,.873016,.401077,571885e-9,0,.904762,.385039,536034e-9,0,.936508,.369483,504227e-9,0,.968254,.354272,473165e-9,0,1,1,599525e-9,0,0,1,599533e-9,0,0,1,599639e-9,0,0,.999998,600097e-9,0,0,.999994,601336e-9,0,0,.999987,603958e-9,0,0,.999972,608775e-9,0,0,.999949,616842e-9,0,0,.999912,629534e-9,0,0,.999857,648658e-9,0,0,.999781,676615e-9,0,538873e-11,.999674,716574e-9,0,308602e-9,.999528,772641e-9,0,.00127003,.999326,849806e-9,0,.00300783,.999009,952682e-9,0,.00556637,.998112,.00106394,0,.00895889,.994496,.00102228,0,.0131827,.992806,.00108586,0,.0182277,.991211,.0011759,0,.0240795,.989415,.00128955,0,.030723,.986499,.00139038,0,.0381418,.982679,.00144539,0,.046321,.978839,.00153954,0,.0552459,.974295,.00164417,0,.0649034,.968784,.00171517,0,.0752814,.962324,.00180282,0,.0863693,.954956,.00186387,0,.0981578,.94624,.00193817,0,.110639,.936517,.00198156,0,.123806,.925186,.00203042,0,.137655,.91252,.0020664,0,.15218,.898441,.00207822,0,.16738,.884394,.0020992,0,.183253,.871273,.00208748,0,.199799,.859057,.00208686,0,.21702,.845243,.00205519,0,.234918,.830723,.00202868,0,.253496,.815801,.00199501,0,.272761,.79914,.00194193,0,.292719,.782372,.00188824,0,.313377,.76482,.00183695,0,.334745,.746586,.00177418,0,.356833,.7281,.00170628,0,.379654,.709842,.00164063,0,.403221,.692019,.00157355,0,.427548,.67364,.00150262,0,.452651,.655277,.00143473,0,.478545,.636438,.00136371,0,.505246,.617364,.00129911,0,.532768,.598603,.00123014,0,.561122,.580195,.00116587,0,.590309,.561786,.00110398,0,.620318,.543377,.00104148,0,.651102,.525093,983984e-9,0,.682545,.506791,92667e-8,0,.714286,.489291,874326e-9,0,.746032,.471811,821734e-9,0,.777778,.454435,774698e-9,0,.809524,.437493,727302e-9,0,.84127,.420977,684039e-9,0,.873016,.404729,64373e-8,0,.904762,.388756,60285e-8,0,.936508,.373344,56765e-8,0,.968254,.358191,531929e-9,0,1,1,832169e-9,0,0,1,832178e-9,0,0,1,83231e-8,0,0,.999998,832893e-9,0,0,.999995,834465e-9,0,0,.999985,837791e-9,0,0,.999969,843893e-9,0,0,.999944,854086e-9,0,0,.999903,870071e-9,0,0,.999843,894042e-9,0,0,.999759,928865e-9,0,531805e-10,.999643,978242e-9,0,579365e-9,.99948,.00104684,0,.00182774,.999255,.00114012,0,.00387804,.998885,.00126188,0,.00675709,.997405,.00135888,0,.010468,.99424,.00133626,0,.0150018,.992458,.00140905,0,.0203443,.990929,.00152305,0,.0264786,.989116,.00165882,0,.0333875,.985624,.00174128,0,.0410536,.982003,.00182108,0,.0494609,.978336,.00194498,0,.0585941,.973184,.00202708,0,.0684396,.9678,.00212166,0,.0789851,.961348,.00221366,0,.0902199,.953841,.00228219,0,.102134,.94534,.00235662,0,.114721,.935552,.00240572,0,.127972,.924064,.00244405,0,.141884,.911827,.00247557,0,.156451,.897731,.00248374,0,.171672,.883409,.00249863,0,.187545,.868625,.00246688,0,.20407,.856529,.00246523,0,.221249,.842999,.00242368,0,.239083,.828505,.00237354,0,.257578,.813825,.00232588,0,.276738,.797813,.00226731,0,.296569,.781097,.00219704,0,.31708,.764038,.00212394,0,.338281,.746067,.00204786,0,.360181,.727687,.00196728,0,.382794,.709571,.00188779,0,.406133,.691503,.00180532,0,.430213,.673673,.00171849,0,.45505,.655732,.00164147,0,.480662,.637399,.00155858,0,.507065,.618616,.00147641,0,.534278,.60005,.00140125,0,.562313,.581713,.00132441,0,.59118,.563546,.00125014,0,.620875,.545605,.00118249,0,.651373,.527559,.0011116,0,.682593,.509764,.00104979,0,.714286,.49193,985977e-9,0,.746032,.475011,928592e-9,0,.777778,.457878,873466e-9,0,.809524,.440979,819585e-9,0,.84127,.424613,772365e-9,0,.873016,.408549,722195e-9,0,.904762,.392771,680014e-9,0,.936508,.377317,636797e-9,0,.968254,.362352,598318e-9,0,1,1,.00114313,0,0,1,.00114314,0,0,.999999,.00114331,0,0,.999998,.00114404,0,0,.999994,.00114601,0,0,.999984,.00115019,0,0,.999967,.00115784,0,0,.999937,.0011706,0,0,.999894,.00119054,0,0,.999828,.00122031,0,0,.999735,.00126331,0,169263e-9,.999606,.00132382,0,949167e-9,.999426,.0014071,0,.00249668,.999173,.00151895,0,.00486392,.99873,.00166102,0,.00806323,.996243,.0017023,0,.0120895,.993779,.00172782,0,.0169288,.9919,.0018108,0,.0225633,.990524,.00196028,0,.028974,.98868,.00212014,0,.036142,.984663,.00217598,0,.044049,.981457,.00230563,0,.0526781,.977608,.00243966,0,.0620137,.972215,.00251336,0,.0720418,.966798,.0026285,0,.0827499,.960241,.00271409,0,.0941271,.952489,.00278381,0,.106164,.944127,.00285399,0,.118852,.934282,.00290994,0,.132185,.923271,.00294558,0,.146157,.910803,.00296269,0,.160766,.896705,.00296803,0,.176007,.88238,.00296637,0,.19188,.867116,.00293163,0,.208385,.853636,.00289418,0,.225523,.840469,.00284663,0,.243296,.82639,.00278594,0,.261709,.811759,.00271618,0,.280767,.796113,.00263187,0,.300476,.779518,.00254589,0,.320845,.763142,.00246003,0,.341883,.745464,.00236529,0,.363601,.727491,.00226536,0,.386011,.709414,.00216375,0,.409128,.691396,.00207127,0,.432967,.67368,.00197106,0,.457545,.656049,.00187022,0,.482881,.638188,.00177605,0,.508992,.620177,.00168482,0,.535899,.601506,.00158909,0,.563619,.58362,.00150583,0,.592165,.565496,.00141791,0,.621544,.54789,.00133693,0,.651743,.530323,.00126038,0,.682709,.512795,.00118556,0,.714286,.495199,.00111527,0,.746032,.478101,.0010489,0,.777778,.461511,984264e-9,0,.809524,.444879,92591e-8,0,.84127,.428424,866582e-9,0,.873016,.412495,814463e-9,0,.904762,.396975,764498e-9,0,.936508,.381614,715967e-9,0,.968254,.366732,672483e-9,0,1,1,.00155501,0,0,1,.00155503,0,0,1,.00155524,0,0,.999998,.00155615,0,0,.999994,.0015586,0,0,.999983,.00156379,0,0,.999963,.0015733,0,0,.999932,.00158911,0,0,.999882,.00161376,0,0,.99981,.00165041,0,100875e-10,.999708,.00170304,0,367658e-9,.999565,.00177658,0,.0014234,.999368,.00187688,0,.00327939,.999081,.00200989,0,.00596629,.99852,.00217177,0,.0094852,.99549,.0021745,0,.013824,.993252,.00222357,0,.0189642,.991727,.00235022,0,.0248856,.989951,.00250561,0,.0315669,.988029,.00268829,0,.0389882,.984029,.0027496,0,.0471302,.980683,.00289793,0,.0559754,.976554,.00303315,0,.0655081,.97139,.00313257,0,.0757138,.965544,.00323656,0,.08658,.95912,.00333432,0,.0980954,.951183,.0034039,0,.110251,.942974,.00347515,0,.123038,.932642,.00350381,0,.13645,.922158,.00354519,0,.150482,.909404,.00353851,0,.165129,.896071,.0035435,0,.18039,.881206,.00349936,0,.196263,.866077,.00347256,0,.212748,.85093,.003415,0,.229847,.837703,.00333367,0,.247561,.823878,.003249,0,.265895,.809449,.00316347,0,.284854,.794379,.00306351,0,.304445,.778138,.0029499,0,.324675,.761997,.00284099,0,.345555,.744938,.00272104,0,.367095,.727212,.00260715,0,.389309,.709549,.00248855,0,.41221,.691704,.00236783,0,.435814,.673689,.00225178,0,.460138,.656453,.00213765,0,.485203,.639128,.00202178,0,.511028,.621512,.00191443,0,.537634,.603598,.00180977,0,.565041,.58559,.00170456,0,.593268,.567852,.00160927,0,.622327,.5503,.00151395,0,.652217,.533033,.00142499,0,.682907,.515942,.00133955,0,.714296,.498814,.0012602,0,.746032,.481595,.00118188,0,.777778,.465117,.00111171,0,.809524,.448865,.00104091,0,.84127,.432711,976618e-9,0,.873016,.416822,91859e-8,0,.904762,.401272,857704e-9,0,.936508,.386226,807172e-9,0,.968254,.371321,75464e-8,0,1,1,.00209596,0,0,1,.00209598,0,0,1,.00209624,0,0,.999997,.00209736,0,0,.999991,.00210039,0,0,.999979,.00210678,0,0,.999959,.00211847,0,0,.999925,.0021379,0,0,.99987,.00216809,0,0,.999791,.00221281,0,681487e-10,.999677,.00227669,0,658161e-9,.999521,.00236533,0,.00200635,.999301,.00248514,0,.0041779,.998977,.00264185,0,.00718648,.998191,.00281695,0,.0110239,.994801,.00278518,0,.015672,.993091,.00288774,0,.0211091,.991571,.00303931,0,.0273123,.9897,.00321643,0,.034259,.987023,.00337332,0,.0419282,.983289,.00346146,0,.0502998,.979892,.00363704,0,.0593562,.975111,.00373601,0,.069081,.970351,.0038842,0,.0794598,.964131,.00397053,0,.0904798,.957747,.00408078,0,.10213,.949536,.00413533,0,.1144,.941372,.00420305,0,.127284,.931049,.00422815,0,.140772,.920647,.00425048,0,.154862,.908033,.0042281,0,.169548,.895028,.00422026,0,.184828,.879968,.00415042,0,.200701,.864875,.00408821,0,.217167,.84918,.00400909,0,.234227,.834934,.00391178,0,.251884,.821397,.00380066,0,.270141,.807135,.00367974,0,.289004,.792363,.00355172,0,.308479,.776661,.003411,0,.328575,.760705,.00328123,0,.349301,.744408,.00314003,0,.370668,.726994,.0029906,0,.392689,.709598,.00285034,0,.415379,.692112,.00271179,0,.438754,.674435,.00257185,0,.46283,.65676,.00243425,0,.48763,.639982,.00230351,0,.513173,.622983,.0021777,0,.539482,.605471,.00204991,0,.566579,.58796,.00193759,0,.594488,.570463,.00181976,0,.623226,.553058,.00171497,0,.6528,.535894,.00161109,0,.683198,.519089,.00151394,0,.714354,.502454,.00142122,0,.746032,.485681,.00133488,0,.777778,.468935,.00124975,0,.809524,.452951,.00117309,0,.84127,.437139,.00110155,0,.873016,.421446,.00103124,0,.904762,.405951,966387e-9,0,.936508,.391003,908119e-9,0,.968254,.376198,848057e-9,0,1,1,.00280076,0,0,1,.00280078,0,0,.999999,.00280109,0,0,.999997,.00280246,0,0,.999992,.00280616,0,0,.999979,.00281396,0,0,.999956,.00282822,0,0,.999916,.00285186,0,0,.999857,.0028885,0,0,.999768,.00294259,0,196026e-9,.999645,.00301946,0,.00104842,.99947,.00312541,0,.00270199,.999229,.00326733,0,.00519449,.998852,.00344992,0,.00852602,.997558,.00361052,0,.0126804,.994417,.0035898,0,.017635,.992824,.00372393,0,.023365,.991344,.00390695,0,.0298456,.989337,.00410392,0,.0370529,.985811,.00420987,0,.0449651,.982772,.00437488,0,.0535615,.979001,.00455069,0,.0628243,.974102,.00464462,0,.0727368,.969197,.00480577,0,.0832844,.962759,.00487818,0,.0944545,.956207,.00498176,0,.106236,.947909,.00503392,0,.118619,.939596,.00507474,0,.131595,.929642,.00509798,0,.145159,.918807,.00508476,0,.159305,.906921,.00505634,0,.174028,.893312,.00498845,0,.189327,.878933,.0049133,0,.2052,.863986,.0048259,0,.221647,.847936,.00470848,0,.23867,.832253,.00456889,0,.25627,.818619,.00442726,0,.274453,.804788,.00427677,0,.293222,.790241,.00411906,0,.312585,.775162,.00394833,0,.33255,.759463,.00377366,0,.353126,.743598,.00361026,0,.374324,.72697,.00343627,0,.396158,.709646,.00326422,0,.418641,.69277,.00309717,0,.44179,.675371,.0029356,0,.465624,.657863,.00277712,0,.490163,.640772,.00261738,0,.515429,.624441,.0024737,0,.541445,.607497,.00233125,0,.568236,.590438,.00218994,0,.595828,.573224,.0020664,0,.624242,.556168,.00193526,0,.653496,.539232,.00182463,0,.683588,.522352,.00170735,0,.714482,.506172,.00160555,0,.746032,.489842,.00150451,0,.777778,.473463,.00140938,0,.809524,.457266,.00132568,0,.84127,.441609,.0012376,0,.873016,.426348,.00116265,0,.904762,.411002,.00108935,0,.936508,.396045,.00101946,0,.968254,.381448,955665e-9,0,1,1,.0037121,0,0,1,.00371213,0,0,1,.00371251,0,0,.999997,.00371417,0,0,.99999,.00371863,0,0,.999977,.00372807,0,0,.99995,.00374529,0,0,.999908,.0037738,0,0,.999843,.00381789,0,123596e-10,.999745,.00388273,0,407442e-9,.999608,.00397443,0,.0015447,.999415,.00409998,0,.00351385,.999143,.00426662,0,.0063316,.9987,.00447625,0,.00998679,.996363,.00455323,0,.0144569,.994021,.00461052,0,.0197151,.992372,.00476359,0,.0257344,.991007,.00499101,0,.0324882,.988767,.0051972,0,.0399517,.984872,.00528407,0,.0481022,.982004,.00548926,0,.0569191,.977714,.00564385,0,.0663839,.973076,.0057693,0,.0764801,.967565,.0058924,0,.0871928,.961384,.00599629,0,.0985095,.954435,.00605998,0,.110419,.946303,.0061133,0,.122912,.937662,.00612028,0,.13598,.927867,.00612209,0,.149617,.916475,.00604813,0,.163817,.90541,.00603088,0,.178577,.891591,.00592218,0,.193894,.877573,.00578854,0,.209767,.862511,.00566648,0,.226196,.846861,.00551481,0,.243182,.83068,.00533754,0,.260728,.815725,.00515487,0,.278837,.802321,.0049655,0,.297515,.787826,.00475421,0,.316768,.773454,.00456002,0,.336605,.758224,.00434727,0,.357034,.74265,.00414444,0,.378067,.726729,.00393738,0,.399717,.710155,.00373575,0,.421998,.693312,.00353736,0,.444928,.67653,.00334368,0,.468523,.659444,.00315981,0,.492806,.642051,.00297809,0,.517798,.625758,.00280592,0,.543525,.609615,.00264254,0,.570012,.592919,.00248459,0,.597288,.576298,.00233327,0,.625379,.559489,.00219519,0,.654307,.542891,.00205441,0,.684084,.526255,.00193385,0,.714693,.509853,.00180745,0,.746044,.494131,.00169817,0,.777778,.478114,.0015913,0,.809524,.462274,.00148981,0,.84127,.446412,.00139537,0,.873016,.431274,.00130984,0,.904762,.41635,.00122403,0,.936508,.401476,.00114809,0,.968254,.386993,.00107563,0,1,1,.00488216,0,0,1,.0048822,0,0,1,.00488265,0,0,.999997,.00488463,0,0,.999988,.00488999,0,0,.999974,.00490129,0,0,.999946,.00492191,0,0,.999897,.00495598,0,0,.999825,.00500855,0,744791e-10,.999718,.00508559,0,712744e-9,.999565,.005194,0,.00215249,.999352,.00534147,0,.00444576,.999046,.00553523,0,.00759218,.998492,.00577016,0,.0115714,.995564,.00578487,0,.0163557,.993339,.00586414,0,.021915,.991834,.00606002,0,.0282201,.990496,.00633312,0,.0352433,.987826,.00651941,0,.042959,.98383,.00660842,0,.0513439,.98109,.00685523,0,.0603772,.976131,.00695778,0,.0700402,.971922,.00714236,0,.0803163,.965901,.00721437,0,.0911908,.959606,.00732017,0,.102651,.952504,.00735788,0,.114686,.944365,.00738493,0,.127286,.935652,.00737969,0,.140443,.925813,.00733612,0,.154151,.914397,.00723094,0,.168405,.903257,.00714002,0,.183201,.890015,.00700149,0,.198536,.876014,.00682813,0,.214409,.861436,.00665567,0,.23082,.845752,.00644526,0,.24777,.829169,.00621635,0,.265263,.813435,.00597789,0,.283301,.799701,.00575694,0,.301889,.785726,.00549866,0,.321035,.77152,.0052503,0,.340746,.75683,.00499619,0,.361032,.741951,.0047543,0,.381904,.726367,.0045084,0,.403374,.710537,.00426784,0,.425457,.693965,.00403487,0,.448169,.677724,.0038075,0,.47153,.66117,.00359431,0,.495561,.644274,.00338354,0,.520284,.627449,.00318163,0,.545725,.611645,.00299672,0,.571911,.595614,.00281016,0,.598873,.579426,.00264252,0,.62664,.563016,.00247509,0,.655239,.546728,.00232647,0,.684692,.530539,.00217803,0,.714999,.514164,.00204216,0,.746106,.498344,.00191403,0,.777778,.482957,.00179203,0,.809524,.467336,.00167695,0,.84127,.451994,.00157567,0,.873016,.436514,.00147113,0,.904762,.42178,.00138034,0,.936508,.407271,.00129219,0,.968254,.392822,.0012098,0,1,1,.00637427,0,0,1,.00637431,0,0,.999999,.00637485,0,0,.999996,.00637721,0,0,.999987,.00638357,0,0,.999971,.006397,0,0,.999939,.00642142,0,0,.999888,.00646177,0,0,.999807,.00652387,0,207916e-9,.999689,.00661454,0,.00112051,.99952,.00674155,0,.00287719,.999283,.00691313,0,.00550145,.998936,.00713598,0,.00897928,.998165,.00738501,0,.0132829,.994847,.00734388,0,.01838,.993182,.00749991,0,.0242381,.991665,.0077246,0,.030826,.989708,.00797579,0,.0381152,.986663,.00813011,0,.0460794,.983288,.00830365,0,.0546951,.980104,.00853496,0,.0639411,.974855,.00861045,0,.0737988,.97045,.00879133,0,.0842516,.964509,.00886377,0,.0952848,.957594,.00890346,0,.106886,.950546,.00893289,0,.119044,.942225,.00890074,0,.131749,.933365,.00886826,0,.144994,.923202,.0087316,0,.158772,.912605,.00863082,0,.173078,.901099,.00847403,0,.187908,.888177,.00825838,0,.203261,.873955,.00801834,0,.219134,.860091,.00779026,0,.235527,.84434,.00752478,0,.252443,.828517,.00724074,0,.269883,.81239,.00693769,0,.287851,.79721,.00664817,0,.306352,.783489,.00634763,0,.325393,.769514,.00604221,0,.344981,.755419,.00573568,0,.365126,.741083,.00544359,0,.385839,.726059,.00515515,0,.407132,.710809,.00487139,0,.42902,.695052,.00459846,0,.45152,.678886,.00433412,0,.474651,.663042,.00407981,0,.498433,.646634,.00384264,0,.52289,.630117,.00360897,0,.548048,.613804,.00338863,0,.573936,.598338,.00318486,0,.600584,.582687,.00298377,0,.628027,.566809,.00280082,0,.656295,.550817,.00262255,0,.685417,.534937,.00245835,0,.715406,.519151,.00230574,0,.74624,.503118,.0021549,0,.777778,.487723,.00202008,0,.809524,.472725,.00189355,0,.84127,.457599,.00177108,0,.873016,.442558,.00165843,0,.904762,.427624,.00155494,0,.936508,.413171,.00145273,0,.968254,.399122,.00136454,0,1,1,.00826496,0,0,1,.00826499,0,0,1,.00826564,0,0,.999996,.00826842,0,0,.999987,.00827589,0,0,.999967,.00829167,0,0,.999933,.00832037,0,0,.999876,.00836768,0,109338e-10,.999786,.00844031,0,427145e-9,.999655,.00854603,0,.0016384,.999468,.00869337,0,.00372392,.999203,.008891,0,.00668513,.998803,.00914387,0,.0104968,.99748,.00935838,0,.015125,.994446,.00933309,0,.0205338,.99292,.00953084,0,.0266884,.991414,.0097893,0,.0335565,.989049,.0100228,0,.0411086,.98582,.0101664,0,.0493181,.982441,.0103582,0,.0581613,.978595,.0105292,0,.0676169,.973495,.0106274,0,.0776661,.968405,.0107261,0,.0882926,.962717,.0108234,0,.0994817,.955478,.0108102,0,.111221,.948275,.0107914,0,.123499,.940006,.0107161,0,.136308,.930831,.0106309,0,.149639,.920648,.0104083,0,.163485,.910205,.0102312,0,.177843,.898445,.0100051,0,.192707,.885986,.00971928,0,.208077,.872204,.00940747,0,.22395,.858436,.0091085,0,.240326,.843454,.00876595,0,.257208,.827437,.00839794,0,.274596,.811488,.00803692,0,.292496,.796039,.00767352,0,.310911,.781083,.0073097,0,.329849,.767642,.00694032,0,.349316,.753901,.00657476,0,.369323,.740131,.00622699,0,.38988,.725845,.0058838,0,.410999,.710991,.00555586,0,.432696,.696002,.00523089,0,.454987,.680461,.00492494,0,.47789,.664875,.00463464,0,.501426,.649273,.00435422,0,.52562,.63302,.0040875,0,.550498,.61705,.00384075,0,.576089,.601154,.00359557,0,.602427,.586008,.00337636,0,.629544,.570699,.00316019,0,.657479,.555166,.00296033,0,.686264,.539645,.00277552,0,.715924,.524159,.00259499,0,.746459,.508682,.00243257,0,.777789,.493163,.00227851,0,.809524,.478004,.00213083,0,.84127,.46347,.00199502,0,.873016,.448778,.00186967,0,.904762,.434105,.00174732,0,.936508,.419576,.00163861,0,.968254,.405541,.00153341,0,1,1,.0106462,0,0,1,.0106462,0,0,.999999,.010647,0,0,.999995,.0106502,0,0,.999985,.0106589,0,0,.999964,.0106773,0,0,.999925,.0107106,0,0,.999861,.0107655,0,712986e-10,.999763,.0108497,0,743959e-9,.999616,.0109716,0,.00227361,.999408,.0111408,0,.0046983,.999112,.0113659,0,.00800158,.998637,.0116475,0,.0121493,.996223,.0117231,0,.0171023,.994006,.0118064,0,.0228218,.992444,.0120254,0,.0292711,.991028,.0123314,0,.036417,.98803,.0124954,0,.0442295,.984816,.0126538,0,.0526815,.981399,.0128537,0,.0617492,.977085,.0129694,0,.0714114,.972154,.013091,0,.0816495,.966617,.0131166,0,.0924472,.960628,.0131583,0,.10379,.953295,.0131094,0,.115665,.94575,.0129966,0,.128062,.937654,.0128796,0,.140972,.927716,.0126477,0,.154387,.917932,.0123889,0,.168301,.907719,.012131,0,.182709,.89584,.0118013,0,.197608,.883526,.0114145,0,.212994,.870301,.0110075,0,.228867,.856272,.0106019,0,.245227,.842251,.0101938,0,.262074,.826466,.00973254,0,.279412,.810859,.0092846,0,.297244,.795051,.00883304,0,.315575,.780053,.00840272,0,.334412,.76575,.00796438,0,.35376,.752298,.00752526,0,.373631,.739153,.00711486,0,.394034,.725514,.00670361,0,.414983,.711473,.00632656,0,.436491,.696936,.00595206,0,.458575,.682126,.00559191,0,.481253,.667027,.00525362,0,.504547,.651875,.00493805,0,.528481,.636463,.00462848,0,.553081,.620641,.00433936,0,.578377,.604931,.00407,0,.604404,.589549,.00380864,0,.631197,.574712,.00357049,0,.658795,.559775,.00334466,0,.687238,.544514,.00312505,0,.716559,.529555,.00293199,0,.746776,.514402,.00274204,0,.777849,.499302,.00256647,0,.809524,.484114,.00239901,0,.84127,.469308,.00225148,0,.873016,.455133,.00210178,0,.904762,.440939,.0019727,0,.936508,.426627,.00184382,0,.968254,.412509,.00172548,0,1,1,.013628,0,0,1,.0136281,0,0,.999999,.0136289,0,0,.999995,.0136327,0,0,.999983,.0136427,0,0,.99996,.0136638,0,0,.999917,.0137022,0,0,.999846,.0137652,0,204597e-9,.999736,.0138615,0,.00116837,.999573,.0140007,0,.00303325,.99934,.0141927,0,.00580613,.999004,.0144457,0,.00945626,.998407,.0147489,0,.0139421,.995464,.014731,0,.0192202,.993328,.0148283,0,.0252495,.991799,.0150797,0,.0319921,.990397,.0154316,0,.0394138,.986835,.0155005,0,.0474843,.983938,.0157308,0,.0561763,.980154,.0158753,0,.0654661,.975659,.0159581,0,.0753326,.970171,.0159832,0,.0857571,.964803,.0160084,0,.0967236,.958366,.0159484,0,.108218,.950613,.0158001,0,.120227,.942874,.0155845,0,.132741,.935005,.0154292,0,.145751,.924991,.0150742,0,.159249,.914814,.0146757,0,.17323,.904743,.0143097,0,.187687,.893216,.0138695,0,.202619,.880769,.0133706,0,.218021,.868136,.0128606,0,.233894,.85469,.0123403,0,.250238,.840593,.0118091,0,.267052,.825808,.011253,0,.284341,.81009,.0107099,0,.302106,.79504,.0101636,0,.320354,.779757,.00964041,0,.33909,.764697,.00911896,0,.358322,.750913,.00859533,0,.378059,.738175,.00811592,0,.398311,.725242,.00764504,0,.41909,.711864,.00718885,0,.440412,.698009,.00675843,0,.462292,.683841,.00634984,0,.484748,.669391,.00595502,0,.507802,.654731,.00558671,0,.531477,.639805,.00523578,0,.555802,.624789,.00490834,0,.580805,.609325,.00459448,0,.606522,.593975,.00430342,0,.63299,.578983,.00403019,0,.66025,.564442,.0037707,0,.688346,.549835,.0035316,0,.717319,.535039,.00330255,0,.7472,.520403,.00308932,0,.777982,.505687,.00289335,0,.809524,.490939,.00270818,0,.84127,.476233,.0025343,0,.873016,.461624,.00237097,0,.904762,.447833,.00222065,0,.936508,.433992,.00207561,0,.968254,.420147,.00194955,0,1,1,.0173415,0,0,1,.0173416,0,0,.999999,.0173426,0,0,.999995,.0173468,0,0,.999983,.0173582,0,0,.999954,.0173822,0,0,.999908,.0174258,0,669501e-11,.999828,.0174973,0,427399e-9,.999705,.0176063,0,.00171019,.999524,.0177631,0,.0039248,.999263,.0179781,0,.00705382,.998878,.018258,0,.0110552,.998012,.0185551,0,.0158812,.994614,.0184264,0,.0214852,.993132,.0186385,0,.0278239,.991563,.0189067,0,.0348585,.989298,.0191577,0,.0425544,.986036,.0192522,0,.050881,.982558,.0194063,0,.059811,.978531,.019486,0,.0693209,.974198,.0195847,0,.0793895,.968148,.0194749,0,.0899984,.962565,.0194277,0,.101132,.956041,.0192991,0,.112775,.947749,.0189893,0,.124917,.94018,.018704,0,.137547,.93165,.0183458,0,.150655,.921798,.0178775,0,.164236,.911573,.0173618,0,.178281,.901569,.0168482,0,.192788,.890341,.016265,0,.207752,.877835,.0156199,0,.223171,.865472,.0149516,0,.239044,.852905,.0143274,0,.255371,.838906,.0136643,0,.272153,.824888,.0129903,0,.289393,.809977,.0123218,0,.307093,.794697,.0116572,0,.325259,.780028,.0110307,0,.343896,.765124,.0104236,0,.363012,.750411,.0098219,0,.382617,.737264,.00924397,0,.402719,.724799,.00868719,0,.423332,.712253,.00816476,0,.444469,.699267,.00767262,0,.466146,.685618,.00719746,0,.488383,.671736,.00673916,0,.511199,.657777,.00631937,0,.534618,.643497,.00592411,0,.558668,.62889,.00553928,0,.58338,.614299,.0051934,0,.608787,.599197,.00485985,0,.634929,.584175,.00454357,0,.661849,.569541,.00425787,0,.689594,.555193,.00397905,0,.718211,.540947,.00372364,0,.747742,.526593,.00348599,0,.778205,.512335,.00326103,0,.80953,.498017,.00305137,0,.84127,.483609,.00285485,0,.873016,.469368,.00267472,0,.904762,.455037,.00249945,0,.936508,.441493,.00234792,0,.968254,.428147,.00219936,0,1,1,.0219422,0,0,1,.0219423,0,0,.999998,.0219434,0,0,.999993,.0219481,0,0,.999981,.021961,0,0,.999949,.0219879,0,0,.999896,.0220367,0,593194e-10,.999808,.0221167,0,75364e-8,.99967,.0222383,0,.00237884,.999466,.0224125,0,.00495612,.999174,.0226495,0,.00844887,.998725,.0229525,0,.0128058,.996979,.0231123,0,.0179742,.994317,.0230742,0,.0239047,.992781,.0232895,0,.0305526,.991191,.0235734,0,.0378786,.987787,.0236152,0,.0458475,.985092,.0237994,0,.0544287,.981121,.0238553,0,.0635952,.976924,.0238706,0,.0733233,.97218,.0238704,0,.0835922,.965956,.0236598,0,.0943839,.959998,.0234735,0,.105682,.953245,.0232277,0,.117474,.944445,.0226973,0,.129747,.937087,.0223527,0,.142491,.928341,.0218144,0,.155697,.9184,.0211516,0,.169358,.907959,.0204553,0,.183469,.89808,.0197673,0,.198024,.887047,.0189915,0,.21302,.875221,.0182082,0,.228455,.86269,.0173584,0,.244329,.850735,.0165718,0,.260639,.837545,.0157524,0,.277389,.823639,.0149482,0,.29458,.809699,.0141431,0,.312216,.794797,.0133527,0,.3303,.780578,.0126193,0,.34884,.766019,.0118914,0,.367842,.751447,.0111839,0,.387315,.737275,.010514,0,.40727,.724545,.00987277,0,.427717,.712644,.00926569,0,.448671,.700432,.00869029,0,.470149,.687664,.00814691,0,.492167,.674288,.00763012,0,.514746,.660966,.00714437,0,.537911,.647264,.00668457,0,.561688,.633431,.00626581,0,.586108,.619133,.00585593,0,.611206,.604935,.00548188,0,.637022,.590236,.00513288,0,.663599,.575473,.0047906,0,.690989,.561228,.00448895,0,.719242,.547054,.00420233,0,.748411,.533175,.00392869,0,.778531,.519163,.00367445,0,.809583,.505328,.00344097,0,.84127,.491446,.00322003,0,.873016,.477356,.00301283,0,.904762,.46356,.00282592,0,.936508,.449623,.00264956,0,.968254,.436068,.00246956,0,1,1,.0276135,0,0,1,.0276136,0,0,.999998,.0276148,0,0,.999993,.0276201,0,0,.999976,.0276342,0,0,.999945,.027664,0,0,.999884,.0277179,0,18679e-8,.999784,.027806,0,.00119607,.99963,.0279394,0,.00318407,.999401,.0281295,0,.00613601,.999066,.0283858,0,.00999963,.998524,.0287027,0,.0147164,.995702,.0286256,0,.0202295,.993593,.0286733,0,.0264876,.992067,.0288989,0,.0334452,.990548,.0292135,0,.0410621,.986775,.0291296,0,.0493032,.984054,.0293099,0,.0581381,.979481,.0291881,0,.0675397,.975297,.0291598,0,.0774848,.96981,.028954,0,.0879528,.963524,.028628,0,.0989258,.957398,.0283135,0,.110388,.950088,.0278469,0,.122327,.941538,.0271798,0,.134729,.933332,.0265388,0,.147587,.924392,.0257776,0,.160889,.914581,.024916,0,.174631,.904347,.0240242,0,.188806,.894324,.0231229,0,.203409,.883724,.022153,0,.218437,.872207,.0211355,0,.233888,.859927,.0201048,0,.249761,.848373,.0191263,0,.266056,.836023,.0181306,0,.282774,.82289,.0171718,0,.299917,.809324,.0162196,0,.317488,.795361,.0152622,0,.335493,.781253,.01439,0,.353936,.767338,.013533,0,.372825,.753156,.0127244,0,.392168,.739122,.0119454,0,.411976,.725358,.0112054,0,.432259,.712949,.010487,0,.453032,.701621,.00984032,0,.47431,.689703,.00921495,0,.496111,.677216,.00862492,0,.518456,.664217,.00806882,0,.541367,.65137,.00755922,0,.564872,.638,.00705705,0,.589001,.62453,.00661266,0,.613789,.610601,.00618432,0,.639277,.59676,.00578033,0,.66551,.582433,.00540927,0,.692539,.568026,.00506104,0,.720422,.55414,.0047353,0,.749216,.540178,.00442889,0,.778974,.526513,.00414363,0,.809711,.512954,.00388237,0,.84127,.499403,.00362875,0,.873016,.486026,.00340827,0,.904762,.472345,.00318598,0,.936508,.458828,.00297635,0,.968254,.445379,.00279447,0,1,1,.0345716,0,0,1,.0345717,0,0,.999999,.034573,0,0,.999991,.0345787,0,0,.999974,.0345941,0,0,.999937,.0346263,0,188589e-11,.999869,.0346847,0,409238e-9,.999757,.0347798,0,.0017674,.999582,.0349233,0,.00413658,.999322,.0351265,0,.00747408,.998939,.0353967,0,.0117157,.998219,.0357018,0,.0167966,.994974,.0354726,0,.0226572,.993201,.0355621,0,.0292445,.991573,.0357641,0,.0365123,.989301,.0359252,0,.0444203,.985712,.0358017,0,.0529334,.982411,.0358353,0,.0620214,.977827,.035617,0,.0716574,.973278,.0354398,0,.0818186,.967397,.0350483,0,.0924846,.960696,.0344795,0,.103638,.954349,.0339861,0,.115263,.946066,.0331323,0,.127348,.938012,.032359,0,.13988,.929413,.0314413,0,.152849,.920355,.0304103,0,.166248,.910586,.0292785,0,.18007,.900609,.0281391,0,.194308,.890093,.0269103,0,.208958,.880013,.0257269,0,.224018,.869001,.0244671,0,.239485,.85751,.0232252,0,.255359,.84582,.0220117,0,.271638,.834383,.0208274,0,.288324,.822158,.0196628,0,.305419,.809056,.0185306,0,.322927,.795832,.0174174,0,.340851,.782547,.0163758,0,.359199,.7689,.015391,0,.377975,.755526,.0144488,0,.397189,.741681,.0135372,0,.416851,.728178,.0126957,0,.436971,.714642,.0118812,0,.457564,.702756,.0111165,0,.478644,.69175,.0104145,0,.500229,.680159,.00974439,0,.522339,.668073,.00911926,0,.544997,.655405,.00851393,0,.56823,.642921,.00797637,0,.592068,.629993,.00745119,0,.616546,.616828,.00696972,0,.641705,.603305,.00652425,0,.66759,.589833,.00610188,0,.694255,.575945,.00570834,0,.72176,.561745,.00533384,0,.750168,.548277,.00500001,0,.779545,.534467,.00467582,0,.809933,.521032,.00438092,0,.841272,.507877,.00410348,0,.873016,.494654,.00383618,0,.904762,.481592,.00358699,0,.936508,.468509,.00337281,0,.968254,.455293,.00316196,0,1,1,.0430698,0,0,1,.0430699,0,0,.999998,.0430713,0,0,.999991,.0430773,0,0,.99997,.0430936,0,0,.999928,.0431277,0,406396e-10,.999852,.0431893,0,744376e-9,.999724,.0432895,0,.0024806,.999527,.0434397,0,.00524779,.99923,.0436507,0,.00898164,.998783,.0439255,0,.0136083,.997507,.0441104,0,.0190582,.994418,.0438225,0,.0252694,.992864,.0439396,0,.0321879,.991127,.0440962,0,.039767,.987331,.0438408,0,.0479667,.984819,.0438991,0,.056752,.980384,.0435906,0,.0660929,.975846,.0432543,0,.075963,.970748,.0428293,0,.0863398,.964303,.042153,0,.0972035,.95772,.0414111,0,.108537,.950747,.0405893,0,.120325,.942533,.0394887,0,.132554,.934045,.0383544,0,.145215,.924942,.037057,0,.158296,.915811,.0356993,0,.17179,.90612,.0342401,0,.185691,.896434,.0328078,0,.199993,.886021,.031288,0,.214691,.876081,.0297776,0,.229782,.865608,.0282334,0,.245265,.854924,.026749,0,.261138,.843607,.02526,0,.277401,.832456,.0238214,0,.294056,.821342,.0224682,0,.311104,.809303,.0211297,0,.328548,.796468,.0198387,0,.346394,.784046,.0186227,0,.364645,.771262,.0174561,0,.38331,.758118,.0163806,0,.402396,.745075,.0153287,0,.421912,.731926,.0143647,0,.44187,.71863,.0134363,0,.462283,.705414,.0125603,0,.483165,.693792,.0117508,0,.504535,.683108,.0110016,0,.52641,.67183,.0102757,0,.548816,.66015,.00962044,0,.571776,.647907,.00898031,0,.595323,.635734,.00840811,0,.619489,.623208,.00786211,0,.644317,.610438,.00734953,0,.669852,.597345,.00687688,0,.696148,.584138,.00643469,0,.723267,.5707,.00602236,0,.75128,.556966,.0056324,0,.780258,.543607,.00528277,0,.810268,.530213,.00493999,0,.841311,.516912,.00462265,0,.873016,.503916,.0043307,0,.904762,.491146,.00406858,0,.936508,.478439,.00381436,0,.968254,.465834,.00358003,0,1,1,.0534039,0,0,1,.053404,0,0,.999998,.0534055,0,0,.999989,.0534116,0,0,.999968,.0534283,0,0,.999918,.0534633,0,155895e-9,.99983,.0535262,0,.00120914,.999685,.0536281,0,.00334944,.999461,.0537799,0,.00653077,.999119,.0539902,0,.0106718,.998582,.0542524,0,.0156907,.995919,.0540318,0,.0215147,.993735,.0538914,0,.0280801,.992126,.0539557,0,.0353323,.990266,.0540401,0,.0432247,.986317,.0536064,0,.0517172,.983213,.0534425,0,.0607754,.978303,.0528622,0,.0703698,.973665,.0523363,0,.0804742,.968091,.0516165,0,.0910667,.961026,.0505434,0,.102128,.954333,.049523,0,.113641,.946372,.0481698,0,.125591,.938254,.0467674,0,.137965,.929516,.0452341,0,.150754,.920106,.0435083,0,.163947,.910899,.0417399,0,.177537,.901532,.0399389,0,.191516,.891919,.0380901,0,.205881,.882006,.0362341,0,.220626,.871965,.0343444,0,.235749,.862145,.0324832,0,.251248,.852058,.0306681,0,.267121,.84161,.0289097,0,.283368,.830806,.0272079,0,.299992,.820476,.0256089,0,.316992,.809514,.0240394,0,.334374,.797865,.0225379,0,.35214,.785621,.0211235,0,.370296,.773765,.0197908,0,.388849,.761629,.0185235,0,.407807,.748891,.0173358,0,.427178,.736437,.0162305,0,.446974,.723707,.0151778,0,.467207,.710606,.0141791,0,.487892,.698019,.0132592,0,.509046,.686203,.0123887,0,.530687,.675692,.0115976,0,.552839,.664826,.0108325,0,.575527,.65349,.0101348,0,.59878,.641774,.00947756,0,.622634,.629794,.00886058,0,.647128,.617647,.00828526,0,.672308,.60534,.00775312,0,.698231,.592718,.00726033,0,.724958,.579746,.00679731,0,.752563,.566763,.00636111,0,.781127,.553515,.00595228,0,.810733,.540118,.00556876,0,.841426,.527325,.00523051,0,.873016,.514265,.00490712,0,.904762,.501406,.00460297,0,.936508,.488922,.00431247,0,.968254,.476541,.0040472,0,1,1,.0659184,0,0,1,.0659185,0,0,.999998,.06592,0,0,.999988,.0659259,0,0,.999963,.0659423,0,0,.999907,.0659764,0,374198e-9,.999806,.0660376,0,.00182071,.999639,.0661361,0,.0043894,.999378,.0662814,0,.00800055,.998985,.0664779,0,.0125594,.998285,.0666914,0,.0179786,.995071,.0661989,0,.0241822,.993172,.0660454,0,.031106,.991438,.0660105,0,.0386952,.988428,.0656875,0,.0469032,.985218,.0652913,0,.0556905,.981128,.0647107,0,.065023,.976015,.0638491,0,.0748717,.97097,.062993,0,.0852112,.964582,.0617927,0,.0960199,.957383,.0603626,0,.107279,.949969,.0588128,0,.118971,.941843,.0570274,0,.131084,.933624,.0551885,0,.143604,.924543,.053122,0,.156521,.914919,.0508897,0,.169825,.905773,.0486418,0,.18351,.896434,.0463364,0,.197569,.887195,.0440623,0,.211997,.877706,.0417799,0,.226789,.867719,.03945,0,.241944,.858587,.037243,0,.257458,.849317,.0350956,0,.273331,.839585,.0329852,0,.289563,.829856,.0310028,0,.306154,.819589,.0290953,0,.323108,.809714,.0272738,0,.340426,.79934,.0255631,0,.358113,.788224,.0239175,0,.376175,.776619,.0223831,0,.394616,.76521,.0209298,0,.413445,.753716,.0195786,0,.432671,.741564,.0183001,0,.452305,.729413,.0171259,0,.472358,.717146,.0159933,0,.492845,.70436,.0149495,0,.513783,.69219,.0139681,0,.535189,.680289,.0130577,0,.557087,.669611,.0122198,0,.5795,.659113,.0114174,0,.602459,.648148,.0106729,0,.625997,.636905,.00998997,0,.650154,.625154,.00934313,0,.674976,.613481,.00874839,0,.700518,.60154,.00818265,0,.726845,.58943,.00766889,0,.754032,.576828,.00717153,0,.782167,.564194,.00672696,0,.811344,.551501,.00630863,0,.841644,.538635,.00592177,0,.873016,.525724,.00554888,0,.904762,.513209,.00520225,0,.936508,.500457,.00488231,0,.968254,.48799,.00457153,0,1,1,.0810131,0,0,1,.0810133,0,0,.999997,.0810145,0,0,.999985,.08102,0,0,.999956,.0810347,0,195026e-10,.999893,.0810656,0,719316e-9,.999777,.0811205,0,.00259774,.999583,.081208,0,.00561807,.999281,.0813343,0,.00967472,.998813,.0814969,0,.0146627,.997597,.0815217,0,.0204902,.994379,.0808502,0,.0270802,.992744,.0806792,0,.0343674,.990745,.0804589,0,.0422974,.986646,.0796107,0,.0508242,.983611,.0790913,0,.0599087,.978869,.0780746,0,.0695175,.973475,.0768218,0,.0796223,.967845,.0754926,0,.0901983,.960778,.0737063,0,.101224,.953333,.0718052,0,.112682,.945274,.0695946,0,.124555,.936955,.0672492,0,.136831,.928319,.0647732,0,.149496,.919075,.0620947,0,.162542,.909114,.0591816,0,.175958,.900137,.0563917,0,.189739,.891069,.0535392,0,.203877,.882262,.0507642,0,.218368,.873232,.0479793,0,.233208,.864042,.045226,0,.248393,.855002,.0425413,0,.263923,.846569,.0400126,0,.279796,.837714,.0375269,0,.296012,.828918,.0352027,0,.312573,.819783,.0330011,0,.329479,.810129,.0308908,0,.346734,.800866,.0289112,0,.364342,.79093,.0270255,0,.382307,.780593,.0252758,0,.400637,.769511,.0236178,0,.419337,.758558,.0220652,0,.438418,.747632,.0206289,0,.457889,.736146,.0192873,0,.477761,.724093,.0180333,0,.49805,.71234,.0168264,0,.51877,.700201,.015746,0,.53994,.687949,.0147027,0,.561581,.676163,.0137512,0,.583718,.665001,.0128655,0,.60638,.65472,.0120366,0,.629599,.644213,.0112604,0,.653415,.633382,.0105413,0,.677874,.62212,.00986498,0,.70303,.610631,.00923308,0,.728948,.599078,.00864206,0,.755706,.587519,.00811784,0,.783396,.575505,.00761237,0,.812121,.563148,.00713949,0,.841989,.550828,.00668379,0,.873035,.538458,.00627715,0,.904762,.525905,.00588336,0,.936508,.513517,.00552687,0,.968254,.501395,.00519681,0,1,1,.0991506,0,0,1,.0991504,0,0,.999996,.0991515,0,0,.999984,.0991558,0,0,.999947,.0991672,0,114389e-9,.999874,.0991912,0,.00121503,.999739,.0992331,0,.00356108,.999514,.0992983,0,.00705578,.999159,.0993877,0,.011574,.998586,.0994837,0,.017003,.995731,.0988425,0,.0232484,.993384,.098276,0,.0302318,.991615,.0979269,0,.0378884,.989029,.0973432,0,.0461641,.985373,.0963539,0,.0550136,.981278,.0952306,0,.0643988,.975777,.0936233,0,.0742868,.970526,.0920219,0,.0846501,.963755,.0898912,0,.0954644,.956676,.0876064,0,.106709,.948099,.0847751,0,.118367,.939718,.0818638,0,.130423,.931305,.078857,0,.142862,.922342,.0756127,0,.155674,.912842,.0721473,0,.168849,.903304,.0686195,0,.182378,.89411,.0650589,0,.196255,.885512,.0616022,0,.210473,.877193,.0582434,0,.225027,.86877,.0548979,0,.239915,.860267,.0516095,0,.255132,.851915,.048468,0,.270678,.843912,.0454447,0,.286551,.83604,.0425612,0,.302751,.828245,.0398752,0,.31928,.820159,.0373198,0,.336138,.81167,.034916,0,.35333,.802659,.0326402,0,.370858,.793921,.0304901,0,.388728,.784713,.0284857,0,.406944,.774946,.0266186,0,.425515,.76448,.0248593,0,.444449,.753793,.0232114,0,.463756,.743506,.0217039,0,.483447,.732555,.0202841,0,.503535,.720965,.0189648,0,.524036,.709422,.0177189,0,.544968,.697756,.0165626,0,.56635,.685565,.015483,0,.588208,.673987,.0144892,0,.610569,.66244,.0135607,0,.633466,.651675,.0126956,0,.656936,.641598,.0118788,0,.681025,.63121,.0111261,0,.705788,.620514,.010437,0,.731289,.609366,.00978747,0,.757606,.598137,.00917257,0,.784834,.586966,.00859778,0,.813085,.575549,.00806803,0,.842485,.563797,.00757294,0,.87313,.551758,.00710592,0,.904762,.539894,.0066841,0,.936508,.527901,.00627901,0,.968254,.515819,.00590506,0,1,1,.120864,0,0,1,.120864,0,0,.999996,.120864,0,0,.99998,.120867,0,0,.99994,.120872,0,323781e-9,.999852,.120884,0,.00188693,.999693,.120903,0,.00473489,.999426,.120929,0,.00872704,.999002,.120955,0,.0137237,.998235,.120918,0,.0196068,.994608,.119764,0,.0262803,.992997,.119265,0,.0336657,.990968,.11863,0,.0416987,.987002,.117261,0,.0503261,.983524,.116009,0,.0595035,.97875,.114252,0,.0691935,.972652,.11193,0,.0793645,.966613,.109555,0,.0899894,.959275,.106612,0,.101045,.951272,.103375,0,.112512,.942323,.0996594,0,.124372,.933679,.0958841,0,.136611,.924822,.0919265,0,.149216,.915742,.0878061,0,.162176,.906348,.0834894,0,.175482,.896883,.079085,0,.189125,.88774,.0746745,0,.203098,.87986,.0705773,0,.217396,.871998,.0665005,0,.232015,.864325,.0625413,0,.24695,.856685,.0586781,0,.2622,.84925,.0550063,0,.277761,.841719,.0514727,0,.293634,.834755,.0481398,0,.309819,.827853,.0450172,0,.326315,.820888,.0420969,0,.343126,.813616,.0393702,0,.360254,.805767,.0367771,0,.377701,.797338,.0343274,0,.395474,.789122,.0320529,0,.413577,.780601,.0299485,0,.432018,.771424,.0279812,0,.450804,.761502,.0261054,0,.469944,.751166,.0243942,0,.489451,.741276,.0228087,0,.509337,.730898,.0213265,0,.529617,.719878,.0199307,0,.550307,.708379,.0186574,0,.571428,.697165,.0174446,0,.593003,.685554,.0163144,0,.615059,.673631,.015276,0,.637628,.662385,.0143003,0,.660746,.651059,.0134112,0,.68446,.640451,.0125794,0,.70882,.630536,.011793,0,.733893,.620316,.0110547,0,.759756,.609722,.0103668,0,.786505,.598804,.00973009,0,.814259,.587871,.00912812,0,.843157,.577121,.00858916,0,.87334,.566019,.00807333,0,.904762,.554664,.00759687,0,.936508,.543101,.00714759,0,.968254,.531558,.00673418,0,1,1,.146767,0,0,1,.146767,0,0,.999997,.146767,0,0,.999977,.146765,0,320658e-11,.999929,.146762,0,682576e-9,.999823,.146753,0,.00276402,.999633,.146735,0,.00614771,.999314,.146699,0,.0106613,.998796,.14662,0,.0161546,.997124,.146107,0,.0225063,.994062,.144857,0,.0296198,.992154,.144011,0,.037417,.989186,.142712,0,.0458348,.985279,.140926,0,.0548211,.980826,.13885,0,.0643326,.975056,.136168,0,.074333,.969005,.133217,0,.0847917,.961554,.12959,0,.0956828,.954206,.125886,0,.106984,.945046,.121335,0,.118675,.935678,.116492,0,.130741,.926748,.111635,0,.143166,.917764,.106625,0,.155939,.908358,.101325,0,.169049,.899219,.0960249,0,.182487,.890089,.0906527,0,.196245,.881488,.0853905,0,.210317,.874031,.0804177,0,.224697,.866932,.0756005,0,.23938,.859976,.0709019,0,.254364,.853375,.0664391,0,.269646,.846971,.0622012,0,.285223,.840483,.058129,0,.301096,.833969,.0542762,0,.317265,.82806,.0507042,0,.333729,.822128,.047368,0,.350491,.815989,.044272,0,.367554,.809336,.0413444,0,.38492,.802177,.038601,0,.402594,.79441,.0360227,0,.420582,.786573,.0336383,0,.438891,.778619,.0314321,0,.457527,.77,.029362,0,.476499,.760698,.0274102,0,.49582,.750932,.0256146,0,.5155,.740993,.023974,0,.535555,.731159,.0224182,0,.556,.720836,.0209889,0,.576855,.709913,.0196411,0,.598143,.698415,.0183824,0,.619888,.68745,.0172222,0,.642123,.676154,.0161509,0,.664883,.664383,.0151397,0,.688211,.6533,.0141873,0,.71216,.642072,.0133105,0,.736792,.631412,.0124932,0,.762186,.621622,.0117408,0,.788439,.611681,.0110358,0,.815672,.60142,.0103775,0,.844034,.59083,.00975623,0,.873699,.580254,.00918084,0,.904765,.569841,.00864721,0,.936508,.559224,.00815731,0,.968254,.548315,.00767924,0,1,1,.177563,0,0,1,.177563,0,0,.999994,.177562,0,0,.999972,.177555,0,664171e-10,.999914,.177536,0,.0012276,.999787,.177496,0,.00388025,.999556,.17742,0,.00783463,.999165,.177285,0,.0128953,.9985,.177037,0,.0189053,.995388,.175634,0,.025742,.993102,.174375,0,.033309,.990992,.173121,0,.0415298,.986932,.170896,0,.0503425,.982786,.16847,0,.0596964,.977592,.165455,0,.0695498,.971075,.161676,0,.0798676,.963967,.157458,0,.0906201,.956397,.152836,0,.101783,.947489,.147467,0,.113333,.937564,.14145,0,.125254,.928182,.135383,0,.137529,.919027,.129212,0,.150144,.909618,.12276,0,.163088,.900492,.116273,0,.176351,.891671,.1098,0,.189924,.883146,.103362,0,.203799,.875151,.0970799,0,.21797,.868338,.0911732,0,.232433,.862033,.0854966,0,.247182,.856107,.0800691,0,.262216,.850644,.0749618,0,.27753,.845261,.070079,0,.293124,.839885,.0654321,0,.308997,.834609,.0610975,0,.325149,.829083,.0569741,0,.341581,.82404,.0531736,0,.358294,.818968,.049665,0,.37529,.813496,.0463856,0,.392573,.807533,.0433217,0,.410148,.80099,.0404402,0,.428019,.793891,.0377578,0,.446192,.786281,.0352616,0,.464676,.778773,.0329577,0,.483478,.770737,.030808,0,.502608,.762094,.0287964,0,.522079,.752898,.0269254,0,.541905,.743306,.0251926,0,.5621,.733416,.023595,0,.582684,.723742,.0221155,0,.603677,.713542,.0207435,0,.625106,.702755,.019434,0,.646998,.691484,.0182046,0,.66939,.680531,.0170771,0,.692324,.66953,.0160339,0,.715849,.658126,.0150677,0,.740028,.646933,.0141551,0,.764937,.636107,.0133179,0,.790673,.625271,.0125284,0,.817358,.615225,.0117937,0,.84515,.605678,.0111181,0,.874244,.59583,.0104759,0,.904828,.585704,.00986672,0,.936508,.575413,.00929712,0,.968254,.565373,.00876713,0,1,1,.214058,0,0,.999999,.214058,0,0,.999994,.214055,0,0,.999966,.214039,0,259642e-9,.999893,.213998,0,.00200075,.999737,.21391,0,.00527775,.999449,.213745,0,.00983959,.99896,.213458,0,.0154755,.9979,.212855,0,.0220249,.994278,.210779,0,.0293654,.992254,.20926,0,.0374021,.98881,.206908,0,.0460604,.984715,.204009,0,.0552802,.979738,.200471,0,.0650127,.972884,.195813,0,.0752175,.965996,.190856,0,.0858612,.957974,.185077,0,.0969155,.949155,.17868,0,.108356,.939288,.171513,0,.120163,.928996,.163838,0,.132319,.919563,.156246,0,.144808,.910004,.148359,0,.157618,.900791,.140417,0,.170737,.892135,.132569,0,.184155,.883803,.124741,0,.197866,.876034,.117091,0,.211861,.869219,.109835,0,.226134,.863062,.102859,0,.240682,.857795,.0962928,0,.255499,.853009,.0900725,0,.270583,.848603,.0842101,0,.285931,.844335,.0786527,0,.301542,.840208,.0734397,0,.317415,.836035,.0685334,0,.33355,.83172,.0639275,0,.349948,.827135,.0595909,0,.36661,.822797,.0556204,0,.383539,.818387,.0519394,0,.400738,.813565,.0485317,0,.41821,.808142,.0453138,0,.435961,.802212,.0423354,0,.453997,.79573,.0395553,0,.472324,.788741,.036988,0,.490951,.781093,.0345688,0,.509887,.773597,.0323297,0,.529144,.765622,.0302719,0,.548735,.757083,.0283477,0,.568674,.747992,.0265562,0,.588979,.738591,.0248844,0,.609671,.728719,.0233342,0,.630773,.719146,.0219081,0,.652314,.709165,.0205711,0,.674328,.69875,.0193248,0,.696854,.687884,.0181582,0,.719942,.676818,.0170746,0,.743651,.666247,.0160718,0,.768057,.655284,.0151262,0,.793253,.64401,.0142561,0,.819363,.633353,.0134327,0,.846547,.622674,.012653,0,.875017,.612265,.0119354,0,.905021,.602455,.0112533,0,.936508,.593147,.0106234,0,.968254,.583592,.0100213,0,1,1,.25717,0,0,1,.25717,0,0,.999992,.257164,0,0,.999958,.257135,0,641715e-9,.999864,.25706,0,.00305314,.999666,.256897,0,.00700975,.999302,.256596,0,.0122194,.998663,.25607,0,.0184622,.995607,.254123,0,.0255773,.993094,.252081,0,.0334439,.9907,.249867,0,.0419696,.98594,.246118,0,.0510823,.981214,.242049,0,.0607242,.974966,.236869,0,.0708486,.967589,.230724,0,.081417,.95915,.223635,0,.0923974,.950257,.21596,0,.103763,.940165,.207296,0,.115491,.929396,.197901,0,.127562,.919288,.188437,0,.13996,.909428,.178762,0,.15267,.900105,.169072,0,.165679,.891418,.159478,0,.178979,.883347,.15002,0,.192558,.875992,.140813,0,.20641,.869466,.13196,0,.220529,.863699,.123501,0,.234907,.858553,.115436,0,.249542,.854379,.107901,0,.264428,.850894,.10088,0,.279564,.847632,.0942296,0,.294947,.844571,.0879861,0,.310575,.84163,.0821534,0,.326448,.838542,.0766409,0,.342566,.835412,.0715322,0,.358929,.831899,.0666883,0,.37554,.828177,.0622175,0,.392399,.82416,.0580452,0,.409511,.820393,.054267,0,.426878,.816068,.0507172,0,.444506,.811201,.0474041,0,.4624,.805785,.0443174,0,.480566,.799878,.0414562,0,.499013,.793469,.0388147,0,.517749,.786473,.0363453,0,.536785,.778874,.0340225,0,.556134,.771277,.0318599,0,.575809,.763426,.0298859,0,.595827,.755044,.0280357,0,.616207,.746161,.0262979,0,.636973,.737124,.0247295,0,.65815,.72761,.0232514,0,.679772,.717822,.0218755,0,.701876,.708279,.0205942,0,.724509,.698333,.0193947,0,.74773,.68802,.0182717,0,.771609,.677321,.0172044,0,.79624,.666504,.0162122,0,.821743,.656184,.0152924,0,.84828,.64556,.0144326,0,.876069,.634636,.0136157,0,.905404,.624124,.0128612,0,.936508,.613914,.0121435,0,.968254,.603589,.0114887,0,1,1,.307946,0,0,.999999,.307945,0,0,.999988,.307934,0,204479e-10,.999944,.307886,0,.00127833,.999824,.307756,0,.00445047,.999565,.30748,0,.00914673,.999085,.306966,0,.0150498,.998103,.306004,0,.0219367,.994249,.303028,0,.0296485,.991807,.300435,0,.038068,.987773,.296554,0,.0471062,.982673,.2916,0,.0566942,.976623,.285641,0,.0667768,.968757,.27815,0,.0773099,.959849,.269529,0,.088257,.950663,.260248,0,.0995879,.940129,.249704,0,.111277,.92895,.238291,0,.123304,.917996,.226501,0,.13565,.907813,.214669,0,.148299,.898305,.202835,0,.161237,.889626,.191158,0,.174455,.88175,.179695,0,.187941,.874715,.168548,0,.201687,.868746,.15792,0,.215687,.863703,.147807,0,.229933,.859315,.138149,0,.24442,.855538,.128993,0,.259145,.852428,.120414,0,.274103,.850168,.112498,0,.289293,.848132,.105054,0,.304711,.846291,.0981087,0,.320357,.844431,.0915942,0,.33623,.842493,.0855056,0,.35233,.840368,.0798204,0,.368658,.83798,.0745097,0,.385214,.83523,.0695424,0,.402002,.832091,.0649092,0,.419023,.828667,.0606291,0,.436282,.824805,.0566523,0,.453782,.820988,.0530229,0,.471529,.816635,.0496364,0,.489528,.811725,.0464658,0,.507788,.806316,.0435082,0,.526317,.800469,.0407873,0,.545124,.794107,.038255,0,.564221,.787218,.0358825,0,.583621,.779872,.0336785,0,.603341,.772097,.0316379,0,.623397,.764484,.0297379,0,.643812,.756428,.0279581,0,.664611,.748022,.0263153,0,.685824,.739268,.0247799,0,.707488,.73024,.0233385,0,.729646,.720893,.0220035,0,.752354,.71119,.0207555,0,.77568,.701791,.0195843,0,.799715,.692184,.0184891,0,.824574,.682258,.0174541,0,.850417,.67206,.0164873,0,.877466,.661717,.0155959,0,.90604,.651462,.0147519,0,.936528,.641467,.0139727,0,.968254,.631229,.0132363,0,1,1,.367573,0,0,.999999,.367571,0,0,.999984,.367553,0,183382e-9,.999925,.367473,0,.00225254,.999759,.367259,0,.00628165,.99941,.366801,0,.0117858,.998739,.365946,0,.0184359,.995529,.363191,0,.0260114,.992875,.360171,0,.0343581,.989135,.355981,0,.0433637,.984166,.350401,0,.0529438,.977871,.343348,0,.0630334,.96951,.334341,0,.0735805,.959964,.323862,0,.0845437,.950162,.312521,0,.095889,.938882,.299577,0,.107588,.926992,.285573,0,.119617,.915589,.271212,0,.131957,.904791,.256611,0,.144591,.895177,.242224,0,.157503,.886403,.227952,0,.170682,.878957,.214192,0,.184117,.872418,.200795,0,.197799,.867029,.188015,0,.21172,.862835,.175975,0,.225873,.859411,.164526,0,.240253,.856655,.153693,0,.254854,.854519,.14352,0,.269673,.852828,.13397,0,.284707,.851412,.124984,0,.299953,.850609,.116748,0,.315408,.849855,.10905,0,.331073,.849017,.101839,0,.346946,.848079,.0951359,0,.363028,.846911,.0888774,0,.379318,.845445,.0830375,0,.395818,.84362,.0775844,0,.41253,.841411,.0725054,0,.429457,.838768,.0677691,0,.446602,.835801,.0634016,0,.463968,.832341,.0593095,0,.481561,.828424,.0555121,0,.499386,.824312,.052024,0,.51745,.819918,.0487865,0,.535761,.815072,.0457801,0,.554328,.809863,.0430184,0,.573162,.804164,.0404245,0,.592275,.798034,.0380146,0,.611681,.791436,.0357436,0,.631398,.784498,.0336475,0,.651445,.777125,.0316666,0,.671845,.769365,.0298122,0,.692628,.761579,.0281001,0,.713827,.753746,.0265049,0,.735484,.745573,.0250067,0,.75765,.737083,.0236026,0,.78039,.728545,.0223302,0,.803789,.719691,.0211243,0,.82796,.710569,.0199983,0,.853056,.701216,.0189569,0,.879298,.692094,.0179702,0,.907014,.682909,.0170418,0,.936691,.673509,.0161732,0,.968254,.663863,.0153406,0,1,1,.437395,0,0,.999998,.437394,0,0,.99998,.437363,0,616704e-9,.999891,.437232,0,.00367925,.999656,.436877,0,.00867446,.999148,.436121,0,.0150679,.997959,.434564,0,.022531,.993464,.430134,0,.0308507,.990606,.426077,0,.0398805,.985027,.419397,0,.0495148,.978491,.41118,0,.0596749,.969643,.40048,0,.0703001,.959189,.38769,0,.0813427,.948223,.373575,0,.0927641,.935955,.357622,0,.104533,.923237,.34043,0,.116624,.911074,.322735,0,.129015,.899724,.30479,0,.141687,.890189,.287392,0,.154626,.881796,.270248,0,.167818,.874781,.253659,0,.181252,.869166,.237786,0,.194918,.864725,.222618,0,.208807,.861565,.208356,0,.222913,.859284,.194867,0,.237229,.857677,.18212,0,.25175,.856714,.17018,0,.266473,.856155,.158969,0,.281392,.8558,.148413,0,.296505,.855672,.138578,0,.311811,.855538,.129345,0,.327306,.855689,.120861,0,.342991,.855767,.112969,0,.358864,.855618,.105593,0,.374925,.85525,.0987451,0,.391176,.854583,.0923727,0,.407616,.853534,.0864143,0,.424249,.852061,.0808338,0,.441076,.850253,.0756771,0,.4581,.848004,.0708612,0,.475324,.845333,.0663784,0,.492754,.842376,.0622631,0,.510394,.838956,.0584112,0,.528251,.835121,.0548328,0,.546331,.830842,.0514838,0,.564644,.826212,.048355,0,.583198,.821522,.0454714,0,.602005,.816551,.0428263,0,.621078,.811211,.0403612,0,.640434,.805479,.038039,0,.660089,.799409,.0358739,0,.680066,.79306,.0338727,0,.70039,.786395,.0319985,0,.721094,.779416,.030241,0,.742215,.77214,.0285951,0,.7638,.764636,.0270747,0,.785912,.756836,.0256354,0,.808628,.749315,.0243027,0,.832055,.741561,.0230497,0,.856338,.733589,.0218801,0,.88169,.725479,.020784,0,.908441,.717255,.0197702,0,.937125,.708829,.0188168,0,.968254,.700191,.0179113,0,1,1,.518937,0,0,.999998,.518933,0,0,.999967,.518883,0,.00147741,.999832,.51866,0,.00573221,.999466,.518057,0,.011826,.998644,.516752,0,.0192116,.994458,.512347,0,.027573,.991223,.507675,0,.0367099,.985515,.500188,0,.046487,.978308,.490408,0,.0568071,.968359,.477357,0,.0675984,.95682,.461752,0,.0788059,.943929,.443796,0,.090386,.930224,.423893,0,.102304,.916514,.402682,0,.114532,.903653,.380914,0,.127047,.892315,.359212,0,.139828,.882942,.338102,0,.152861,.875438,.31773,0,.16613,.869642,.298186,0,.179624,.865304,.279491,0,.193332,.862382,.261804,0,.207247,.860666,.245146,0,.22136,.859788,.229406,0,.235666,.859608,.214605,0,.250158,.859912,.200691,0,.264832,.86053,.187623,0,.279684,.861368,.17539,0,.294711,.862237,.163901,0,.309911,.863127,.153175,0,.32528,.863923,.143147,0,.340819,.864567,.133781,0,.356524,.865013,.125042,0,.372397,.86539,.116952,0,.388438,.865591,.109476,0,.404645,.865517,.102542,0,.421022,.865084,.0960688,0,.437569,.864309,.0900499,0,.454287,.863151,.0844328,0,.471181,.861649,.0792218,0,.488253,.859742,.0743482,0,.505507,.857446,.0697963,0,.522947,.854757,.0655364,0,.54058,.851783,.061608,0,.558412,.848516,.0579701,0,.576449,.844897,.0545742,0,.594701,.840956,.0514167,0,.613178,.836676,.0484598,0,.631892,.832075,.0456934,0,.650856,.827191,.0431178,0,.670088,.822295,.0407718,0,.689606,.817294,.0386032,0,.709434,.812013,.0365675,0,.7296,.806465,.0346547,0,.750138,.800691,.0328717,0,.771093,.794709,.031211,0,.792519,.788493,.0296504,0,.814488,.782049,.0281782,0,.837097,.775403,.0267965,0,.860481,.76857,.0255002,0,.884842,.761536,.0242759,0,.910494,.754303,.0231142,0,.937985,.74692,.0220305,0,.968254,.739745,.0210192,0,1,1,.613914,0,0,.999996,.613907,0,963597e-10,.999942,.613814,0,.00301247,.999704,.613407,0,.00870385,.999046,.612302,0,.0160714,.995516,.608266,0,.0245899,.991726,.602863,0,.0339681,.985157,.593956,0,.0440254,.97642,.581748,0,.0546409,.964404,.565183,0,.0657284,.950601,.545273,0,.0772246,.935158,.522129,0,.0890812,.919364,.496782,0,.10126,.904754,.470571,0,.113731,.89176,.444037,0,.126469,.881492,.418322,0,.139454,.873656,.393522,0,.15267,.868053,.369795,0,.166101,.864336,.347171,0,.179736,.862259,.325737,0,.193565,.861556,.305532,0,.207578,.861776,.286416,0,.221769,.862661,.268355,0,.23613,.864015,.251334,0,.250656,.865711,.235352,0,.265343,.867519,.220302,0,.280187,.869351,.206161,0,.295183,.871144,.192908,0,.31033,.872839,.180505,0,.325624,.874307,.168848,0,.341065,.875667,.158021,0,.35665,.876758,.147877,0,.37238,.87764,.138441,0,.388253,.878237,.129627,0,.404269,.878563,.121415,0,.42043,.878572,.113741,0,.436735,.87842,.106652,0,.453187,.878057,.100097,0,.469786,.877413,.0940128,0,.486536,.87646,.0883462,0,.503439,.875233,.0830924,0,.520498,.8737,.0781975,0,.537717,.871873,.07364,0,.555102,.86978,.0694103,0,.572657,.867405,.0654696,0,.59039,.864751,.0617914,0,.608307,.861818,.0583491,0,.626419,.858645,.0551443,0,.644733,.855307,.0521894,0,.663264,.851736,.0494334,0,.682025,.847927,.0468504,0,.701032,.843888,.0444261,0,.720308,.839629,.0421497,0,.739875,.835158,.0400082,0,.759764,.830509,.0380076,0,.780014,.825714,.0361488,0,.800673,.820729,.0343956,0,.821803,.815751,.0327781,0,.843492,.810752,.031275,0,.86586,.805587,.0298542,0,.889087,.800317,.0285397,0,.913466,.79489,.0272948,0,.93952,.789314,.0261139,0,.96835,.783593,.0249938,0,1,1,.724258,0,0,.999992,.724243,0,726889e-9,.99987,.724044,0,.00569574,.999336,.72317,0,.0131702,.996271,.719432,0,.0220738,.991159,.712576,0,.0319405,.982465,.700927,0,.0425202,.97049,.684297,0,.0536599,.953973,.661244,0,.065258,.935546,.633804,0,.0772427,.916596,.603071,0,.0895616,.899353,.57105,0,.102175,.885216,.539206,0,.11505,.875076,.508714,0,.128164,.868334,.479571,0,.141495,.864414,.451796,0,.155026,.862678,.425328,0,.168745,.862835,.400352,0,.182639,.864067,.376532,0,.196699,.866086,.35391,0,.210915,.868557,.332424,0,.225282,.871271,.312053,0,.239792,.874058,.292764,0,.25444,.8768,.27453,0,.269223,.87939,.257297,0,.284135,.8819,.24114,0,.299174,.884187,.225934,0,.314337,.886262,.211669,0,.329622,.888119,.198311,0,.345026,.889709,.185783,0,.360549,.891054,.174063,0,.376189,.892196,.163143,0,.391946,.893101,.152952,0,.407819,.893803,.143475,0,.423808,.894277,.134647,0,.439914,.894532,.126434,0,.456137,.894576,.1188,0,.472479,.894393,.111694,0,.48894,.893976,.105069,0,.505523,.893346,.0989077,0,.52223,.892502,.0931724,0,.539064,.891441,.0878276,0,.556028,.890276,.082903,0,.573125,.888972,.0783505,0,.590361,.887469,.0741083,0,.607741,.885785,.0701633,0,.62527,.883914,.0664835,0,.642957,.881872,.0630567,0,.660809,.879651,.0598527,0,.678836,.877267,.0568615,0,.69705,.874717,.05406,0,.715465,.872012,.0514378,0,.734098,.869157,.0489805,0,.752968,.866155,.0466727,0,.772101,.863014,.0445056,0,.791529,.859748,.0424733,0,.81129,.856416,.0405957,0,.831438,.852958,.0388273,0,.852044,.849382,.0371619,0,.87321,.845694,.0355959,0,.89509,.841893,.0341155,0,.917932,.837981,.0327141,0,.942204,.833963,.0313856,0,.968981,.829847,.0301275,0,1,1,.85214,0,0,.999969,.852095,0,.00279627,.999483,.851408,0,.0107635,.994545,.84579,0,.0206454,.986188,.835231,0,.0315756,.969847,.814687,0,.0432021,.945951,.783735,0,.0553396,.91917,.746074,0,.0678766,.895488,.706938,0,.0807395,.878232,.669534,0,.0938767,.868252,.635168,0,.10725,.863873,.603069,0,.120832,.863369,.572514,0,.134598,.86545,.543169,0,.148533,.868803,.514578,0,.16262,.872794,.486762,0,.176849,.87702,.459811,0,.19121,.881054,.433654,0,.205694,.884974,.408574,0,.220294,.888587,.384525,0,.235005,.891877,.36156,0,.24982,.894793,.339661,0,.264737,.89743,.318913,0,.279751,.899796,.299302,0,.294859,.901943,.280843,0,.310058,.903858,.263481,0,.325346,.905574,.247197,0,.340721,.907069,.231915,0,.356181,.908379,.217614,0,.371725,.90952,.20425,0,.387353,.910483,.191758,0,.403063,.91128,.180092,0,.418854,.911936,.169222,0,.434727,.912454,.159098,0,.450682,.912835,.149668,0,.466718,.913078,.140884,0,.482837,.913192,.132709,0,.499038,.913175,.125095,0,.515324,.91304,.118012,0,.531695,.912781,.111417,0,.548153,.91241,.105281,0,.5647,.911924,.0995691,0,.581338,.911331,.0942531,0,.59807,.910637,.0893076,0,.6149,.90984,.0846998,0,.63183,.908941,.0804044,0,.648865,.907944,.0763984,0,.666011,.906857,.0726638,0,.683273,.90568,.0691783,0,.700659,.904416,.0659222,0,.718176,.903067,.0628782,0,.735834,.901637,.0600307,0,.753646,.900128,.0573647,0,.771625,.898544,.0548668,0,.78979,.89689,.052527,0,.808162,.895165,.0503306,0,.826771,.893371,.0482668,0,.845654,.891572,.0463605,0,.864863,.889763,.0445998,0,.884472,.887894,.0429451,0,.904592,.885967,.0413884,0,.925407,.883984,.0399225,0,.947271,.881945,.0385405,0,.97105,.879854,.0372362,0,1,.999804,.995833,0,0,.938155,.933611,0,.0158731,.864755,.854311,0,.0317461,.888594,.865264,0,.0476191,.905575,.863922,0,.0634921,.915125,.850558,0,.0793651,.920665,.829254,0,.0952381,.924073,.802578,0,.111111,.926304,.772211,0,.126984,.927829,.739366,0,.142857,.928924,.705033,0,.15873,.92973,.670019,0,.174603,.930339,.634993,0,.190476,.930811,.600485,0,.206349,.931191,.566897,0,.222222,.93149,.534485,0,.238095,.931737,.503429,0,.253968,.931939,.473811,0,.269841,.932108,.445668,0,.285714,.93225,.418993,0,.301587,.932371,.393762,0,.31746,.932474,.369939,0,.333333,.932562,.347479,0,.349206,.932638,.326336,0,.365079,.932703,.306462,0,.380952,.93276,.287805,0,.396825,.932809,.270313,0,.412698,.932851,.253933,0,.428571,.932887,.23861,0,.444444,.932917,.224289,0,.460317,.932943,.210917,0,.47619,.932965,.19844,0,.492063,.932982,.186807,0,.507937,.932995,.175966,0,.52381,.933005,.165869,0,.539683,.933011,.156468,0,.555556,.933013,.147719,0,.571429,.933013,.139579,0,.587302,.93301,.132007,0,.603175,.933004,.124965,0,.619048,.932994,.118416,0,.634921,.932982,.112326,0,.650794,.932968,.106663,0,.666667,.93295,.101397,0,.68254,.932931,.0964993,0,.698413,.932908,.0919438,0,.714286,.932883,.0877057,0,.730159,.932856,.0837623,0,.746032,.932827,.0800921,0,.761905,.932796,.0766754,0,.777778,.932762,.0734936,0,.793651,.932727,.0705296,0,.809524,.932689,.0677676,0,.825397,.93265,.0651929,0,.84127,.932609,.0627917,0,.857143,.932565,.0605515,0,.873016,.932521,.0584606,0,.888889,.932474,.0565082,0,.904762,.932427,.0546841,0,.920635,.932377,.0529793,0,.936508,.932326,.0513851,0,.952381,.932274,.0498936,0,.968254,.93222,.0484975,0,.984127,.932164,.0471899,0,1],i=new Float32Array(t),a=new Float32Array(e);n.UniformsLib.LTC_FLOAT_1=new n.DataTexture(i,64,64,n.RGBAFormat,n.FloatType,n.UVMapping,n.ClampToEdgeWrapping,n.ClampToEdgeWrapping,n.LinearFilter,n.NearestFilter,1),n.UniformsLib.LTC_FLOAT_2=new n.DataTexture(a,64,64,n.RGBAFormat,n.FloatType,n.UVMapping,n.ClampToEdgeWrapping,n.ClampToEdgeWrapping,n.LinearFilter,n.NearestFilter,1),n.UniformsLib.LTC_FLOAT_1.needsUpdate=!0,n.UniformsLib.LTC_FLOAT_2.needsUpdate=!0;const s=new Uint16Array(t.length);t.forEach((function(t,e){s[e]=n.DataUtils.toHalfFloat(t)}));const o=new Uint16Array(e.length);e.forEach((function(t,e){o[e]=n.DataUtils.toHalfFloat(t)})),n.UniformsLib.LTC_HALF_1=new n.DataTexture(s,64,64,n.RGBAFormat,n.HalfFloatType,n.UVMapping,n.ClampToEdgeWrapping,n.ClampToEdgeWrapping,n.LinearFilter,n.NearestFilter,1),n.UniformsLib.LTC_HALF_2=new n.DataTexture(o,64,64,n.RGBAFormat,n.HalfFloatType,n.UVMapping,n.ClampToEdgeWrapping,n.ClampToEdgeWrapping,n.LinearFilter,n.NearestFilter,1),n.UniformsLib.LTC_HALF_1.needsUpdate=!0,n.UniformsLib.LTC_HALF_2.needsUpdate=!0}}function g(){return"ontouchstart"in document.documentElement}function m(t,e,i){const n=function(t,e){if(1===e.getSelectionSet().size){const i=e.getSelectionSet().values().next().value;return t.root.getIndexedNodeById(i)}return null}(t,e);return n&&i===n.data.type?n:null}function f(t){let e;switch(t.data.type){case o.r.DTPattern:e=t.parentNode.parentNode.parentNode;break;case o.r.DTTileList:e=t.parentNode.parentNode;break;case o.r.DTFace3D:e=t.parentNode;break;case o.r.DTTileInst:e=t.parentNode.parentNode.parentNode.parentNode}return e}function y(t,e=null){const i=o.i.FF_COVER|o.i.FF_FILLED,n=r.j;let a;t===o.J.FLOOR||t===o.J.HPLANE?(a=o.h.CLASSID_FLOOR,null==e&&(e=r.k)):(a=o.h.CLASSID_WALL,null==e&&(e=r.p));const s=new o.g(i,n,e,a,-1,[]);return new o.c(s)}function v(t,e){let i=t.root.getFirstChildOfType(o.r.DTMaskList);if(!i){const e=new o.q;i=new o.c(e),t.root.appendChild(i)}let n=!1;if(i.walkOnAllChildrenByType(o.r.DTMask,!1,(t=>{t.data.id===e.id&&(n=!0)})),!n){const t=new o.p(e.id,e.src,e.indexes,e.reflection,e.shading);t.contour2d=e.contour2d;const n=new o.c(t);i.appendChild(n)}}function x(t){let e=t.root.getFirstChildOfType(o.r.DTLightList);if(!e||0===e.childNodes.length){const i=new o.n;e=new o.c(i);const n=new o.l(o.o.Ambient,0,null,null,r.c,0,0,o.m.None),a=new o.c(n);e.appendChild(a),t.root.appendChild(e),t.projectChanged.notify({type:"LIGHT_ADDED",node:a})}}function T(t){const e=new n.PerspectiveCamera(t.fov,t.imageAspect,r.b,r.a);e.matrixAutoUpdate=!0;const i=new n.Vector3(0,0,t.heightFromGround);i.applyMatrix4(u.a),e.position.set(i.x,i.y,i.z);const a=new n.Vector3(0,0,-1);a.applyAxisAngle(new n.Vector3(1,0,0),-h.a.degToRad(t.grade)),a.normalize();const s=new n.Vector3(0,1,0);s.applyAxisAngle(new n.Vector3(0,0,1),h.a.degToRad(t.roll)),s.normalize(),e.up.set(s.x,s.y,s.z);const o=i.clone();return o.add(a),e.lookAt(o),e.updateMatrixWorld(),e.updateProjectionMatrix(),e.updateMatrix(),e}function M(t,e,i){const a=new n.Vector3(0,1,0),o=(new n.Plane).setFromNormalAndCoplanarPoint(a,new n.Vector3(0,0,0));let r;r=e?new n.Vector2(e.x*i.x/100,e.y*i.y/100):new n.Vector2(50*i.x/100,80*i.y/100);const h=s.a.getPlaneIntersection(o,r,t,i.x,i.y);return h.applyMatrix4(u.c),{x:h.x,y:h.y,z:0}}function C(t,e,i,a,o){const r=new n.Vector2(t.x*o.x/e.x,t.y*o.y/e.y);return s.a.getPlaneIntersection(i,r,a,o.x,o.y)}function b(t,e,i){return{x:t.x*i.x/e.x,y:t.y*i.y/e.y}}function P(t,e,i){return{x:t.x*e.x/i.x,y:t.y*e.y/i.y}}function E(t,e,i,a,o,r){const h=[],l=(new n.Plane).setFromNormalAndCoplanarPoint(e,i);for(const e of t){const t=s.a.getPlaneIntersection(l,new n.Vector2(e.x,e.y),r,a,o);t&&h.push(t)}return h}function D(t,e,i,a,o,r=window.devicePixelRatio){const h=[];for(const l of t){const t=new n.Vector3(l.x,l.y,l.z);o&&t.applyMatrix4(o);const c=s.a.worldToViewportPosition(t,a,e,i,r);h.push(c)}return h}function w(t,e,i,a,s,o){const l=new n.Plane(new n.Vector3(0,1,0),0),c=1e5*r.s;let d=T(a),u=C(t,o,l,d,s),p=C(e,o,l,d,s),g=i;if(null==u||u.x>c||u.y>c||null==p||p.x>c||p.y>c){const r=new n.Vector2(e.x*s.x/o.x,e.y*s.y/o.y).y,m=s.y/2,f=Math.abs(m-r-Math.abs(s.x/2*Math.tan(h.a.degToRad(a.roll))))/s.y;let y=Math.atan(f);if(a.grade=h.a.radToDeg(y),d=T(a),u=C(t,o,l,d,s),p=C(e,o,l,d,s),null==u||u.x>c||u.y>c||null==p||p.x>c||p.y>c)for(y=i;null==u||u.x>c||u.y>c||null==p||p.x>c||p.y>c;){if(y+=Math.PI/180,a.grade=h.a.radToDeg(y),a.grade>90){y=i;break}d=T(a),u=C(t,o,l,d,s),p=C(e,o,l,d,s)}g=y}return g}function S(t,e,i,a){const o=[],r=new n.Plane(new n.Vector3(0,1,0),0);let h=!1;for(const l of t){const t=new n.Vector2(l.x*a.x/i.x,l.y*a.y/i.y),c=s.a.getPlaneIntersection(r,t,e,a.x,a.y);c?(c.applyMatrix4(u.c),o.push({x:c.x,y:c.y})):h=!0}if(h)return null;const l=[],c=200;return l.push({x:o[0].x-c,y:o[0].y-200,z:0}),l.push({x:o[1].x-c,y:o[1].y+200,z:0}),l.push({x:o[2].x+c,y:o[2].y+200,z:0}),l.push({x:o[3].x+c,y:o[3].y-200,z:0}),l}function I(t,e,i,n,a){let o=null;const r=t.data;if(r.origin){const t=r.origin.x*n.x/100,l=r.origin.y*n.y/100,c=s.a.createRaycaster(i,n.x,n.y,t,l).intersectObjects(a,!0);if(c.length>0)for(const t of c)if(t.object.userData.id==e){o=Object(h.c)(t.point.applyMatrix4(u.c));break}}return o}function L(t,e,i){let s;if(e.lightType===o.o.Ambient)s=new n.AmbientLight(16777215,e.power),s.userData=new a.h(t);else if(e.lightType===o.o.Directional){console.debug("DIRECTIONAL: "+t),s=new n.DirectionalLight(16774855,e.power),s.userData=new a.h(t);const o=new n.Vector3(e.pnt.x,e.pnt.y,e.pnt.z);o.applyMatrix4(u.a),s.position.set(o.x,o.y,o.z);const r=new n.Vector3(e.targetPnt.x,e.targetPnt.y,e.targetPnt.z);r.applyMatrix4(u.a);const h=r.clone().sub(o),l=new n.Object3D;l.position.set(h.x,h.y,h.z),i.add(l),s.target=l}else if(e.lightType===o.o.Omni){console.debug("OMNI: "+t);const i=new n.Vector3(e.pnt.x,e.pnt.y,e.pnt.z);i.applyMatrix4(u.a),s=new n.PointLight,s.position.set(i.x,i.y,i.z),s.decay=2,s.power=e.power,s.shadow.mapSize.width=1024,s.shadow.mapSize.height=1024,s.shadow.radius=2.5,s.shadow.bias=-1e-5,s.color=new n.Color(1,.97,.94),s.userData=new a.h(t),s.visible=!0}else if(e.lightType===o.o.Rect){console.debug("RECT: "+t),p.init();const i=new n.Vector3(e.pnt.x,e.pnt.y,e.pnt.z);i.applyMatrix4(u.a),s=new n.RectAreaLight(16777215,0,e.areaDim1,e.areaDim2),s.userData=new a.h(t),s.position.set(i.x,i.y,i.z),s.rotation.y=e.angle,s.power=e.power}return i.add(s),s}function A(){const t=new o.n,e=new o.c(t),i=new o.l(o.o.Ambient,0,null,null,r.c,0,0,null),n=new o.c(i);return e.appendChild(n),e}function O(t,e){const i=t.root.data;let n,a,s,r;if(i.sceneType===o.I.STATIC)n=t.save();else if(i.sceneType===o.I.CUSTOM){const h=t.clone(),l=h.root.getChildNodes(!1);for(;l.moveNext();)switch(l.current.data.type){case o.r.DTBackgroundImage:{const t=l.current.data;a=t.src,t.src="api/share/texture?id="+i.sceneId+"/bg.jpg&storageAccount="+e;break}case o.r.DTMaskList:l.current.walkOnAllChildrenByType(o.r.DTMask,!1,(t=>{const n=t.data;n.id===o.F.FLOOR?(s=n.src,n.src="api/share/texture?id="+i.sceneId+"/floor.png&storageAccount="+e):n.id===o.F.WALL&&(r=n.src,n.src="api/share/texture?id="+i.sceneId+"/wall.png&storageAccount="+e)}))}n=h.save()}return{prjDataString:n,bgMask:a,floorMask:s,wallMask:r}}function R(t,e){let i=e.get(o.F.ALL);if(!i)switch(t){case o.J.FLOOR:case o.J.HPLANE:case o.J.RUG:case o.J.CORRIDOR:i=e.get(o.F.FLOOR);break;case o.J.WALL:case o.J.BACKSPLASH:i=e.get(o.F.WALL)}return i}function _(t){let e=o.F.FLOOR;switch(t){case o.J.FLOOR:case o.J.HPLANE:case o.J.RUG:case o.J.CORRIDOR:e=o.F.FLOOR;break;case o.J.WALL:case o.J.BACKSPLASH:e=o.F.WALL}return e}function k(t,e,i,n=!0){const a=[];for(const s of t){const t=s,r=new l.f({idProduct:t.idProduct,idManufacturer:t.idManuf,colorVar:"0",width:t.width,height:t.height,diagonal:t.diagonal,formatType:t.formatType,offshaded:t.offshaded,numImages:t.material.maps.length,dominantColor:null!=t.material.dominantColor?t.material.dominantColor:16777215,offshadedRot:t.offshadedRot,polygon:c.b.getTilePolygon(t.formatType,t.width,t.height,t.diagonal)});a.push(r);for(let a=0;a<t.material.maps.length;a++){const s=new o.f;s.key=new o.H(t.idManuf,t.idProduct,a+1),d.a.fillMaterialData(a,s,t.material),i.createExternalTileMat(r.idManufacturer,r.idProduct,r.colorVar,a+1,e,s,n)}}return a}function j(t,e,i){let n=`${t}${Number.isInteger(t)?".0":""}x${e}${Number.isInteger(e)?".0":""}`;return null!=i&&0!==i&&(n=`${n}x${i}${Number.isInteger(i)?".0":""}`),n}function N(t){const e=[];return t.root.walkOnAllChildrenByType(o.r.DTTiledLayer,!1,(t=>{const i=t.data,n={id:t.id,surfaceIndex:i.surfaceIndex,surfaceType:i.surfaceType};e.push(n)})),e}function F(t,e){let i=!1;for(const n of e){for(const e of t){const t=e.data;for(const e of t.layers)if(e===n.id){i=!0;break}if(i)break}if(i)break}return!i}function z(t,e){let i=null;if(e.getSelectionSet().size>0)for(const n of e.getSelectionSet().values()){const e=t.root.getIndexedNodeById(n);if(e&&e.data.type==o.r.DTTiledLayer){i=e.data.surfaceType;break}}return i}function B(t,e){let i=null;const n=t.root.getFirstChildOfType(o.r.DTGroupList);return n&&n.walkOnAllChildrenByType(o.r.DTGroup,!1,(t=>{if(!i){const n=t.data;for(const a of n.layers)if(a===e){i=t;break}}})),i}function H(t){return t===o.J.WALL||t===o.J.BACKSPLASH?l.e.WALL:t===o.J.FLOOR||t===o.J.HPLANE?l.e.FLOOR:void 0}function U(t,e){const i=t.getChildNodes(!0);for(;i.moveNextByType(o.r.DTTileInst);){const t=i.current.data;"SIST"!==t.idProduct&&"SIST"!==t.idManuf&&"SIST"!==t.colorVar&&e.add([t.idProduct,t.idManuf,t.colorVar].join("|"))}}},function(t,e,i){"use strict";i.d(e,"e",(function(){return n.c})),i.d(e,"c",(function(){return n.b})),i.d(e,"a",(function(){return n.a})),i.d(e,"g",(function(){return n.d})),i.d(e,"h",(function(){return a})),i.d(e,"d",(function(){return s.a})),i.d(e,"f",(function(){return u})),i.d(e,"b",(function(){return p.a}));i(33);var n=i(40);i(55);class a{constructor(t){this.id=t}}var s=i(47),o=i(2),r=i(0),h=i(21),l=i(10),c=i(17),d=i(30);class u{constructor(t,e){this.project=t,this.tileClient=e,this.patternStructureMap=new Map,this.tilingAreaFace3DDataMap=new Map}clear(){this.patternStructureMap.clear(),this.tilingAreaFace3DDataMap.clear()}addPattern(t,e,i,n,a,s,h,l=!1,c=!0){if(t.data.type!==r.r.DTFace3D)throw new Error("Invalid node type");const d=t.data,u=this.get2DFace3D(t);let p=null;if(null!=e){if(e.data.type!==r.r.DTPattern)throw new Error("Invalid node type");const t=e.parentNode;this.removePattern(e);const d=e.data,g=0,m=new r.s(s.posFile.id,n,i,g,a,s.posInfo.strategyId);m.areaRect=o.a.box2Clone(d.areaRect),m.v0=o.a.vec2Clone(s.posInfo.v0),m.v1=o.a.vec2Clone(s.posInfo.v1),h&&(m.origin=o.a.vec2Clone(h));const f=new r.c(m);t.appendChild(f),this.setPatternStructure(f.id,s),this.fillPattern(f,s,u.points),p=f.id,c&&this.project.projectChanged.notify({type:"PATTERN_ADDED",node:f,blockUI:l})}else{const e=t.getChildNodes(!1);let g;for(;e.moveNextByType(r.r.DTTileList);){if(e.current.data.flags!==r.z.Custom){g=e.current;break}}if(null==g){const e=this.getTileListDefaultFlags(d.classId),g=new r.y(u.points,u.points[0],e);g.modelToPoly=u._2DMatrix,g.polyToModel=u._3DMatrix;const m=0,f=new r.s(s.posFile.id,n,i,m,a,s.posInfo.strategyId);f.areaRect=o.a.poly2BoundingBox(u.points),f.v0=o.a.vec2Clone(s.posInfo.v0),f.v1=o.a.vec2Clone(s.posInfo.v1),h&&(f.origin=o.a.vec2Clone(h));const y=new r.c(f),v=new r.c(g);v.appendChild(y),this.setPatternStructure(y.id,s),this.fillPattern(y,s,u.points),t.appendChild(v),p=y.id,c&&this.project.projectChanged.notify({type:"PATTERN_ADDED",node:y,blockUI:l})}else{const t=this.getTileListHeight(g),e=0,d=new r.s(s.posFile.id,n,i,e,a,s.posInfo.strategyId);d.v0=o.a.vec2Clone(s.posInfo.v0),d.v1=o.a.vec2Clone(s.posInfo.v1),h&&(d.origin=o.a.vec2Clone(h));const m=o.a.poly2BoundingBox(u.points);d.areaRect={min:{x:m.min.x,y:t},max:m.max};const f=new r.c(d);g.appendChild(f),this.setPatternStructure(f.id,s),this.fillPattern(f,s,u.points),p=f.id,c&&this.project.projectChanged.notify({type:"PATTERN_ADDED",node:f,blockUI:l})}}return p}updateFace3DTileListNodes(t){if(t.data.type!==r.r.DTFace3D)throw new Error("Invalid node type");const e=t.data,i=this.get2DFace3D(t),n=o.a.poly2BoundingBox(i.points),a=t.getChildNodes(!1);for(;a.moveNextByType(r.r.DTTileList);){const s=a.current.data;if(s.flags===r.z.Full||s.flags===r.z.Horizontal)s.points=i.points,s.origin=i.points[0],s.modelToPoly=i._2DMatrix,s.polyToModel=i._3DMatrix;else if(s.flags===r.z.Custom&&e.classId!==r.h.CLASSID_FLOOR){const n=this.tilingAreaFace3DDataMap.get(t.id),a=o.a.vec3Negate(o.a.poly3Normal(n)),r=Object(h.c)(n,Object(h.b)(e),a),l=o.a.poly2ToPoly3(s.points,s.polyToModel,0),c=o.a.pnt3TransformArray(r._2DMatrix,l),d=o.a.poly2ToPoly3(c,i._3DMatrix,0),u=Object(h.c)(d,h.a.Default);s.modelToPoly=u._2DMatrix,s.polyToModel=u._3DMatrix,this.tilingAreaFace3DDataMap.set(t.id,o.a.vec3ArrayClone(e.points))}const l=a.current.getChildNodes(!1);for(;l.moveNextByType(r.r.DTPattern);){const t=l.current.data,e=l.current;let i;if(s.flags===r.z.Full)i=o.a.box2Clone(n);else if(s.flags===r.z.Horizontal){if(t.areaRect.min.y>n.max.y){this.removePattern(e);continue}i=o.a.box2Clone(t.areaRect),i.min.x=n.min.x,i.max={x:n.max.x,y:Math.min(t.areaRect.max.y,n.max.y)}}this.updatePatternProperties(e,null,null,null,i)}}}updatePattern(t,e){t.removeChildNodes();const i=this.get2DFace3D(t.parentNode.parentNode);this.setPatternStructure(t.id,e),this.fillPattern(t,e,i.points),this.project.projectChanged.notify({type:"PATTERN_UPDATED",node:t})}isRandomPattern(t){return null!=t.strategyId&&-1!==t.strategyId.indexOf("$SF_VFIX$")}updatePatternProperties(t,e,i,n,a,s,h){return new Promise(((c,d)=>{this.getOrCreatePatternStructure(t).then((d=>{const u=t.data;u.rotation,o.a.vec2Clone(u.origin);let p=null,g=!1,m=!1,f=!1;if(s&&h){const e=l.g.substituteTile(s,h,d,u.groutSize);this.setPatternStructure(t.id,e),f=!0}else null!=e&&e!==u.groutSize&&(u.groutSize=e,l.g.recalcPatternData(d,u.groutSize),u.v0=o.a.vec2Clone(d.posInfo.v0),u.v1=o.a.vec2Clone(d.posInfo.v1),this.setPatternStructure(t.id,d),g=!0),null!=i&&i!==u.rotation&&(u.rotation=i),null==n||o.a.vec2Equals(n,u.origin)||(u.origin.x=n.x,u.origin.y=n.y),null!=a&&(u.areaRect=o.a.box2Clone(a),m=!0);let y=!1;for(const e of t.childNodes)if(e.data.posMethod===r.x.SINGLE){y=!0;break}t.removeChildNodes();const v=r.G.getPatternFace3D(t),x=this.get2DFace3D(v);this.fillPattern(t,d,x.points,p,g,f);y&&this.isRandomPattern(u),this.project.projectChanged.notify({type:"PATTERN_UPDATED",node:t}),c()})).catch((t=>{console.log("[MatManager] getOrCreatePatternStructure error")}))}))}updatePatternSimpleProperties(t,e,i,n,a){const s=t.data;let h=!1;null!=i&&i!==s.groutSize&&(s.groutSize=i,l.g.recalcPatternData(e,s.groutSize),s.v0=o.a.vec2Clone(e.posInfo.v0),s.v1=o.a.vec2Clone(e.posInfo.v1),this.setPatternStructure(t.id,e),h=!0),null!=n&&n!==s.rotation&&(s.rotation=n),null==a||o.a.vec2Equals(a,s.origin)||(s.origin.x=a.x,s.origin.y=a.y),t.removeChildNodes();const c=r.G.getPatternFace3D(t),d=this.get2DFace3D(c);this.fillPattern(t,e,d.points,null,h,!1),this.project.projectChanged.notify({type:"PATTERN_UPDATED",node:t})}getTilerizeInfoData(t,e){const i=t.data,n=r.G.getPatternFace3D(t),a=this.get2DFace3D(n),s=c.b.getPatternPolygon(i.areaRect,a.points),h=null!=i.origin?i.origin:s[1],l=d.a.calcTilerizeInfoMaps(s,h,e,i.rotation),u=t.childNodes;for(let t=0;t<u.length;t++){const n=u[t].data;if(n.posMethod===r.x.PERSONALIZED)for(const a of n.tiles){const s=d.a.getBaseCoordFromInserPoint(a,n.rotation,i.rotation,i.origin,e.tiles[t].polygon.center,n.polygonSet.contours[0].vertices[0]),h=d.a.getTilerizeInfoByBaseCoord(l[t],s);if(h){const s=(a.rotation===r.E?a.rotOk:a.rotation)-o.a.degToRad(n.rotation)-i.rotation;h.texRotationIndex=e.tiles[t].polygon.getNearestDegreeIndex(s),h.offshadedIndex=a.offshadedIndex,h.changed=a.rotation===r.E}}}return l}applyPatternStructure(t,e,i,n,a,s,h,l,c,d,u=!0){const p=this.get2DFace3D(t);let g,m;t.walkOnAllChildrenByType(r.r.DTTileList,!1,(t=>{if(!m){const e=t.data;e.flags!==r.z.Custom&&(m=t,g=e)}})),g||(g=new r.y(p.points,p.points[0],e),g.modelToPoly=p._2DMatrix,g.polyToModel=p._3DMatrix,m=new r.c(g),t.appendChild(m));const f=new r.s(s.posFile.id,n,i,0,a,s.posInfo.strategyId);f.v0=o.a.vec2Clone(s.posInfo.v0),f.v1=o.a.vec2Clone(s.posInfo.v1);const y=o.a.poly2BoundingBox(p.points);if(g.flags===r.z.Full)f.areaRect={min:{x:y.min.x,y:y.min.y},max:{x:y.max.x,y:y.max.y}};else if(g.flags===r.z.Horizontal){const t=l||this.getStripHeight(s,n,a,1),e=c||this.getTileListHeight(m);f.areaRect={min:{x:y.min.x,y:e},max:{x:y.max.x,y:t+e}}}f.origin=h?o.a.pnt3Transform(p._2DMatrix,h):d?o.a.vec2Clone(d):o.a.vec2Clone(f.areaRect.min);const v=new r.c(f);return m.appendChild(v),this.setPatternStructure(v.id,s),this.fillPattern(v,s,p.points),u&&this.project.projectChanged.notify({type:"PATTERN_ADDED",node:v,blockUI:!1}),v.id}clearTileList(t){const e=[];t.walkOnAllChildrenByType(r.r.DTPattern,!1,(t=>{e.push(t)})),e.forEach((t=>{this.removePattern(t)}))}get2DFace3D(t){const e=t.data,i=Object(h.b)(e);return Object(h.c)(e.points,i)}getStripHeight(t,e,i,n){const a=t.tiles[0].polygon.getBBDim();return(Math.abs((a.x+e)*Math.sin(i))+Math.abs((a.y+e)*Math.cos(i)))*n-Math.abs(e*Math.cos(i))}setPatternStructure(t,e){this.patternStructureMap.set(t,e)}removePatternStructure(t){this.patternStructureMap.delete(t)}getPatternStructure(t){return this.patternStructureMap.has(t)?this.patternStructureMap.get(t):null}getOrCreatePatternStructure(t){if(this.patternStructureMap.has(t.id)&&null!=this.patternStructureMap.get(t.id).posFile){const e=this.patternStructureMap.get(t.id);let i=!0;for(let n=0;n<e.tiles.length;n++){const a=e.tiles[n];if(n<t.childNodes.length){const e=t.childNodes[n].data;if(a.idManufacturer!==e.idManuf||a.idProduct!==e.idProduct||a.colorVar!==e.colorVar){i=!1;break}}}if(i)return Promise.resolve(e)}const e=t.data;let i=!1;const n=t.getFirstChildOfType(r.r.DTTileInst).data;let a;"CPLXPOLY"===n.formatType&&(i=!0),a=i?this.tileClient.getFpsPosFile(e.id+".fps"):this.tileClient.getPosFile(e.id);return a.then((i=>{const a=new l.a;a.posFile=i;let s=0;return t.walkOnAllChildrenByType(r.r.DTTileInst,!1,(t=>{const e=t.data;if(e.posMethod===r.x.PERSONALIZED){const t=new l.f({tileNum:e.tileNum,tileCode:e.tileCode,idManufacturer:e.idManuf,idProduct:e.idProduct,colorVar:e.colorVar,width:e.width,height:e.height,diagonal:e.diagonal,formatType:e.formatType,offshaded:e.offshaded,offshadedRot:e.offshadedRot,numImages:e.numImages,dominantColor:e.dominantColor,rotation:e.rotation,insertPoint:e.insertPoint,x:e.x,y:e.y,polygon:c.b.getTilePolygon(e.formatType,e.width,e.height,e.diagonal,e.polygonSet),formatSize:n.formatSize});l.g.completeTileData(t,i,s++),a.tiles.push(t)}})),l.g.recalcPatternData(a,e.groutSize),e.v0=o.a.vec2Clone(a.posInfo.v0),e.v1=o.a.vec2Clone(a.posInfo.v1),a})).catch((t=>(console.error(`Error loading pos file. Id: ${e.id} Type: ${n.formatType} ${t.message} ${t.stack}`),null)))}removePattern(t){if(t.data.type!==r.r.DTPattern)throw new Error("Invalid node type");this.removePatternStructure(t.id),this.project.removePattern(t)}removeTileList(t){if(t.data.type!==r.r.DTTileList)throw new Error("Invalid node type");this.clearTileList(t),this.project.removeTileList(t)}removeTileListNodes(t){if(t.data.type!==r.r.DTFace3D)throw new Error("Invalid node type");const e=t.childNodes;for(let t=e.length;t>0;t--)this.removeTileList(e[t-1])}fillPattern(t,e,i,n,a=!1,s=!0){const h=t.data;let l;const u=t.parentNode.data;l=u.flags===r.z.Custom?o.a.vec2ArrayClone(u.points):c.b.getPatternPolygon(h.areaRect,i),h.origin||(h.origin=l[1]);const p=d.a.calculateTiles(l,h.origin,e,h.groutSize,h.rotation,n,a,s);for(let i=0;i<e.tiles.length;i++)if(p.tileList[i].length>0){const n=e.tiles[i],a=new r.w(n.tileNum,n.idProduct,n.idManufacturer,n.colorVar,n.tileIndex,n.formatType,n.width,n.height,n.diagonal,n.insertPoint,n.x,n.y,n.rotation,n.offshaded,n.offshadedRot,n.tileCode,n.dominantColor,n.numImages,n.polygon.polySet,r.x.PERSONALIZED,n.formatSize);for(const t of p.tileList[i])a.tiles.push(t);const s=new r.c(a);t.appendChild(s)}return p.tilerizeInfoData}getTileListHeight(t){let e=0;return t.walkOnAllChildrenByType(r.r.DTPattern,!1,(t=>{const i=t.data;e+=i.areaRect.max.y-i.areaRect.min.y})),e}getTileListDefaultFlags(t){let e;switch(t){case r.h.CLASSID_FLOOR:case r.h.CLASSID_FLOOR_AI:case r.h.CLASSID_CEILING:case r.h.CLASSID_OBJECT_PLANE:case r.h.CLASSID_OBJECT_BASE:case r.h.CLASSID_WALL:case r.h.CLASSID_OBJECT_SIDE:e=r.z.Full;break;case r.h.CLASSID_TILE:e=r.z.Single;break;default:e=r.z.Full}return e}addTilingAreaFace3DData(t,e){this.tilingAreaFace3DDataMap.set(t,e)}hasTilingAreaFace3DData(t){return null!=this.tilingAreaFace3DDataMap.get(t)}}var p=i(23);i(53)},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return PatternStructure})),__webpack_require__.d(__webpack_exports__,"b",(function(){return PosInfo})),__webpack_require__.d(__webpack_exports__,"f",(function(){return TileInfo})),__webpack_require__.d(__webpack_exports__,"d",(function(){return TileBorderFlags})),__webpack_require__.d(__webpack_exports__,"e",(function(){return TileDestination})),__webpack_require__.d(__webpack_exports__,"c",(function(){return Tile})),__webpack_require__.d(__webpack_exports__,"h",(function(){return TilerizeInfo})),__webpack_require__.d(__webpack_exports__,"g",(function(){return Tiler}));var _lib_cobyla_CobylaWrapper__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(63),_lib_gmath__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(2),_TilerUtils__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(17),TileBorderFlags,TileDestination;class PatternStructure{constructor(){this.tiles=[]}}class PosInfo{}class TileInfo{constructor(t){Object.assign(this,t)}}!function(t){t[t.COLOR=1]="COLOR",t[t.MATERIAL=2]="MATERIAL"}(TileBorderFlags||(TileBorderFlags={})),function(t){t.FLOOR="PAVIMENTO",t.WALL="RIVESTIMENTO",t.BOTH="ENTRAMBE"}(TileDestination||(TileDestination={}));class Tile{}class TilerizeInfo{}class Tiler{static completeTileData(t,e,i){let n;n=_lib_gmath__WEBPACK_IMPORTED_MODULE_1__.a.parmGt(t.height,t.width)&&null!=e.tilesPose[i].v?e.tilesPose[i].v:e.tilesPose[i].h,t.tileCode=e.tilesPose[i].code,t.xString=n.xPosition,t.yString=n.yPosition,t.rotation=n.rotation,t.insertPoint=n.insertPoint,t.tileIndex=this.getTileIndexByCode(e.tiles,e.tilesPose[i].code),t.polygon=_TilerUtils__WEBPACK_IMPORTED_MODULE_2__.b.getTilePolygon(t.formatType,t.width,t.height,t.diagonal,t.polygon.polySet)}static createTilePlaceholder(t,e){return new TileInfo({tileNum:-1,idManufacturer:"SIST",idProduct:"SIST",colorVar:"0000",width:t.default0,height:t.default1,diagonal:t.default2,formatType:t.formatType,offshaded:!1,numImages:1,dominantColor:e})}static isTilePlaceholder(t){return"SIST"===t.idManufacturer&&"SIST"===t.idProduct&&"0000"===t.colorVar}static createPatternStructureWithTiles(t,e,i){const n=[];for(let i=0;i<t.tiles.length;i++){const a=i<e.length&&e[i]?e[i]:Tiler.createTilePlaceholder(t.tiles[i],Tiler.defaultTileColors[i]);a.tileCode=t.tiles[i].code,a.tileIndex=i,n.push(a)}const a=this.resolvePatternSchemeCostraints(t,n,i);if(!a.isValid)return null;const s=[];for(const e of t.tilesPose){const i=this.getPosFileTileByCode(t.tiles,e.code),o=Object.assign({},n[i.index]);let r;Tiler.isTilePlaceholder(o)&&Tiler.setTileInfoSize(o,a.variables,i.index),r=_lib_gmath__WEBPACK_IMPORTED_MODULE_1__.a.parmGt(o.height,o.width)&&null!=e.v?e.v:e.h,o.tileIndex=i.index,o.tileCode=i.tileData.code,o.xString=r.xPosition,o.yString=r.yPosition,o.rotation=r.rotation,o.insertPoint=r.insertPoint,o.polygon=_TilerUtils__WEBPACK_IMPORTED_MODULE_2__.b.getTilePolygon(o.formatType,o.width,o.height,o.diagonal,o.polySet),r=null,s.push(o)}const o=new PatternStructure;return o.tiles=s,o.posFile=t,this.createPatternData(o,i),o}static substituteTile(t,e,i,n){const a=[];for(let n=0;n<i.tiles.length;n++)if(i.tiles[n].tileCode===t){const t=new TileInfo(i.tiles[n]);t.colorVar=e.colorVar,t.idProduct=e.idProduct,t.idManufacturer=e.idManufacturer,t.width=e.width,t.height=e.height,t.diagonal=e.diagonal,t.dominantColor=e.dominantColor,t.numImages=e.numImages,t.offshaded=e.offshaded,t.offshadedRot=e.offshadedRot,t.tileNum=e.tileNum,this.completeTileData(t,i.posFile,n),a.push(t)}else a.push(i.tiles[n]);const s=this.resolvePatternSchemeCostraints(i.posFile,a,n);return s.isValid?(i.tiles=a,this.adaptTilePlaceholders(i.tiles,s.variables),this.createPatternData(i,n),i):null}static checkContstraints(t,e,i,n){const a=[];for(let n=0;n<i.tiles.length;n++)if(i.tiles[n].tileCode===t){const t=new TileInfo(i.tiles[n]);t.colorVar=e.colorVar,t.idProduct=e.idProduct,t.idManufacturer=e.idManufacturer,t.width=e.width,t.height=e.height,t.diagonal=e.diagonal,t.dominantColor=e.dominantColor,t.numImages=e.numImages,t.offshaded=e.offshaded,t.offshadedRot=e.offshadedRot,t.tileNum=e.tileNum,this.completeTileData(t,i.posFile,n),a.push(t)}else a.push(i.tiles[n]);return this.resolvePatternSchemeCostraints(i.posFile,a,n).isValid}static recalcPatternData(t,e){this.createPatternData(t,e)}static createPatternData(patternStructure,groutSize){const posInfo=new PosInfo,v0String={x:patternStructure.posFile.xDir0,y:patternStructure.posFile.yDir0},v1String={x:patternStructure.posFile.xDir1,y:patternStructure.posFile.yDir1},substitutions={TLD:groutSize,SQRT:"Math.sqrt"};for(let t=0;t<patternStructure.posFile.tiles.length;t++){const e=t,i=this.getTileByCode(patternStructure.posFile.tiles[t].code,patternStructure.tiles);let n=0,a=0,s=0;_lib_gmath__WEBPACK_IMPORTED_MODULE_1__.a.parmGt(i.height,i.width)&&null!=patternStructure.posFile.tilesPose[t].v?(n=i.height,a=i.width):(n=i.width,a=i.height),s=i.diagonal;const o=`D0${e}_0`,r=`D0${e}_1`,h=`D0${e}_2`;substitutions[o]=n,substitutions[r]=a,substitutions[h]=s}if(patternStructure.posFile.prefix){const parts=patternStructure.posFile.prefix.split(";");for(const element of parts){const variableParts=element.split(":="),variableName=variableParts[0].trim().split(" ")[1],variableExpression=this.replaceIdentifiers(variableParts[1],substitutions),evalueatedExpression=eval(variableExpression);substitutions[variableName]=evalueatedExpression}}for(const tile of patternStructure.tiles){const xString=this.replaceIdentifiers(tile.xString,substitutions),yString=this.replaceIdentifiers(tile.yString,substitutions);tile.x=eval(xString),tile.y=eval(yString)}-1!==v0String.x.indexOf("$")?(posInfo.strategyId=v0String.x,v0String.y=this.replaceIdentifiers(v0String.y,substitutions),v1String.y=this.replaceIdentifiers(v1String.y,substitutions),posInfo.v0={x:-1,y:eval(v0String.y)},posInfo.v1={x:-1,y:eval(v1String.y)}):(v0String.x=this.replaceIdentifiers(v0String.x,substitutions),v0String.y=this.replaceIdentifiers(v0String.y,substitutions),v1String.x=this.replaceIdentifiers(v1String.x,substitutions),v1String.y=this.replaceIdentifiers(v1String.y,substitutions),posInfo.v0={x:eval(v0String.x),y:eval(v0String.y)},posInfo.v1={x:eval(v1String.x),y:eval(v1String.y)}),patternStructure.posInfo=posInfo}static resolvePatternSchemeCostraints(t,e,i){const n={TLD:i},a=[],s=[],o=[];let r=0;for(const i of t.tiles){const a=this.getTileByCode(i.code,e);if(Tiler.isTilePlaceholder(a)){const e=`D0${a.tileIndex}_0`,i=`D0${a.tileIndex}_1`,h=`D0${a.tileIndex}_2`,l=`x[${r}]`,c=`x[${r+1}]`,d=`x[${r+2}]`,u=t.tiles[a.tileIndex].default0,p=t.tiles[a.tileIndex].default1,g=t.tiles[a.tileIndex].default2;n[e]=l,n[i]=c,n[h]=d,r+=3,s.push(`Math.abs(${l} - ${u})`),s.push(`Math.abs(${c} - ${p})`),s.push(`Math.abs(${d} - ${g})`),o.push(u),o.push(p),o.push(g)}else a.width>a.height?(n[`D0${a.tileIndex}_0`]=a.width,n[`D0${a.tileIndex}_1`]=a.height):(n[`D0${a.tileIndex}_0`]=a.height,n[`D0${a.tileIndex}_1`]=a.width),n[`D0${a.tileIndex}_2`]=a.diagonal}let h=0;for(const e of t.constraints){const t=e;if(-1!==t.indexOf(";")){const e=t.split(";"),i=this.replaceIdentifiersForConstraint(e[0],e[1],n);a.push(`c[${h}] = (${i.lside}) - (${i.rside})`),a.push(`c[${h+1}] = -((${i.lside}) - (${i.rside}))`),h+=2}else if(-1!==t.indexOf(">=")){const e=t.split(">="),i=this.replaceIdentifiersForConstraint(e[0],e[1],n);a.push(`c[${h}] = (${i.lside}) - (${i.rside})`),h++}else if(-1!==t.indexOf("<=")){const e=t.split("<="),i=this.replaceIdentifiersForConstraint(e[0],e[1],n);a.push(`c[${h}] = -((${i.lside}) - (${i.rside}))`),h++}}const l=new _lib_cobyla_CobylaWrapper__WEBPACK_IMPORTED_MODULE_0__.a;let c=l.createObjectiveFunction(`function(n,m,x,c){ ${a.join(";")}; return ${s.join("+")}; }`);const d=l.resolveConstraints(c,o,r,h);c=null;for(const t in n){let e=n[t];if("string"==typeof e){e=e.replace("x[",""),e=e.replace("]","");const i=parseInt(e);n[t]=o[i]}}return l.clearObjectiveFunction(),{isValid:d<=l.resultTh,variables:n}}static replaceIdentifiers(t,e){for(const i in e)t=this.replaceAll(t,i,e[i]);return t}static replaceIdentifiersForConstraint(t,e,i){for(const e in i)t=this.replaceAll(t,e,i[e]);for(const t in i)e=this.replaceAll(e,t,i[t]);return{lside:t,rside:e}}static replaceAll(t,e,i){const n=new RegExp("\\b"+e+"\\b","g");return t.replace(n,i)}static adaptTilePlaceholders(t,e){for(const i of t)if(Tiler.isTilePlaceholder(i)){const t=i.tileIndex;Tiler.setTileInfoSize(i,e,t),i.polygon=_TilerUtils__WEBPACK_IMPORTED_MODULE_2__.b.getTilePolygon(i.formatType,i.width,i.height,i.diagonal,i.polySet)}}static setTileInfoSize(t,e,i){t.width=e[`D0${i}_0`],t.height=e[`D0${i}_1`],t.diagonal=e[`D0${i}_2`]}static getPosFileTileByCode(t,e){let i,n;for(n=0;n<t.length;n++)if(t[n].code===e){i=t[n];break}return{tileData:i,index:n}}static getTileByCode(t,e){let i;for(const n of e)if(n.tileCode===t){i=n;break}return i}static getTileIndexByCode(t,e){let i=-1;for(let n=0;n<t.length;n++)if(t[n].code===e){i=n;break}return i}}Tiler.defaultTileColors=[12845056,52992,220,65535,16711935,16776960,4259840,16640,65,8388608,32768,128]},function(t,e,i){"use strict";var n,a,s,o;i.d(e,"a",(function(){return n})),i.d(e,"b",(function(){return a})),i.d(e,"d",(function(){return s})),i.d(e,"c",(function(){return o})),function(t){t[t.Ambient=1]="Ambient",t[t.Spot=2]="Spot",t[t.Omni=3]="Omni",t[t.Directional=4]="Directional",t[t.Rect=5]="Rect"}(n||(n={})),function(t){t[t.SINGLE_LAYER=0]="SINGLE_LAYER",t[t.LAYER_IS_IN_GROUP=1]="LAYER_IS_IN_GROUP",t[t.GROUP=2]="GROUP"}(a||(a={})),function(t){t[t.INFO=1]="INFO",t[t.ERROR=2]="ERROR",t[t.WARNING=4]="WARNING",t[t.SUCCESS=8]="SUCCESS"}(s||(s={})),function(t){t.GENERIC_ERROR="GENERIC_ERROR",t.DROP_OUTSIDE="DROP_OUTSIDE",t.TILE_INVALID_SURFACE="TILE_INVALID_SURFACE",t.TILE_WRONG_FORMAT="TILE_WRONG_FORMAT",t.TILE_WALL_ONLY="TILE_WALL_ONLY",t.TILE_FLOOR_ONLY="TILE_FLOOR_ONLY",t.PATTERN_INVALID_SURFACE="PATTERN_INVALID_SURFACE",t.PATTERN_CONSTRAINTS_VIOLATION="PATTERN_CONSTRAINTS_VIOLATION",t.PATTERN_NOT_SUPPORTED="PATTERN_NOT_SUPPORTED",t.CONNECTION_ERROR="CONNECTION_ERROR",t.NO_SELECTED_OBJECT="NO_SELECTED_OBJECT",t.WRONG_NODE_TYPE="WRONG_NODE_TYPE",t.NOTHING_TO_EXTEND="NOTHING_TO_EXTEND",t.SELECT_DRAG_DROP_TILE="SELECT_DRAG_DROP_TILE",t.SHARE_LINK_MAIL_SUCCESS="SHARE_LINK_MAIL_SUCCESS",t.SHARE_LINK_MAIL_ERROR="SHARE_LINK_MAIL_ERROR",t.SHARE_LINK_ERROR="SHARE_LINK_ERROR",t.LOAD_SHARED_PROJECT_ERROR="LOAD_SHARED_PROJECT_ERROR",t.LOAD_SHARED_PROJECT_PW_ERROR="LOAD_SHARED_PROJECT_PW_ERROR",t.NO_FLOOR_DETECTED="NO_FLOOR_DETECTED",t.TILE_NOT_AVAILABLE="TILE_NOT_AVAILABLE",t.INVALID_PARAMETERS="INVALID_PARAMETERS",t.ADD_GROUP_OK="ADD_GROUP_OK",t.ADD_GROUP_ERROR="ADD_GROUP_ERROR",t.EDIT_GROUP_OK="EDIT_GROUP_OK",t.DELETE_GROUP_OK="DELETE_GROUP_OK",t.NO_EXIST_GROUP_TO_EDIT="NO_EXIST_GROUP_TO_EDIT",t.TOO_FEW_POINTS="TOO_FEW_POINTS"}(o||(o={}))},function(t,e,i){"use strict";i.d(e,"c",(function(){return v})),i.d(e,"s",(function(){return n.a})),i.d(e,"t",(function(){return r.a})),i.d(e,"H",(function(){return C.b})),i.d(e,"w",(function(){return C.a})),i.d(e,"h",(function(){return x})),i.d(e,"J",(function(){return b})),i.d(e,"i",(function(){return T})),i.d(e,"g",(function(){return P})),i.d(e,"G",(function(){return E})),i.d(e,"C",(function(){return M})),i.d(e,"B",(function(){return D})),i.d(e,"u",(function(){return w})),i.d(e,"E",(function(){return S})),i.d(e,"A",(function(){return I})),i.d(e,"z",(function(){return O})),i.d(e,"r",(function(){return R})),i.d(e,"o",(function(){return L})),i.d(e,"m",(function(){return A})),i.d(e,"l",(function(){return _})),i.d(e,"n",(function(){return k})),i.d(e,"b",(function(){return a})),i.d(e,"d",(function(){return s})),i.d(e,"a",(function(){return j})),i.d(e,"D",(function(){return N})),i.d(e,"F",(function(){return u.b})),i.d(e,"p",(function(){return u.a})),i.d(e,"q",(function(){return p})),i.d(e,"f",(function(){return l})),i.d(e,"y",(function(){return d})),i.d(e,"x",(function(){return g})),i.d(e,"v",(function(){return F})),i.d(e,"I",(function(){return z.a})),i.d(e,"e",(function(){return h})),i.d(e,"j",(function(){return B})),i.d(e,"k",(function(){return H}));var n=i(13);class a{constructor(t,e,i,n,a){this.fov=t,this.grade=e,this.roll=i,this.heightFromGround=n,this.imageAspect=a}}class s extends n.a{constructor(){super(),this.type=r.a.DTBackgroundImage}}var o=i(2),r=i(19);class h extends n.a{constructor(t,e,i,n,a,s){super(),this.id=t,this.width=e,this.height=i,this.surfaceIndex=n,this.points=a,this.texture=s,this.type=r.a.DTCorridor,this.matrix=o.a.mat4GetIdentity()}}class l extends n.a{constructor(){super(),this.type=r.a.DTExternalMaterial}}class c extends n.a{constructor(){super(),this.type=r.a.DTExternalMaterialList,this.data=new Map}toJSON(){return Object.assign({},this,{data:Array.from(this.data.entries())})}static fromJSON(t){if("string"==typeof t)return JSON.parse(t,c.reviver);{let e=t,i=Object.create(c.prototype);return Object.assign(i,t,{data:new Map(e.data)})}}static reviver(t,e){return""===t?c.fromJSON(e):e}}n.a;var d,u=i(38);class p extends n.a{constructor(){super(),this.type=r.a.DTMaskList}}!function(t){t.RECT="RECT",t.ROUND="ROUND",t.FLAT="FLAT"}(d||(d={}));n.a;class g extends n.a{constructor(t,e,i,n,a){super(),this.id=t,this.bbox=e,this.surfaceIndex=i,this.texture=n,this.objModel=a,this.type=r.a.DTRug,this.version=2,this.matrix=o.a.mat4GetIdentity()}static fromJSON(t){if("string"==typeof t)return JSON.parse(t,g.reviver);{let e=t.version;e||(e=1);let i=t;if(1===e){const t=i,e=Object.create(g.prototype);Object.assign(e,t,{shape:d.RECT,version:2}),i=e}return i}}static reviver(t,e){return""===t?g.fromJSON(e):e}}const m=i(61);class f{constructor(t,e){this.nodes=t,this.recursive=e,this.pos=-1,this.len=t.length,this.posIt=null}get current(){return null!=this.posIt?this.posIt.current:this.nodes[this.pos]}moveNextByType(t){for(;this.moveNext();)if(t==this.current.data.type)return!0;return!1}moveNextByTypes(t){for(;this.moveNext();)if(t.has(this.current.data.type))return!0;return!1}moveNextByCbk(t){for(;this.moveNext();)if(t(this.current))return!0;return!1}moveNext(){return null!=this.posIt?(this.posIt.moveNext()||(this.posIt=null),!0):(this.pos++,this.pos<this.len&&(!this.recursive||(this.posIt=this.nodes[this.pos].getChildNodes(this.recursive),this.posIt.moveNext()||(this.posIt=null),!0)))}}var y;!function(t){t[t.Before=0]="Before",t[t.After=1]="After"}(y||(y={}));class v{constructor(t,e=null){this.id=e||m(),this.idNodeMap=null,this.idNodeMapCbk=null,this.parentNode=null,this.parentIndex=null,this.childNodes=[],this.data=t}getRoot(){return this.parentNode?this.parentNode.getRoot():this}enableIndex(t){const e=this.getRoot();e.idNodeMap=new Map,e.idNodeMapCbk=t,e.idNodeMapCbk(e)&&e.idNodeMap.set(e.id,e);const i=e.getChildNodes(!0);for(;i.moveNextByCbk(e.idNodeMapCbk);)e.idNodeMap.set(i.current.id,i.current)}disableIndex(){const t=this.getRoot();t.idNodeMap=null,t.idNodeMapCbk=null}getIndexedNodeById(t){const e=this.getRoot();if(e.idNodeMap)return e.idNodeMap.get(t);throw new Error("Index disabled")}indexImportChild(t){t.idNodeMap=null,t.idNodeMapCbk=null;const e=this.getRoot();if(e.idNodeMap){e.idNodeMapCbk(t)&&e.idNodeMap.set(t.id,t);const i=t.getChildNodes(!0);for(;i.moveNextByCbk(e.idNodeMapCbk);)e.idNodeMap.set(i.current.id,i.current)}}indexExportChild(t){const e=this.getRoot();if(e.idNodeMap){e.idNodeMap.delete(t.id);const i=t.getChildNodes(!0);for(;i.moveNext();)e.idNodeMap.delete(i.current.id)}}getChildNodes(t){return new f(this.childNodes,t)}getFirstChildOfType(t){const e=this.getChildNodes(!1);return e.moveNextByType(t)?e.current:null}getFirstChildOfTypes(t){const e=this.getChildNodes(!1);return e.moveNextByTypes(t)?e.current:null}countAllChildrenByType(t,e){let i=0;return this.walkOnAllChildrenByType(t,e,(t=>{i++})),i}walkOnAllChildrenByType(t,e,i){const n=this.getChildNodes(e);for(;n.moveNextByType(t);)i(n.current)}walkOnAllChildrenByTypes(t,e,i){const n=this.getChildNodes(e);for(;n.moveNextByTypes(t);)i(n.current)}walkOnAllChildrenByCbk(t,e,i){const n=this.getChildNodes(e);for(;n.moveNextByCbk(t);)i(n.current)}isDescendantOf(t){let e=!1,i=!1,n=this;for(;!e;)n?(n.id===t&&(i=!0,e=!0),n=n.parentNode):e=!0;return i}appendChild(t){if(null!=t.parentNode)throw new Error("Reparenting a node is not supported");t.parentNode=this,t.parentIndex=this.childNodes.push(t)-1,this.indexImportChild(t)}insertChild(t,e,i){if(null!=t.parentNode)throw new Error("Reparenting a node is not supported");if(e.parentNode!==this)throw new Error("'referenceNode' is not a child of the current node");t.parentNode=this,t.parentIndex=i==y.Before?e.parentIndex:e.parentIndex+1,this.childNodes.splice(t.parentIndex,0,t);for(let e=t.parentIndex+1;e<this.childNodes.length;e++)this.childNodes[e].parentIndex++;this.indexImportChild(t)}insertChildBefore(t,e){this.insertChild(t,e,y.Before)}insertChildAfter(t,e){this.insertChild(t,e,y.After)}removeChildById(t){let e=null,i=-1;for(let n=0;n<this.childNodes.length;n++)this.childNodes[n].id===t&&(i=n,e=this.childNodes[n]),i>=0&&this.childNodes[n].parentIndex--;return i>=0&&(this.childNodes.splice(i,1),e.parentNode=null,e.parentIndex=null,this.indexExportChild(e)),e}removeChildNodes(){for(let t=0;t<this.childNodes.length;t++){let e=this.childNodes[t];e.parentNode=null,e.parentIndex=null,this.indexExportChild(e)}const t=this.childNodes;return this.childNodes=[],t}toJSON(){const t=Object.assign({},this);return delete t.parentIndex,delete t.parentNode,delete t.idNodeMap,delete t.idNodeMapCbk,t}static fromJSON(t){if("string"==typeof t)return JSON.parse(t,v.reviver);{const e=Object.create(v.prototype);let i;switch(t.data.type){case r.a.DTMaterialList:i=R.fromJSON(t.data);break;case r.a.DTTileInst:i=O.fromJSON(t.data);break;case r.a.DTMask:i=u.a.fromJSON(t.data);break;case r.a.DTRug:i=g.fromJSON(t.data);break;case r.a.DTViewList:i=s.fromJSON(t.data),Object.assign(i,{type:r.a.DTBackgroundImage});break;case r.a.DT3DView:i=N.fromJSON(t.data),Object.assign(i,{type:r.a.DTTiledLayer});break;case r.a.DTDbSpec:i=u.a.fromJSON(t.data),Object.assign(i,{type:r.a.DTMask});break;case r.a.DTDbField:i=p.fromJSON(t.data),Object.assign(i,{type:r.a.DTMaskList});break;case r.a.DTPrjSpec:i=l.fromJSON(t.data),Object.assign(i,{type:r.a.DTExternalMaterial});break;case r.a.DTDimPoint:i=c.fromJSON(t.data),Object.assign(i,{type:r.a.DTExternalMaterialList});break;case r.a.DTText:i=g.fromJSON(t.data),Object.assign(i,{type:r.a.DTRug});break;case r.a.DTAnimVector:i=h.fromJSON(t.data),Object.assign(i,{type:r.a.DTCorridor});break;default:i=t.data}const n=Object.assign(e,t,{parentIndex:null,parentNode:null,idNodeMap:null,idNodeMapCbk:null,data:i,childNodes:[]});for(let e of t.childNodes)e?n.appendChild(v.fromJSON(e)):n.childNodes.push(e);return n}}static reviver(t,e){return""===t?v.fromJSON(e):e}}var x,T,M,C=i(49);function b(t){switch(t){case x.CLASSID_EXTERNAL_WALL:case x.CLASSID_FLOOR:case x.CLASSID_WALL:case x.CLASSID_CEILING:case x.CLASSID_DOORSTEP:case x.CLASSID_FRAME_0:case x.CLASSID_FRAME_90:case x.CLASSID_DS3D00:case x.CLASSID_DS3D01:case x.CLASSID_DS3D02:case x.CLASSID_DS3D03:case x.CLASSID_DS3D04:case x.CLASSID_DS3D05:case x.CLASSID_DS3D10:case x.CLASSID_DS3D12:case x.CLASSID_DS3D20:case x.CLASSID_OBJECT_BASE:case x.CLASSID_OBJECT_SIDE:case x.CLASSID_OBJECT_PLANE:return!0}return!1}!function(t){t[t.CLASSID_DEFAULT=0]="CLASSID_DEFAULT",t[t.CLASSID_EXTERNAL_WALL=1]="CLASSID_EXTERNAL_WALL",t[t.CLASSID_FLOOR=2]="CLASSID_FLOOR",t[t.CLASSID_WALL=3]="CLASSID_WALL",t[t.CLASSID_FLOOR_AI=4]="CLASSID_FLOOR_AI",t[t.CLASSID_CEILING=5]="CLASSID_CEILING",t[t.CLASSID_DOORSTEP=10]="CLASSID_DOORSTEP",t[t.CLASSID_FRAME_0=20]="CLASSID_FRAME_0",t[t.CLASSID_FRAME_90=21]="CLASSID_FRAME_90",t[t.CLASSID_DS3D00=100]="CLASSID_DS3D00",t[t.CLASSID_DS3D01=101]="CLASSID_DS3D01",t[t.CLASSID_DS3D02=102]="CLASSID_DS3D02",t[t.CLASSID_DS3D03=103]="CLASSID_DS3D03",t[t.CLASSID_DS3D04=104]="CLASSID_DS3D04",t[t.CLASSID_DS3D05=105]="CLASSID_DS3D05",t[t.CLASSID_DS3D10=110]="CLASSID_DS3D10",t[t.CLASSID_DS3D12=112]="CLASSID_DS3D12",t[t.CLASSID_DS3D20=120]="CLASSID_DS3D20",t[t.CLASSID_OBJECT_BASE=151]="CLASSID_OBJECT_BASE",t[t.CLASSID_OBJECT_SIDE=152]="CLASSID_OBJECT_SIDE",t[t.CLASSID_OBJECT_PLANE=153]="CLASSID_OBJECT_PLANE",t[t.CLASSID_TILE=9999]="CLASSID_TILE"}(x||(x={})),function(t){t[t.FF_NOCLIP=1]="FF_NOCLIP",t[t.FF_WIRE=2]="FF_WIRE",t[t.FF_FILLED=4]="FF_FILLED",t[t.FF_SUBTR=8]="FF_SUBTR",t[t.FF_COVER=16]="FF_COVER",t[t.FF_DUMMY=32]="FF_DUMMY",t[t.FF_CHILD=64]="FF_CHILD",t[t.FF_WALL=128]="FF_WALL",t[t.FF_HIDECHILDS=256]="FF_HIDECHILDS",t[t.FF_NOSHADE=512]="FF_NOSHADE",t[t.FF_SMOOTH=1024]="FF_SMOOTH",t[t.FF_GHOST=2048]="FF_GHOST",t[t.FF_CONTACT_COVER=4096]="FF_CONTACT_COVER",t[t.FF_HIDDEN=-2147483648]="FF_HIDDEN"}(T||(T={}));class P extends n.a{constructor(t,e,i,n,a,s){super(),this.flags=t,this.color=e,this.points=i,this.classId=n,this.materialId=a,this.texels=s,this.type=r.a.DTFace3D}toJSON(){return Object.assign({},this,{flags:this.flags>>>0})}static fromJSON(t){if("string"==typeof t)return JSON.parse(t,P.reviver);{const e=t,i=Object.create(P.prototype);return Object.assign(i,{texels:[]},t,{flags:e.flags>>>0})}}static reviver(t,e){return""===t?P.fromJSON(e):e}}class E{constructor(t,e,i){this.manufacturer=t,this.name=e,this.idx=i}}n.a;!function(t){t[t.Full=1]="Full",t[t.Horizontal=2]="Horizontal",t[t.Vertical=4]="Vertical",t[t.Custom=8]="Custom",t[t.Single=16]="Single",t[t.Frame=32]="Frame"}(M||(M={}));class D extends n.a{constructor(t,e,i){super(),this.points=t,this.origin=e,this.flags=i,this.type=r.a.DTTileList}}n.a;n.a;class w extends n.a{constructor(t,e,i,n,a,s){super(),this.id=t,this.groutSize=e,this.groutColor=i,this.materialID=n,this.rotation=a,this.strategyId=s,this.type=r.a.DTPattern,this.version=3}static fromJSON(t){if("string"==typeof t)return JSON.parse(t,w.reviver);{let e=t.version;e||(e=1);let i=t;switch(e){case 1:{let t=i,e=Object.create(w.prototype);Object.assign(e,t,{delta:{x:0,y:0,z:0},version:2}),i=e}case 2:{let t=i,e=Object.create(w.prototype);Object.assign(e,t,{version:3}),delete e.delta,i=e}}return i}}static reviver(t,e){return""===t?w.fromJSON(e):e}}const S=3402823466e29;var I,L,A;!function(t){t[t.SINGLE=0]="SINGLE",t[t.PERSONALIZED=1]="PERSONALIZED"}(I||(I={}));n.a;n.a;n.a;class O extends n.a{constructor(t,e,i,n,a,s,o,h,l,c,d,u,p,g,m,f,y,v,x,T,M){super(),this.tileNum=t,this.idProduct=e,this.idManuf=i,this.colorVar=n,this.tileIndex=a,this.formatType=s,this.width=o,this.height=h,this.diagonal=l,this.insertPoint=c,this.x=d,this.y=u,this.rotation=p,this.offshaded=g,this.offshadedRot=m,this.tileCode=f,this.dominantColor=y,this.numImages=v,this.polygonSet=x,this.posMethod=T,this.formatSize=M,this.type=r.a.DTTileInst,this.version=4,this.tiles=[],this.estimateAreaTot=0,this.estimateNTot=0,this.estimateLTHalf=0,this.estimateGTHalf=0}static fromJSON(t){if("string"==typeof t)return JSON.parse(t,O.reviver);{let e=t.version;e||(e=1);let i=t;switch(e){case 1:{let t=i,e=Object.create(O.prototype);Object.assign(e,t,{polygonSet:{contours:[{vertices:t.polygon}],holes:[!1]},version:2}),delete e.polygon,i=e}case 2:{let t=i,e=Object.create(O.prototype);Object.assign(e,t,{posMethod:I.PERSONALIZED,version:3}),delete e.basePoint,i=e}case 3:{let t=i,e=Object.create(O.prototype),n=`${t.width}${Number.isInteger(t.width)?".0":""}x${t.height}${Number.isInteger(t.height)?".0":""}`;null!=t.diagonal&&0!==t.diagonal&&(n=`${n}x${t.diagonal}${Number.isInteger(t.diagonal)?".0":""}`),Object.assign(e,t,{formatSize:n,version:4}),i=e}}return i}}static reviver(t,e){return""===t?O.fromJSON(e):e}}class R extends n.a{constructor(){super(),this.type=r.a.DTMaterialList,this.data=new Map}toJSON(){return Object.assign({},this,{data:Array.from(this.data.entries())})}static fromJSON(t){if("string"==typeof t)return JSON.parse(t,R.reviver);{let e=t,i=Object.create(R.prototype);return Object.assign(i,t,{data:new Map(e.data)})}}static reviver(t,e){return""===t?R.fromJSON(e):e}}n.a;!function(t){t[t.Ambient=1]="Ambient",t[t.Spot=2]="Spot",t[t.Omni=3]="Omni",t[t.Directional=4]="Directional",t[t.Rect=5]="Rect"}(L||(L={})),function(t){t[t.None=0]="None",t[t.Rect=1]="Rect",t[t.Disc=2]="Disc",t[t.Sphere=3]="Sphere",t[t.Cylinder=4]="Cylinder"}(A||(A={}));class _ extends n.a{constructor(t,e,i,n,a,s,o,h,l,c,d){super(),this.lightType=t,this.dimension=e,this.pnt=i,this.targetPnt=n,this.power=a,this.angle=s,this.penumbra=o,this.areaType=h,this.areaDim1=l,this.areaDim2=c,this.animationPositions=d,this.type=r.a.DTLight}}class k extends n.a{constructor(){super(),this.type=r.a.DTLightList}}i(50);class j{constructor(t,e,i){this.gridPoints=t,this.alignPoints=e,this.rotation=i}}n.a;class N extends n.a{constructor(){super(),this.type=r.a.DTTiledLayer,this.version=2,this.visible=!0}static fromJSON(t){if("string"==typeof t)return JSON.parse(t,N.reviver);{let e=t.version;e||(e=1);let i=t;if(1===e){let t=i,e=Object.create(N.prototype);Object.assign(e,t,{visible:!0,version:2}),i=e}return i}}static reviver(t,e){return""===t?N.fromJSON(e):e}}class F extends n.a{constructor(){super(),this.type=r.a.DTPrjData,this.hPlanesData=[]}}var z=i(51);class B extends n.a{constructor(t,e,i,n){super(),this.layers=t,this.hotspot=e,this.label=i,this.tileDestination=n,this.type=r.a.DTGroup}}class H extends n.a{constructor(){super(),this.type=r.a.DTGroupList}}},function(t,e,i){"use strict";i.d(e,"a",(function(){return a}));var n=i(19);class a{constructor(){this.type=n.a.DTObject,this.version=1}static fromJSON(t){return t}}},function(t,e,i){"use strict";i.r(e),i.d(e,"DTLightTypeEnum",(function(){return s.a})),i.d(e,"HotspotType",(function(){return s.b})),i.d(e,"MessageType",(function(){return s.d})),i.d(e,"MessageCode",(function(){return s.c})),i.d(e,"EngineContainer",(function(){return o.a})),i.d(e,"CommandsEnum",(function(){return r.Q})),i.d(e,"LoadProjectCommand",(function(){return r.zb})),i.d(e,"LoadProjectCommandHandler",(function(){return r.Ab})),i.d(e,"ChangeGroutCommand",(function(){return r.K})),i.d(e,"ChangeGroutCommandHandler",(function(){return r.L})),i.d(e,"ChangeGroutColorCommand",(function(){return r.I})),i.d(e,"ChangeGroutColorCommandHandler",(function(){return r.J})),i.d(e,"ChangePatternRotationCommand",(function(){return r.O})),i.d(e,"ChangePatternRotationCommandHandler",(function(){return r.P})),i.d(e,"ApplyPatternCommand",(function(){return r.m})),i.d(e,"ApplyPatternCommandHandler",(function(){return r.n})),i.d(e,"EditPatternCommand",(function(){return r.fb})),i.d(e,"EditPatternCommandHandler",(function(){return r.gb})),i.d(e,"ApplyTilePatternToSurfaceCommand",(function(){return r.w})),i.d(e,"ApplyTilePatternToSurfaceCommandHandler",(function(){return r.x})),i.d(e,"ApplyPatternsToSurfacesCommand",(function(){return r.q})),i.d(e,"ApplyPatternsToSurfacesCommandHandler",(function(){return r.r})),i.d(e,"ApplyTileCommand",(function(){return r.u})),i.d(e,"ApplyTileCommandHandler",(function(){return r.v})),i.d(e,"AddBackgroundImageCommand",(function(){return r.a})),i.d(e,"AddBackgroundImageCommandHandler",(function(){return r.b})),i.d(e,"CalcSegmentationCommand",(function(){return r.C})),i.d(e,"CalcSegmentationCommandHandler",(function(){return r.D})),i.d(e,"SaveImageCommand",(function(){return r.Sb})),i.d(e,"SaveImageCommandHandler",(function(){return r.Tb})),i.d(e,"DeleteTiledLayerCommand",(function(){return r.T})),i.d(e,"DeleteTiledLayerCommandHandler",(function(){return r.U})),i.d(e,"AddTiledLayerCommand",(function(){return r.i})),i.d(e,"AddTiledLayerCommandHandler",(function(){return r.j})),i.d(e,"ToggleLightAnimationCommand",(function(){return r.qc})),i.d(e,"ToggleLightAnimationCommandHandler",(function(){return r.rc})),i.d(e,"LoadSceneWithPBCommand",(function(){return r.Db})),i.d(e,"LoadSceneWithPBCommandHandler",(function(){return r.Eb})),i.d(e,"LoadExternalProjectCommand",(function(){return r.vb})),i.d(e,"LoadExternalProjectCommandHandler",(function(){return r.wb})),i.d(e,"SetSelectedLayerCommand",(function(){return r.Yb})),i.d(e,"SetSelectedLayerCommandHandler",(function(){return r.Zb})),i.d(e,"ChangeMaterialCommand",(function(){return r.M})),i.d(e,"ChangeMaterialCommandHandler",(function(){return r.N})),i.d(e,"ExportProjectCommand",(function(){return r.nb})),i.d(e,"ExportProjectCommandHandler",(function(){return r.ob})),i.d(e,"CalcSegmentationRugCommand",(function(){return r.G})),i.d(e,"CalcSegmentationRugCommandHandler",(function(){return r.H})),i.d(e,"AddRugCommand",(function(){return r.g})),i.d(e,"AddRugCommandHandler",(function(){return r.h})),i.d(e,"ApplyPatternExtCommand",(function(){return r.o})),i.d(e,"ApplyPatternExtCommandHandler",(function(){return r.p})),i.d(e,"AddCorridorCommand",(function(){return r.c})),i.d(e,"AddCorridorCommandHandler",(function(){return r.d})),i.d(e,"CalcSegmentationCorridorCommand",(function(){return r.E})),i.d(e,"CalcSegmentationCorridorCommandHandler",(function(){return r.F})),i.d(e,"RemoveCorridorCommand",(function(){return r.Ob})),i.d(e,"RemoveCorridorCommandHandler",(function(){return r.Pb})),i.d(e,"GetSceneRugImageCommand",(function(){return r.pb})),i.d(e,"GetSceneRugImageCommandHandler",(function(){return r.qb})),i.d(e,"CalcPerspectiveCommand",(function(){return r.A})),i.d(e,"CalcPerspectiveCommandHandler",(function(){return r.B})),i.d(e,"EditLightsCommand",(function(){return r.eb})),i.d(e,"EditLightCommandHandler",(function(){return r.bb})),i.d(e,"EditPerspectiveCommand",(function(){return r.hb})),i.d(e,"EditPerspectiveCommandHandler",(function(){return r.ib})),i.d(e,"EditTiledLayerCommand",(function(){return r.lb})),i.d(e,"EditTiledLayerCommandHandler",(function(){return r.mb})),i.d(e,"CalcPerspectiveAICommand",(function(){return r.y})),i.d(e,"CalcPerspectiveAICommandHandler",(function(){return r.z})),i.d(e,"LoadExternalTileCommand",(function(){return r.xb})),i.d(e,"LoadExternalTileCommandHandler",(function(){return r.yb})),i.d(e,"PublishProjectCommand",(function(){return r.Mb})),i.d(e,"PublishProjectCommandHandler",(function(){return r.Nb})),i.d(e,"SaveProjectCommand",(function(){return r.Ub})),i.d(e,"SaveProjectCommandHandler",(function(){return r.Vb})),i.d(e,"SaveProjectCustomizationCommand",(function(){return r.Wb})),i.d(e,"SaveProjectCustomizationCommandHandler",(function(){return r.Xb})),i.d(e,"ApplyProjectCustomizationCommand",(function(){return r.s})),i.d(e,"ApplyProjectCustomizationCommandHandler",(function(){return r.t})),i.d(e,"PrintContent",(function(){return r.Lb})),i.d(e,"PrintCommand",(function(){return r.Jb})),i.d(e,"PrintCommandHandler",(function(){return r.Kb})),i.d(e,"EditRugCommand",(function(){return r.jb})),i.d(e,"EditRugCommandHandler",(function(){return r.kb})),i.d(e,"SetupRugCommand",(function(){return r.ec})),i.d(e,"SetupRugCommandHandler",(function(){return r.fc})),i.d(e,"SetupCorridorCommand",(function(){return r.cc})),i.d(e,"SetupCorridorCommandHandler",(function(){return r.dc})),i.d(e,"EditCorridorCommand",(function(){return r.X})),i.d(e,"EditCorridorCommandHandler",(function(){return r.Y})),i.d(e,"SetSelectedNodeCommand",(function(){return r.ac})),i.d(e,"SetSelectedNodeCommandHandler",(function(){return r.bc})),i.d(e,"AlignTiledLayerCommand",(function(){return r.k})),i.d(e,"AlignTiledLayerCommandHandler",(function(){return r.l})),i.d(e,"RequestInfoCommand",(function(){return r.Qb})),i.d(e,"RequestInfoCommandHandler",(function(){return r.Rb})),i.d(e,"ShareProjectLinkCommand",(function(){return r.kc})),i.d(e,"ShareProjectLinkCommandHandler",(function(){return r.lc})),i.d(e,"ShareProjectLinkMailCommand",(function(){return r.mc})),i.d(e,"ShareProjectLinkMailCommandHandler",(function(){return r.nc})),i.d(e,"ShareOnFacebookCommand",(function(){return r.ic})),i.d(e,"ShareOnFacebookCommandHandler",(function(){return r.jc})),i.d(e,"LoadSharedProjectCommand",(function(){return r.Fb})),i.d(e,"LoadSharedProjectCommandHandler",(function(){return r.Gb})),i.d(e,"EditLightIntensityCommand",(function(){return r.cb})),i.d(e,"EditLightIntensityCommandHandler",(function(){return r.db})),i.d(e,"ShowLightPlaceholderCommand",(function(){return r.oc})),i.d(e,"ShowLightPlaceholderCommandHandler",(function(){return r.pc})),i.d(e,"LoadTileVignetteCommand",(function(){return r.Hb})),i.d(e,"LoadTileVignetteCommandHandler",(function(){return r.Ib})),i.d(e,"DownloadVignetteImageCommand",(function(){return r.V})),i.d(e,"DownloadVignetteImageCommandHandler",(function(){return r.W})),i.d(e,"SetupVignetteViewCommand",(function(){return r.gc})),i.d(e,"SetupVignetteViewCommandHandler",(function(){return r.hc})),i.d(e,"LoadRugVignetteCommand",(function(){return r.Bb})),i.d(e,"LoadRugVignetteCommandHandler",(function(){return r.Cb})),i.d(e,"LoadCorridorVignetteCommand",(function(){return r.tb})),i.d(e,"LoadCorridorVignetteCommandHandler",(function(){return r.ub})),i.d(e,"LoadBroadloomVignetteCommand",(function(){return r.rb})),i.d(e,"LoadBroadloomVignetteCommandHandler",(function(){return r.sb})),i.d(e,"AddGroupsCommand",(function(){return r.e})),i.d(e,"AddGroupsCommandHandler",(function(){return r.f})),i.d(e,"EditGroupsCommand",(function(){return r.Z})),i.d(e,"EditGroupsCommandHandler",(function(){return r.ab})),i.d(e,"DeleteGroupsCommand",(function(){return r.R})),i.d(e,"DeleteGroupsCommandHandler",(function(){return r.S})),i.d(e,"Qt",(function(){return h})),i.d(e,"MixedQt",(function(){return l})),i.d(e,"UNITS",(function(){return n})),i.d(e,"QtUtils",(function(){return g})),i.d(e,"Fraction",(function(){return d})),i.d(e,"FileType",(function(){return m.a})),i.d(e,"FileUtils",(function(){return m.b})),i.d(e,"ComparisonTool",(function(){return v})),i.d(e,"UnitsEnum",(function(){return x.a})),i.d(e,"SurfaceType",(function(){return T.a})),i.d(e,"MaskId",(function(){return M.b})),i.d(e,"TileDestination",(function(){return C.e})),i.d(e,"SceneType",(function(){return b.b})),i.d(e,"GizmoPosition",(function(){return o.b})),i.d(e,"TIEngineContainer",(function(){return S})),i.d(e,"VignetteContainer",(function(){return q})),i.d(e,"EngineApiClient",(function(){return X})),i.d(e,"RR3Project",(function(){return W.e})),i.d(e,"RR3Layer",(function(){return W.d})),i.d(e,"RR3RugLayer",(function(){return W.f})),i.d(e,"RR3CorridorLayer",(function(){return W.c})),i.d(e,"RR3Corridor",(function(){return W.b})),i.d(e,"VignetteType",(function(){return W.g})),i.d(e,"RR3Broadloom",(function(){return W.a}));var n,a,s=i(11),o=i(22),r=i(3);class h{static getSquaredUnit(t){let e=c[t].sq;if(!e)throw"Specified squared unit of measurement is not supported: "+t;return e}static getUnitsRatio(t,e){let i=c[t],n=c[e];return i.ratio/n.ratio}constructor(t,e){this.unit=e;let i=c[e];if(!i)throw"Specified unit of measurement is not supported: "+e;this.spec=i,this.value=t}to(t){let e=c[t];if(this.spec.type!=e.type)throw"Cannot convert between incompatible unit types: "+this.spec.sym+" -> "+e.sym;return new h(this.value*(this.spec.ratio/e.ratio),t)}roundTo(t){let e=c[t],i=this.spec.ratio/e.ratio;return new h(Math.round(this.value*i)/i,this.unit)}toMixed(t,e){let i=h.getUnitsRatio(t,e),n=this.to(t),a=Math.floor(n.value),s=(n.value-a)*i;return new l(new h(a,t),new h(s,e))}getSymbol(){return this.spec.sym}}class l{constructor(t,e){this.largerQt=t,this.smallerQt=e}toSingle(t){let e=this.largerQt.to(t).value+this.smallerQt.to(t).value;return new h(e,t)}roundToSmaller(){let t=h.getUnitsRatio(this.largerQt.unit,this.smallerQt.unit),e=this.largerQt.value,i=this.smallerQt.roundTo(this.smallerQt.unit).value;return Math.abs(i-t)<1e-4&&(e+=1,i=0),new l(new h(e,this.largerQt.unit),new h(i,this.smallerQt.unit))}}!function(t){t[t.MM=1]="MM",t[t.CM=2]="CM",t[t.M=3]="M",t[t.IN=4]="IN",t[t.FT=5]="FT",t[t.MM2=6]="MM2",t[t.CM2=7]="CM2",t[t.M2=8]="M2",t[t.IN2=9]="IN2",t[t.FT2=10]="FT2"}(n||(n={})),function(t){t[t.LENGHT=0]="LENGHT",t[t.AREA=1]="AREA"}(a||(a={}));const c={};c[n.MM]={sym:"mm",ratio:.001,type:a.LENGHT,sq:n.MM2},c[n.CM]={sym:"cm",ratio:.01,type:a.LENGHT,sq:n.CM2},c[n.M]={sym:"m",ratio:1,type:a.LENGHT,sq:n.M2},c[n.IN]={sym:'"',ratio:.0254,type:a.LENGHT,sq:n.IN2},c[n.FT]={sym:"'",ratio:.3048,type:a.LENGHT,sq:n.FT2},c[n.MM2]={sym:"mm",ratio:1e-6,type:a.AREA,sq:null},c[n.CM2]={sym:"cm",ratio:1e-4,type:a.AREA,sq:null},c[n.M2]={sym:"m",ratio:1,type:a.AREA,sq:null},c[n.IN2]={sym:"in",ratio:.064516,type:a.AREA,sq:null},c[n.FT2]={sym:"ft",ratio:.09290304,type:a.AREA,sq:null};class d{constructor(t,e=0){e&&(t=function(t,e){const i=new d(e);return i.numerator>0?Math.round(t*i.denominator)/i.denominator:Math.round(t)}(t,e));const i=t<0?Math.ceil(t):Math.floor(t),n=t-i;let a=0,s=1;if(n>0){const t=n.toString().substring(2);s=Math.pow(10,t.length),a=parseInt(t);const e=function(t,e){if(t=Math.abs(t),(e=Math.abs(e))>t){let i=t;t=e,e=i}for(;;){if(0==e)return t;if(0==(t%=e))return e;e%=t}}(a,s);a/=e,s/=e}this.whole=i,this.numerator=a,this.denominator=s}isZero(){return 0==this.whole&&0==this.numerator}toString(){let t="";return this.whole>0&&(t+=this.whole.toString()),this.numerator>0&&(t.length>0&&(t+=" "),t+=function(t){let e=t.toString(),i="";for(let n=0,a=e.length;n<a;n++)i+=u(parseInt(t[n]));return i}(this.numerator)+String.fromCharCode(8260)+function(t){let e=t.toString(),i="";for(let n=0,a=e.length;n<a;n++)i+=p(parseInt(t[n]));return i}(this.denominator)),t}}function u(t){if(t<0||t>9)throw"Invalid digit: "+t;switch(t){case 1:return String.fromCharCode(185);case 2:return String.fromCharCode(178);case 3:return String.fromCharCode(179);default:return String.fromCharCode(8304+t)}}function p(t){if(t<0||t>9)throw"Invalid digit: "+t;return String.fromCharCode(8320+t)}class g{constructor(){this.decimalSeparator=this.browserDecimalSeparator()}setInchesRoundingFactor(t){this.inchesRoundingFactor=t}formatLength(t,e=!0){let i;switch(t.unit){case n.FT:i=e?this.formatFeetAndInches(t):this.formatInches(t.to(n.IN),!1);break;case n.IN:i=this.formatInches(t.to(n.IN),e);break;default:i=this.formatMetricUnit(t,e)}return i}formatArea(t,e=!0){let i;switch(t.unit){case n.FT2:i=e?this.formatFeetAndInches(t):this.formatInches(t.to(n.IN2),!1);break;case n.IN2:i=this.formatInches(t.to(n.IN),e);break;default:i=this.formatMetricUnit(t,e)}return i}browserDecimalSeparator(){let t=.1.toLocaleString().charAt(1);return"."!=t&&","!=t&&(t="."),t}formatMetricUnit(t,e){return t.value.toString().replace(".",this.decimalSeparator)+(e?` ${t.getSymbol()}`:"")}formatFeetAndInches(t){let e=t.unit==n.FT?n.IN:n.IN2,i=t.toMixed(t.unit,e),a=i.largerQt.value,s=i.smallerQt.value,o=new d(s,this.inchesRoundingFactor),r=t.unit==n.FT?12:144;return o.whole==r&&0==o.numerator&&(a+=1,o=new d(0)),a+" "+t.getSymbol()+" "+(o.isZero()?"":o.toString()+" "+i.smallerQt.getSymbol())}formatInches(t,e){return new d(t.value,this.inchesRoundingFactor).toString()+(e?` ${t.getSymbol()}`:"")}}var m=i(36),f=i(18);const y={width:"46px",height:"46px",position:"absolute",left:"50%",top:"50%",marginLeft:"-23px",marginTop:"-23px",border:"3px solid white",borderRadius:"1000px",WebkitBorderRadius:"1000px",MozBorderRadius:"1000px",boxShadow:"0px 0px 12px rgba(51, 51, 51, 0.5)",WebkitBoxShadow:"0px 0px 12px rgba(51, 51, 51, 0.5)",MozBoxShadow:"0px 0px 12px rgba(51, 51, 51, 0.5)",zIndex:40,cursor:"pointer"};class v extends f.Component{constructor(t){super(t),this.setCtHandleRef=t=>{this.ctHandleDiv=t},this.setInternalContainerRef=t=>{this.internalContainerDiv=t},this.setupComparisonTool=()=>{const t=this.calcOffset(this.handlePosition),e=Object.assign({},y);e.left=t.cw+"px",e.display=this.state.displayString;const i=Object.assign({},this.compareImageDefaultStyle);i.display=this.state.displayString,"left"===this.activeSide?i.clip=`rect(0, ${t.w}px, ${t.h}px, ${t.cw}px)`:"right"===this.activeSide&&(i.clip=`rect(0, ${t.cw+2}px, ${t.h}px, 0)`),this.setState({compareImageFinalStyle:i,handleStyle:e})},this.calcOffset=t=>({w:this.props.width,h:this.props.height,cw:this.props.width*t,ch:this.props.height*t}),this.pointerDownEventHandler=t=>{if(this.getEventTouches(t).length>1)return;const e=this.getPointerCoordinates(t);this.handlePressed=null!=e,this.props.onCTDragStart&&this.props.onCTDragStart()},this.pointerMoveEventHandler=t=>{if(this.handlePressed){t.preventDefault();const e=this.getPointerCoordinates(t);if(e.x<=23||e.x>=this.props.width-23)return;this.handlePosition=e.x/this.props.width,this.handlePosition<0&&(this.handlePosition=0),this.handlePosition>1&&(this.handlePosition=1),this.setupComparisonTool(),this.props.onCTMove&&this.props.onCTMove(this.handlePosition)}},this.pointerUpEventHandler=t=>{this.handlePressed=!1,this.props.onCTDragEnd&&this.props.onCTDragEnd(this.handlePosition)},this.compareImageDefaultStyle={width:"100%",height:"100%",position:"absolute",top:"0px",left:"0px"};const e=Object.assign({},this.compareImageDefaultStyle);e.display="none";const i=Object.assign({},y);i.display="none",i.left="0px",this.state={comparisonToolActive:!1,imageSrc:"#",compareImageFinalStyle:e,handleStyle:i,displayString:"none"},this.handlePosition=.5}showComparisonTool(t,e,i){i&&(this.handlePosition=i),this.activeSide=t;const n=Object.assign({},this.compareImageDefaultStyle),a=Object.assign({},y);this.setState({comparisonToolActive:!0,imageSrc:e,compareImageFinalStyle:n,displayString:"block",handleStyle:a},(()=>{this.setupComparisonTool(),this.attachEventHandlers()}))}hideComparisonTool(){const t=Object.assign({},this.compareImageDefaultStyle);t.display="none";const e=Object.assign({},y);e.display="none",this.detachEventHandlers(),this.setState({comparisonToolActive:!1,compareImageFinalStyle:t,displayString:"none",handleStyle:e,imageSrc:"#"})}attachEventHandlers(){this.ctHandleDiv.addEventListener("mousedown",this.pointerDownEventHandler),this.ctHandleDiv.addEventListener("touchstart",this.pointerDownEventHandler),this.ctHandleDiv.addEventListener("mousemove",this.pointerMoveEventHandler),this.ctHandleDiv.addEventListener("touchmove",this.pointerMoveEventHandler),this.ctHandleDiv.addEventListener("mouseup",this.pointerUpEventHandler),this.ctHandleDiv.addEventListener("touchend",this.pointerUpEventHandler),this.ctHandleDiv.addEventListener("touchcancel",this.pointerUpEventHandler),this.internalContainerDiv.addEventListener("mousemove",this.pointerMoveEventHandler),this.internalContainerDiv.addEventListener("touchmove",this.pointerMoveEventHandler),this.internalContainerDiv.addEventListener("mouseup",this.pointerUpEventHandler),this.internalContainerDiv.addEventListener("touchend",this.pointerUpEventHandler),this.internalContainerDiv.addEventListener("touchcance",this.pointerUpEventHandler)}detachEventHandlers(){this.ctHandleDiv.removeEventListener("mousedown",this.pointerDownEventHandler),this.ctHandleDiv.removeEventListener("touchstart",this.pointerDownEventHandler),this.ctHandleDiv.removeEventListener("mousemove",this.pointerMoveEventHandler),this.ctHandleDiv.removeEventListener("touchmove",this.pointerMoveEventHandler),this.ctHandleDiv.removeEventListener("mouseup",this.pointerUpEventHandler),this.ctHandleDiv.removeEventListener("touchend",this.pointerUpEventHandler),this.ctHandleDiv.removeEventListener("touchcancel",this.pointerUpEventHandler),this.internalContainerDiv.removeEventListener("mousemove",this.pointerMoveEventHandler),this.internalContainerDiv.removeEventListener("touchmove",this.pointerMoveEventHandler),this.internalContainerDiv.removeEventListener("mouseup",this.pointerUpEventHandler),this.internalContainerDiv.removeEventListener("touchend",this.pointerUpEventHandler),this.internalContainerDiv.removeEventListener("touchcancel",this.pointerUpEventHandler)}getPointerCoordinates(t){switch(t.type){case"touchstart":case"touchmove":return this.getEventTouches(t)[0];case"mousedown":case"mouseup":case"mousemove":case"mouseover":case"mouseout":case"mouseenter":case"mouseleave":case"mousewheel":case"DOMMouseScroll":case"wheel":case"drop":return this.getRelativePointerCoordinates(t.clientX,t.clientY,this.internalContainerDiv);case"touchend":case"touchcancel":return null;default:throw"Unsupported event type: "+t.type}}getEventTouches(t){const e=[],i=t.touches||t.changedTouches||[];for(let t=0;t<i.length;t++){const n=i[t];e.push(this.getRelativePointerCoordinates(n.clientX,n.clientY,this.internalContainerDiv))}return e}getRelativePointerCoordinates(t,e,i){const n=i.getBoundingClientRect();return{x:t-n.left,y:e-n.top}}render(){const t=this.props.height/2-23;return f.createElement("div",{id:"external-container",className:"comparison-tool",style:{width:this.props.width+"px",height:this.props.height+"px"}},f.createElement("div",{id:"internal-container",className:"ct-container",ref:this.setInternalContainerRef,style:{boxSizing:"content-box",WebkitBoxSizing:"content-box",MozBoxSizing:"content-box",zIndex:0,overflow:"hidden",position:"relative",WebkitUserSelect:"none",MozUserSelect:"none"}},f.Children.toArray(this.props.children)[0],f.createElement("img",{id:"compare-image",src:this.state.imageSrc,style:this.state.compareImageFinalStyle}),f.createElement("div",{id:"ct-handle",ref:this.setCtHandleRef,style:this.state.handleStyle},f.createElement("div",{style:{content:" ",display:"block",background:"white",position:"absolute",zIndex:30,boxShadow:"0 3px 0 white, 0px 0px 12px rgba(51, 51, 51, 0.5)",WebkitBoxShadow:"0 3px 0 white, 0px 0px 12px rgba(51, 51, 51, 0.5)",MozBoxShadow:"0 3px 0 white, 0px 0px 12px rgba(51, 51, 51, 0.5)",width:"3px",height:t+"px",left:"50%",marginLeft:"-2px",top:-t-3+"px"}}),f.createElement("span",{className:"ct-left-arrow",style:{width:"0px",height:"0px",borderWidth:"8px",borderColor:"transparent white transparent transparent",borderStyle:"inset solid inset inset",position:"absolute",top:"50%",marginTop:"-8px",left:"50%",marginLeft:"-24px"}}),f.createElement("span",{className:"ct-right-arrow",style:{width:"0px",height:"0px",borderWidth:"8px",borderColor:"transparent transparent transparent white",borderStyle:"inset inset inset solid",position:"absolute",top:"50%",marginTop:"-8px",right:"50%",marginRight:"-24px"}}),f.createElement("div",{style:{content:" ",display:"block",background:"white",position:"absolute",zIndex:30,boxShadow:"0 -3px 0 white, 0px 0px 12px rgba(51, 51, 51, 0.5)",WebkitBoxShadow:"0 -3px 0 white, 0px 0px 12px rgba(51, 51, 51, 0.5)",MozBoxShadow:"0 -3px 0 white, 0px 0px 12px rgba(51, 51, 51, 0.5)",width:"3px",height:t+"px",left:"50%",marginLeft:"-2px",bottom:-t-3+"px"}}))))}}var x=i(50),T=i(51),M=i(38),C=i(10),b=i(49),P=i(0),E=i(44),D=i(45),w=i(5);class S extends f.Component{constructor(t){super(t),this.isEngineReady=!1,this.updateAnimationFrame=()=>{this.lastFrameId=requestAnimationFrame(this.updateAnimationFrame),this.sceneManager.update()},this.state={},this.project=new P.G,this.commandManager=new E.a,this.canvasContainer=f.createRef(),this.sceneManager=null}componentDidMount(){if(null!=this.canvasContainer.current)try{this.sceneManager=new D.b(this.canvasContainer.current,this.props.width,this.props.height,this.project,this.commandManager,this.props.resourceManager,this.props.apiEndpoint,this.props.apiToken,this.props.autoRot,this.props.initAngle,this.props.tileOrientation,this.props.bgColor,this.props.defaultThickness,this.props.cubemapTextures),this.updateAnimationFrame(),this.forceUpdate(),this.sceneManager.initAnalytics(w.q,this.props.groupId,this.props.tenantId)}catch(t){this.props.onInitializationError&&this.props.onInitializationError(t)}}executeCommand(t){this.sceneManager.executeCommand(t)}canExecuteCommand(t){return this.sceneManager&&0==this.sceneManager.getNBlockingTask()}componentWillUnmount(){cancelAnimationFrame(this.lastFrameId)}render(){return this.sceneManager&&(this.sceneManager.resize(this.props.width,this.props.height),this.isEngineReady||(this.isEngineReady=!0,this.props.onEngineReady&&this.props.onEngineReady(this))),f.createElement("div",{style:{position:"relative"},"engine-version":w.w},f.createElement("div",{style:{height:`${this.props.height}px`,width:`${this.props.width}px`,position:"relative"},ref:this.canvasContainer}))}}var I,L,A,O=i(1),R=i(9),_=i(26),k=i(7),j=i(35),N=i(41),F=i(46),z=i(42),B=i(25),H=i(66);!function(t){t[t.NONE=-1]="NONE",t[t.ROTATE=0]="ROTATE",t[t.DOLLY=1]="DOLLY",t[t.PAN=2]="PAN",t[t.TOUCH_ROTATE=3]="TOUCH_ROTATE",t[t.TOUCH_DOLLY_PAN=4]="TOUCH_DOLLY_PAN",t[t.WHEEL_DOLLY_PAN=5]="WHEEL_DOLLY_PAN"}(I||(I={})),function(t){t[t.SCREEN=0]="SCREEN",t[t.DEPTH=1]="DEPTH",t[t.ELEVATION=2]="ELEVATION",t[t.DOLLY=3]="DOLLY"}(L||(L={})),function(t){t[t.WALK=0]="WALK",t[t.ORBIT=1]="ORBIT"}(A||(A={}));const U=1e-6;class G extends O.EventDispatcher{isProcessingUserInput(){return this.state!==I.NONE}constructor(t,e){if(super(),this.object=t,this.domElement=e,this.onMouseDown=t=>{if(!1!==this.enabled){switch(t.preventDefault(),t.button){case this.mouseButtons.LEFT:if(t.ctrlKey||t.metaKey||t.shiftKey){if(!1===this.enablePan)return;this.handleMouseDownPan(t),this.state=I.PAN}else{if(!1===this.enableRotate)return;this.handleMouseDownRotate(t),this.state=I.ROTATE}break;case this.mouseButtons.MIDDLE:if(!1===this.enableZoom)return;this.handleMouseDownDolly(t),this.state=I.DOLLY;break;case this.mouseButtons.RIGHT:if(!1===this.enablePan)return;this.handleMouseDownPan(t),this.state=I.PAN}this.state!==I.NONE&&(document.addEventListener("mousemove",this.onMouseMove,!1),document.addEventListener("mouseup",this.onMouseUp,!1),this.dispatchEvent({type:"start"}))}},this.onMouseMove=t=>{if(!1!==this.enabled)switch(t.preventDefault(),this.state){case I.ROTATE:if(!1===this.enableRotate)return;this.handleMouseMoveRotate(t);break;case I.DOLLY:if(!1===this.enableZoom)return;this.handleMouseMoveDolly(t);break;case I.PAN:if(!1===this.enablePan)return;this.handleMouseMovePan(t)}},this.onMouseUp=t=>{!1!==this.enabled&&(this.handleMouseUp(t),document.removeEventListener("mousemove",this.onMouseMove,!1),document.removeEventListener("mouseup",this.onMouseUp,!1),this.dispatchEvent({type:"end"}),this.state=I.NONE)},this.onMouseWheel=t=>{if(!1!==this.enabled&&!1!==this.enableZoom&&(this.state===I.NONE||this.state===I.ROTATE||this.state===I.WHEEL_DOLLY_PAN)){switch(t.preventDefault(),t.stopPropagation(),this.dispatchEvent({type:"start"}),this.mode){case A.ORBIT:this.handleMouseWheelDolly(t);break;case A.WALK:this.handleMouseWheelPan(t)}this.state=I.WHEEL_DOLLY_PAN,this.dispatchWheelEnd(t)}},this.onKeyDown=t=>{!1!==this.enabled&&!1!==this.enableKeys&&!1!==this.enablePan&&this.handleKeyDown(t)},this.onTouchStart=t=>{if(!1!==this.enabled){switch(t.preventDefault(),t.touches.length){case 1:if(!1===this.enableRotate)return;this.handleTouchStartRotate(t),this.state=I.TOUCH_ROTATE;break;case 2:if(!1===this.enableZoom&&!1===this.enablePan)return;this.handleTouchStartDollyPan(t),this.state=I.TOUCH_DOLLY_PAN;break;default:this.state=I.NONE}this.state!==I.NONE&&this.dispatchEvent({type:"start"})}},this.onTouchMove=t=>{if(!1!==this.enabled)switch(t.preventDefault(),t.stopPropagation(),t.touches.length){case 1:if(!1===this.enableRotate)return;if(this.state!==I.TOUCH_ROTATE)return;this.handleTouchMoveRotate(t);break;case 2:if(!1===this.enableZoom&&!1===this.enablePan)return;if(this.state!==I.TOUCH_DOLLY_PAN)return;switch(this.mode){case A.ORBIT:this.handleTouchMoveDollyPan(t);break;case A.WALK:this.handleTouchMovePan(t)}break;default:this.state=I.NONE}},this.onTouchEnd=t=>{!1!==this.enabled&&(this.handleTouchEnd(t),this.dispatchEvent({type:"end"}),this.state=I.NONE)},this.onContextMenu=t=>{!1!==this.enabled&&t.preventDefault()},!e)throw new Error("Invalid argument: 'domElement' cannot be null");this.object=t,this.domElement=e,this.mode=A.ORBIT,this.enabled=!0,this.target=new O.Vector3,this.minElevation=-1/0,this.maxElevation=1/0,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.panMode=L.DEPTH,this.mousePanInvert=!1,this.wheelPanSpeed=70,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.enableKeys=!0,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},this.mouseButtons={LEFT:O.MOUSE.LEFT,MIDDLE:O.MOUSE.MIDDLE,RIGHT:O.MOUSE.RIGHT},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.spherical=new O.Spherical,this.sphericalDelta=new O.Spherical,this.scale=1,this.panOffset=new O.Vector3,this.zoomChanged=!1,this.rotateStart=new O.Vector2,this.rotateEnd=new O.Vector2,this.rotateDelta=new O.Vector2,this.panStart=new O.Vector2,this.panEnd=new O.Vector2,this.panDelta=new O.Vector2,this.dollyStart=new O.Vector2,this.dollyEnd=new O.Vector2,this.dollyDelta=new O.Vector2,this.updateOffset=new O.Vector3,this.updateQuat=(new O.Quaternion).setFromUnitVectors(this.object.up,new O.Vector3(0,1,0)),this.updateQuatInverse=this.updateQuat.clone().invert(),this.updateLastPosition=new O.Vector3,this.updateLastQuaternion=new O.Quaternion,this.panInternalOffset=new O.Vector3,this.panLeftV=new O.Vector3,this.panUpV=new O.Vector3,this.attachDomHandlers(),this.dispatchWheelEnd=Object(H.debounce)((()=>{this.state=I.NONE,this.dispatchEvent({type:"end"})}),100),this.update()}getPolarAngle(){return this.spherical.phi}getAzimuthalAngle(){return this.spherical.theta}saveState(){this.target0.copy(this.target),this.position0.copy(this.object.position),this.zoom0=this.object.zoom}reset(){this.target.copy(this.target0),this.object.position.copy(this.position0),this.object.zoom=this.zoom0,this.object.updateProjectionMatrix(),this.dispatchEvent({type:"change"}),this.update(),this.state=I.NONE}update(){const t=this.object.position;this.updateOffset.copy(t).sub(this.target),this.updateOffset.applyQuaternion(this.updateQuat),this.spherical.setFromVector3(this.updateOffset),this.autoRotate&&this.state===I.NONE&&this.rotateLeft(this.getAutoRotationAngle());const e=this.rotateInvert?-1:1;switch(this.enableDamping?(this.spherical.theta+=this.sphericalDelta.theta*e*this.dampingFactor,this.spherical.phi+=this.sphericalDelta.phi*e*this.dampingFactor):(this.spherical.theta+=this.sphericalDelta.theta*e,this.spherical.phi+=this.sphericalDelta.phi*e),this.minAzimuthAngle<this.maxAzimuthAngle?this.spherical.theta=Math.max(this.minAzimuthAngle,Math.min(this.maxAzimuthAngle,this.spherical.theta)):this.spherical.theta=this.spherical.theta<0?Math.min(this.maxAzimuthAngle,this.spherical.theta):Math.max(this.minAzimuthAngle,this.spherical.theta),this.spherical.phi=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,this.spherical.phi)),this.spherical.makeSafe(),this.spherical.radius*=this.scale,this.spherical.radius=Math.max(this.minDistance,Math.min(this.maxDistance,this.spherical.radius)),this.updateOffset.setFromSpherical(this.spherical),this.updateOffset.applyQuaternion(this.updateQuatInverse),this.mode){case A.ORBIT:this.target.add(this.panOffset),t.copy(this.target).add(this.updateOffset),t.y=Math.max(this.minElevation,Math.min(this.maxElevation,t.y));break;case A.WALK:t.add(this.panOffset),t.y=Math.max(this.minElevation,Math.min(this.maxElevation,t.y)),this.target.copy(t).add(this.updateOffset.clone().negate())}this.object.lookAt(this.target),!0===this.enableDamping?(this.sphericalDelta.theta*=1-this.dampingFactor,this.sphericalDelta.phi*=1-this.dampingFactor,this.panOffset.multiplyScalar(1-this.dampingFactor)):(this.sphericalDelta.set(0,0,0),this.panOffset.set(0,0,0)),this.scale=1;const i=this.updateLastPosition.distanceToSquared(this.object.position)>U||8*(1-this.updateLastQuaternion.dot(this.object.quaternion))>U;return this.zoomChanged||i?(this.dispatchEvent({type:"change"}),this.updateLastPosition.copy(this.object.position),this.updateLastQuaternion.copy(this.object.quaternion),this.zoomChanged=!1,!0):(this.sphericalDelta.set(0,0,0),this.panOffset.set(0,0,0),!1)}hasPendingTransforms(){return 0!==this.sphericalDelta.phi||0!==this.sphericalDelta.theta||0!==this.sphericalDelta.radius||0!==this.panOffset.x||0!==this.panOffset.y||0!==this.panOffset.z}dispose(){this.domElement.removeEventListener("contextmenu",this.onContextMenu,!1),this.domElement.removeEventListener("mousedown",this.onMouseDown,!1),this.domElement.removeEventListener("wheel",this.onMouseWheel,!1),this.domElement.removeEventListener("touchstart",this.onTouchStart,!1),this.domElement.removeEventListener("touchend",this.onTouchEnd,!1),this.domElement.removeEventListener("touchmove",this.onTouchMove,!1),document.removeEventListener("mousemove",this.onMouseMove,!1),document.removeEventListener("mouseup",this.onMouseUp,!1),window.removeEventListener("keydown",this.onKeyDown,!1)}attachDomHandlers(){this.domElement.addEventListener("contextmenu",this.onContextMenu,!1),this.domElement.addEventListener("mousedown",this.onMouseDown,!1),this.domElement.addEventListener("wheel",this.onMouseWheel,!1),this.domElement.addEventListener("touchstart",this.onTouchStart,!1),this.domElement.addEventListener("touchend",this.onTouchEnd,!1),this.domElement.addEventListener("touchmove",this.onTouchMove,!1),window.addEventListener("keydown",this.onKeyDown,!1)}getAutoRotationAngle(){return 2*Math.PI/60/60*this.autoRotateSpeed}getZoomScale(){return Math.pow(.95,this.zoomSpeed)}rotateLeft(t){this.sphericalDelta.theta-=t}rotateUp(t){this.sphericalDelta.phi-=t}panLeft(t,e){this.panLeftV.setFromMatrixColumn(e,0),this.panLeftV.multiplyScalar(-t),this.panOffset.add(this.panLeftV)}panUp(t,e,i){switch(i){case L.DEPTH:this.panUpV.setFromMatrixColumn(e,0),this.panUpV.crossVectors(this.object.up,this.panUpV);break;case L.SCREEN:this.panUpV.setFromMatrixColumn(e,1);break;case L.ELEVATION:this.panUpV=new O.Vector3(0,1,0);break;case L.DOLLY:this.panUpV.setFromMatrixColumn(e,2).negate();break;default:}this.panUpV.multiplyScalar(t),this.panOffset.add(this.panUpV)}pan(t,e,i){const n=this.domElement;if(k.a.isPerspectiveCamera(this.object)){const a=this.object.position;this.panInternalOffset.copy(a).sub(this.target);let s=this.panInternalOffset.length();s*=Math.tan(this.object.fov/2*Math.PI/180);const o=this.object.matrix;this.panLeft(2*t*s/n.clientHeight,o),this.panUp(2*e*s/n.clientHeight,o,i)}else k.a.isOrthographicCamera(this.object)?(this.panLeft(t*(this.object.right-this.object.left)/this.object.zoom/n.clientWidth,this.object.matrix),this.panUp(e*(this.object.top-this.object.bottom)/this.object.zoom/n.clientHeight,this.object.matrix,i)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),this.enablePan=!1);this.dispatchEvent({type:"pan",panOffset:this.panOffset})}dollyIn(t){k.a.isPerspectiveCamera(this.object)?this.scale/=t:k.a.isOrthographicCamera(this.object)?(this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom*t)),this.object.updateProjectionMatrix(),this.zoomChanged=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)}dollyOut(t){k.a.isPerspectiveCamera(this.object)?this.scale*=t:k.a.isOrthographicCamera(this.object)?(this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/t)),this.object.updateProjectionMatrix(),this.zoomChanged=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)}handleMouseDownRotate(t){this.rotateStart.set(t.clientX,t.clientY)}handleMouseDownDolly(t){this.dollyStart.set(t.clientX,t.clientY)}handleMouseDownPan(t){this.panStart.set(t.clientX,t.clientY)}handleMouseMoveRotate(t){this.rotateEnd.set(t.clientX,t.clientY),this.rotateDelta.subVectors(this.rotateEnd,this.rotateStart).multiplyScalar(this.rotateSpeed);const e=this.domElement;this.rotateLeft(2*Math.PI*this.rotateDelta.x/e.clientHeight),this.rotateUp(2*Math.PI*this.rotateDelta.y/e.clientHeight),this.rotateStart.copy(this.rotateEnd),this.update()}handleMouseMoveDolly(t){this.dollyEnd.set(t.clientX,t.clientY),this.dollyDelta.subVectors(this.dollyEnd,this.dollyStart),this.dollyDelta.y>0?this.dollyIn(this.getZoomScale()):this.dollyDelta.y<0&&this.dollyOut(this.getZoomScale()),this.dollyStart.copy(this.dollyEnd),this.update()}handleMouseMovePan(t){this.panEnd.set(t.clientX,t.clientY),this.panDelta.subVectors(this.panEnd,this.panStart).multiplyScalar(this.panSpeed),this.mousePanInvert&&this.panDelta.negate(),this.pan(this.panDelta.x,this.panDelta.y,this.panMode),this.panStart.copy(this.panEnd),this.update()}handleMouseUp(t){}handleMouseWheelDolly(t){t.deltaY<0?this.dollyOut(this.getZoomScale()):t.deltaY>0&&this.dollyIn(this.getZoomScale()),this.update()}handleMouseWheelPan(t){t.deltaY<0?this.pan(0,this.wheelPanSpeed,this.wheelPanMode):t.deltaY>0&&this.pan(0,-this.wheelPanSpeed,this.wheelPanMode),this.update()}handleKeyDown(t){switch(t.keyCode){case this.keys.UP:this.pan(0,this.keyPanSpeed,this.panMode),this.update();break;case this.keys.BOTTOM:this.pan(0,-this.keyPanSpeed,this.panMode),this.update();break;case this.keys.LEFT:this.pan(this.keyPanSpeed,0,this.panMode),this.update();break;case this.keys.RIGHT:this.pan(-this.keyPanSpeed,0,this.panMode),this.update()}}handleTouchStartRotate(t){this.rotateStart.set(t.touches[0].pageX,t.touches[0].pageY)}handleTouchStartDollyPan(t){if(this.enableZoom){const e=t.touches[0].pageX-t.touches[1].pageX,i=t.touches[0].pageY-t.touches[1].pageY,n=Math.sqrt(e*e+i*i);this.dollyStart.set(0,n)}if(this.enablePan){const e=.5*(t.touches[0].pageX+t.touches[1].pageX),i=.5*(t.touches[0].pageY+t.touches[1].pageY);this.panStart.set(e,i)}}handleTouchMoveRotate(t){this.rotateEnd.set(t.touches[0].pageX,t.touches[0].pageY),this.rotateDelta.subVectors(this.rotateEnd,this.rotateStart).multiplyScalar(this.rotateSpeed);const e=this.domElement;this.rotateLeft(2*Math.PI*this.rotateDelta.x/e.clientHeight),this.rotateUp(2*Math.PI*this.rotateDelta.y/e.clientHeight),this.rotateStart.copy(this.rotateEnd),this.update()}handleTouchMoveDollyPan(t){if(this.enableZoom){const e=t.touches[0].pageX-t.touches[1].pageX,i=t.touches[0].pageY-t.touches[1].pageY,n=Math.sqrt(e*e+i*i);this.dollyEnd.set(0,n),this.dollyDelta.set(0,Math.pow(this.dollyEnd.y/this.dollyStart.y,this.zoomSpeed)),this.dollyIn(this.dollyDelta.y),this.dollyStart.copy(this.dollyEnd)}if(this.enablePan){const e=.5*(t.touches[0].pageX+t.touches[1].pageX),i=.5*(t.touches[0].pageY+t.touches[1].pageY);this.panEnd.set(e,i),this.panDelta.subVectors(this.panEnd,this.panStart).multiplyScalar(this.panSpeed),this.pan(this.panDelta.x,this.panDelta.y,this.panMode),this.panStart.copy(this.panEnd)}this.update()}handleTouchMovePan(t){if(this.enablePan){const e=t.touches[0].pageX-t.touches[1].pageX,i=t.touches[0].pageY-t.touches[1].pageY,n=Math.sqrt(e*e+i*i);this.dollyEnd.set(0,n),this.dollyDelta.subVectors(this.dollyEnd,this.dollyStart).multiplyScalar(this.panSpeed),this.pan(0,this.dollyDelta.y,L.DEPTH),console.log(this.dollyDelta.y),this.dollyStart.copy(this.dollyEnd);const a=.5*(t.touches[0].pageX+t.touches[1].pageX),s=.5*(t.touches[0].pageY+t.touches[1].pageY);this.panEnd.set(a,s),this.panDelta.subVectors(this.panEnd,this.panStart).multiplyScalar(this.panSpeed),this.pan(this.panDelta.x,this.panDelta.y,this.panMode),this.panStart.copy(this.panEnd)}this.update()}handleTouchEnd(t){}}var V=i(4),W=i(24);class J{resize(t,e){this._width&&this._height&&this._width===t&&this._height===e||(this._width=t,this._height=e,this.lineMaterial.resolution.set(t,e),this.renderer.setSize(t,e))}constructor(t,e,i,n,a,s,o,r,h,l,c,d){this.containerDomElement=t,this.commandManager=a,this.resourceManager=s,this.apiEndpoint=o,this.apiToken=r,this.minVignetteWidth=h,this.minVignetteHeight=l,this.onTasksChanged=t=>{this.resourceManager&&this.resourceManager.showActivityIndicator(t.blockingTasks,t.nonBlockingTasks)},this.renderFrameChanged=t=>{this.renderFrame=t},this.projectChangedEventHandler=t=>{switch(t.type){case"FACE3D_ADDED":this.addFace3D(t.node);break;case"RUG_ADDED":this.addRug(t.node);break;case"CORRIDOR_ADDED":this.addCorridor(t.node)}},this._width=e,this._height=i,this.project=n,this.project.projectChanged.attach(this.projectChangedEventHandler),this.canvas=this.buildCanvas(),this.scene=new O.Scene,this.scene.background=new O.Color(d||13224393);const u=new O.HemisphereLight(16777215,14145495,14);this.scene.add(u);const p=new O.PointLight(16777215,.5,0,2);let g;this.scene.add(p),this.tileClient=new j.b(this.apiEndpoint,this.apiToken),this.orthoCamera=new O.OrthographicCamera(-1,1,1,-1,0,1),this.perspectiveCamera=this.buildPerspectiveCamera(this._width,this._height),this.renderer=this.buildRenderer(this.canvas,this._width,this._height,window.devicePixelRatio?window.devicePixelRatio:1),this.modelToThreeMap=new Map,this.sceneEntities=new z.a(this.modelToThreeMap),this.activityManager=new N.a,this.activityManager.tasksChanged.on(this.onTasksChanged),this.matManager=new R.d(new j.a(this.apiEndpoint,this.apiToken),this.project,this.scene,this.activityManager,!1,null),this.patternManager=new R.f(this.project,this.tileClient),this.renderFrameRequest=new _.a(!1),this.renderFrameRequest.Changed.on(this.renderFrameChanged),this.renderFrame=!0,c&&(g=new O.Color(c)),this.patternLoader=new R.e(this.matManager,this.sceneEntities,this.patternManager,null,null,null,g),this.face3DLoader=new R.c(this.project,this.matManager,this.patternLoader,this.renderFrameRequest,null),this.rugLoader=new R.g(this.matManager,this.activityManager,this.renderFrameRequest),this.corridorLoader=new R.a(this.matManager,null,this.renderFrameRequest),c&&(this.lineMaterial=new B.a({color:c,linewidth:1,toneMapped:!1,resolution:new O.Vector2(this._width,this._height),depthTest:!0,transparent:!1,opacity:1}),this.patternLoader.setLineMaterial(this.lineMaterial)),this.orbitControls=new G(this.perspectiveCamera,this.containerDomElement)}buildCanvas(){const t=document.createElement("canvas");return t.style.position="absolute",this.containerDomElement.appendChild(t),t}buildRenderer(t,e,i,n){const a=new O.WebGLRenderer({canvas:t,antialias:!0,powerPreference:"low-power"});return a.setPixelRatio(n),a.setSize(e,i),a.outputColorSpace=O.SRGBColorSpace,a.toneMappingExposure=.1,a.toneMapping=O.ACESFilmicToneMapping,a.shadowMap.enabled=!0,a.shadowMap.type=O.PCFSoftShadowMap,a}buildPerspectiveCamera(t,e){const i=t/e,n=new O.PerspectiveCamera(60,i,.01,35);return n.position.set(0,3,3),n.lookAt(new O.Vector3(0,0,0)),n}initAnalytics(t,e,i){window.location.href.includes("localhost")||(this.analyticsManager=new F.a(t,e,i),this.analyticsManager.notifyPagePreview("VIGNETTE",window.location.href))}getNBlockingTask(){return this.activityManager.getNBlockingTask()}onCommandEnd(t){t.canceled||!t.nextCommand||this.executeCommand(t.nextCommand)}executeCommand(t){switch(t.type){case r.Q.LoadTileVignette:this.clearProject(),this.vignetteType=W.g.Tile,this.lineMaterial.visible=!0,this.commandManager.execute(new r.Ib(this.project,this.tileClient,this.matManager,this.patternManager,this.minVignetteWidth,this.minVignetteHeight,this.activityManager,this.analyticsManager),t);break;case r.Q.DownloadVignetteImage:this.commandManager.execute(new r.W(this.project,this.renderer,this.scene,this.vignetteType,this.lineMaterial,this.activityManager,this.analyticsManager),t);break;case r.Q.SetupVignetteView:this.commandManager.execute(new r.hc(this.orthoCamera,this._width,this._height),t);break;case r.Q.LoadRugVignette:this.clearProject(),this.vignetteType=W.g.Rug,this.lineMaterial.visible=!1,this.commandManager.execute(new r.Cb(this.project,this.activityManager,this.analyticsManager),t);break;case r.Q.LoadCorridorVignette:this.clearProject(),this.vignetteType=W.g.Corridor,this.lineMaterial.visible=!1,this.commandManager.execute(new r.ub(this.project,this.activityManager,this.analyticsManager),t);break;case r.Q.LoadBroadloomVignette:this.clearProject(),this.vignetteType=W.g.Broadloom,this.commandManager.execute(new r.sb(this.project,this.activityManager,this.matManager,this.patternManager,this.lineMaterial,this.analyticsManager),t)}}update(){this.renderer.render(this.scene,this.orthoCamera)}addFace3D(t){if(t.data.type!==P.r.DTFace3D)throw new Error("Invalid node type");const e=this.sceneEntities.addAndAttachToParentAndSetId(t.id,new O.Mesh,this.scene);this.face3DLoader.loadFace3D(e,t,!1,-1,null)}addRug(t){if(t.data.type!==P.r.DTRug)throw new Error("Invalid node type");const e=t.data,i=this.sceneEntities.addAndAttachToParentAndSetId(t.id,new O.Group,this.scene);k.a.setObject3DTransform(i,Object(V.e)(e.matrix,V.c,V.a)),this.rugLoader.loadRug(i,t,1,null)}addCorridor(t){if(t.data.type!==P.r.DTCorridor)throw new Error("Invalid node type");const e=t.data,i=this.sceneEntities.addAndAttachToParentAndSetId(t.id,new O.Mesh,this.scene);k.a.setObject3DTransform(i,Object(V.e)(e.matrix,V.c,V.a)),this.corridorLoader.loadCorridor(t,i)}clearProject(){for(const t of Array.from(this.modelToThreeMap.keys())){const e=this.modelToThreeMap.get(t);this.scene.remove(e),k.a.disposeObject3D(e,!0)}this.project.root.removeChildNodes(),this.matManager.clear(),this.modelToThreeMap.clear()}freeResources(){this.project.root.removeChildNodes(),this.clearScene(),this.matManager.clear(),this.modelToThreeMap.clear()}clearScene(){k.a.clearScene(this.scene)}}class q extends f.Component{constructor(t){super(t),this.isEngineReady=!1,this.updateAnimationFrame=()=>{this.lastFrameId=requestAnimationFrame(this.updateAnimationFrame),this.sceneManager.update()},this.state={},this.commandManager=new E.a,this.canvasContainer=f.createRef(),this.sceneManager=null,this.project=new P.G,this.attachCommandManagerEventHandlers(this.commandManager)}componentDidMount(){if(null!=this.canvasContainer.current)try{this.sceneManager=new J(this.canvasContainer.current,this.props.width,this.props.height,this.project,this.commandManager,this.props.resourceManager,this.props.apiEndpoint,this.props.apiToken,this.props.minVignetteWidth,this.props.minVignetteHeight,this.props.groutEnhancedColor,this.props.backgroundColor),this.updateAnimationFrame(),this.forceUpdate(),this.sceneManager.initAnalytics(w.q,this.props.groupId,this.props.tenantId)}catch(t){this.props.onInitializationError&&this.props.onInitializationError(t)}}executeCommand(t){this.sceneManager.executeCommand(t)}attachCommandManagerEventHandlers(t){t.onCommandEnd.attach((t=>{this.sceneManager.onCommandEnd(t)}))}canExecuteCommand(t){return this.sceneManager&&0==this.sceneManager.getNBlockingTask()}componentWillUnmount(){cancelAnimationFrame(this.lastFrameId),this.sceneManager.freeResources()}render(){return this.sceneManager&&(this.sceneManager.resize(this.props.width,this.props.height),this.isEngineReady||(this.isEngineReady=!0,this.props.onEngineReady&&this.props.onEngineReady(this))),f.createElement("div",{style:{position:"relative"},"engine-version":w.w},f.createElement("div",{style:{height:`${this.props.height}px`,width:`${this.props.width}px`,position:"relative"},ref:this.canvasContainer}))}}var K,Y=i(31);!function(t){t[t.Script=0]="Script",t[t.Internal=1]="Internal",t[t.Db=2]="Db"}(K||(K={}));class $ extends Y.a{constructor(t,e,i){super(t,e),this.lang=i}getModFurnManufacturerData(t,e){return this.get(`api/modfurn/manufacturers/data?man=${encodeURIComponent(t)}`,e).then(this.responseAsJson).then((e=>{const i=e;return i.code=t,i}))}getTranslatedString(t){return this.get(`api/db/translations?key=${encodeURIComponent(t)}&lang=${encodeURIComponent(this.lang)}`).then(this.responseAsJson).then((t=>t))}}class X{constructor(t,e,i){this.dbClient=new $(t,e,i)}getModFurnManufacturerData(t,e){return this.dbClient.getModFurnManufacturerData(t,e)}getTranslatedString(t){return this.dbClient.getTranslatedString(t)}}},function(t,e,i){"use strict";i.d(e,"a",(function(){return a})),i.d(e,"b",(function(){return s})),i.d(e,"d",(function(){return o})),i.d(e,"c",(function(){return r}));var n=i(2);const a=1e3;function s(t,e=!0,i=!0){const n=[];for(let s=0;s<t.length;s++){const o=[],r=t[s];for(let t=0;t<r.length;t++)i?o.push({x:r[t].X/a,y:r[t].Y/a}):o.push({x:r[t].X,y:r[t].Y});e&&o.reverse(),n.push(o)}return n}function o(t,e=!0){const i=[];for(let n=0;n<t.length;n++)e?i.push({X:Math.round(t[n].x*a),Y:Math.round(t[n].y*a)}):i.push({X:Math.round(t[n].x),Y:Math.round(t[n].y)});return i}function r(t){const e={contours:[],holes:[]};for(let i=0;i<t.length;i++){const a={vertices:s([t[i]])[0]};n.a.poly2SignedArea(a.vertices)>=0?(e.holes.push(!0),e.contours.push(a)):(e.contours.unshift(a),e.holes.unshift(!1))}return e}},function(t,e,i){"use strict";i.d(e,"a",(function(){return a}));var n=i(1);class a{static _getRelativePointerCoordinates(t,e,i){let a=i.getBoundingClientRect();return new n.Vector2(t-a.left,e-a.top)}static _getAbsolutePointerCoordinates(t,e,i){return new n.Vector2(t,e)}static _getPointerCoordinates(t,e,i){switch(t.type){case"touchstart":case"touchmove":return a._getEventTouches(t,e,i)[0];case"mousedown":case"mouseup":case"mousemove":case"mouseover":case"mouseout":case"mouseenter":case"mouseleave":case"mousewheel":case"DOMMouseScroll":case"wheel":case"drop":{const n=e?a._getAbsolutePointerCoordinates:a._getRelativePointerCoordinates,s=document.getElementById(i);return n(t.clientX,t.clientY,s)}case"touchend":case"touchcancel":return null;default:throw"Unsupported event type: "+t.type}}static _getEventTouches(t,e,i){const n=e?a._getAbsolutePointerCoordinates:a._getRelativePointerCoordinates,s=t.touches||t.changedTouches||[],o=[],r=document.getElementById(i);for(let t=0;t<s.length;t++){let e=s[t];o.push(n(e.clientX,e.clientY,r))}return o}static getPointerCoordinates(t,e){return a._getPointerCoordinates(t,!1,e)}static getAbsolutePointerCoordinates(t,e){return a._getPointerCoordinates(t,!0,e)}static getEventTouches(t,e){return a._getEventTouches(t,!1,e)}}},function(t,e,i){"use strict";i.d(e,"a",(function(){return x})),i.d(e,"b",(function(){return T}));var n=i(2);class a{constructor(){this.diagonal=0}getTransformedPolygonMatrix(t,e,i){return null}getTextureRotationMatrix(t){t>=this.degrees.length&&(t=0);const e=this.degrees[t]*Math.PI/180,i=n.a.mat3GetIdentity();return n.a.mat3Translate(i,-this.center.x,-this.center.y),n.a.mat3Rotate(i,e),n.a.mat3Translate(i,this.center.x,this.center.y),i}getNearestDegreeIndex(t){let e=0;const i=n.a.radToDeg(t);for(e=0;e<this.degrees.length&&!n.a.parmEq(i,this.degrees[e]);e++);return e}getBBDim(){return{x:this.width,y:this.height}}}class s extends a{constructor(t,e){super(),this.width=t,this.height=e;let i={vertices:[{x:0,y:0},{x:0,y:e},{x:t,y:e},{x:t,y:0}]};this.polySet={contours:[i],holes:[!1]},this.insertPoint={x:0,y:0},this.boundingBox={min:{x:0,y:0},max:{x:t,y:e}},this.width!==this.height?this.degrees=[0,180]:this.degrees=[0,90,180,270],this.center={x:this.width/2,y:this.height/2},this.textureInfo={textureWidth:this.width,textureHeight:this.height,dx:0,dy:0}}getTransformedPolygonMatrix(t,e,i){switch(t){case 1:n.a.mat3Translate(i,0,-this.height);break;case 2:n.a.mat3Translate(i,-this.width,-this.height);break;case 3:n.a.mat3Translate(i,-this.width,0)}return n.a.mat3Rotate(i,e),i}}class o extends a{constructor(t,e,i){super(),this.width=t,this.height=e,this.diagonal=i,this.delta=Math.sqrt(i*i-e/2*(e/2));let a={vertices:[{x:0,y:0},{x:-this.delta,y:e/2},{x:0,y:e},{x:t-2*this.delta,y:e},{x:t-this.delta,y:e/2},{x:t-2*this.delta,y:0}]};this.polySet={contours:[a],holes:[!1]},this.insertPoint={x:0,y:0},this.boundingBox=n.a.poly2BoundingBox(this.polySet.contours[0].vertices),this.degrees=[0,60,120,180,240,300],this.center={x:this.diagonal/2,y:this.height/2},this.textureInfo={textureWidth:this.width,textureHeight:this.height,dx:-this.delta,dy:0}}getTransformedPolygonMatrix(t,e,i){switch(t){case 1:n.a.mat3Translate(i,this.delta,-this.height/2);break;case 2:n.a.mat3Translate(i,0,-this.height);break;case 3:n.a.mat3Translate(i,-(this.width-2*this.delta),-this.height);break;case 4:n.a.mat3Translate(i,-(this.width-this.delta),-this.height/2);break;case 5:n.a.mat3Translate(i,-(this.width-2*this.delta),0)}return n.a.mat3Rotate(i,e),i}}class r extends a{constructor(t,e,i){super(),this.width=t,this.height=e,this.diagonal=i,this.delta=i/Math.sqrt(2);let a={vertices:[{x:0,y:0},{x:-this.delta,y:this.delta},{x:-this.delta,y:e-this.delta},{x:0,y:e},{x:e-2*this.delta,y:e},{x:t-this.delta,y:e-this.delta},{x:t-this.delta,y:this.delta},{x:t-2*this.delta,y:0}]};this.polySet={contours:[a],holes:[!1]},this.insertPoint={x:0,y:0},this.boundingBox=n.a.poly2BoundingBox(this.polySet.contours[0].vertices),this.width!==this.height?this.degrees=[0,180]:this.degrees=[0,90,180,270],this.center={x:(this.width-2*this.delta)/2,y:this.height/2},this.textureInfo={textureWidth:this.width,textureHeight:this.height,dx:-this.delta,dy:0}}getTransformedPolygonMatrix(t,e,i){switch(t){case 1:n.a.mat3Translate(i,this.delta,-this.delta);break;case 2:n.a.mat3Translate(i,this.delta,-(this.height-this.delta));break;case 3:n.a.mat3Translate(i,0,this.height);break;case 4:n.a.mat3Translate(i,-(this.width-2*this.delta),-this.height);break;case 5:n.a.mat3Translate(i,-(this.width-this.delta),-(this.height-this.delta));break;case 6:n.a.mat3Translate(i,-(this.width-this.delta),-this.delta);break;case 7:n.a.mat3Translate(i,-(this.width-2*this.delta),0)}return n.a.mat3Rotate(i,e),i}}class h extends a{constructor(t,e,i){super(),this.width=t,this.height=e,this.diagonal=i,this.delta=Math.sqrt(i*i-e*e);let a={vertices:[{x:0,y:0},{x:this.delta,y:e},{x:t+this.delta,y:e},{x:t,y:0}]};this.polySet={contours:[a],holes:[!1]},this.insertPoint={x:0,y:0},this.boundingBox=n.a.poly2BoundingBox(this.polySet.contours[0].vertices),this.degrees=[0,180],this.center={x:(t+this.delta)/2,y:this.height/2},this.textureInfo={textureWidth:this.boundingBox.max.x-this.boundingBox.min.x,textureHeight:this.height,dx:0,dy:0}}getTransformedPolygonMatrix(t,e,i){switch(t){case 1:n.a.mat3Translate(i,-this.delta,-this.height);break;case 2:n.a.mat3Translate(i,-this.width-this.delta,-this.height);break;case 3:n.a.mat3Translate(i,-this.width,0)}return n.a.mat3Rotate(i,e),i}getBBDim(){return{x:this.width+this.delta,y:this.height}}}class l extends a{constructor(t,e,i){super(),this.width=t,this.height=e,this.diagonal=i,this.delta=Math.sqrt(i*i-e*e);let a={vertices:[{x:0,y:0},{x:-this.delta,y:e},{x:t-this.delta,y:e},{x:t,y:0}]};this.polySet={contours:[a],holes:[!1]},this.insertPoint={x:0,y:0},this.boundingBox=n.a.poly2BoundingBox(this.polySet.contours[0].vertices),this.degrees=[0,180],this.center={x:(t-this.delta)/2,y:this.height/2},this.textureInfo={textureWidth:this.boundingBox.max.x-this.boundingBox.min.x,textureHeight:this.height,dx:-this.delta,dy:0}}getTransformedPolygonMatrix(t,e,i){switch(t){case 1:n.a.mat3Translate(i,this.delta,-this.height);break;case 2:n.a.mat3Translate(i,-this.width+this.delta,-this.height);break;case 3:n.a.mat3Translate(i,-this.width,0)}return n.a.mat3Rotate(i,e),i}getBBDim(){return{x:this.width+this.delta,y:this.height}}}class c extends a{constructor(t,e,i){super(),this.width=t,this.height=e,this.diagonal=i,this.delta=i/Math.sqrt(2);let a={vertices:[{x:0,y:0},{x:0,y:e},{x:t-this.delta,y:e},{x:t,y:e-this.delta},{x:t,y:0}]};this.polySet={contours:[a],holes:[!1]},this.insertPoint={x:0,y:0},this.boundingBox=n.a.poly2BoundingBox(this.polySet.contours[0].vertices),this.degrees=[0],this.center={x:this.width/2,y:this.height/2},this.textureInfo={textureWidth:this.width,textureHeight:this.height,dx:0,dy:0}}getTransformedPolygonMatrix(t,e,i){switch(t){case 1:n.a.mat3Translate(i,0,-this.height);break;case 2:n.a.mat3Translate(i,-(this.width-this.delta),-this.height);break;case 3:n.a.mat3Translate(i,-this.width,-(this.height-this.delta));break;case 4:n.a.mat3Translate(i,-this.width,0)}return n.a.mat3Rotate(i,e),i}}class d extends a{constructor(t,e,i){super(),this.width=t,this.height=e,this.diagonal=i,this.delta=i/Math.sqrt(2);let a={vertices:[{x:0,y:0},{x:0,y:e-this.delta},{x:this.delta,y:e},{x:t,y:e},{x:t,y:0}]};this.polySet={contours:[a],holes:[!1]},this.insertPoint={x:0,y:0},this.boundingBox=n.a.poly2BoundingBox(this.polySet.contours[0].vertices),this.degrees=[0],this.center={x:this.width/2,y:this.height/2},this.textureInfo={textureWidth:this.width,textureHeight:this.height,dx:0,dy:0}}getTransformedPolygonMatrix(t,e,i){switch(t){case 1:n.a.mat3Translate(i,0,-this.height);break;case 2:n.a.mat3Translate(i,0,-(this.height-this.delta));break;case 3:n.a.mat3Translate(i,-this.width,-this.height);break;case 4:n.a.mat3Translate(i,-this.width,0)}return n.a.mat3Rotate(i,e),i}}class u extends a{constructor(t,e,i){super(),this.width=t,this.height=e,this.diagonal=i,this.delta=i/Math.sqrt(2);let a={vertices:[{x:0,y:0},{x:0,y:e-this.delta},{x:this.delta,y:e},{x:t,y:e},{x:t,y:this.delta},{x:t-this.delta,y:0}]};this.polySet={contours:[a],holes:[!1]},this.insertPoint={x:0,y:0},this.boundingBox=n.a.poly2BoundingBox(this.polySet.contours[0].vertices),this.degrees=[0,180],this.center={x:this.width/2,y:this.height/2},this.textureInfo={textureWidth:this.width,textureHeight:this.height,dx:0,dy:0}}getTransformedPolygonMatrix(t,e,i){switch(t){case 1:n.a.mat3Translate(i,this.delta,-this.height/2);break;case 2:n.a.mat3Translate(i,0,-this.height);break;case 3:n.a.mat3Translate(i,-(this.width-2*this.delta),-this.height);break;case 4:n.a.mat3Translate(i,-(this.width-this.delta),-this.height/2);break;case 5:n.a.mat3Translate(i,-(this.width-2*this.delta),0)}return n.a.mat3Rotate(i,e),i}}class p extends a{constructor(t,e){super(),this.width=t,this.height=e;let i={vertices:[{x:0,y:0},{x:-t/2,y:e/2},{x:0,y:e},{x:t/2,y:e/2}]};this.polySet={contours:[i],holes:[!1]},this.insertPoint={x:0,y:0},this.boundingBox=n.a.poly2BoundingBox(this.polySet.contours[0].vertices),this.degrees=[0,180],this.center={x:0,y:this.height/2},this.textureInfo={textureWidth:this.width,textureHeight:this.height,dx:-this.width/2,dy:0}}getTransformedPolygonMatrix(t,e,i){switch(t){case 1:n.a.mat3Translate(i,this.width/2,-this.height/2);break;case 2:n.a.mat3Translate(i,0,-this.height);break;case 3:n.a.mat3Translate(i,-this.width/2,-this.height/2)}return n.a.mat3Rotate(i,e),i}}class g extends a{constructor(t,e,i){super(),this.width=t,this.height=e,this.diagonal=i,this.delta=Math.sqrt(i*i-e*e);let a={vertices:[{x:0,y:0},{x:this.delta,y:e},{x:t-this.delta,y:e},{x:t,y:0}]};this.polySet={contours:[a],holes:[!1]},this.insertPoint={x:0,y:0},this.boundingBox=n.a.poly2BoundingBox(this.polySet.contours[0].vertices),this.degrees=[0],this.center={x:this.width/2,y:this.height/2},this.textureInfo={textureWidth:this.width,textureHeight:this.height,dx:0,dy:0}}getTransformedPolygonMatrix(t,e,i){switch(t){case 1:n.a.mat3Translate(i,-this.delta,-this.height);break;case 2:n.a.mat3Translate(i,-this.width+this.delta,-this.height);break;case 3:n.a.mat3Translate(i,-this.width,0)}return n.a.mat3Rotate(i,e),i}}class m extends a{constructor(t,e,i){super(),this.width=t,this.height=e,this.diagonal=i;let a={vertices:[{x:0,y:0},{x:t/2,y:e},{x:t,y:0}]};this.polySet={contours:[a],holes:[!1]},this.insertPoint={x:0,y:0},this.boundingBox=n.a.poly2BoundingBox(this.polySet.contours[0].vertices),this.degrees=t==i?[0,120,240]:[0],this.center={x:this.width/2,y:this.height/2},this.textureInfo={textureWidth:this.width,textureHeight:this.height,dx:0,dy:0}}getTransformedPolygonMatrix(t,e,i){switch(t){case 1:n.a.mat3Translate(i,-this.width/2,-this.height);break;case 2:n.a.mat3Translate(i,-this.width,0)}return n.a.mat3Rotate(i,e),i}}var f=i(15);class y extends a{constructor(t,e,i){super(),this.width=e,this.height=i,this.polySet=t,this.boundingBox=this.polySetBoundingBox(t),this.insertPoint={x:-this.boundingBox.min.x,y:-this.boundingBox.min.y},this.degrees=[0],this.center={x:(this.boundingBox.max.x+this.boundingBox.min.x)/2,y:(this.boundingBox.max.y+this.boundingBox.min.y)/2},this.textureInfo={textureWidth:this.width,textureHeight:this.height,dx:this.boundingBox.min.x,dy:this.boundingBox.min.y}}getTransformedPolygonMatrix(t,e,i){return n.a.mat3Rotate(i,e),i}polySetBoundingBox(t){let e=n.a.vec2Clone(t.contours[0].vertices[0]),i=n.a.vec2Clone(t.contours[0].vertices[0]);for(const n of t.contours)for(const t of n.vertices)t.x<e.x&&(e.x=t.x),t.y<e.y&&(e.y=t.y),t.x>i.x&&(i.x=t.x),t.y>i.y&&(i.y=t.y);return{min:e,max:i}}}const v=i(59);var x;!function(t){t[t.TOT=0]="TOT",t[t.LESS_THEN_HALF=1]="LESS_THEN_HALF",t[t.GREAT_THEN_HALF=2]="GREAT_THEN_HALF"}(x||(x={}));class T{static getTilePolygon(t,e,i,n,a=null){let f;return"RETT"===t?f=new s(e,i):"ESAG"===t?f=new o(e,i,n):"ROMB"===t?f=new p(e,i):"TRIA"===t?f=new m(e,i,n):"PARDX"===t?f=new h(e,i,n):"PARSX"===t?f=new l(e,i,n):"TRAP"===t?f=new g(e,i,n):"PENTDX"===t?f=new c(e,i,n):"PENTSX"===t?f=new d(e,i,n):"OTTA"===t?f=new r(e,i,n):"QTTO"===t?f=new u(e,i,n):"CPLXPOLY"===t&&(f=new y(a,e,i)),f}static intersectPolygons(t,e){const i=new v.Clipper;i.Clear();const n=Object(f.d)(t),a=Object(f.d)(e);i.AddPath(n,v.PolyType.ptSubject,!0),i.AddPath(a,v.PolyType.ptClip,!0);const s=new v.Paths;i.Execute(v.ClipType.ctIntersection,s,v.PolyFillType.pftNonZero,v.PolyFillType.pftEvenOdd);return Object(f.b)(s)[0]}static isPolygonInside(t,e){const i=new v.Clipper;i.Clear();const a=Object(f.d)(t),s=Object(f.d)(e);i.AddPath(a,v.PolyType.ptSubject,!0),i.AddPath(s,v.PolyType.ptClip,!0);const o=new v.Paths;i.Execute(v.ClipType.ctIntersection,o,v.PolyFillType.pftNonZero,v.PolyFillType.pftNonZero);if(Object(f.b)(o).length>0){const t=n.a.round(Math.abs(v.JS.AreaOfPolygons([a])),3)/(f.a*f.a),e=n.a.round(Math.abs(v.JS.AreaOfPolygons(o)),3)/(f.a*f.a);return!!n.a.parmEq(t,e)}return!1}static getPolygonWithHoles(t,e){const i=new v.Clipper;i.Clear();const n=[Object(f.d)(t)];i.AddPaths(n,v.PolyType.ptSubject,!0);const a=[];for(const t of e){const e=Object(f.d)(t);a.push(e)}i.AddPaths(a,v.PolyType.ptClip,!0);const s=new v.Paths;i.Execute(v.ClipType.ctDifference,s,v.PolyFillType.pftNonZero,v.PolyFillType.pftNonZero);const o=Object(f.b)(s);return this.clipperPolygonToPolySet2(o)}static getIntersectingTilePolygon(t,e,i,a){const s=new v.Clipper;s.Clear();const o=[];for(let i=0;i<t.length;i++){const n=Object(f.d)(t[i]);e[i]&&n.reverse(),o.push(n)}const r=[Object(f.d)(i)],h=[];for(const t of a){const e=Object(f.d)(t);h.push(e)}s.AddPaths(r,v.PolyType.ptSubject,!0),s.AddPaths(h,v.PolyType.ptClip,!0);const l=new v.Paths;s.Execute(v.ClipType.ctDifference,l,v.PolyFillType.pftNonZero,v.PolyFillType.pftNonZero),s.Clear(),s.AddPaths(o,v.PolyType.ptSubject,!0),s.AddPaths(l,v.PolyType.ptClip,!0);const c=new v.Paths;if(s.Execute(v.ClipType.ctIntersection,c,v.PolyFillType.pftNonZero,v.PolyFillType.pftEvenOdd),0===c.length)return null;const d=Object(f.b)(c),u=n.a.round(Math.abs(v.JS.AreaOfPolygons(o)),3)/(f.a*f.a),p=n.a.round(Math.abs(v.JS.AreaOfPolygons(c)),3)/(f.a*f.a);let g;g=u-p>10?p<u/2?x.LESS_THEN_HALF:x.GREAT_THEN_HALF:x.TOT;return{clippedPolygon:this.clipperPolygonToPolySet2(d),area:p,tileCut:g}}static clipperPolygonToPolySet2(t){const e={contours:[],holes:[]};for(const i of t){const t={vertices:i};this.polygonArea(t.vertices)>0?(e.holes.push(!0),e.contours.push(t)):(e.contours.unshift(t),e.holes.unshift(!1))}return e}static polygonArea(t){let e=0;for(let i=0;i<t.length;i++){const n=(i+1)%t.length;e+=t[i].x*t[n].y,e-=t[n].x*t[i].y}return e/2}static isPolygonIntersecting(t,e,i){const n=new v.Clipper;n.Clear();const a=[];for(let i=0;i<t.length;i++){const n=Object(f.d)(t[i]);e[i]&&n.reverse(),a.push(n)}const s=[Object(f.d)(i)];n.AddPaths(a,v.PolyType.ptSubject,!0),n.AddPaths(s,v.PolyType.ptClip,!0);const o=new v.Paths;return n.Execute(v.ClipType.ctIntersection,o,v.PolyFillType.pftNonZero,v.PolyFillType.pftEvenOdd),o.length>0}static getPatternPolygon(t,e,i=!1){let n=this.getPolygonIntersection(t,e);if(i){const t=new v.ClipperOffset(0,.001);t.AddPaths(n,v.JoinType.jtSquare,v.EndType.etClosedPolygon);const e=new v.Paths;t.Execute(e,-2),n=e}return Object(f.b)(n)[0]}static getTilingAreaPatternPolygon(t,e,i,a,s,o){const r=n.a.poly2ToPoly3(i,a,0),h=n.a.pnt3TransformArray(t._2DMatrix,r),l=T.intersectPolygons(t.points,h),c=n.a.poly2ToPoly3(l,t._3DMatrix,0),d=n.a.pnt3TransformArray(s,c);let u=Object(f.b)(this.getPolygonIntersection(e,d))[0];if(u&&o){const t=Object(f.d)(u),e=new v.ClipperOffset(0,.001);e.AddPaths([t],v.JoinType.jtSquare,v.EndType.etClosedPolygon);const i=new v.Paths;e.Execute(i,-2),u=Object(f.b)(i)[0]}return u}static getTexureCoordinate(t,e,i,a){const s=n.a.mat3GetInverted(e);let o=n.a.pnt2Transform(s,t);o=n.a.pnt2Transform(i,o);return{x:(o.x-a.dx)/a.textureWidth,y:(o.y-a.dy)/a.textureHeight}}static getPolygonIntersection(t,e){const i=[];i.push({X:Math.round(t.min.x*f.a),Y:Math.round(t.min.y*f.a)}),i.push({X:Math.round(t.min.x*f.a),Y:Math.round(t.max.y*f.a)}),i.push({X:Math.round(t.max.x*f.a),Y:Math.round(t.max.y*f.a)}),i.push({X:Math.round(t.max.x*f.a),Y:Math.round(t.min.y*f.a)});const n=new v.Clipper;n.Clear(),n.AddPath(i,v.PolyType.ptSubject,!0),n.AddPath(Object(f.d)(e),v.PolyType.ptClip,!0);const a=new v.Paths;return n.Execute(v.ClipType.ctIntersection,a,v.PolyFillType.pftNonZero,v.PolyFillType.pftEvenOdd),a}static vec2ArrayToArray(t,e){const i=[];for(const n of t)i.push(n.x,n.y),e&&i.push(0);return i}}},function(t,e){t.exports=__WEBPACK_EXTERNAL_MODULE__18__},function(t,e,i){"use strict";var n;i.d(e,"a",(function(){return n})),function(t){t[t.DTObject=1]="DTObject",t[t.DTProject=2]="DTProject",t[t.DTRoom=4]="DTRoom",t[t.DTWall=5]="DTWall",t[t.DTWallside=6]="DTWallside",t[t.DTFace3D=11]="DTFace3D",t[t.DTFloorPlan=14]="DTFloorPlan",t[t.DTMaterial=17]="DTMaterial",t[t.DTTileList=18]="DTTileList",t[t.DTPattern=19]="DTPattern",t[t.DTTileInst=20]="DTTileInst",t[t.DTMaterialList=21]="DTMaterialList",t[t.DTLight=24]="DTLight",t[t.DTLightList=25]="DTLightList",t[t.DTViewList=33]="DTViewList",t[t.DT3DView=34]="DT3DView",t[t.DTDbSpec=35]="DTDbSpec",t[t.DTDbField=36]="DTDbField",t[t.DTPrjSpec=37]="DTPrjSpec",t[t.DTDimPoint=38]="DTDimPoint",t[t.DTText=39]="DTText",t[t.DTAnimVector=40]="DTAnimVector",t[t.DTBackgroundImage=1033]="DTBackgroundImage",t[t.DTTiledLayer=1034]="DTTiledLayer",t[t.DTMask=1035]="DTMask",t[t.DTMaskList=1036]="DTMaskList",t[t.DTExternalMaterial=1037]="DTExternalMaterial",t[t.DTExternalMaterialList=1038]="DTExternalMaterialList",t[t.DTRug=1039]="DTRug",t[t.DTCorridor=1040]="DTCorridor",t[t.DTGroupList=1041]="DTGroupList",t[t.DTGroup=1042]="DTGroup",t[t.DTPrjData=99]="DTPrjData"}(n||(n={}))},function(t,e,i){"use strict";i.d(e,"a",(function(){return a}));var n=i(0);class a{static getSurfaceType(t){let e;switch(t){case"FLOOR":e=n.J.FLOOR;break;case"WALL":e=n.J.WALL;break;case"BACKSPLASH":e=n.J.BACKSPLASH;break;case"RUG":e=n.J.RUG;break;case"HPLANE":e=n.J.HPLANE;break;case"CORRIDOR":e=n.J.CORRIDOR}return e}static getSurfaceTypeString(t){let e;switch(t){case n.J.FLOOR:e="FLOOR";break;case n.J.WALL:e="WALL";break;case n.J.BACKSPLASH:e="BACKSPLASH";break;case n.J.RUG:e="RUG";break;case n.J.HPLANE:e="HPLANE";break;case n.J.CORRIDOR:e="CORRIDOR"}return e}static fillMaterialData(t,e,i){e.color=i.dominantColor,e.opacity=i.opacity,e.map=i.maps[t],null!=i.bumpMaps&&i.bumpMaps.length>0&&(e.bumpMap=i.bumpMaps[t],e.bumpScale=i.bumpScale),null!=i.metalness&&(e.metalness=i.metalness),null!=i.metalnessMaps&&i.metalnessMaps.length>0&&(e.metalnessMap=i.metalnessMaps[t]),null!=i.normalMaps&&i.normalMaps.length>0&&(e.normalScale=i.normalScale,e.normalMap=i.normalMaps[t]),null!=i.roughness&&(e.roughness=i.roughness),null!=i.roughnessMaps&&i.roughnessMaps.length>0&&(e.roughnessMap=i.roughnessMaps[t])}static rr3RugToDTRug(t,e){const i=null!=t.shape?n.v[t.shape]:n.v.RECT,a={min:{x:-t.width/2,y:-t.height/2,z:0},max:{x:t.width/2,y:t.height/2,z:t.thickness}},s=new n.u(t.id,a,e,t.mapUrl,t.objModelUrl);return s.shape=i,s.textureWidth=t.mapWidth,s.textureHeight=t.mapHeight,s}}},function(t,e,i){"use strict";i.d(e,"a",(function(){return n})),i.d(e,"b",(function(){return r})),i.d(e,"c",(function(){return h}));var n,a=i(0),s=i(2),o=i(34);function r(t){switch(t.classId){case a.h.CLASSID_WALL:return n.Wallside;case a.h.CLASSID_FLOOR:case a.h.CLASSID_FLOOR_AI:return n.Default;case a.h.CLASSID_TILE:return n.Tile;default:return n.Default}}function h(t,e,i=null){const a=i||o.a.getPolygonNormal(t).normalize().negate();let r,h;switch(e){case n.Wallside:h=s.a.vec3Clone(t[1]),r=s.a.vec3Diff(t[0],h);break;case n.Floor:h=s.a.box3FromPoints(t).min,r={x:1,y:0,z:0};break;case n.Tile:h=s.a.vec3Clone(t[0]),r={x:1,y:0,z:0};break;default:h=s.a.vec3Clone(t[0]),r=s.a.vec3Diff(t[t.length-1],h)}s.a.vec3Normalize(r);const l=s.a.vec3Negate(s.a.vec3MultVect(r,a)),c=s.a.mat4GetIdentity();s.a.mat4MakeBasis(c,r,l,a),s.a.mat4SetPosition(c,h);const d=s.a.mat4GetInverted(c);return d?{points:s.a.pnt3TransformArray(d,t),_2DMatrix:d,_3DMatrix:c}:{points:t,_2DMatrix:s.a.mat4GetIdentity(),_3DMatrix:s.a.mat4GetIdentity()}}!function(t){t[t.Wallside=0]="Wallside",t[t.Floor=1]="Floor",t[t.Tile=2]="Tile",t[t.Default=3]="Default"}(n||(n={}))},function(t,e,i){"use strict";i.d(e,"b",(function(){return n})),i.d(e,"a",(function(){return c}));var n,a=i(18),s=i(3),o=i(44),r=i(55),h=i(0),l=i(5);!function(t){t[t.OUTSIDE=0]="OUTSIDE",t[t.INSIDE=1]="INSIDE"}(n||(n={}));class c extends a.Component{constructor(t){super(t),this.isEngineReady=!1,this.updateAnimationFrame=()=>{this.lastFrameId=requestAnimationFrame(this.updateAnimationFrame),this.sceneManager.update()},this.onCommandEnd=t=>{this.sceneManager.onCommandEnd(t),this.props.onCommandEnd&&this.props.onCommandEnd(s.Q[t.command.type],t.errorMsg,t.params)},this.initAdvancedCanvases=()=>{this.sceneManager.initAdvancedCanvases()},this.state={},this.canvasContainer=a.createRef(),this.project=new h.G,this.commandManager=new o.a,this.commandManager.onCommandEnd.attach(this.onCommandEnd)}componentDidMount(){if(null!=this.canvasContainer.current)try{this.sceneManager=new r.a(this.canvasContainer.current,null!=this.props.engineId?this.props.engineId:"rr",this.props.width,this.props.height,this.project,this.commandManager,this.props.resourceManager,this.props.apiToken,this.props.aiConfig,this.props.catalogueApiEndpoint,this.props.apiEndpoint,this.props.cubemapTextures,this.props.defaultMaterials,this.props.multipleHotspots,this.props.minHotspotDistance,this.props.selectableLayers,this.props.detailedEvents,this.props.maxTextureSize),this.props.disableStats||this.sceneManager.initAnalytics(l.q,this.props.groupId,this.props.tenantId),this.updateAnimationFrame(),this.forceUpdate()}catch(t){console.log("[EngineContainer] initialization error: "+JSON.stringify(t)),this.props.onInitializationError&&this.props.onInitializationError(t)}}componentDidUpdate(){this.sceneManager&&(this.sceneManager.resize(this.props.width,this.props.height),this.sceneManager.showStats=this.props.showStats,this.sceneManager.resourceManager=this.props.resourceManager,this.sceneManager.unitOfMeasurement=this.props.unitOfMeasurement,this.sceneManager.selectionColor=this.props.selectionColor,this.sceneManager.gizmoConfig=this.props.gizmoConfig,this.isEngineReady||(this.isEngineReady=!0,this.props.onEngineReady&&this.props.onEngineReady(this)))}componentWillUnmount(){cancelAnimationFrame(this.lastFrameId),this.sceneManager.dispose(),this.commandManager.onCommandEnd.detach(this.onCommandEnd),this.project=null,this.sceneManager=null,this.commandManager=null,this.canvasContainer=null,console.debug("[EngineContainer] unmounted")}pause(){cancelAnimationFrame(this.lastFrameId)}play(){this.updateAnimationFrame()}executeCommand(t){this.sceneManager.executeCommand(t)}setUserInteraction(t){this.sceneManager.setUserInteraction(t)}canExecuteCommand(t){return 0===this.sceneManager.getNBlockingTask()}render(){return a.createElement("div",{id:null!=this.props.engineId?this.props.engineId:"rr",style:{position:"relative"},"engine-version":l.w},a.createElement("div",{style:{height:`${this.props.height}px`,width:`${this.props.width}px`,position:"relative"},ref:this.canvasContainer}))}}},function(t,e,i){"use strict";i.d(e,"a",(function(){return r})),i.d(e,"b",(function(){return l}));var n=i(1),a=i(7),s=i(16);class o{constructor(){this.listeners=new Map}addEventListener(t,e){this.listeners.has(t)||this.listeners.set(t,[]);let i=this.listeners.get(t);-1===i.indexOf(e)&&i.push(e)}addEventListenerAtIndex(t,e,i){this.listeners.has(t)||this.listeners.set(t,[]);let n=this.listeners.get(t);-1===n.indexOf(e)&&n.splice(i,0,e)}removeEventListener(t,e){if(this.listeners.has(t)){let i=this.listeners.get(t),n=i.indexOf(e);n>-1&&i.splice(n,1)}}dispatchEvent(t){if(this.listeners.has(t.type)){let e=this.listeners.get(t.type);for(const i of e){if(t.handled)return;i.call(null,t)}}}}var r,h=i(8);!function(t){t.POINTERDOWN="0",t.DRAGSTART="1",t.DRAG="2",t.DRAGEND="3",t.POINTERUP="4",t.CLICK="5",t.TWOFINGERSTART="6",t.TWOFINGERMOVE="7",t.TWOFINGEREND="8"}(r||(r={}));class l extends o{get status(){return this._status}constructor(t,e,i,o){super(),this.camera=t,this.scene=e,this.phScene=i,this.domElement=o,this.inputEvents=[],this.dragPixelTreshold=5,this.enabled=!0,this.pointerDownEventHandler=t=>{if(this.enabled){if(t instanceof MouseEvent){if(!(t.target instanceof HTMLCanvasElement))return}if("TouchEvent"in window&&t instanceof TouchEvent){if(!(t.target instanceof HTMLCanvasElement))return}const e=s.a.getEventTouches(t,this.domElement.parentElement.id);if(e.length>1){if(e.length>2)return void this.clearStatus();this._status=r.TWOFINGERSTART;const i={type:r.TWOFINGERSTART,startFingerPositions:e,handled:!1,originalEvent:t};this.dispatchEvent(i)}else{this.pointerPosition=s.a.getPointerCoordinates(t,this.domElement.parentElement.id),this.pointerDownPosition=this.pointerPosition;const e=a.a.createRaycaster(this.camera,this.domElement.offsetWidth,this.domElement.offsetHeight,this.pointerDownPosition.x,this.pointerDownPosition.y);this.pointerDownIntersections=[];const i=e.intersectObjects(this.scene.children,!0);this.pointerDownIntersections=this.pointerDownIntersections.concat(i);const n=e.intersectObjects(this.phScene.children,!0);this.pointerDownIntersections=this.pointerDownIntersections.concat(n),this._status=r.POINTERDOWN;const o={type:r.POINTERDOWN,intersections:this.pointerDownIntersections,target:null,handled:!1,originalEvent:t,pointer:this.pointerPosition.clone()};this.dispatchEvent(o),this.target=o.target,this.pointer=s.a.getAbsolutePointerCoordinates(t,this.domElement.parentElement.id)}}},this.pointerMoveEventHandler=t=>{if(this.enabled){const e=s.a.getEventTouches(t,this.domElement.parentElement.id);if(e.length>1){if(e.length>2)return void this.clearStatus();this._status=r.TWOFINGERMOVE;const i={type:r.TWOFINGERMOVE,fingerPositions:e,handled:!1,originalEvent:t};this.dispatchEvent(i)}else if(this.pointerPosition=s.a.getPointerCoordinates(t,this.domElement.parentElement.id),this.target&&(this._status==r.DRAG||this.isDragPointerMovement(this.pointerPosition,this.pointerDownPosition))){const t=a.a.createRaycaster(this.camera,this.domElement.offsetWidth,this.domElement.offsetHeight,this.pointerPosition.x,this.pointerPosition.y),e=this.target.point,i=(new n.Plane).setFromNormalAndCoplanarPoint(this.dragPlaneNormal,e),s=new n.Vector3;if(t.ray.intersectPlane(i,s)){this._status==r.POINTERDOWN&&(this._status=r.DRAGSTART,this.dispatchEvent({type:r.DRAGSTART,target:this.target,handled:!1}));const t=s.sub(e);this._status=r.DRAG,this.dispatchEvent({type:r.DRAG,delta:t,target:this.target,handled:!1,pointer:this.pointerPosition.clone()})}}}},this.pointerUpEventHandler=t=>{if(this._status){if(this._status==r.DRAG)this._status=r.DRAGEND,this.dispatchEvent({type:r.DRAGEND,target:this.target,handled:!1});else if(this._status==r.TWOFINGERMOVE||this._status==r.TWOFINGERSTART)this._status=r.TWOFINGEREND,this.dispatchEvent({type:r.TWOFINGEREND,handled:!1});else if(null!=this.pointerDownPosition&&!this.isDragPointerMovement(this.pointerPosition,this.pointerDownPosition)){this._status=r.CLICK;const e={type:r.CLICK,target:this.target,intersections:this.pointerDownIntersections,pointer:this.pointer,handled:!1,originalEvent:t};this.dispatchEvent(e)}this._status=r.POINTERUP,this.dispatchEvent({type:r.POINTERUP,target:this.target,handled:!1,originalEvent:t}),this.clearStatus()}},this.pointerEventsHandler=t=>{this.enabled&&this.inputEvents.push(t)},this.dragPlaneNormal=new n.Vector3(0,1,0)}update(){let t,e;if(this.enabled)for(const i of this.inputEvents)if(e=t,t=i,null==e||t.type!=e.type)switch(t.type){case"touchstart":case"mousedown":this.pointerDownEventHandler(t);break;case"mousemove":case"touchmove":this.pointerMoveEventHandler(t);break;case"mouseup":case"touchend":case"touchcancel":this.pointerUpEventHandler(t)}this.inputEvents=[]}clearStatus(){this.inputEvents=[],this.pointerDownPosition=null,this.pointerDownIntersections=null,this.target=null,this.pointer=null,this._status=null}isDragPointerMovement(t,e){return!!e&&(Math.abs(t.x-e.x)>this.dragPixelTreshold||Math.abs(t.y-e.y)>this.dragPixelTreshold)}attachDomHandlers(){Object(h.t)()?(this.domElement.addEventListener("touchstart",this.pointerEventsHandler,!1),this.domElement.addEventListener("touchmove",this.pointerEventsHandler,!1),this.domElement.addEventListener("touchend",this.pointerEventsHandler,!1),this.domElement.addEventListener("touchcancel",this.pointerEventsHandler,!1),document.body.addEventListener("touchend",this.pointerEventsHandler,!1),document.body.addEventListener("touchcancel",this.pointerEventsHandler,!1)):(this.domElement.addEventListener("mousedown",this.pointerEventsHandler,!1),this.domElement.addEventListener("mousemove",this.pointerEventsHandler,!1),this.domElement.addEventListener("mouseup",this.pointerEventsHandler,!1),document.body.addEventListener("mouseup",this.pointerEventsHandler,!1))}detachDomHandlers(){Object(h.t)()?(this.domElement.removeEventListener("touchstart",this.pointerEventsHandler),this.domElement.removeEventListener("touchmove",this.pointerEventsHandler),this.domElement.removeEventListener("touchend",this.pointerEventsHandler),this.domElement.removeEventListener("touchcancel",this.pointerEventsHandler),document.body.removeEventListener("touchend",this.pointerEventsHandler),document.body.removeEventListener("touchcancel",this.pointerEventsHandler)):(this.domElement.removeEventListener("mousedown",this.pointerEventsHandler),this.domElement.removeEventListener("mousemove",this.pointerEventsHandler),this.domElement.removeEventListener("mouseup",this.pointerEventsHandler),document.body.removeEventListener("mouseup",this.pointerEventsHandler))}attachWindowHandlers(){Object(h.t)()?(window.addEventListener("touchstart",this.pointerEventsHandler,!1),window.addEventListener("touchmove",this.pointerEventsHandler,!1),window.addEventListener("touchend",this.pointerEventsHandler,!1),window.addEventListener("touchcancel",this.pointerEventsHandler,!1)):(window.addEventListener("mousedown",this.pointerEventsHandler,!1),window.addEventListener("mousemove",this.pointerEventsHandler,!1),window.addEventListener("mouseup",this.pointerEventsHandler,!1))}detachWindowHandlers(){Object(h.t)()?(window.removeEventListener("touchstart",this.pointerEventsHandler,!1),window.removeEventListener("touchmove",this.pointerEventsHandler,!1),window.removeEventListener("touchend",this.pointerEventsHandler,!1),window.removeEventListener("touchcancel",this.pointerEventsHandler,!1)):(window.removeEventListener("mousedown",this.pointerEventsHandler,!1),window.removeEventListener("mousemove",this.pointerEventsHandler,!1),window.removeEventListener("mouseup",this.pointerEventsHandler,!1))}dispose(){this.detachDomHandlers()}}},function(t,e,i){"use strict";i.d(e,"e",(function(){return n})),i.d(e,"d",(function(){return a})),i.d(e,"f",(function(){return s})),i.d(e,"c",(function(){return o})),i.d(e,"b",(function(){return r})),i.d(e,"g",(function(){return h})),i.d(e,"a",(function(){return l}));class n{}class a{}class s{}class o{}class r{}var h;!function(t){t[t.Tile=0]="Tile",t[t.Rug=1]="Rug",t[t.Corridor=2]="Corridor",t[t.Broadloom=3]="Broadloom"}(h||(h={}));class l{}},function(t,e,i){"use strict";i.d(e,"b",(function(){return b})),i.d(e,"a",(function(){return r})),i.d(e,"c",(function(){return o})),i.d(e,"d",(function(){return j})),i.d(e,"e",(function(){return F}));var n=i(1);const a=new n.Box3,s=new n.Vector3;class o extends n.InstancedBufferGeometry{constructor(){super(),this.isLineSegmentsGeometry=!0,this.type="LineSegmentsGeometry";this.setIndex([0,2,1,2,3,1,2,4,3,4,5,3,4,6,5,6,7,5]),this.setAttribute("position",new n.Float32BufferAttribute([-1,2,0,1,2,0,-1,1,0,1,1,0,-1,0,0,1,0,0,-1,-1,0,1,-1,0],3)),this.setAttribute("uv",new n.Float32BufferAttribute([-1,2,1,2,-1,1,1,1,-1,-1,1,-1,-1,-2,1,-2],2))}applyMatrix4(t){const e=this.attributes.instanceStart,i=this.attributes.instanceEnd;return void 0!==e&&(e.applyMatrix4(t),i.applyMatrix4(t),e.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}setPositions(t){let e;t instanceof Float32Array?e=t:Array.isArray(t)&&(e=new Float32Array(t));const i=new n.InstancedInterleavedBuffer(e,6,1);return this.setAttribute("instanceStart",new n.InterleavedBufferAttribute(i,3,0)),this.setAttribute("instanceEnd",new n.InterleavedBufferAttribute(i,3,3)),this.computeBoundingBox(),this.computeBoundingSphere(),this}setColors(t){let e;t instanceof Float32Array?e=t:Array.isArray(t)&&(e=new Float32Array(t));const i=new n.InstancedInterleavedBuffer(e,6,1);return this.setAttribute("instanceColorStart",new n.InterleavedBufferAttribute(i,3,0)),this.setAttribute("instanceColorEnd",new n.InterleavedBufferAttribute(i,3,3)),this}fromWireframeGeometry(t){return this.setPositions(t.attributes.position.array),this}fromEdgesGeometry(t){return this.setPositions(t.attributes.position.array),this}fromMesh(t){return this.fromWireframeGeometry(new n.WireframeGeometry(t.geometry)),this}fromLineSegments(t){const e=t.geometry;return this.setPositions(e.attributes.position.array),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new n.Box3);const t=this.attributes.instanceStart,e=this.attributes.instanceEnd;void 0!==t&&void 0!==e&&(this.boundingBox.setFromBufferAttribute(t),a.setFromBufferAttribute(e),this.boundingBox.union(a))}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new n.Sphere),null===this.boundingBox&&this.computeBoundingBox();const t=this.attributes.instanceStart,e=this.attributes.instanceEnd;if(void 0!==t&&void 0!==e){const i=this.boundingSphere.center;this.boundingBox.getCenter(i);let n=0;for(let a=0,o=t.count;a<o;a++)s.fromBufferAttribute(t,a),n=Math.max(n,i.distanceToSquared(s)),s.fromBufferAttribute(e,a),n=Math.max(n,i.distanceToSquared(s));this.boundingSphere.radius=Math.sqrt(n),isNaN(this.boundingSphere.radius)&&console.error("THREE.LineSegmentsGeometry.computeBoundingSphere(): Computed radius is NaN. The instanced position data is likely to have NaN values.",this)}}toJSON(){}applyMatrix(t){return console.warn("THREE.LineSegmentsGeometry: applyMatrix() has been renamed to applyMatrix4()."),this.applyMatrix4(t)}}n.UniformsLib.line={worldUnits:{value:1},linewidth:{value:1},resolution:{value:new n.Vector2(1,1)},dashOffset:{value:0},dashScale:{value:1},dashSize:{value:1},gapSize:{value:1}},n.ShaderLib.line={uniforms:n.UniformsUtils.merge([n.UniformsLib.common,n.UniformsLib.fog,n.UniformsLib.line]),vertexShader:"\n\t\t#include <common>\n\t\t#include <color_pars_vertex>\n\t\t#include <fog_pars_vertex>\n\t\t#include <logdepthbuf_pars_vertex>\n\t\t#include <clipping_planes_pars_vertex>\n\n\t\tuniform float linewidth;\n\t\tuniform vec2 resolution;\n\n\t\tattribute vec3 instanceStart;\n\t\tattribute vec3 instanceEnd;\n\n\t\tattribute vec3 instanceColorStart;\n\t\tattribute vec3 instanceColorEnd;\n\n\t\t#ifdef WORLD_UNITS\n\n\t\t\tvarying vec4 worldPos;\n\t\t\tvarying vec3 worldStart;\n\t\t\tvarying vec3 worldEnd;\n\n\t\t\t#ifdef USE_DASH\n\n\t\t\t\tvarying vec2 vUv;\n\n\t\t\t#endif\n\n\t\t#else\n\n\t\t\tvarying vec2 vUv;\n\n\t\t#endif\n\n\t\t#ifdef USE_DASH\n\n\t\t\tuniform float dashScale;\n\t\t\tattribute float instanceDistanceStart;\n\t\t\tattribute float instanceDistanceEnd;\n\t\t\tvarying float vLineDistance;\n\n\t\t#endif\n\n\t\tvoid trimSegment( const in vec4 start, inout vec4 end ) {\n\n\t\t\t// trim end segment so it terminates between the camera plane and the near plane\n\n\t\t\t// conservative estimate of the near plane\n\t\t\tfloat a = projectionMatrix[ 2 ][ 2 ]; // 3nd entry in 3th column\n\t\t\tfloat b = projectionMatrix[ 3 ][ 2 ]; // 3nd entry in 4th column\n\t\t\tfloat nearEstimate = - 0.5 * b / a;\n\n\t\t\tfloat alpha = ( nearEstimate - start.z ) / ( end.z - start.z );\n\n\t\t\tend.xyz = mix( start.xyz, end.xyz, alpha );\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\t#ifdef USE_COLOR\n\n\t\t\t\tvColor.xyz = ( position.y < 0.5 ) ? instanceColorStart : instanceColorEnd;\n\n\t\t\t#endif\n\n\t\t\t#ifdef USE_DASH\n\n\t\t\t\tvLineDistance = ( position.y < 0.5 ) ? dashScale * instanceDistanceStart : dashScale * instanceDistanceEnd;\n\t\t\t\tvUv = uv;\n\n\t\t\t#endif\n\n\t\t\tfloat aspect = resolution.x / resolution.y;\n\n\t\t\t// camera space\n\t\t\tvec4 start = modelViewMatrix * vec4( instanceStart, 1.0 );\n\t\t\tvec4 end = modelViewMatrix * vec4( instanceEnd, 1.0 );\n\n\t\t\t#ifdef WORLD_UNITS\n\n\t\t\t\tworldStart = start.xyz;\n\t\t\t\tworldEnd = end.xyz;\n\n\t\t\t#else\n\n\t\t\t\tvUv = uv;\n\n\t\t\t#endif\n\n\t\t\t// special case for perspective projection, and segments that terminate either in, or behind, the camera plane\n\t\t\t// clearly the gpu firmware has a way of addressing this issue when projecting into ndc space\n\t\t\t// but we need to perform ndc-space calculations in the shader, so we must address this issue directly\n\t\t\t// perhaps there is a more elegant solution -- WestLangley\n\n\t\t\tbool perspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 ); // 4th entry in the 3rd column\n\n\t\t\tif ( perspective ) {\n\n\t\t\t\tif ( start.z < 0.0 && end.z >= 0.0 ) {\n\n\t\t\t\t\ttrimSegment( start, end );\n\n\t\t\t\t} else if ( end.z < 0.0 && start.z >= 0.0 ) {\n\n\t\t\t\t\ttrimSegment( end, start );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// clip space\n\t\t\tvec4 clipStart = projectionMatrix * start;\n\t\t\tvec4 clipEnd = projectionMatrix * end;\n\n\t\t\t// ndc space\n\t\t\tvec3 ndcStart = clipStart.xyz / clipStart.w;\n\t\t\tvec3 ndcEnd = clipEnd.xyz / clipEnd.w;\n\n\t\t\t// direction\n\t\t\tvec2 dir = ndcEnd.xy - ndcStart.xy;\n\n\t\t\t// account for clip-space aspect ratio\n\t\t\tdir.x *= aspect;\n\t\t\tdir = normalize( dir );\n\n\t\t\t#ifdef WORLD_UNITS\n\n\t\t\t\t// get the offset direction as perpendicular to the view vector\n\t\t\t\tvec3 worldDir = normalize( end.xyz - start.xyz );\n\t\t\t\tvec3 offset;\n\t\t\t\tif ( position.y < 0.5 ) {\n\n\t\t\t\t\toffset = normalize( cross( start.xyz, worldDir ) );\n\n\t\t\t\t} else {\n\n\t\t\t\t\toffset = normalize( cross( end.xyz, worldDir ) );\n\n\t\t\t\t}\n\n\t\t\t\t// sign flip\n\t\t\t\tif ( position.x < 0.0 ) offset *= - 1.0;\n\n\t\t\t\tfloat forwardOffset = dot( worldDir, vec3( 0.0, 0.0, 1.0 ) );\n\n\t\t\t\t// don't extend the line if we're rendering dashes because we\n\t\t\t\t// won't be rendering the endcaps\n\t\t\t\t#ifndef USE_DASH\n\n\t\t\t\t\t// extend the line bounds to encompass  endcaps\n\t\t\t\t\tstart.xyz += - worldDir * linewidth * 0.5;\n\t\t\t\t\tend.xyz += worldDir * linewidth * 0.5;\n\n\t\t\t\t\t// shift the position of the quad so it hugs the forward edge of the line\n\t\t\t\t\toffset.xy -= dir * forwardOffset;\n\t\t\t\t\toffset.z += 0.5;\n\n\t\t\t\t#endif\n\n\t\t\t\t// endcaps\n\t\t\t\tif ( position.y > 1.0 || position.y < 0.0 ) {\n\n\t\t\t\t\toffset.xy += dir * 2.0 * forwardOffset;\n\n\t\t\t\t}\n\n\t\t\t\t// adjust for linewidth\n\t\t\t\toffset *= linewidth * 0.5;\n\n\t\t\t\t// set the world position\n\t\t\t\tworldPos = ( position.y < 0.5 ) ? start : end;\n\t\t\t\tworldPos.xyz += offset;\n\n\t\t\t\t// project the worldpos\n\t\t\t\tvec4 clip = projectionMatrix * worldPos;\n\n\t\t\t\t// shift the depth of the projected points so the line\n\t\t\t\t// segments overlap neatly\n\t\t\t\tvec3 clipPose = ( position.y < 0.5 ) ? ndcStart : ndcEnd;\n\t\t\t\tclip.z = clipPose.z * clip.w;\n\n\t\t\t#else\n\n\t\t\t\tvec2 offset = vec2( dir.y, - dir.x );\n\t\t\t\t// undo aspect ratio adjustment\n\t\t\t\tdir.x /= aspect;\n\t\t\t\toffset.x /= aspect;\n\n\t\t\t\t// sign flip\n\t\t\t\tif ( position.x < 0.0 ) offset *= - 1.0;\n\n\t\t\t\t// endcaps\n\t\t\t\tif ( position.y < 0.0 ) {\n\n\t\t\t\t\toffset += - dir;\n\n\t\t\t\t} else if ( position.y > 1.0 ) {\n\n\t\t\t\t\toffset += dir;\n\n\t\t\t\t}\n\n\t\t\t\t// adjust for linewidth\n\t\t\t\toffset *= linewidth;\n\n\t\t\t\t// adjust for clip-space to screen-space conversion // maybe resolution should be based on viewport ...\n\t\t\t\toffset /= resolution.y;\n\n\t\t\t\t// select end\n\t\t\t\tvec4 clip = ( position.y < 0.5 ) ? clipStart : clipEnd;\n\n\t\t\t\t// back to clip space\n\t\t\t\toffset *= clip.w;\n\n\t\t\t\tclip.xy += offset;\n\n\t\t\t#endif\n\n\t\t\tgl_Position = clip;\n\n\t\t\tvec4 mvPosition = ( position.y < 0.5 ) ? start : end; // this is an approximation\n\n\t\t\t#include <logdepthbuf_vertex>\n\t\t\t#include <clipping_planes_vertex>\n\t\t\t#include <fog_vertex>\n\n\t\t}\n\t\t",fragmentShader:"\n\t\tuniform vec3 diffuse;\n\t\tuniform float opacity;\n\t\tuniform float linewidth;\n\n\t\t#ifdef USE_DASH\n\n\t\t\tuniform float dashOffset;\n\t\t\tuniform float dashSize;\n\t\t\tuniform float gapSize;\n\n\t\t#endif\n\n\t\tvarying float vLineDistance;\n\n\t\t#ifdef WORLD_UNITS\n\n\t\t\tvarying vec4 worldPos;\n\t\t\tvarying vec3 worldStart;\n\t\t\tvarying vec3 worldEnd;\n\n\t\t\t#ifdef USE_DASH\n\n\t\t\t\tvarying vec2 vUv;\n\n\t\t\t#endif\n\n\t\t#else\n\n\t\t\tvarying vec2 vUv;\n\n\t\t#endif\n\n\t\t#include <common>\n\t\t#include <color_pars_fragment>\n\t\t#include <fog_pars_fragment>\n\t\t#include <logdepthbuf_pars_fragment>\n\t\t#include <clipping_planes_pars_fragment>\n\n\t\tvec2 closestLineToLine(vec3 p1, vec3 p2, vec3 p3, vec3 p4) {\n\n\t\t\tfloat mua;\n\t\t\tfloat mub;\n\n\t\t\tvec3 p13 = p1 - p3;\n\t\t\tvec3 p43 = p4 - p3;\n\n\t\t\tvec3 p21 = p2 - p1;\n\n\t\t\tfloat d1343 = dot( p13, p43 );\n\t\t\tfloat d4321 = dot( p43, p21 );\n\t\t\tfloat d1321 = dot( p13, p21 );\n\t\t\tfloat d4343 = dot( p43, p43 );\n\t\t\tfloat d2121 = dot( p21, p21 );\n\n\t\t\tfloat denom = d2121 * d4343 - d4321 * d4321;\n\n\t\t\tfloat numer = d1343 * d4321 - d1321 * d4343;\n\n\t\t\tmua = numer / denom;\n\t\t\tmua = clamp( mua, 0.0, 1.0 );\n\t\t\tmub = ( d1343 + d4321 * ( mua ) ) / d4343;\n\t\t\tmub = clamp( mub, 0.0, 1.0 );\n\n\t\t\treturn vec2( mua, mub );\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\t#include <clipping_planes_fragment>\n\n\t\t\t#ifdef USE_DASH\n\n\t\t\t\tif ( vUv.y < - 1.0 || vUv.y > 1.0 ) discard; // discard endcaps\n\n\t\t\t\tif ( mod( vLineDistance + dashOffset, dashSize + gapSize ) > dashSize ) discard; // todo - FIX\n\n\t\t\t#endif\n\n\t\t\tfloat alpha = opacity;\n\n\t\t\t#ifdef WORLD_UNITS\n\n\t\t\t\t// Find the closest points on the view ray and the line segment\n\t\t\t\tvec3 rayEnd = normalize( worldPos.xyz ) * 1e5;\n\t\t\t\tvec3 lineDir = worldEnd - worldStart;\n\t\t\t\tvec2 params = closestLineToLine( worldStart, worldEnd, vec3( 0.0, 0.0, 0.0 ), rayEnd );\n\n\t\t\t\tvec3 p1 = worldStart + lineDir * params.x;\n\t\t\t\tvec3 p2 = rayEnd * params.y;\n\t\t\t\tvec3 delta = p1 - p2;\n\t\t\t\tfloat len = length( delta );\n\t\t\t\tfloat norm = len / linewidth;\n\n\t\t\t\t#ifndef USE_DASH\n\n\t\t\t\t\t#ifdef USE_ALPHA_TO_COVERAGE\n\n\t\t\t\t\t\tfloat dnorm = fwidth( norm );\n\t\t\t\t\t\talpha = 1.0 - smoothstep( 0.5 - dnorm, 0.5 + dnorm, norm );\n\n\t\t\t\t\t#else\n\n\t\t\t\t\t\tif ( norm > 0.5 ) {\n\n\t\t\t\t\t\t\tdiscard;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t#endif\n\n\t\t\t\t#endif\n\n\t\t\t#else\n\n\t\t\t\t#ifdef USE_ALPHA_TO_COVERAGE\n\n\t\t\t\t\t// artifacts appear on some hardware if a derivative is taken within a conditional\n\t\t\t\t\tfloat a = vUv.x;\n\t\t\t\t\tfloat b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;\n\t\t\t\t\tfloat len2 = a * a + b * b;\n\t\t\t\t\tfloat dlen = fwidth( len2 );\n\n\t\t\t\t\tif ( abs( vUv.y ) > 1.0 ) {\n\n\t\t\t\t\t\talpha = 1.0 - smoothstep( 1.0 - dlen, 1.0 + dlen, len2 );\n\n\t\t\t\t\t}\n\n\t\t\t\t#else\n\n\t\t\t\t\tif ( abs( vUv.y ) > 1.0 ) {\n\n\t\t\t\t\t\tfloat a = vUv.x;\n\t\t\t\t\t\tfloat b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;\n\t\t\t\t\t\tfloat len2 = a * a + b * b;\n\n\t\t\t\t\t\tif ( len2 > 1.0 ) discard;\n\n\t\t\t\t\t}\n\n\t\t\t\t#endif\n\n\t\t\t#endif\n\n\t\t\tvec4 diffuseColor = vec4( diffuse, alpha );\n\n\t\t\t#include <logdepthbuf_fragment>\n\t\t\t#include <color_fragment>\n\n\t\t\tgl_FragColor = vec4( diffuseColor.rgb, alpha );\n\n\t\t\t#include <tonemapping_fragment>\n\t\t\t#include <colorspace_fragment>\n\t\t\t#include <fog_fragment>\n\t\t\t#include <premultiplied_alpha_fragment>\n\n\t\t}\n\t\t"};class r extends n.ShaderMaterial{constructor(t){super({type:"LineMaterial",uniforms:n.UniformsUtils.clone(n.ShaderLib.line.uniforms),vertexShader:n.ShaderLib.line.vertexShader,fragmentShader:n.ShaderLib.line.fragmentShader,clipping:!0}),this.isLineMaterial=!0,this.setValues(t)}get color(){return this.uniforms.diffuse.value}set color(t){this.uniforms.diffuse.value=t}get worldUnits(){return"WORLD_UNITS"in this.defines}set worldUnits(t){!0===t?this.defines.WORLD_UNITS="":delete this.defines.WORLD_UNITS}get linewidth(){return this.uniforms.linewidth.value}set linewidth(t){this.uniforms.linewidth&&(this.uniforms.linewidth.value=t)}get dashed(){return"USE_DASH"in this.defines}set dashed(t){!0===t!==this.dashed&&(this.needsUpdate=!0),!0===t?this.defines.USE_DASH="":delete this.defines.USE_DASH}get dashScale(){return this.uniforms.dashScale.value}set dashScale(t){this.uniforms.dashScale.value=t}get dashSize(){return this.uniforms.dashSize.value}set dashSize(t){this.uniforms.dashSize.value=t}get dashOffset(){return this.uniforms.dashOffset.value}set dashOffset(t){this.uniforms.dashOffset.value=t}get gapSize(){return this.uniforms.gapSize.value}set gapSize(t){this.uniforms.gapSize.value=t}get opacity(){return this.uniforms.opacity.value}set opacity(t){this.uniforms&&(this.uniforms.opacity.value=t)}get resolution(){return this.uniforms.resolution.value}set resolution(t){this.uniforms.resolution.value.copy(t)}get alphaToCoverage(){return"USE_ALPHA_TO_COVERAGE"in this.defines}set alphaToCoverage(t){this.defines&&(!0===t!==this.alphaToCoverage&&(this.needsUpdate=!0),!0===t?(this.defines.USE_ALPHA_TO_COVERAGE="",this.extensions.derivatives=!0):(delete this.defines.USE_ALPHA_TO_COVERAGE,this.extensions.derivatives=!1))}}const h=new n.Vector3,l=new n.Vector3,c=new n.Vector4,d=new n.Vector4,u=new n.Vector4,p=new n.Vector3,g=new n.Matrix4,m=new n.Line3,f=new n.Vector3,y=new n.Box3,v=new n.Sphere,x=new n.Vector4;let T,M;function C(t,e,i){return x.set(0,0,-e,1).applyMatrix4(t.projectionMatrix),x.multiplyScalar(1/x.w),x.x=M/i.width,x.y=M/i.height,x.applyMatrix4(t.projectionMatrixInverse),x.multiplyScalar(1/x.w),Math.abs(Math.max(x.x,x.y))}class b extends n.Mesh{constructor(t=new o,e=new r({color:16777215*Math.random()})){super(t,e),this.isLineSegments2=!0,this.type="LineSegments2"}computeLineDistances(){const t=this.geometry,e=t.attributes.instanceStart,i=t.attributes.instanceEnd,a=new Float32Array(2*e.count);for(let t=0,n=0,s=e.count;t<s;t++,n+=2)h.fromBufferAttribute(e,t),l.fromBufferAttribute(i,t),a[n]=0===n?0:a[n-1],a[n+1]=a[n]+h.distanceTo(l);const s=new n.InstancedInterleavedBuffer(a,2,1);return t.setAttribute("instanceDistanceStart",new n.InterleavedBufferAttribute(s,1,0)),t.setAttribute("instanceDistanceEnd",new n.InterleavedBufferAttribute(s,1,1)),this}raycast(t,e){const i=this.material.worldUnits,a=t.camera;null!==a||i||console.error('LineSegments2: "Raycaster.camera" needs to be set in order to raycast against LineSegments2 while worldUnits is set to false.');const s=void 0!==t.params.Line2&&t.params.Line2.threshold||0;T=t.ray;const o=this.matrixWorld,r=this.geometry,h=this.material;let l,x;if(M=h.linewidth+s,null===r.boundingSphere&&r.computeBoundingSphere(),v.copy(r.boundingSphere).applyMatrix4(o),i)l=.5*M;else{l=C(a,Math.max(a.near,v.distanceToPoint(T.origin)),h.resolution)}if(v.radius+=l,!1!==T.intersectsSphere(v)){if(null===r.boundingBox&&r.computeBoundingBox(),y.copy(r.boundingBox).applyMatrix4(o),i)x=.5*M;else{x=C(a,Math.max(a.near,y.distanceToPoint(T.origin)),h.resolution)}y.expandByScalar(x),!1!==T.intersectsBox(y)&&(i?function(t,e){const i=t.matrixWorld,a=t.geometry,s=a.attributes.instanceStart,o=a.attributes.instanceEnd;for(let r=0,h=Math.min(a.instanceCount,s.count);r<h;r++){m.start.fromBufferAttribute(s,r),m.end.fromBufferAttribute(o,r),m.applyMatrix4(i);const a=new n.Vector3,h=new n.Vector3;T.distanceSqToSegment(m.start,m.end,h,a),h.distanceTo(a)<.5*M&&e.push({point:h,pointOnLine:a,distance:T.origin.distanceTo(h),object:t,face:null,faceIndex:r,uv:null,uv1:null})}}(this,e):function(t,e,i){const a=e.projectionMatrix,s=t.material.resolution,o=t.matrixWorld,r=t.geometry,h=r.attributes.instanceStart,l=r.attributes.instanceEnd,y=Math.min(r.instanceCount,h.count),v=-e.near;T.at(1,u),u.w=1,u.applyMatrix4(e.matrixWorldInverse),u.applyMatrix4(a),u.multiplyScalar(1/u.w),u.x*=s.x/2,u.y*=s.y/2,u.z=0,p.copy(u),g.multiplyMatrices(e.matrixWorldInverse,o);for(let e=0,r=y;e<r;e++){if(c.fromBufferAttribute(h,e),d.fromBufferAttribute(l,e),c.w=1,d.w=1,c.applyMatrix4(g),d.applyMatrix4(g),c.z>v&&d.z>v)continue;if(c.z>v){const t=c.z-d.z,e=(c.z-v)/t;c.lerp(d,e)}else if(d.z>v){const t=d.z-c.z,e=(d.z-v)/t;d.lerp(c,e)}c.applyMatrix4(a),d.applyMatrix4(a),c.multiplyScalar(1/c.w),d.multiplyScalar(1/d.w),c.x*=s.x/2,c.y*=s.y/2,d.x*=s.x/2,d.y*=s.y/2,m.start.copy(c),m.start.z=0,m.end.copy(d),m.end.z=0;const r=m.closestPointToPointParameter(p,!0);m.at(r,f);const u=n.MathUtils.lerp(c.z,d.z,r),y=u>=-1&&u<=1,x=p.distanceTo(f)<.5*M;if(y&&x){m.start.fromBufferAttribute(h,e),m.end.fromBufferAttribute(l,e),m.start.applyMatrix4(o),m.end.applyMatrix4(o);const a=new n.Vector3,s=new n.Vector3;T.distanceSqToSegment(m.start,m.end,s,a),i.push({point:s,pointOnLine:a,distance:T.origin.distanceTo(s),object:t,face:null,faceIndex:e,uv:null,uv1:null})}}}(this,a,e))}}}const P=/^[og]\s*(.+)?/,E=/^mtllib /,D=/^usemtl /,w=/^usemap /,S=/\s+/,I=new n.Vector3,L=new n.Vector3,A=new n.Vector3,O=new n.Vector3,R=new n.Vector3,_=new n.Color;function k(){const t={objects:[],object:{},vertices:[],normals:[],colors:[],uvs:[],materials:{},materialLibraries:[],startObject:function(t,e){if(this.object&&!1===this.object.fromDeclaration)return this.object.name=t,void(this.object.fromDeclaration=!1!==e);const i=this.object&&"function"==typeof this.object.currentMaterial?this.object.currentMaterial():void 0;if(this.object&&"function"==typeof this.object._finalize&&this.object._finalize(!0),this.object={name:t||"",fromDeclaration:!1!==e,geometry:{vertices:[],normals:[],colors:[],uvs:[],hasUVIndices:!1},materials:[],smooth:!0,startMaterial:function(t,e){const i=this._finalize(!1);i&&(i.inherited||i.groupCount<=0)&&this.materials.splice(i.index,1);const n={index:this.materials.length,name:t||"",mtllib:Array.isArray(e)&&e.length>0?e[e.length-1]:"",smooth:void 0!==i?i.smooth:this.smooth,groupStart:void 0!==i?i.groupEnd:0,groupEnd:-1,groupCount:-1,inherited:!1,clone:function(t){const e={index:"number"==typeof t?t:this.index,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0,groupEnd:-1,groupCount:-1,inherited:!1};return e.clone=this.clone.bind(e),e}};return this.materials.push(n),n},currentMaterial:function(){if(this.materials.length>0)return this.materials[this.materials.length-1]},_finalize:function(t){const e=this.currentMaterial();if(e&&-1===e.groupEnd&&(e.groupEnd=this.geometry.vertices.length/3,e.groupCount=e.groupEnd-e.groupStart,e.inherited=!1),t&&this.materials.length>1)for(let t=this.materials.length-1;t>=0;t--)this.materials[t].groupCount<=0&&this.materials.splice(t,1);return t&&0===this.materials.length&&this.materials.push({name:"",smooth:this.smooth}),e}},i&&i.name&&"function"==typeof i.clone){const t=i.clone(0);t.inherited=!0,this.object.materials.push(t)}this.objects.push(this.object)},finalize:function(){this.object&&"function"==typeof this.object._finalize&&this.object._finalize(!0)},parseVertexIndex:function(t,e){const i=parseInt(t,10);return 3*(i>=0?i-1:i+e/3)},parseNormalIndex:function(t,e){const i=parseInt(t,10);return 3*(i>=0?i-1:i+e/3)},parseUVIndex:function(t,e){const i=parseInt(t,10);return 2*(i>=0?i-1:i+e/2)},addVertex:function(t,e,i){const n=this.vertices,a=this.object.geometry.vertices;a.push(n[t+0],n[t+1],n[t+2]),a.push(n[e+0],n[e+1],n[e+2]),a.push(n[i+0],n[i+1],n[i+2])},addVertexPoint:function(t){const e=this.vertices;this.object.geometry.vertices.push(e[t+0],e[t+1],e[t+2])},addVertexLine:function(t){const e=this.vertices;this.object.geometry.vertices.push(e[t+0],e[t+1],e[t+2])},addNormal:function(t,e,i){const n=this.normals,a=this.object.geometry.normals;a.push(n[t+0],n[t+1],n[t+2]),a.push(n[e+0],n[e+1],n[e+2]),a.push(n[i+0],n[i+1],n[i+2])},addFaceNormal:function(t,e,i){const n=this.vertices,a=this.object.geometry.normals;I.fromArray(n,t),L.fromArray(n,e),A.fromArray(n,i),R.subVectors(A,L),O.subVectors(I,L),R.cross(O),R.normalize(),a.push(R.x,R.y,R.z),a.push(R.x,R.y,R.z),a.push(R.x,R.y,R.z)},addColor:function(t,e,i){const n=this.colors,a=this.object.geometry.colors;void 0!==n[t]&&a.push(n[t+0],n[t+1],n[t+2]),void 0!==n[e]&&a.push(n[e+0],n[e+1],n[e+2]),void 0!==n[i]&&a.push(n[i+0],n[i+1],n[i+2])},addUV:function(t,e,i){const n=this.uvs,a=this.object.geometry.uvs;a.push(n[t+0],n[t+1]),a.push(n[e+0],n[e+1]),a.push(n[i+0],n[i+1])},addDefaultUV:function(){const t=this.object.geometry.uvs;t.push(0,0),t.push(0,0),t.push(0,0)},addUVLine:function(t){const e=this.uvs;this.object.geometry.uvs.push(e[t+0],e[t+1])},addFace:function(t,e,i,n,a,s,o,r,h){const l=this.vertices.length;let c=this.parseVertexIndex(t,l),d=this.parseVertexIndex(e,l),u=this.parseVertexIndex(i,l);if(this.addVertex(c,d,u),this.addColor(c,d,u),void 0!==o&&""!==o){const t=this.normals.length;c=this.parseNormalIndex(o,t),d=this.parseNormalIndex(r,t),u=this.parseNormalIndex(h,t),this.addNormal(c,d,u)}else this.addFaceNormal(c,d,u);if(void 0!==n&&""!==n){const t=this.uvs.length;c=this.parseUVIndex(n,t),d=this.parseUVIndex(a,t),u=this.parseUVIndex(s,t),this.addUV(c,d,u),this.object.geometry.hasUVIndices=!0}else this.addDefaultUV()},addPointGeometry:function(t){this.object.geometry.type="Points";const e=this.vertices.length;for(let i=0,n=t.length;i<n;i++){const n=this.parseVertexIndex(t[i],e);this.addVertexPoint(n),this.addColor(n)}},addLineGeometry:function(t,e){this.object.geometry.type="Line";const i=this.vertices.length,n=this.uvs.length;for(let e=0,n=t.length;e<n;e++)this.addVertexLine(this.parseVertexIndex(t[e],i));for(let t=0,i=e.length;t<i;t++)this.addUVLine(this.parseUVIndex(e[t],n))}};return t.startObject("",!1),t}class j extends n.Loader{constructor(t){super(t),this.materials=null}load(t,e,i,a){const s=this,o=new n.FileLoader(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(t,(function(i){try{e(s.parse(i))}catch(e){a?a(e):console.error(e),s.manager.itemError(t)}}),i,a)}setMaterials(t){return this.materials=t,this}parse(t){const e=new k;-1!==t.indexOf("\r\n")&&(t=t.replace(/\r\n/g,"\n")),-1!==t.indexOf("\\\n")&&(t=t.replace(/\\\n/g,""));const i=t.split("\n");let a=[];for(let t=0,n=i.length;t<n;t++){const n=i[t].trimStart();if(0===n.length)continue;const s=n.charAt(0);if("#"!==s)if("v"===s){const t=n.split(S);switch(t[0]){case"v":e.vertices.push(parseFloat(t[1]),parseFloat(t[2]),parseFloat(t[3])),t.length>=7?(_.setRGB(parseFloat(t[4]),parseFloat(t[5]),parseFloat(t[6])).convertSRGBToLinear(),e.colors.push(_.r,_.g,_.b)):e.colors.push(void 0,void 0,void 0);break;case"vn":e.normals.push(parseFloat(t[1]),parseFloat(t[2]),parseFloat(t[3]));break;case"vt":e.uvs.push(parseFloat(t[1]),parseFloat(t[2]))}}else if("f"===s){const t=n.slice(1).trim().split(S),i=[];for(let e=0,n=t.length;e<n;e++){const n=t[e];if(n.length>0){const t=n.split("/");i.push(t)}}const a=i[0];for(let t=1,n=i.length-1;t<n;t++){const n=i[t],s=i[t+1];e.addFace(a[0],n[0],s[0],a[1],n[1],s[1],a[2],n[2],s[2])}}else if("l"===s){const t=n.substring(1).trim().split(" ");let i=[];const a=[];if(-1===n.indexOf("/"))i=t;else for(let e=0,n=t.length;e<n;e++){const n=t[e].split("/");""!==n[0]&&i.push(n[0]),""!==n[1]&&a.push(n[1])}e.addLineGeometry(i,a)}else if("p"===s){const t=n.slice(1).trim().split(" ");e.addPointGeometry(t)}else if(null!==(a=P.exec(n))){const t=(" "+a[0].slice(1).trim()).slice(1);e.startObject(t)}else if(D.test(n))e.object.startMaterial(n.substring(7).trim(),e.materialLibraries);else if(E.test(n))e.materialLibraries.push(n.substring(7).trim());else if(w.test(n))console.warn('THREE.OBJLoader: Rendering identifier "usemap" not supported. Textures must be defined in MTL files.');else if("s"===s){if(a=n.split(" "),a.length>1){const t=a[1].trim().toLowerCase();e.object.smooth="0"!==t&&"off"!==t}else e.object.smooth=!0;const t=e.object.currentMaterial();t&&(t.smooth=e.object.smooth)}else{if("\0"===n)continue;console.warn('THREE.OBJLoader: Unexpected line: "'+n+'"')}}e.finalize();const s=new n.Group;s.materialLibraries=[].concat(e.materialLibraries);if(!0===!(1===e.objects.length&&0===e.objects[0].geometry.vertices.length))for(let t=0,i=e.objects.length;t<i;t++){const i=e.objects[t],a=i.geometry,o=i.materials,r="Line"===a.type,h="Points"===a.type;let l=!1;if(0===a.vertices.length)continue;const c=new n.BufferGeometry;c.setAttribute("position",new n.Float32BufferAttribute(a.vertices,3)),a.normals.length>0&&c.setAttribute("normal",new n.Float32BufferAttribute(a.normals,3)),a.colors.length>0&&(l=!0,c.setAttribute("color",new n.Float32BufferAttribute(a.colors,3))),!0===a.hasUVIndices&&c.setAttribute("uv",new n.Float32BufferAttribute(a.uvs,2));const d=[];for(let t=0,i=o.length;t<i;t++){const i=o[t],a=i.name+"_"+i.smooth+"_"+l;let s=e.materials[a];if(null!==this.materials)if(s=this.materials.create(i.name),!r||!s||s instanceof n.LineBasicMaterial){if(h&&s&&!(s instanceof n.PointsMaterial)){const t=new n.PointsMaterial({size:10,sizeAttenuation:!1});n.Material.prototype.copy.call(t,s),t.color.copy(s.color),t.map=s.map,s=t}}else{const t=new n.LineBasicMaterial;n.Material.prototype.copy.call(t,s),t.color.copy(s.color),s=t}void 0===s&&(s=r?new n.LineBasicMaterial:h?new n.PointsMaterial({size:1,sizeAttenuation:!1}):new n.MeshPhongMaterial,s.name=i.name,s.flatShading=!i.smooth,s.vertexColors=l,e.materials[a]=s),d.push(s)}let u;if(d.length>1){for(let t=0,e=o.length;t<e;t++){const e=o[t];c.addGroup(e.groupStart,e.groupCount,t)}u=r?new n.LineSegments(c,d):h?new n.Points(c,d):new n.Mesh(c,d)}else u=r?new n.LineSegments(c,d[0]):h?new n.Points(c,d[0]):new n.Mesh(c,d[0]);u.name=i.name,s.add(u)}else if(e.vertices.length>0){const t=new n.PointsMaterial({size:1,sizeAttenuation:!1}),i=new n.BufferGeometry;i.setAttribute("position",new n.Float32BufferAttribute(e.vertices,3)),e.colors.length>0&&void 0!==e.colors[0]&&(i.setAttribute("color",new n.Float32BufferAttribute(e.colors,3)),t.vertexColors=!0);const a=new n.Points(i,t);s.add(a)}return s}}const N=n.SRGBColorSpace;class F extends n.Loader{constructor(t){super(t),this.defaultDPI=90,this.defaultUnit="px"}load(t,e,i,a){const s=this,o=new n.FileLoader(s.manager);o.setPath(s.path),o.setRequestHeader(s.requestHeader),o.setWithCredentials(s.withCredentials),o.load(t,(function(i){try{e(s.parse(i))}catch(e){a?a(e):console.error(e),s.manager.itemError(t)}}),i,a)}parse(t){const e=this;function i(t,e,i,n,s,o,r,h){if(0==e||0==i)return void t.lineTo(h.x,h.y);n=n*Math.PI/180,e=Math.abs(e),i=Math.abs(i);const l=(r.x-h.x)/2,c=(r.y-h.y)/2,d=Math.cos(n)*l+Math.sin(n)*c,u=-Math.sin(n)*l+Math.cos(n)*c;let p=e*e,g=i*i;const m=d*d,f=u*u,y=m/p+f/g;if(y>1){const t=Math.sqrt(y);p=(e*=t)*e,g=(i*=t)*i}const v=p*f+g*m,x=(p*g-v)/v;let T=Math.sqrt(Math.max(0,x));s===o&&(T=-T);const M=T*e*u/i,C=-T*i*d/e,b=Math.cos(n)*M-Math.sin(n)*C+(r.x+h.x)/2,P=Math.sin(n)*M+Math.cos(n)*C+(r.y+h.y)/2,E=a(1,0,(d-M)/e,(u-C)/i),D=a((d-M)/e,(u-C)/i,(-d-M)/e,(-u-C)/i)%(2*Math.PI);t.currentPath.absellipse(b,P,e,i,E,E+D,0===o,n)}function a(t,e,i,n){const a=t*i+e*n,s=Math.sqrt(t*t+e*e)*Math.sqrt(i*i+n*n);let o=Math.acos(Math.max(-1,Math.min(1,a/s)));return t*n-e*i<0&&(o=-o),o}function s(t,e){e=Object.assign({},e);let i={};if(t.hasAttribute("class")){const e=t.getAttribute("class").split(/\s/).filter(Boolean).map((t=>t.trim()));for(let t=0;t<e.length;t++)i=Object.assign(i,f["."+e[t]])}function n(n,a,s){void 0===s&&(s=function(t){return t.startsWith("url")&&console.warn("SVGLoader: url access in attributes is not implemented."),t}),t.hasAttribute(n)&&(e[a]=s(t.getAttribute(n))),i[n]&&(e[a]=s(i[n])),t.style&&""!==t.style[n]&&(e[a]=s(t.style[n]))}function a(t){return Math.max(0,Math.min(1,c(t)))}function s(t){return Math.max(0,c(t))}return t.hasAttribute("id")&&(i=Object.assign(i,f["#"+t.getAttribute("id")])),n("fill","fill"),n("fill-opacity","fillOpacity",a),n("fill-rule","fillRule"),n("opacity","opacity",a),n("stroke","stroke"),n("stroke-opacity","strokeOpacity",a),n("stroke-width","strokeWidth",s),n("stroke-linejoin","strokeLineJoin"),n("stroke-linecap","strokeLineCap"),n("stroke-miterlimit","strokeMiterLimit",s),n("visibility","visibility"),e}function o(t,e){return t-(e-t)}function r(t,e,i){if("string"!=typeof t)throw new TypeError("Invalid input: "+typeof t);const n={SEPARATOR:/[ \t\r\n\,.\-+]/,WHITESPACE:/[ \t\r\n]/,DIGIT:/[\d]/,SIGN:/[-+]/,POINT:/\./,COMMA:/,/,EXP:/e/i,FLAGS:/[01]/};let a=0,s=!0,o="",r="";const h=[];function l(t,e,i){const n=new SyntaxError('Unexpected character "'+t+'" at index '+e+".");throw n.partial=i,n}function c(){""!==o&&(""===r?h.push(Number(o)):h.push(Number(o)*Math.pow(10,Number(r)))),o="",r=""}let d;const u=t.length;for(let p=0;p<u;p++)if(d=t[p],Array.isArray(e)&&e.includes(h.length%i)&&n.FLAGS.test(d))a=1,o=d,c();else{if(0===a){if(n.WHITESPACE.test(d))continue;if(n.DIGIT.test(d)||n.SIGN.test(d)){a=1,o=d;continue}if(n.POINT.test(d)){a=2,o=d;continue}n.COMMA.test(d)&&(s&&l(d,p,h),s=!0)}if(1===a){if(n.DIGIT.test(d)){o+=d;continue}if(n.POINT.test(d)){o+=d,a=2;continue}if(n.EXP.test(d)){a=3;continue}n.SIGN.test(d)&&1===o.length&&n.SIGN.test(o[0])&&l(d,p,h)}if(2===a){if(n.DIGIT.test(d)){o+=d;continue}if(n.EXP.test(d)){a=3;continue}n.POINT.test(d)&&"."===o[o.length-1]&&l(d,p,h)}if(3===a){if(n.DIGIT.test(d)){r+=d;continue}if(n.SIGN.test(d)){if(""===r){r+=d;continue}1===r.length&&n.SIGN.test(r)&&l(d,p,h)}}n.WHITESPACE.test(d)?(c(),a=0,s=!1):n.COMMA.test(d)?(c(),a=0,s=!0):n.SIGN.test(d)?(c(),a=1,o=d):n.POINT.test(d)?(c(),a=2,o=d):l(d,p,h)}return c(),h}const h=["mm","cm","in","pt","pc","px"],l={mm:{mm:1,cm:.1,in:1/25.4,pt:72/25.4,pc:6/25.4,px:-1},cm:{mm:10,cm:1,in:1/2.54,pt:72/2.54,pc:6/2.54,px:-1},in:{mm:25.4,cm:2.54,in:1,pt:72,pc:6,px:-1},pt:{mm:25.4/72,cm:2.54/72,in:1/72,pt:1,pc:6/72,px:-1},pc:{mm:25.4/6,cm:2.54/6,in:1/6,pt:12,pc:1,px:-1},px:{px:1}};function c(t){let i,n="px";if("string"==typeof t||t instanceof String)for(let e=0,i=h.length;e<i;e++){const i=h[e];if(t.endsWith(i)){n=i,t=t.substring(0,t.length-i.length);break}}return"px"===n&&"px"!==e.defaultUnit?i=l.in[e.defaultUnit]/e.defaultDPI:(i=l[n][e.defaultUnit],i<0&&(i=l[n].in*e.defaultDPI)),i*parseFloat(t)}function d(t){const e=t.elements;return e[0]*e[4]-e[1]*e[3]<0}function u(t){const e=t.elements,i=e[0]*e[3]+e[1]*e[4];if(0===i)return!1;const n=p(t),a=g(t);return Math.abs(i/(n*a))>Number.EPSILON}function p(t){const e=t.elements;return Math.sqrt(e[0]*e[0]+e[1]*e[1])}function g(t){const e=t.elements;return Math.sqrt(e[3]*e[3]+e[4]*e[4])}const m=[],f={},y=[],v=new n.Matrix3,x=new n.Matrix3,T=new n.Matrix3,M=new n.Matrix3,C=new n.Vector2,b=new n.Vector3,P=new n.Matrix3,E=(new DOMParser).parseFromString(t,"image/svg+xml");!function t(e,a){if(1!==e.nodeType)return;const h=function(t){if(!(t.hasAttribute("transform")||"use"===t.nodeName&&(t.hasAttribute("x")||t.hasAttribute("y"))))return null;const e=function(t){const e=new n.Matrix3,i=v;if("use"===t.nodeName&&(t.hasAttribute("x")||t.hasAttribute("y"))){const i=c(t.getAttribute("x")),n=c(t.getAttribute("y"));e.translate(i,n)}if(t.hasAttribute("transform")){const n=t.getAttribute("transform").split(")");for(let t=n.length-1;t>=0;t--){const a=n[t].trim();if(""===a)continue;const s=a.indexOf("("),o=a.length;if(s>0&&s<o){const t=a.slice(0,s),e=r(a.slice(s+1));switch(i.identity(),t){case"translate":if(e.length>=1){const t=e[0];let n=0;e.length>=2&&(n=e[1]),i.translate(t,n)}break;case"rotate":if(e.length>=1){let t=0,n=0,a=0;t=e[0]*Math.PI/180,e.length>=3&&(n=e[1],a=e[2]),x.makeTranslation(-n,-a),T.makeRotation(t),M.multiplyMatrices(T,x),x.makeTranslation(n,a),i.multiplyMatrices(x,M)}break;case"scale":if(e.length>=1){const t=e[0];let n=t;e.length>=2&&(n=e[1]),i.scale(t,n)}break;case"skewX":1===e.length&&i.set(1,Math.tan(e[0]*Math.PI/180),0,0,1,0,0,0,1);break;case"skewY":1===e.length&&i.set(1,0,0,Math.tan(e[0]*Math.PI/180),1,0,0,0,1);break;case"matrix":6===e.length&&i.set(e[0],e[2],e[4],e[1],e[3],e[5],0,0,1)}}e.premultiply(i)}}return e}(t);y.length>0&&e.premultiply(y[y.length-1]);return P.copy(e),y.push(e),e}(e);let l=!1,E=null;switch(e.nodeName){case"svg":case"g":a=s(e,a);break;case"style":!function(t){if(!t.sheet||!t.sheet.cssRules||!t.sheet.cssRules.length)return;for(let e=0;e<t.sheet.cssRules.length;e++){const i=t.sheet.cssRules[e];if(1!==i.type)continue;const n=i.selectorText.split(/,/gm).filter(Boolean).map((t=>t.trim()));for(let t=0;t<n.length;t++){const e=Object.fromEntries(Object.entries(i.style).filter((([,t])=>""!==t)));f[n[t]]=Object.assign(f[n[t]]||{},e)}}}(e);break;case"path":a=s(e,a),e.hasAttribute("d")&&(E=function(t){const e=new n.ShapePath,a=new n.Vector2,s=new n.Vector2,h=new n.Vector2;let l=!0,c=!1;const d=t.getAttribute("d");if(""===d||"none"===d)return null;const u=d.match(/[a-df-z][^a-df-z]*/gi);for(let t=0,n=u.length;t<n;t++){const n=u[t],d=n.charAt(0),p=n.slice(1).trim();let g;switch(!0===l&&(c=!0,l=!1),d){case"M":g=r(p);for(let t=0,i=g.length;t<i;t+=2)a.x=g[t+0],a.y=g[t+1],s.x=a.x,s.y=a.y,0===t?e.moveTo(a.x,a.y):e.lineTo(a.x,a.y),0===t&&h.copy(a);break;case"H":g=r(p);for(let t=0,i=g.length;t<i;t++)a.x=g[t],s.x=a.x,s.y=a.y,e.lineTo(a.x,a.y),0===t&&!0===c&&h.copy(a);break;case"V":g=r(p);for(let t=0,i=g.length;t<i;t++)a.y=g[t],s.x=a.x,s.y=a.y,e.lineTo(a.x,a.y),0===t&&!0===c&&h.copy(a);break;case"L":g=r(p);for(let t=0,i=g.length;t<i;t+=2)a.x=g[t+0],a.y=g[t+1],s.x=a.x,s.y=a.y,e.lineTo(a.x,a.y),0===t&&!0===c&&h.copy(a);break;case"C":g=r(p);for(let t=0,i=g.length;t<i;t+=6)e.bezierCurveTo(g[t+0],g[t+1],g[t+2],g[t+3],g[t+4],g[t+5]),s.x=g[t+2],s.y=g[t+3],a.x=g[t+4],a.y=g[t+5],0===t&&!0===c&&h.copy(a);break;case"S":g=r(p);for(let t=0,i=g.length;t<i;t+=4)e.bezierCurveTo(o(a.x,s.x),o(a.y,s.y),g[t+0],g[t+1],g[t+2],g[t+3]),s.x=g[t+0],s.y=g[t+1],a.x=g[t+2],a.y=g[t+3],0===t&&!0===c&&h.copy(a);break;case"Q":g=r(p);for(let t=0,i=g.length;t<i;t+=4)e.quadraticCurveTo(g[t+0],g[t+1],g[t+2],g[t+3]),s.x=g[t+0],s.y=g[t+1],a.x=g[t+2],a.y=g[t+3],0===t&&!0===c&&h.copy(a);break;case"T":g=r(p);for(let t=0,i=g.length;t<i;t+=2){const i=o(a.x,s.x),n=o(a.y,s.y);e.quadraticCurveTo(i,n,g[t+0],g[t+1]),s.x=i,s.y=n,a.x=g[t+0],a.y=g[t+1],0===t&&!0===c&&h.copy(a)}break;case"A":g=r(p,[3,4],7);for(let t=0,n=g.length;t<n;t+=7){if(g[t+5]==a.x&&g[t+6]==a.y)continue;const n=a.clone();a.x=g[t+5],a.y=g[t+6],s.x=a.x,s.y=a.y,i(e,g[t],g[t+1],g[t+2],g[t+3],g[t+4],n,a),0===t&&!0===c&&h.copy(a)}break;case"m":g=r(p);for(let t=0,i=g.length;t<i;t+=2)a.x+=g[t+0],a.y+=g[t+1],s.x=a.x,s.y=a.y,0===t?e.moveTo(a.x,a.y):e.lineTo(a.x,a.y),0===t&&h.copy(a);break;case"h":g=r(p);for(let t=0,i=g.length;t<i;t++)a.x+=g[t],s.x=a.x,s.y=a.y,e.lineTo(a.x,a.y),0===t&&!0===c&&h.copy(a);break;case"v":g=r(p);for(let t=0,i=g.length;t<i;t++)a.y+=g[t],s.x=a.x,s.y=a.y,e.lineTo(a.x,a.y),0===t&&!0===c&&h.copy(a);break;case"l":g=r(p);for(let t=0,i=g.length;t<i;t+=2)a.x+=g[t+0],a.y+=g[t+1],s.x=a.x,s.y=a.y,e.lineTo(a.x,a.y),0===t&&!0===c&&h.copy(a);break;case"c":g=r(p);for(let t=0,i=g.length;t<i;t+=6)e.bezierCurveTo(a.x+g[t+0],a.y+g[t+1],a.x+g[t+2],a.y+g[t+3],a.x+g[t+4],a.y+g[t+5]),s.x=a.x+g[t+2],s.y=a.y+g[t+3],a.x+=g[t+4],a.y+=g[t+5],0===t&&!0===c&&h.copy(a);break;case"s":g=r(p);for(let t=0,i=g.length;t<i;t+=4)e.bezierCurveTo(o(a.x,s.x),o(a.y,s.y),a.x+g[t+0],a.y+g[t+1],a.x+g[t+2],a.y+g[t+3]),s.x=a.x+g[t+0],s.y=a.y+g[t+1],a.x+=g[t+2],a.y+=g[t+3],0===t&&!0===c&&h.copy(a);break;case"q":g=r(p);for(let t=0,i=g.length;t<i;t+=4)e.quadraticCurveTo(a.x+g[t+0],a.y+g[t+1],a.x+g[t+2],a.y+g[t+3]),s.x=a.x+g[t+0],s.y=a.y+g[t+1],a.x+=g[t+2],a.y+=g[t+3],0===t&&!0===c&&h.copy(a);break;case"t":g=r(p);for(let t=0,i=g.length;t<i;t+=2){const i=o(a.x,s.x),n=o(a.y,s.y);e.quadraticCurveTo(i,n,a.x+g[t+0],a.y+g[t+1]),s.x=i,s.y=n,a.x=a.x+g[t+0],a.y=a.y+g[t+1],0===t&&!0===c&&h.copy(a)}break;case"a":g=r(p,[3,4],7);for(let t=0,n=g.length;t<n;t+=7){if(0==g[t+5]&&0==g[t+6])continue;const n=a.clone();a.x+=g[t+5],a.y+=g[t+6],s.x=a.x,s.y=a.y,i(e,g[t],g[t+1],g[t+2],g[t+3],g[t+4],n,a),0===t&&!0===c&&h.copy(a)}break;case"Z":case"z":e.currentPath.autoClose=!0,e.currentPath.curves.length>0&&(a.copy(h),e.currentPath.currentPoint.copy(a),l=!0);break;default:console.warn(n)}c=!1}return e}(e));break;case"rect":a=s(e,a),E=function(t){const e=c(t.getAttribute("x")||0),i=c(t.getAttribute("y")||0),a=c(t.getAttribute("rx")||t.getAttribute("ry")||0),s=c(t.getAttribute("ry")||t.getAttribute("rx")||0),o=c(t.getAttribute("width")),r=c(t.getAttribute("height")),h=.448084975506,l=new n.ShapePath;l.moveTo(e+a,i),l.lineTo(e+o-a,i),(0!==a||0!==s)&&l.bezierCurveTo(e+o-a*h,i,e+o,i+s*h,e+o,i+s);l.lineTo(e+o,i+r-s),(0!==a||0!==s)&&l.bezierCurveTo(e+o,i+r-s*h,e+o-a*h,i+r,e+o-a,i+r);l.lineTo(e+a,i+r),(0!==a||0!==s)&&l.bezierCurveTo(e+a*h,i+r,e,i+r-s*h,e,i+r-s);l.lineTo(e,i+s),(0!==a||0!==s)&&l.bezierCurveTo(e,i+s*h,e+a*h,i,e+a,i);return l}(e);break;case"polygon":a=s(e,a),E=function(t){function e(t,e,i){const n=c(e),o=c(i);0===s?a.moveTo(n,o):a.lineTo(n,o),s++}const i=/([+-]?\d*\.?\d+(?:e[+-]?\d+)?)(?:,|\s)([+-]?\d*\.?\d+(?:e[+-]?\d+)?)/g,a=new n.ShapePath;let s=0;return t.getAttribute("points").replace(i,e),a.currentPath.autoClose=!0,a}(e);break;case"polyline":a=s(e,a),E=function(t){function e(t,e,i){const n=c(e),o=c(i);0===s?a.moveTo(n,o):a.lineTo(n,o),s++}const i=/([+-]?\d*\.?\d+(?:e[+-]?\d+)?)(?:,|\s)([+-]?\d*\.?\d+(?:e[+-]?\d+)?)/g,a=new n.ShapePath;let s=0;return t.getAttribute("points").replace(i,e),a.currentPath.autoClose=!1,a}(e);break;case"circle":a=s(e,a),E=function(t){const e=c(t.getAttribute("cx")||0),i=c(t.getAttribute("cy")||0),a=c(t.getAttribute("r")||0),s=new n.Path;s.absarc(e,i,a,0,2*Math.PI);const o=new n.ShapePath;return o.subPaths.push(s),o}(e);break;case"ellipse":a=s(e,a),E=function(t){const e=c(t.getAttribute("cx")||0),i=c(t.getAttribute("cy")||0),a=c(t.getAttribute("rx")||0),s=c(t.getAttribute("ry")||0),o=new n.Path;o.absellipse(e,i,a,s,0,2*Math.PI);const r=new n.ShapePath;return r.subPaths.push(o),r}(e);break;case"line":a=s(e,a),E=function(t){const e=c(t.getAttribute("x1")||0),i=c(t.getAttribute("y1")||0),a=c(t.getAttribute("x2")||0),s=c(t.getAttribute("y2")||0),o=new n.ShapePath;return o.moveTo(e,i),o.lineTo(a,s),o.currentPath.autoClose=!1,o}(e);break;case"defs":l=!0;break;case"use":a=s(e,a);const h=(e.getAttributeNS("http://www.w3.org/1999/xlink","href")||"").substring(1),d=e.viewportElement.getElementById(h);d?t(d,a):console.warn("SVGLoader: 'use node' references non-existent node id: "+h)}E&&(void 0!==a.fill&&"none"!==a.fill&&E.color.setStyle(a.fill,N),function(t,e){function i(t){b.set(t.x,t.y,1).applyMatrix3(e),t.set(b.x,b.y)}function a(t){const i=t.xRadius,a=t.yRadius,s=Math.cos(t.aRotation),o=Math.sin(t.aRotation),r=new n.Vector3(i*s,i*o,0),h=new n.Vector3(-a*o,a*s,0),l=r.applyMatrix3(e),c=h.applyMatrix3(e),u=v.set(l.x,c.x,0,l.y,c.y,0,0,0,1),p=x.copy(u).invert(),g=T.copy(p).transpose().multiply(p).elements,m=function(t,e,i){let n,a,s,o,r;const h=t+i,l=t-i,c=Math.sqrt(l*l+4*e*e);h>0?(n=.5*(h+c),r=1/n,a=t*r*i-e*r*e):h<0?a=.5*(h-c):(n=.5*c,a=-.5*c);s=l>0?l+c:l-c;Math.abs(s)>2*Math.abs(e)?(r=-2*e/s,o=1/Math.sqrt(1+r*r),s=r*o):0===Math.abs(e)?(s=1,o=0):(r=-.5*s/e,s=1/Math.sqrt(1+r*r),o=r*s);l>0&&(r=s,s=-o,o=r);return{rt1:n,rt2:a,cs:s,sn:o}}(g[0],g[1],g[4]),f=Math.sqrt(m.rt1),y=Math.sqrt(m.rt2);t.xRadius=1/f,t.yRadius=1/y,t.aRotation=Math.atan2(m.sn,m.cs);if(!((t.aEndAngle-t.aStartAngle)%(2*Math.PI)<Number.EPSILON)){const i=x.set(f,0,0,0,y,0,0,0,1),a=T.set(m.cs,m.sn,0,-m.sn,m.cs,0,0,0,1),s=i.multiply(a).multiply(u),o=t=>{const{x:e,y:i}=new n.Vector3(Math.cos(t),Math.sin(t),0).applyMatrix3(s);return Math.atan2(i,e)};t.aStartAngle=o(t.aStartAngle),t.aEndAngle=o(t.aEndAngle),d(e)&&(t.aClockwise=!t.aClockwise)}}function s(t){const i=p(e),n=g(e);t.xRadius*=i,t.yRadius*=n;const a=i>Number.EPSILON?Math.atan2(e.elements[1],e.elements[0]):Math.atan2(-e.elements[3],e.elements[4]);t.aRotation+=a,d(e)&&(t.aStartAngle*=-1,t.aEndAngle*=-1,t.aClockwise=!t.aClockwise)}const o=t.subPaths;for(let t=0,n=o.length;t<n;t++){const n=o[t].curves;for(let t=0;t<n.length;t++){const o=n[t];o.isLineCurve?(i(o.v1),i(o.v2)):o.isCubicBezierCurve?(i(o.v0),i(o.v1),i(o.v2),i(o.v3)):o.isQuadraticBezierCurve?(i(o.v0),i(o.v1),i(o.v2)):o.isEllipseCurve&&(C.set(o.aX,o.aY),i(C),o.aX=C.x,o.aY=C.y,u(e)?a(o):s(o))}}}(E,P),m.push(E),E.userData={node:e,style:a});const D=e.childNodes;for(let e=0;e<D.length;e++){const i=D[e];l&&"style"!==i.nodeName&&"defs"!==i.nodeName||t(i,a)}h&&(y.pop(),y.length>0?P.copy(y[y.length-1]):P.identity())}(E.documentElement,{fill:"#000",fillOpacity:1,strokeOpacity:1,strokeWidth:1,strokeLineJoin:"miter",strokeLineCap:"butt",strokeMiterLimit:4});return{paths:m,xml:E.documentElement}}static createShapes(t){const e=999999999,i=0,a=1,s=2,o=3,r=4,h=5,l=6,c={loc:i,t:0};function d(t,e,n,a){const o=t.x,r=e.x,h=n.x,l=a.x,d=t.y,p=e.y,g=n.y,m=a.y,f=(l-h)*(d-g)-(m-g)*(o-h),y=(m-g)*(r-o)-(l-h)*(p-d),v=f/y,x=((r-o)*(d-g)-(p-d)*(o-h))/y;if(0===y&&0!==f||v<=0||v>=1||x<0||x>1)return null;if(0===f&&0===y){for(let h=0;h<2;h++){if(u(0===h?n:a,t,e),c.loc==i){const t=0===h?n:a;return{x:t.x,y:t.y,t:c.t}}if(c.loc==s){return{x:+(o+c.t*(r-o)).toPrecision(10),y:+(d+c.t*(p-d)).toPrecision(10),t:c.t}}}return null}for(let s=0;s<2;s++)if(u(0===s?n:a,t,e),c.loc==i){const t=0===s?n:a;return{x:t.x,y:t.y,t:c.t}}return{x:+(o+v*(r-o)).toPrecision(10),y:+(d+v*(p-d)).toPrecision(10),t:v}}function u(t,e,n){const d=n.x-e.x,u=n.y-e.y,p=t.x-e.x,g=t.y-e.y,m=d*g-p*u;if(t.x===e.x&&t.y===e.y)return c.loc=i,void(c.t=0);if(t.x===n.x&&t.y===n.y)return c.loc=a,void(c.t=1);if(m<-Number.EPSILON)return void(c.loc=o);if(m>Number.EPSILON)return void(c.loc=r);if(d*p<0||u*g<0)return void(c.loc=h);if(Math.sqrt(d*d+u*u)<Math.sqrt(p*p+g*g))return void(c.loc=l);let f;f=0!==d?p/d:g/u,c.loc=s,c.t=f}function p(t,e,i){const a=new n.Vector2;e.getCenter(a);const s=[];return i.forEach((e=>{if(e.boundingBox.containsPoint(a)){(function(t,e){const i=[],a=[];for(let s=1;s<t.length;s++){const o=t[s-1],r=t[s];for(let t=1;t<e.length;t++){const s=d(o,r,e[t-1],e[t]);null!==s&&void 0===i.find((t=>t.t<=s.t+Number.EPSILON&&t.t>=s.t-Number.EPSILON))&&(i.push(s),a.push(new n.Vector2(s.x,s.y)))}}return a})(t,e.points).forEach((t=>{s.push({identifier:e.identifier,isCW:e.isCW,point:t})}))}})),s.sort(((t,e)=>t.point.x-e.point.x)),s}let g=e,m=-999999999,f=t.subPaths.map((t=>{const i=t.getPoints();let a=-999999999,s=e,o=-999999999,r=e;for(let t=0;t<i.length;t++){const e=i[t];e.y>a&&(a=e.y),e.y<s&&(s=e.y),e.x>o&&(o=e.x),e.x<r&&(r=e.x)}return m<=o&&(m=o+1),g>=r&&(g=r-1),{curves:t.curves,points:i,isCW:n.ShapeUtils.isClockWise(i),identifier:-1,boundingBox:new n.Box2(new n.Vector2(r,s),new n.Vector2(o,a))}}));f=f.filter((t=>t.points.length>1));for(let t=0;t<f.length;t++)f[t].identifier=t;const y=f.map((e=>function(t,e,i,a,s){null!=s&&""!==s||(s="nonzero");const o=new n.Vector2;t.boundingBox.getCenter(o);const r=p([new n.Vector2(i,o.y),new n.Vector2(a,o.y)],t.boundingBox,e);r.sort(((t,e)=>t.point.x-e.point.x));const h=[],l=[];r.forEach((e=>{e.identifier===t.identifier?h.push(e):l.push(e)}));const c=h[0].point.x,d=[];let u=0;for(;u<l.length&&l[u].point.x<c;)d.length>0&&d[d.length-1]===l[u].identifier?d.pop():d.push(l[u].identifier),u++;if(d.push(t.identifier),"evenodd"===s){const e=d.length%2==0,i=d[d.length-2];return{identifier:t.identifier,isHole:e,for:i}}if("nonzero"===s){let i=!0,n=null,a=null;for(let t=0;t<d.length;t++){const s=d[t];i?(a=e[s].isCW,i=!1,n=s):a!==e[s].isCW&&(a=e[s].isCW,i=!0)}return{identifier:t.identifier,isHole:i,for:n}}console.warn('fill-rule: "'+s+'" is currently not implemented.')}(e,f,g,m,t.userData?t.userData.style.fillRule:void 0))),v=[];return f.forEach((t=>{if(!y[t.identifier].isHole){const e=new n.Shape;e.curves=t.curves;y.filter((e=>e.isHole&&e.for===t.identifier)).forEach((t=>{const i=f[t.identifier],a=new n.Path;a.curves=i.curves,e.holes.push(a)})),v.push(e)}})),v}static getStrokeStyle(t,e,i,n,a){return{strokeColor:e=void 0!==e?e:"#000",strokeWidth:t=void 0!==t?t:1,strokeLineJoin:i=void 0!==i?i:"miter",strokeLineCap:n=void 0!==n?n:"butt",strokeMiterLimit:a=void 0!==a?a:4}}static pointsToStroke(t,e,i,a){const s=[],o=[],r=[];if(0===F.pointsToStrokeWithBuffers(t,e,i,a,s,o,r))return null;const h=new n.BufferGeometry;return h.setAttribute("position",new n.Float32BufferAttribute(s,3)),h.setAttribute("normal",new n.Float32BufferAttribute(o,3)),h.setAttribute("uv",new n.Float32BufferAttribute(r,2)),h}static pointsToStrokeWithBuffers(t,e,i,a,s,o,r,h){const l=new n.Vector2,c=new n.Vector2,d=new n.Vector2,u=new n.Vector2,p=new n.Vector2,g=new n.Vector2,m=new n.Vector2,f=new n.Vector2,y=new n.Vector2,v=new n.Vector2,x=new n.Vector2,T=new n.Vector2,M=new n.Vector2,C=new n.Vector2,b=new n.Vector2,P=new n.Vector2,E=new n.Vector2;i=void 0!==i?i:12,a=void 0!==a?a:.001,h=void 0!==h?h:0;const D=(t=function(t){let e=!1;for(let i=1,n=t.length-1;i<n;i++)if(t[i].distanceTo(t[i+1])<a){e=!0;break}if(!e)return t;const i=[];i.push(t[0]);for(let e=1,n=t.length-1;e<n;e++)t[e].distanceTo(t[e+1])>=a&&i.push(t[e]);return i.push(t[t.length-1]),i}(t)).length;if(D<2)return 0;const w=t[0].equals(t[D-1]);let S,I,L=t[0];const A=e.strokeWidth/2,O=1/(D-1);let R,_,k,j,N=0,F=!1,z=0,B=3*h,H=2*h;U(t[0],t[1],l).multiplyScalar(A),f.copy(t[0]).sub(l),y.copy(t[0]).add(l),v.copy(f),x.copy(y);for(let i=1;i<D;i++){S=t[i],I=i===D-1?w?t[1]:void 0:t[i+1];const n=l;if(U(L,S,n),d.copy(n).multiplyScalar(A),T.copy(S).sub(d),M.copy(S).add(d),R=N+O,_=!1,void 0!==I){U(S,I,c),d.copy(c).multiplyScalar(A),C.copy(S).sub(d),b.copy(S).add(d),k=!0,d.subVectors(I,L),n.dot(d)<0&&(k=!1),1===i&&(F=k),d.subVectors(I,S),d.normalize();const t=Math.abs(n.dot(d));if(t>Number.EPSILON){const i=A/t;d.multiplyScalar(-i),u.subVectors(S,L),p.copy(u).setLength(i).add(d),P.copy(p).negate();const n=p.length(),a=u.length();u.divideScalar(a),g.subVectors(I,S);const s=g.length();switch(g.divideScalar(s),u.dot(P)<a&&g.dot(P)<s&&(_=!0),E.copy(p).add(S),P.add(S),j=!1,_?k?(b.copy(P),M.copy(P)):(C.copy(P),T.copy(P)):W(),e.strokeLineJoin){case"bevel":J(k,_,R);break;case"round":q(k,_),k?V(S,T,C,R,0):V(S,b,M,R,1);break;default:const t=A*e.strokeMiterLimit/n;if(t<1){if("miter-clip"!==e.strokeLineJoin){J(k,_,R);break}q(k,_),k?(g.subVectors(E,T).multiplyScalar(t).add(T),m.subVectors(E,C).multiplyScalar(t).add(C),G(T,R,0),G(g,R,0),G(S,R,.5),G(S,R,.5),G(g,R,0),G(m,R,0),G(S,R,.5),G(m,R,0),G(C,R,0)):(g.subVectors(E,M).multiplyScalar(t).add(M),m.subVectors(E,b).multiplyScalar(t).add(b),G(M,R,1),G(g,R,1),G(S,R,.5),G(S,R,.5),G(g,R,1),G(m,R,1),G(S,R,.5),G(m,R,1),G(b,R,1))}else _?(k?(G(y,N,1),G(f,N,0),G(E,R,0),G(y,N,1),G(E,R,0),G(P,R,1)):(G(y,N,1),G(f,N,0),G(E,R,1),G(f,N,0),G(P,R,0),G(E,R,1)),k?C.copy(E):b.copy(E)):k?(G(T,R,0),G(E,R,0),G(S,R,.5),G(S,R,.5),G(E,R,0),G(C,R,0)):(G(M,R,1),G(E,R,1),G(S,R,.5),G(S,R,.5),G(E,R,1),G(b,R,1)),j=!0}}else W()}else W();w||i!==D-1||K(t[0],v,x,k,!0,N),N=R,L=S,f.copy(C),y.copy(b)}if(w){if(_&&s){let t=E,e=P;F!==k&&(t=P,e=E),k?(j||F)&&(e.toArray(s,0),e.toArray(s,9),j&&t.toArray(s,3)):!j&&F||(e.toArray(s,3),e.toArray(s,9),j&&t.toArray(s,0))}}else K(S,T,M,k,!1,R);return z;function U(t,e,i){return i.subVectors(e,t),i.set(-i.y,i.x).normalize()}function G(t,e,i){s&&(s[B]=t.x,s[B+1]=t.y,s[B+2]=0,o&&(o[B]=0,o[B+1]=0,o[B+2]=1),B+=3,r&&(r[H]=e,r[H+1]=i,H+=2)),z+=3}function V(t,e,n,a,s){l.copy(e).sub(t).normalize(),c.copy(n).sub(t).normalize();let o=Math.PI;const r=l.dot(c);Math.abs(r)<1&&(o=Math.abs(Math.acos(r))),o/=i,d.copy(e);for(let e=0,n=i-1;e<n;e++)u.copy(d).rotateAround(t,o),G(d,a,s),G(u,a,s),G(t,a,.5),d.copy(u);G(u,a,s),G(n,a,s),G(t,a,.5)}function W(){G(y,N,1),G(f,N,0),G(T,R,0),G(y,N,1),G(T,R,1),G(M,R,0)}function J(t,e,i){e?t?(G(y,N,1),G(f,N,0),G(T,R,0),G(y,N,1),G(T,R,0),G(P,R,1),G(T,i,0),G(C,i,0),G(P,i,.5)):(G(y,N,1),G(f,N,0),G(M,R,1),G(f,N,0),G(P,R,0),G(M,R,1),G(M,i,1),G(P,i,0),G(b,i,1)):t?(G(T,i,0),G(C,i,0),G(S,i,.5)):(G(M,i,1),G(b,i,0),G(S,i,.5))}function q(t,e){e&&(t?(G(y,N,1),G(f,N,0),G(T,R,0),G(y,N,1),G(T,R,0),G(P,R,1),G(T,N,0),G(S,R,.5),G(P,R,1),G(S,R,.5),G(C,N,0),G(P,R,1)):(G(y,N,1),G(f,N,0),G(M,R,1),G(f,N,0),G(P,R,0),G(M,R,1),G(M,N,1),G(P,R,0),G(S,R,.5),G(S,R,.5),G(P,R,0),G(b,N,1)))}function K(t,i,n,a,o,r){switch(e.strokeLineCap){case"round":o?V(t,n,i,r,.5):V(t,i,n,r,.5);break;case"square":if(o)l.subVectors(i,t),c.set(l.y,-l.x),d.addVectors(l,c).add(t),u.subVectors(c,l).add(t),a?(d.toArray(s,3),u.toArray(s,0),u.toArray(s,9)):(d.toArray(s,3),d.toArray(s,9),u.toArray(s,0));else{l.subVectors(n,t),c.set(l.y,-l.x),d.addVectors(l,c).add(t),u.subVectors(c,l).add(t);const e=s.length;a?(d.toArray(s,e-3),u.toArray(s,e-6),u.toArray(s,e-12)):(u.toArray(s,e-6),d.toArray(s,e-3),u.toArray(s,e-12))}}}}}},function(t,e,i){"use strict";i.d(e,"a",(function(){return a}));var n=i(58);class a{get value(){return this._value}set value(t){this._value!=t&&(this._value=t,this.onChanged.trigger(this._value))}constructor(t){this.onChanged=new n.a,this._value=t}get Changed(){return this.onChanged.expose()}}},function(t,e,i){"use strict";i.d(e,"a",(function(){return n}));class n{constructor(){this.eventListeners=[]}isBubblingEventArg(t){return t&&"handled"in t}attach(t){this.eventListeners.push(t)}detach(t){let e=this.eventListeners.indexOf(t);e>-1&&this.eventListeners.splice(e,1)}notify(t){if(this.isBubblingEventArg(t))for(let e=this.eventListeners.length-1;e>=0;e--){if(t.handled)return;this.eventListeners[e].call(null,t)}else for(let e=0;e<this.eventListeners.length;e++)this.eventListeners[e].call(null,t)}}},function(t,e,i){"use strict";i.d(e,"e",(function(){return a})),i.d(e,"a",(function(){return s})),i.d(e,"h",(function(){return o})),i.d(e,"i",(function(){return r})),i.d(e,"f",(function(){return h})),i.d(e,"g",(function(){return l})),i.d(e,"c",(function(){return c})),i.d(e,"b",(function(){return d})),i.d(e,"d",(function(){return p}));var n=i(1);i(39);function a(t,e=[[],[],[],[]]){for(let i=0;i<4;i++)for(let n=0;n<4;n++)e[n][i]=t.elements[4*n+i];return e}function s(t,e=new n.Matrix4){for(let i=0;i<4;i++)for(let n=0;n<4;n++)e.elements[4*n+i]=t[n][i];return e}function o(t){return new n.Vector2(t.x,t.y)}function r(t){return new n.Vector3(t.x,t.y,t.z)}function h(t){return{x:t.x,y:t.y,z:t.z}}function l(t){let e=[];for(let i=0;i<t.length;i++)e.push({x:t[i].x,y:t[i].y,z:t[i].z});return e}function c(t){let e=[],i=-1;for(let n=0;n<t.contours.length;n++){let a=u(t.contours[n].vertices,t.holes[n]);if(t.holes[n]){e[i].holes.push(a)}else e.push(a),i=n}return e}function d(t,e=!1){const i=new n.Shape;e&&(t=t.reverse()),i.moveTo(t[0].x,t[0].y);for(let e=1;e<t.length;e++)i.lineTo(t[e].x,t[e].y);return i.closePath(),i}function u(t,e=!1){let i=new n.Shape;e&&(t=t.reverse()),i.moveTo(t[0].x,t[0].y);for(let e=1;e<t.length;e++)i.lineTo(t[e].x,t[e].y);return i.closePath(),i}function p(t){const e=[];let i=-1;for(let n=0;n<t.contours.length;n++){const a=d(t.contours[n].vertices,t.holes[n]);if(t.holes[n]){e[i].holes.push(a)}else e.push(a),i=n}return e}},function(t,e,i){"use strict";i.d(e,"a",(function(){return a}));var n=i(57);class a extends n.a{constructor(t){super(t),this.isIBLStandardMaterial=!0,this.name="IBLStandardMaterial"}dispose(){this.uShadingMap.value=null}copy(t){return super.copy(t)}clone(){return super.clone()}onBeforeCompile(t,e){super.onBeforeCompile(t,e),t.uniforms.shadingMap=this.uShadingMap,t.uniforms.screenResolution=this.uScreenResolution,t.uniforms.shadingAmmount=this.uShadingAmmount,t.uniforms.reflectionAmmount=this.uReflectionAmmount,t.uniforms.surfaceIndex=this.uSurfaceIndex,t.uniforms.selectionAmmount=this.uSelectionAmmount,t.uniforms.selectionColor=this.uSelectionColor,this.updateParams(),this.extendPixelShader(t,"map_pars_fragment","\n                uniform vec2 screenResolution;\n                uniform sampler2D shadingMap;\n                uniform float shadingAmmount;\n                uniform float reflectionAmmount;\n                uniform float surfaceIndex;\n                uniform float selectionAmmount;\n                uniform vec3 selectionColor;        \n        ");this.extendPixelShader(t,"colorspace_fragment","\n                vec2 screenCoords = gl_FragCoord.xy / screenResolution;\n\n                // apply shadows\n                vec4 shading = texture2D(shadingMap, screenCoords);\n                              \n                //if(shading.a == 0.0) discard;\n                float textureAlpha = gl_FragColor.a;\n                float shadowMul = shading.g;\n                shadowMul = pow(shadowMul, max(0.01, shadingAmmount));  // apply a gamma-based user modulation               \n                gl_FragColor.rgb = gl_FragColor.rgb * shadowMul;\n                gl_FragColor.rgb = gl_FragColor.rgb * sqrt(max(1.0, shadingAmmount + 0.4));\n\n                // apply highlights using the computed surface normal\n                float hlPower = 1.0 / clamp(pow(roughnessFactor, 2.5), 0.0001, 1.0);                                                                            // calc a phong-like exponent from roghness\n                float fakeDotVR = clamp(dot(normalize(normal) * (128.0 / 127.0), normalize(vNormal)), 0.0, 1.0);                                                // calc a fake specular factor from the surface normal\n                float reflMul = max(0.0, 2.0 * texture2D(shadingMap, screenCoords, roughnessFactor * 8.0).b - 1.0);                                             // extract a shading value from the mask, roughness based blur\n                reflMul = pow(reflMul, clamp(1.0 / reflectionAmmount, 0.5, 3.0)) * min(reflectionAmmount - 0.2, 1.0) * mix(1.0 - roughnessFactor, 1.0, 0.5);    // apply a gamma-based user modulation\n                float hlIntensity = pow(fakeDotVR , hlPower) * clamp(reflMul, 0.0, 1.0);                                                                        // modulate specular with the shading mask, apply phong specular exponent\n                gl_FragColor.rgb = 1.0 - (1.0 - gl_FragColor.rgb) * (1.0 - vec3(hlIntensity));                \n                gl_FragColor.rgb = mix(gl_FragColor.rgb, selectionColor, selectionAmmount);\n                               \n                gl_FragColor.a = step(abs(shading.r - surfaceIndex), 0.4999 / 255.0) * shading.a * opacity * textureAlpha;\n                ")}updateParams(){this.shadingMap&&(this.uShadingMap.value=this.shadingMap,this.shadingMap.needsUpdate=!0),this.uScreenResolution.value=this.screenResolution,this.uShadingAmmount.value=this.shadingAmmount,this.uReflectionAmmount.value=this.reflectionAmmount,this.uSurfaceIndex.value=this.surfaceIndex,this.uSelectionAmmount.value=this.selectionAmmount,this.uSelectionColor.value=this.selectionColor}extendPixelShader(t,e,i){t.fragmentShader=t.fragmentShader.replace("#include <"+e+">","#include <"+e+">"+i)}}},function(t,e,i){"use strict";i.d(e,"a",(function(){return r}));var n=i(2),a=i(10),s=i(17),o=i(0);class r{static calculateTiles(t,e,i,n,a,s,o=!1,r=!0){return null!=i.posInfo.strategyId&&-1!==i.posInfo.strategyId.indexOf("$SF_VFIX$")?this.createTileAreaGeometryRandom(t,e,i,n,a):this.createTileAreaGeometry(t,e,i,a,s,o,r)}static calculateBaseTiles(t,e,i,n){return this.createBasePattern(t,e,i,n)}static calcTilerizeInfoMaps(t,e,i,n){const o=this.getTransformedPolygon(n,e,t),r=i.posInfo.v0,h=i.posInfo.v1,l=this.getTilingSchemeIndexBounds(r,h,o.ooPolygon),c=this.initTilerizeInfoArray(i.tiles.length),d=Array(i.tiles.length).fill(0);let u=0;for(let t=l.min.x;t<l.max.x;t++)for(let e=l.min.y;e<l.max.y;e++){for(let n=0;n<i.tiles.length;n++){const l=r.x*t+h.x*e,p=r.y*t+h.y*e,g=i.tiles[n],m=this.getTransformedTilePolygon(l,p,g);if(s.b.isPolygonIntersecting(m,g.polygon.polySet.holes,o.ooPolygon)){const t=Math.floor(Math.random()*g.numImages)+1,e=new a.h;if(e.offshadedIndex=t,e.changed=!1,e.baseIndex=u,e.insertIndex=d[n],e.texRotationIndex=0,d[n]++,"CPLXPOLY"===g.formatType){const t=l+g.x,i=p+g.y;e.baseCoord={x:t,y:i}}else e.baseCoord=m[0][0];c[n].push(e)}}u++}return c}static getTilerizeInfoByBaseCoord(t,e){let i;for(const a of t)if(n.a.vec2Equals(a.baseCoord,e)){i=a;break}return i}static getTilerizeInfoByBaseIndex(t,e){let i;for(const n of t)if(n.baseIndex===e){i=n;break}return i}static getPatternPolygonMatrix(t,e){const i=n.a.mat3GetIdentity();return n.a.mat3Translate(i,-e.x,-e.y),n.a.mat3Rotate(i,-t),i}static getTileMatrix(t,e,i,a,s){const r=t.rotation===o.E?t.rotOk:t.rotation,h=r-n.a.degToRad(e)-i,l=r-h,c=n.a.mat3GetIdentity();n.a.mat3Translate(c,-a.x,-a.y),n.a.mat3Rotate(c,h),n.a.mat3Translate(c,a.x,a.y);const d=n.a.pnt2Transform(c,s),u=n.a.vec2Diff(t.insertPoint,d);return n.a.mat3Rotate(c,l),n.a.mat3Translate(c,u.x,u.y),{matrix:c,firstVertex:d}}static getBaseCoordFromInserPoint(t,e,i,a,s,o){const r=this.getTileMatrix(t,e,i,s,o),h=n.a.pnt2Transform(r.matrix,o),l=this.getPatternPolygonMatrix(i,a),c=n.a.pnt2Transform(l,h);return n.a.vec2Diff(c,r.firstVertex)}static rotateInsertPoint(t,e,i,a,s,o,r){const h=this.getBaseCoordFromInserPoint(t,e,i,a,s,o),l=this.getPatternPolygonMatrix(i,a),c=n.a.mat3GetInverted(l),d=n.a.pnt2Transform(c,h),u=n.a.mat3GetIdentity(),p=n.a.degToRad(r);n.a.mat3Translate(u,-d.x,-d.y),n.a.mat3Translate(u,-s.x,-s.y),n.a.mat3Rotate(u,p),n.a.mat3Translate(u,s.x,s.y),n.a.mat3Translate(u,d.x,d.y);return{insertPoint:n.a.pnt2Transform(u,d),rotation:p+n.a.degToRad(e)+i}}static createTileAreaGeometryRandom(t,e,i,n,a){const s=this.getTransformedPolygon(a,e,t),o=this.initTilesArray(i.tiles.length),r=i.posInfo.v1,h=this.getTilingSchemeIndexBounds({x:i.tiles[0].width,y:0},{x:0,y:r.y},s.ooPolygon),l=(h.max.y-h.min.y)*i.tiles.length,c=this.generateRandom(i.tiles[0].width,l,this.thStaggered);for(let t=0;t<i.tiles.length;t++){const e=i.tiles[t],l=this.getTilingSchemeIndexBounds({x:Math.max(e.width,e.height),y:0},{x:0,y:r.y},s.ooPolygon);for(let d=l.min.y;d<l.max.y;d++){const u=(d-h.min.y)*i.tiles.length+t;e.x=c[u];for(let i=l.min.x;i<l.max.x;i++){const h=(Math.max(e.width,e.height)+n)*i,l=r.y*d;this.checkAndAddTiles(h,l,e,s,a,t,0,o,null,null,!1,!0)}}}return{tileList:o,tilerizeInfoData:null}}static createTileAreaGeometry(t,e,i,n,a,s,o){const r=this.getTransformedPolygon(n,e,t),h=i.posInfo.v0,l=i.posInfo.v1,c=this.getTilingSchemeIndexBounds(h,l,r.ooPolygon),d=this.initTilesArray(i.tiles.length),u=this.initTilerizeInfoArray(i.tiles.length);let p=0;for(let t=c.min.x;t<c.max.x;t++)for(let e=c.min.y;e<c.max.y;e++){for(let c=0;c<i.tiles.length;c++){const g=h.x*t+l.x*e,m=h.y*t+l.y*e,f=i.tiles[c];this.checkAndAddTiles(g,m,f,r,n,c,p,d,a,u,s,o)}p++}return{tileList:d,tilerizeInfoData:u}}static createBasePattern(t,e,i,n){const a=this.getTransformedPolygon(n,e,t),s=this.initTilesArray(i.tiles.length);for(let t=0;t<i.tiles.length;t++){const e=0,o=0,r=i.tiles[t];this.checkAndAddTiles(e,o,r,a,n,t,0,s,null,null,!1,!0)}return s}static checkAndAddTiles(t,e,i,o,r,h,l,c,d,u,p,g){const m=this.getTransformedTilePolygon(t,e,i);if(s.b.isPolygonIntersecting(m,i.polygon.polySet.holes,o.ooPolygon)){let s;s="CPLXPOLY"===i.formatType?{x:t+i.x,y:e+i.y}:m[0][0];const f=new a.c,y=n.a.pnt2Transform(o.invMtx,s);let v;d&&(v=p?this.getTilerizeInfoByBaseIndex(d[h],l):this.getTilerizeInfoByBaseCoord(d[h],s));let x=0;v&&!g?x=v.texRotationIndex:i.offshaded&&i.offshadedRot&&(x=Math.floor(Math.random()*i.polygon.degrees.length));const T=n.a.mat3GetIdentity(),M=n.a.degToRad(i.polygon.degrees[x]);n.a.mat3Translate(T,-y.x,-y.y),n.a.mat3Translate(T,-i.polygon.center.x,-i.polygon.center.y),n.a.mat3Rotate(T,M),n.a.mat3Translate(T,i.polygon.center.x,i.polygon.center.y),n.a.mat3Translate(T,y.x,y.y);const C=n.a.pnt2Transform(T,y);f.insertPoint=C,f.offshadedIndex=v&&!g?v.offshadedIndex:Math.floor(Math.random()*i.numImages)+1,f.rotation=M+n.a.degToRad(i.rotation)+r;const b=new a.h;b.offshadedIndex=f.offshadedIndex,b.changed=!1,b.baseIndex=l,b.insertIndex=c[h].length,b.baseCoord=s,b.texRotationIndex=x,u&&u[h].push(b),c[h].push(f)}}static getTransformedPolygon(t,e,i){const a=this.getPatternPolygonMatrix(t,e),s=n.a.mat3GetInverted(a);return{ooPolygon:n.a.pnt2TransformArray(a,i),invMtx:s}}static getTransformedTilePolygon(t,e,i){const a=t+i.x,s=e+i.y;let o=n.a.mat3GetIdentity();o=i.polygon.getTransformedPolygonMatrix(i.insertPoint,i.rotation*Math.PI/180,o);const r=[];for(const t of i.polygon.polySet.contours){const e=n.a.pnt2TransformArray(o,t.vertices),i=[];for(const t of e){const e={x:t.x+a,y:t.y+s};i.push(e)}r.push(i)}return r}static initTilesArray(t){const e=[];for(let i=0;i<t;i++)e.push([]);return e}static initTilerizeInfoArray(t){const e=[];for(let i=0;i<t;i++)e.push([]);return e}static generateRandom(t,e,i){const n=[];let a=0;const s=t*i;for(let i=0;i<e;i++){let e=Math.random()*t;Math.abs(e-a)<s&&(e=e+s>t?a-s:a+s),a=e,n.push(e)}return n}static getTilingSchemeIndexBounds(t,e,i){const a=n.a.mat3GetIdentity();a[0][0]=t.x,a[1][0]=e.x,a[0][1]=t.y,a[1][1]=e.y;const s=n.a.mat3GetInverted(a),o=n.a.pnt2TransformArray(s,i),r=n.a.poly2BoundingBox(o);return r.min.x=Math.floor(r.min.x)-13,r.max.x=Math.ceil(r.max.x)+13,r.min.y=Math.floor(r.min.y)-13,r.max.y=Math.ceil(r.max.y)+13,r}}r.thStaggered=.3},function(t,e,i){"use strict";i.d(e,"a",(function(){return a}));var n=i(60);class a{constructor(t,e){this.apiEndpoint=t,this.apiToken=e,this.defaultOptions={credentials:"include",mode:"cors",headers:{Authorization:`Bearer ${this.apiToken}`,Accept:"application/json","Content-Type":"application/json"}}}post(t,e){return e.length>1024?new Promise(((i,a)=>{const s=n.gzip(e),o=Object.assign(Object.assign({},this.defaultOptions),{method:"POST",body:s});o.headers["Content-Encoding"]="gzip",fetch(`${this.apiEndpoint}/${t}`,o).then((t=>{i(t)})).catch((t=>{a(t)}))})):fetch(`${this.apiEndpoint}/${t}`,Object.assign(Object.assign({},this.defaultOptions),{method:"POST",body:e}))}postCompressed(t,e){return e.length>1024?new Promise(((i,a)=>{const s=n.gzip(e),o=Object.assign(Object.assign({},this.defaultOptions),{method:"POST",body:s});o.headers["Content-Encoding"]="gzip",o.headers["Content-Length"]=s.length,fetch(`${this.apiEndpoint}/${t}`,o).then((t=>{i(t)})).catch((t=>{a(t)}))})):fetch(`${this.apiEndpoint}/${t}`,Object.assign(Object.assign({},this.defaultOptions),{method:"POST",body:e}))}postFormData(t,e){return fetch(`${this.apiEndpoint}/${t}`,{credentials:"include",mode:"cors",headers:{Authorization:`Bearer ${this.apiToken}`},method:"POST",body:e})}get(t,e){return fetch(`${this.apiEndpoint}/${t}`,Object.assign(Object.assign({},this.defaultOptions),{signal:e}))}responseAsJson(t){if(!t.ok)throw new Error(`${t.status}: ${t.statusText}`);return t.json()}responseAsText(t){if(!t.ok)throw new Error(`${t.status}: ${t.statusText}`);return t.text()}getEndpoint(){return this.apiEndpoint}getQueryStringPart(t,e,i){return i?`${t}${e}=${encodeURIComponent(i.toString())}`:""}}},function(t,e,i){"use strict";i.d(e,"a",(function(){return s})),i.d(e,"b",(function(){return o})),i.d(e,"c",(function(){return r})),i.d(e,"d",(function(){return h}));var n=i(1),a=i(2);i(21);const s={up:{x:0,y:1,z:0},point:{x:0,y:0,z:0},normal:{x:0,y:0,z:1},size:{x:5e3,y:5e3}};function o(t,e,i){return{up:Object(a.f)(t.up).applyMatrix4(e).normalize(),normal:Object(a.f)(t.normal).applyMatrix4(e).normalize(),point:Object(a.f)(t.point).applyMatrix4(e),size:{x:t.size.x*i,y:t.size.y*i}}}function r(t,e,i,a,s,o){const r=[];t.position.toArray(r,r.length),e.toArray(r,r.length);const h=[],l=t.quaternion,c=(new n.Quaternion).setFromRotationMatrix((new n.Matrix4).lookAt(e,i,a));return l.toArray(h,h.length),c.toArray(h,h.length),new n.AnimationClip(null,-1,[new n.VectorKeyframeTrack(".position",[s,o],r,n.InterpolateSmooth),new n.QuaternionKeyframeTrack(".quaternion",[s,o],h,n.InterpolateSmooth)])}function h(t,e){const i=t.clipAction(e);i.clampWhenFinished=!0,i.setLoop(n.LoopOnce,1),i.play()}},function(t,e,i){"use strict";i.d(e,"a",(function(){return a})),i.d(e,"b",(function(){return s}));var n=i(1);i(32);class a{constructor(t=0,e=0,i=0,n=0){this.top=t,this.bottom=e,this.left=i,this.right=n}}class s{constructor(t,e){this.viewportWidthPixels=t,this.viewportHeightPixels=e,this.cameraFar=25,this.cameraNear=.1,this.targetDistance=24,this.minViewportSize=10,this.marginPixels=new a(80,80,80,80)}box2SizeToFitRatio(t,e){const i=e.x/t.x,n=e.y/t.y;return n<i?n:i}configureCamera(t,e,i=null){let a,s;this.viewportWidthPixels>this.viewportHeightPixels?(s=this.viewportWidthPixels/this.viewportHeightPixels*this.minViewportSize,a=this.minViewportSize):(s=this.minViewportSize,a=this.viewportHeightPixels/this.viewportWidthPixels*this.minViewportSize);const o=s/this.viewportWidthPixels,r=this.marginPixels.left*o,h=this.marginPixels.right*o,l=this.marginPixels.top*o,c=this.marginPixels.bottom*o,d=this.box2SizeToFitRatio(e.size,{x:s-r-h,y:a-l-c}),u=e.point,p=u.clone().addScaledVector(e.normal,this.targetDistance),g=(new n.Matrix4).lookAt(p,u,e.up),m=new n.Vector3,f=new n.Vector3,y=new n.Vector3;g.extractBasis(m,f,y);const v=(h-r)/2/d,x=(l-c)/2/d;u.addScaledVector(m,v).addScaledVector(f,x),p.addScaledVector(m,v).addScaledVector(f,x);const T=-s/2,M=s/2,C=a/2,b=-a/2,P=this.cameraFar,E=this.cameraNear;i?this.animateCameraUpdateTransition(i,t,P,E,p,u,e.up,T,M,C,b,d):(t.far=P,t.near=E,t.position.copy(p),t.up=e.up,t.lookAt(u),t.left=T,t.right=M,t.top=C,t.bottom=b,t.zoom=d)}animateCameraUpdateTransition(t,e,i,a,s,o,r,h,l,c,d,u){e.far=i,e.near=a;const p=[];e.position.toArray(p,p.length),s.toArray(p,p.length);const g=[],m=e.quaternion,f=(new n.Quaternion).setFromRotationMatrix((new n.Matrix4).lookAt(s,o,r));m.toArray(g,g.length),f.toArray(g,g.length);const y=[e.left,h],v=[e.right,l],x=[e.top,c],T=[e.bottom,d],M=[e.zoom,u],C=.5,b=new n.AnimationClip(null,-1,[new n.VectorKeyframeTrack(".position",[0,C],p,n.InterpolateSmooth),new n.NumberKeyframeTrack(".left",[0,C],y,n.InterpolateSmooth),new n.NumberKeyframeTrack(".right",[0,C],v,n.InterpolateSmooth),new n.NumberKeyframeTrack(".top",[0,C],x,n.InterpolateSmooth),new n.NumberKeyframeTrack(".bottom",[0,C],T,n.InterpolateSmooth),new n.NumberKeyframeTrack(".zoom",[0,C],M,n.InterpolateSmooth),new n.QuaternionKeyframeTrack(".quaternion",[0,C],g,n.InterpolateSmooth)]),P=t.clipAction(b);P.clampWhenFinished=!0,P.setLoop(n.LoopOnce,1),P.play()}}var o;!function(t){t[t.Width=0]="Width",t[t.Height=1]="Height",t[t.WidthAndHeight=2]="WidthAndHeight"}(o||(o={}))},function(t,e,i){"use strict";i.d(e,"a",(function(){return s}));var n=i(2),a=i(1);const s=new class{getPlaneNormal(t,e,i){let n=new a.Vector3;n.x=e.x-t.x,n.y=e.y-t.y,n.z=e.z-t.z;let s=new a.Vector3;return s.x=i.x-e.x,s.y=i.y-e.y,s.z=i.z-e.z,(new a.Vector3).crossVectors(n,s)}getPolygonNormal(t,e){let i=t.length,s=n.a.floatEquals,o=null,r=new a.Vector3(0,0,0);e&&(e.isConvex=!0);for(let n=0;n<i;n++){let a=t[n],h=t[(n+1)%i],l=t[(n+2)%i],c=this.getPlaneNormal(a,h,l);r.add(c),e&&(c.normalize(),o&&(e.isConvex=e.isConvex&&s(c.dot(o),1)),o=c)}return r}transformPolygon(t,e){let i=[];for(let n=0;n<t.length;n++)i.push(new a.Vector3(t[n].x,t[n].y,t[n].z).applyMatrix4(e));return i}getRayPlaneIntersection(t,e,i){let n=new a.Vector3,s=i.dot(t.direction);if(0!=s){let a=i.dot(e.clone().sub(t.origin))/s;return n.copy(t.direction).multiplyScalar(a).add(t.origin),n}}}},function(t,e,i){"use strict";i.d(e,"c",(function(){return n.a})),i.d(e,"a",(function(){return s})),i.d(e,"b",(function(){return o}));var n=i(31),a=i(0);class s extends n.a{responseOr404AsText(t){if(t.ok)return t.text();if(404===t.status)return"";throw new Error(`${t.status}: ${t.statusText}`)}getMat(t,e){return new Promise(((i,n)=>{this.get(`api/mat?manufacturer=${encodeURIComponent(t)}&name=${encodeURIComponent(e)}`).then(this.responseOr404AsText).then((t=>{if(t.length>0){let e=JSON.parse(t,a.c.reviver);i(e)}else i(null)})).catch((t=>{n(t)}))}))}getTileMat(t,e,i,n){return new Promise(((s,o)=>{this.get(`api/mat/tile?idManuf=${encodeURIComponent(t)}&idProd=${encodeURIComponent(e)}&colorVar=${encodeURIComponent(i)}&idx=${n}`).then(this.responseOr404AsText).then((t=>{if(t.length>0){let e=JSON.parse(t,a.c.reviver);s(e)}else s(null)})).catch((t=>{o(t)}))}))}getTextureUrl(t,e=0){return`${this.apiEndpoint}/api/mat/textures?id=${encodeURIComponent(t)}&maxTextureSize=${e}`}getFileUrl(t){return`${this.apiEndpoint}/api/mat/files?id=${encodeURIComponent(t)}`}}class o extends n.a{constructor(t,e){super(t,e)}getPosFile(t){return this.get(`api/pattern?id=${encodeURIComponent(t)}`).then(this.responseAsJson).then((t=>t))}getDefaultPosFile(t){return this.getPosFile(`pieno_${encodeURIComponent(t)}`)}getFpsPosFile(t){return this.get(`api/pattern/fps?fileName=${encodeURIComponent(t)}`).then(this.responseAsJson).then((t=>t))}getTpsPosFile(t,e){return this.get(`api/pattern/tps?fileName=${encodeURIComponent(t)}&dirImg=${encodeURIComponent(e)}`).then(this.responseAsJson).then((t=>t))}getSeamlessPattern(t){return this.get(`api/pattern/seamless?id=${encodeURIComponent(t)}`).then(this.responseAsJson).then((t=>t))}getTileInfo(t){return this.get(`api/tile?id=${t}`).then(this.responseAsJson).then((t=>t))}getTileInfoByKey(t,e,i){return this.get(`api/tile?manufacturer=${encodeURIComponent(t)}&code=${encodeURIComponent(e)}&color=${encodeURIComponent(i)}`).then(this.responseAsJson).then((t=>t))}getTileWithBorderData(t,e,i){return this.get(`api/tile/withborder?manufacturer=${encodeURIComponent(t)}&code=${encodeURIComponent(e)}&color=${encodeURIComponent(i)}`).then(this.responseAsJson).then((t=>t))}}},function(t,e,i){"use strict";var n;i.d(e,"a",(function(){return n})),i.d(e,"b",(function(){return a})),function(t){t.JSON="text/json",t.PNG="image/png",t.JPG="image/jpeg"}(n||(n={}));class a{static downloadFile(t,e,i){const n=new Array(t.length);for(let e=0;e<t.length;e++)n[e]=t.charCodeAt(e);const a=new Uint8Array(n),s=new Blob([a],{type:i}),o=document.createElement("a");o.href=URL.createObjectURL(s),o.setAttribute("visibility","hidden"),o.download=e,document.body.appendChild(o),o.click(),document.body.removeChild(o)}static dataURLtoFile(t,e){const i=t.split(","),n=i[0].match(/:(.*?);/)[1],a=atob(i[1]);let s=a.length;const o=new Uint8Array(s);for(;s--;)o[s]=a.charCodeAt(s);return new File([o],e,{type:n})}static resizeImage(t,e,i){return new Promise(((n,s)=>{try{const s=new Image;s.onload=()=>{const o=s.width,r=s.height;let h=document.createElement("canvas");if(o>e||r>e){const t=o/r;o>=r?(h.width=e,h.height=e/t):(h.height=e,h.width=e*t)}else h.width=o,h.height=r;if(h.getContext("2d").drawImage(s,0,0,h.width,h.height),i)h.toBlob((e=>{a.copyExifWithoutOrientation(t,e).then((e=>{const i=e;i.lastModifiedDate=new Date,i.name=t.name,h=null,n(new File([e],"userImage.jpg",{lastModified:(new Date).getTime(),type:e.type}))})).catch((e=>{console.debug("Cannot copy exif data, executing resizing without exif data: "+e);const i=h.toDataURL("image/jpeg");h=null,n(a.dataURLtoFile(i,t.name))}))}),"image/jpeg");else{const e=h.toDataURL("image/jpeg");h=null,n(a.dataURLtoFile(e,t.name))}},s.src=URL.createObjectURL(t)}catch(t){console.log("resizeImage error: "+JSON.stringify(t)),s(t)}}))}static copyExif(t,e){return new Promise(((i,n)=>{a.retrieveExif(t).then((t=>{i(new Blob([e.slice(0,2),t,e.slice(2)],{type:"image/jpeg"}))})).catch((t=>{n(t)}))}))}static retrieveExif(t){return new Promise(((e,i)=>{const n=new FileReader;n.addEventListener("load",(({target:{result:n}})=>{const a=new DataView(n);let s=0;if(65496!==a.getUint16(s))return i("not a valid jpeg");for(s+=2;;){const i=a.getUint16(s);if(65498===i)break;const n=a.getUint16(s+2);if(65505===i&&1165519206===a.getUint32(s+4))return e(t.slice(s,s+2+n));s+=2+n}return e(new Blob)})),n.readAsArrayBuffer(t)}))}static copyExifWithoutOrientation(t,e){return new Promise(((i,n)=>{a.retrieveExifWithoutOrientation(t).then((t=>{i(new Blob([e.slice(0,2),t,e.slice(2)],{type:"image/jpeg"}))})).catch((t=>{n(t)}))}))}static retrieveExifWithoutOrientation(t){return new Promise(((e,i)=>{const n=new FileReader;n.addEventListener("load",(({target:{result:t}})=>{const n=new DataView(t);let a=0;if(65496!==n.getUint16(a))return i("not a valid JPEG");for(a+=2;;){const s=n.getUint16(a);if(65498===s)break;const o=n.getUint16(a+2);if(65505===s&&1165519206===n.getUint32(a+4)){const s=a+10;let r;switch(n.getUint16(s)){case 18761:r=!0;break;case 19789:r=!1;break;default:return i("TIFF header contains invalid endian")}if(42!==n.getUint16(s+2,r))return i("TIFF header contains invalid version");const h=n.getUint32(s+4,r);let l=s+h+2+12*n.getUint16(s+h,r);for(let t=s+h+2;t<l;t+=12){if(274==n.getUint16(t,r)){if(3!==n.getUint16(t+2,r))return i("Orientation data type is invalid");if(1!==n.getUint32(t+4,r))return i("Orientation data count is invalid");n.setUint16(t+8,1,r);break}}return e(t.slice(a,a+2+o))}a+=2+o}return e(new Blob)})),n.readAsArrayBuffer(t)}))}}},function(t,e,i){"use strict";i.d(e,"a",(function(){return u}));var n=i(1),a=i(27),s=i(7),o=i(23),r=i(25),h=i(56),l=i(22);const c="D3DGIZMOROTY";var d;!function(t){t[t.NONE=0]="NONE",t[t.ROTATEY=1]="ROTATEY"}(d||(d={}));class u{static isGizmoPart(t){return t.name==c}setVisibility(t){this.gizmoObject3D&&(this.gizmoObject3D.visible=t)}constructor(t,e,i){this.sceneControls=t,this.gizmoConfig=e,this.scene=i,this.onPointerDown=t=>{console.debug("[GizmoControl] intersections: "+t.intersections.length+" - pointer: "+JSON.stringify(t.pointer));for(const e of t.intersections)if(this.gizmoInteractionObject=s.a.getSelfOrAncestorObject3D(e.object,(t=>t.name==c)),console.debug("[GizmoControl] gizmoObj: "+(this.gizmoInteractionObject?this.gizmoInteractionObject.name:null)),this.gizmoInteractionObject){t.target=e,t.handled=!0,this.gizmoStatus=d.ROTATEY,console.debug("[GizmoControl] arrow clicked");break}if(null==this.gizmoInteractionObject){console.debug("[GizmoControl] checking tap area");for(const e of t.intersections){const t=e;if("RUG-TOP"==t.object.name||"RUG-BORDER"==t.object.name)return}const e=t.pointer.x,i=t.pointer.y;for(const a of this.gizmoObject3D.children)if(a.name==c){const o=new n.Vector3;o.setFromMatrixPosition(a.matrixWorld);const r=s.a.worldToViewportPosition(o,this.sceneControls.camera,this.sceneControls.domElement.offsetWidth,this.sceneControls.domElement.offsetHeight,window.devicePixelRatio),h=r.x/window.devicePixelRatio,l=r.y/window.devicePixelRatio;if(Math.abs(h-e)<this.gizmoConfig.tapArea&&Math.abs(l-i)<this.gizmoConfig.tapArea){this.gizmoInteractionObject=a,console.debug("[GizmoControl] tap area threshold ok"),t.target={distance:1,point:o.clone(),object:a},t.handled=!0,this.gizmoStatus=d.ROTATEY;break}}}},this.onPointerUp=()=>{this.gizmoStatus=d.NONE,this.gizmoInteractionObject=null},this.onClick=t=>{},this.onDragStart=t=>{this.gizmoInteractionObject&&(t.handled=!0,this.gizmoStartRotation=this.gizmoObject3D.rotation.clone(),this.gizmoStartPosition=this.gizmoObject3D.position.clone(),this.gizmoInteractionObjectStartPosition=this.gizmoInteractionObject.getWorldPosition(new n.Vector3),this.onChange.notify({type:"BEGIN",target:this.targetObject}))},this.onDrag=t=>{if(this.gizmoInteractionObject&&this.gizmoStatus==d.ROTATEY){t.handled=!0;let e=this.gizmoInteractionObjectStartPosition.clone().add(t.delta).sub(this.gizmoStartPosition),i=this.gizmoInteractionObjectStartPosition.clone().sub(this.gizmoStartPosition),a=this.gizmoObject3D.localToWorld(new n.Vector3(0,1,0)).sub(this.gizmoStartPosition).normalize(),s=i.clone().dot(e),o=a.dot(i.clone().cross(e)),r=Math.atan2(o,s);this.gizmoObject3D.rotation.copy(this.gizmoStartRotation),this.gizmoObject3D.rotateY(r),this.onChange.notify({type:"CHANGED",target:this.targetObject,targetPosition:this.gizmoObject3D.position.clone(),targetRotation:this.gizmoObject3D.rotation.clone(),deltaRotation:r,targetScale:this.gizmoObject3D.scale.clone()})}},this.onDragEnd=t=>{this.gizmoInteractionObject&&(t.handled=!0,this.onChange.notify({type:"END",target:this.targetObject}))},this.onChange=new a.a,this.transparentMaterial=new n.MeshBasicMaterial({color:16777215,transparent:!0,opacity:0,side:n.DoubleSide,alphaTest:.5}),this.arrowWhiteMaterial=new n.MeshBasicMaterial({color:16777215,side:n.DoubleSide,transparent:!1,toneMapped:!1}),this.arrowBlackMaterial=new n.MeshBasicMaterial({color:0,side:n.DoubleSide,transparent:!1,toneMapped:!1})}attach(t,e,i,n){if(null!=this.targetObject)throw new Error("Invalid operation: gizmo is already attached. Invoke detach() first");n&&(this.worldPos=n.clone()),this.isRotationEnabled=e,this.addGizmo(t,i),this.attachEventHandlers()}updateGizmoConfig(t){this.gizmoConfig=t,this.worldPos=null}detach(){this.removeGizmo(),this.detachEventHandlers()}update(t){t&&this.worldPos&&this.worldPos.copy(t.clone()),this.setGizmoObject3DTransform(this.gizmoObject3D,this.targetObject)}attachEventHandlers(){this.sceneControls.addEventListenerAtIndex(o.a.POINTERDOWN,this.onPointerDown,0),this.sceneControls.addEventListenerAtIndex(o.a.POINTERUP,this.onPointerUp,0),this.sceneControls.addEventListenerAtIndex(o.a.DRAGSTART,this.onDragStart,0),this.sceneControls.addEventListenerAtIndex(o.a.DRAG,this.onDrag,0),this.sceneControls.addEventListenerAtIndex(o.a.DRAGEND,this.onDragEnd,0),this.sceneControls.addEventListenerAtIndex(o.a.CLICK,this.onClick,0),this.gizmoConfig.rotateOusideCanvas&&this.sceneControls.attachWindowHandlers()}detachEventHandlers(){this.sceneControls.removeEventListener(o.a.POINTERDOWN,this.onPointerDown),this.sceneControls.removeEventListener(o.a.POINTERUP,this.onPointerUp),this.sceneControls.removeEventListener(o.a.DRAGSTART,this.onDragStart),this.sceneControls.removeEventListener(o.a.DRAG,this.onDrag),this.sceneControls.removeEventListener(o.a.DRAGEND,this.onDragEnd),this.sceneControls.removeEventListener(o.a.CLICK,this.onClick),this.gizmoConfig.rotateOusideCanvas&&this.sceneControls.detachWindowHandlers()}setGizmoObject3DTransform(t,e){t.scale.copy(e.scale),this.worldPos?t.position.copy(this.worldPos):t.position.copy(e.position),t.rotation.copy(e.rotation)}addGizmo(t,e){this.targetObject=t,this.targetObjectOBB=e||s.a.computeOBB(t),this.gizmoObject3D=this.loadGizmoObject3D(this.targetObjectOBB),this.setGizmoObject3DTransform(this.gizmoObject3D,t),this.scene.add(this.gizmoObject3D)}removeGizmo(){this.gizmoObject3D&&(null!=this.gizmoObject3D.parent&&this.gizmoObject3D.parent.remove(this.gizmoObject3D),s.a.disposeObject3D(this.gizmoObject3D,!0),this.gizmoObject3D=null,this.targetObject=null)}loadGizmoObject3D(t){let e=new n.Group;if(e.name="DS3DGIZMO",e.renderOrder=11e3,this.isRotationEnabled)if(this.gizmoConfig)if("RUGSUSA"===this.gizmoConfig.gizmoType)this.buildRugsUsaGizmo(e,t);else this.buildDefaultGizmo(e,t);else this.buildDefaultGizmo(e,t);return e}buildDefaultGizmo(t,e){let i=Math.abs(e.max.x);i-=.02;const a=e.max.y+.01,o=s.a.createCircleLineBufferGeometry(i),r=new n.Line(o,this.transparentMaterial);r.position.y=a+.018,t.add(r);const h=new n.RingGeometry(i,i+.03,64,1),l=new n.MeshBasicMaterial({color:16777215,toneMapped:!1}),d=new n.Mesh(h,l);d.position.y=a+.01,d.rotation.x=-Math.PI/2,t.add(d);const u=new n.RingGeometry(i+.01,i+.02,64,1),p=new n.MeshBasicMaterial({color:0,toneMapped:!1}),g=new n.Mesh(u,p);g.position.y=a+.015,g.rotation.x=-Math.PI/2,t.add(g);let m=.15,f=.02/Math.sqrt(2),y=new n.PlaneGeometry(.2-3*f,m);y.rotateX(-Math.PI/2);let v=new n.Group;v.name=c,v.position.x=i,v.position.y=.001,v.rotation.y=Math.PI/2,r.add(v);let x=v.clone();x.position.x=-i,x.rotation.y=-Math.PI/2,r.add(x);let T=v.clone();T.position.x=0,T.position.z=i,T.rotation.y=0,r.add(T);let M=v.clone();M.position.x=0,M.position.z=-i,M.rotation.y=-Math.PI,r.add(M);let C=new n.Mesh(y,this.transparentMaterial);C.position.x=-f,C.scale.multiplyScalar(1.5),v.add(C);let b=C.clone();x.add(b);let P=C.clone();T.add(P);let E=C.clone();M.add(E);let D=new n.Shape;D.moveTo(0,0),D.lineTo(-.1+f,.075),D.lineTo(-.1,.075-f),D.lineTo(-2*f,0),D.lineTo(-.1,-.075+f),D.lineTo(-.1+f,-.075);let w=.005,S=new n.ExtrudeGeometry([D],{depth:w,bevelEnabled:!1,steps:1});S.rotateX(-Math.PI/2);let I=new n.Mesh(S,this.arrowWhiteMaterial);I.position.y=-.0025,v.add(I);let L=I.clone();L.position.x+=4*f,v.add(L);let A=I.clone();x.add(A);let O=A.clone();O.position.x+=4*f,x.add(O);let R=I.clone();T.add(R);let _=A.clone();_.position.x+=4*f,T.add(_);let k=I.clone();M.add(k);let j=A.clone();j.position.x+=4*f,M.add(j);let N=new n.Mesh(S,this.arrowBlackMaterial);N.position.y=-.0035,N.position.z=.02,v.add(N);let F=N.clone();F.position.x+=4*f,v.add(F);let z=N.clone();x.add(z);let B=z.clone();B.position.x+=4*f,x.add(B);let H=N.clone();T.add(H);let U=z.clone();U.position.x+=4*f,T.add(U);let G=N.clone();M.add(G);let V=z.clone();V.position.x+=4*f,M.add(V)}buildRugsUsaGizmo(t,e){let i;if(this.gizmoConfig.position==l.b.OUTSIDE){const t=Math.abs(e.max.x-e.min.x),n=Math.abs(e.max.z-e.min.z);i=1.4*Math.max(t,n)/2}else i=Math.abs(e.max.x);const a=this.createEllipseMesh(i,i,this.gizmoConfig.whiteLineMaterial);a.position.y=.007,t.add(a);const s=this.createEllipseMesh(i+.008,i+.008,this.gizmoConfig.blackLineMaterial);s.position.y=.009,t.add(s);const o=(new r.e).parse('<svg width="22" height="19" viewBox="0 0 22 19" fill="none"><path d="M20.5303 8.61148L1.49172 0.984742C1.23604 0.882316 0.949384 0.890172 0.699697 1.00645C0.116475 1.27805 -0.0608928 2.02257 0.33723 2.52796L6.09903 9.84207L0.384157 17.2294C0.0193328 17.701 0.182419 18.3889 0.720119 18.6465C0.956482 18.7598 1.22949 18.7687 1.47279 18.6713L20.5303 11.037C21.6244 10.5986 21.6244 9.04979 20.5303 8.61148Z" fill = "white" /></svg>').paths,h=r.e.createShapes(o[0]),d=.1*this.gizmoConfig.scaleFactor,u=.1*this.gizmoConfig.scaleFactor;let p=new n.Group;p.name=c,p.position.x=i,p.position.y=.0075,p.rotation.y=Math.PI/2,t.add(p);const g=p.clone();g.position.x=-i,g.rotation.y=-Math.PI/2,t.add(g);const m=p.clone();m.position.x=0,m.position.z=i,m.rotation.y=0,t.add(m);const f=p.clone();f.position.x=0,f.position.z=-i,f.rotation.y=-Math.PI,t.add(f);const y=new n.PlaneGeometry(d,u);y.rotateX(-Math.PI/2);const v=new n.Mesh(y,this.transparentMaterial);v.scale.multiplyScalar(3.5),p.add(v);const x=v.clone();g.add(x);const T=v.clone();m.add(T);const M=v.clone();f.add(M);const C=new n.ShapeGeometry(h[0]);C.scale(.01*this.gizmoConfig.scaleFactor,.01*this.gizmoConfig.scaleFactor,.01*this.gizmoConfig.scaleFactor),C.rotateX(-Math.PI/2);const b=new n.Mesh(C,this.arrowWhiteMaterial);b.position.x=-d,b.position.z=u,b.position.y=.0077,p.add(b);const P=o[0].subPaths[0].getPoints(),E=this.getArrowContourMesh(P,.01*this.gizmoConfig.scaleFactor,this.gizmoConfig.blackLineMaterial);E.position.x=-d,E.position.z=-u,E.position.y=.0077,p.add(E);const D=b.clone();g.add(D);const w=E.clone();g.add(w);const S=b.clone();m.add(S);const I=E.clone();m.add(I);const L=b.clone();f.add(L);const A=E.clone();if(f.add(A),8==this.gizmoConfig.nArrow){const e=p.clone();e.position.x=i*Math.cos(Math.PI/4),e.position.z=-i*Math.cos(Math.PI/4),e.rotation.y=3*Math.PI/4,t.add(e);const n=p.clone();n.position.x=i*Math.cos(Math.PI/4),n.position.z=i*Math.cos(Math.PI/4),n.rotation.y=Math.PI/4,t.add(n);const a=p.clone();a.position.x=-i*Math.cos(Math.PI/4),a.position.z=-i*Math.cos(Math.PI/4),a.rotation.y=3*-Math.PI/4,t.add(a);const s=p.clone();s.position.x=-i*Math.cos(Math.PI/4),s.position.z=i*Math.cos(Math.PI/4),s.rotation.y=-Math.PI/4,t.add(s);const o=v.clone();e.add(o);const r=v.clone();n.add(r);const h=v.clone();a.add(h);const l=v.clone();s.add(l);const c=b.clone();e.add(c);const d=E.clone();e.add(d);const u=b.clone();n.add(u);const g=E.clone();n.add(g);const m=b.clone();a.add(m);const f=E.clone();a.add(f);const y=b.clone();s.add(y);const x=E.clone();s.add(x)}}createEllipseMesh(t,e,i){const a=new n.EllipseCurve(0,0,e,t,0,2*Math.PI,!1,0).getPoints(150),s=[],o=[],h=new n.Color(i.color);for(let t=0;t<a.length;t++){const e=(t+1)%a.length;s.push(a[t].x,0,a[t].y),s.push(a[e].x,0,a[e].y),o.push(h.r,h.g,h.b,h.r,h.g,h.b)}const l=new r.c;l.setPositions(s),l.setColors(o);const c=new r.b(l,i);return c.computeLineDistances(),c.scale.set(1,1,1),c}getArrowContourMesh(t,e,i){const a=[],s=[],o=Object(h.a)(t,210),l=new n.Color(i.color);for(let t=0;t<o.length;t++){const i=(t+1)%o.length;a.push(o[t].x*e,0,o[t].y*e),a.push(o[i].x*e,0,o[i].y*e),s.push(l.r,l.g,l.b,l.r,l.g,l.b)}const c=new r.c;c.setPositions(a),c.setColors(s);const d=new r.b(c,i);return d.computeLineDistances(),d.scale.set(1,1,1),d}}},function(t,e,i){"use strict";i.d(e,"b",(function(){return n})),i.d(e,"a",(function(){return o}));var n,a=i(13),s=i(12);!function(t){t.FLOOR="MaskFloor",t.WALL="MaskWalls",t.ALL="MaskAll"}(n||(n={}));a.a;a.a;a.a;class o extends a.a{constructor(t,e,i,n,a){super(),this.id=t,this.src=e,this.indexes=i,this.reflection=n,this.shading=a,this.type=s.t.DTMask,this.version=4,this.contour2d=[]}static fromJSON(t){if("string"==typeof t)return JSON.parse(t,o.reviver);{let e=t.version;e||(e=1);let i=t;switch(e){case 1:{let t=i,e=Object.create(o.prototype);Object.assign(e,t,{hasReflection:!1,version:2}),i=e}case 2:{let t=i,e=Object.create(o.prototype);Object.assign(e,t,{hasReflection:!1,version:3}),e.reflection=t.exposure,delete e.exposure,delete e.hasReflections,i=e}case 3:{let t=i,e=Object.create(o.prototype);Object.assign(e,t,{contour2d:[],version:4}),i=e}}return i}}static reviver(t,e){return""===t?o.fromJSON(e):e}}},function(t,e,i){"use strict";i.d(e,"a",(function(){return St}));class n{constructor(t,e){if(this.compare=this.defaultComparator,this.data=t||[],this.length=this.data.length,e&&(this.compare=e),t)for(let t=Math.floor(this.length/2);t>=0;t--)this.bubbleDown(t)}defaultComparator(t,e){return t<e?-1:t>e?1:0}swap(t,e,i){const n=t[e];t[e]=t[i],t[i]=n}push(t){this.data.push(t),this.length++,this.bubbleUp(this.length-1)}pop(){const t=this.data[0];return this.data[0]=this.data[this.length-1],this.length--,this.data.pop(),this.bubbleDown(0),t}peek(){return this.data[0]}bubbleUp(t){const e=this.data,i=this.compare;for(;t>0;){const n=Math.floor((t-1)/2);if(!(i(e[t],e[n])<0))break;this.swap(e,n,t),t=n}}bubbleDown(t){const e=this.data,i=this.compare,n=this.length;for(;;){const a=2*t+1,s=a+1;let o=t;if(a<n&&i(e[a],e[o])<0&&(o=a),s<n&&i(e[s],e[o])<0&&(o=s),o===t)return;this.swap(e,o,t),t=o}}}const a=1e-8;function s(t){return Math.abs(t)<a}function o(t,e){return Math.abs(t-e)<=a+a*Math.abs(e)}function r(t){return t>a}function h(t){return t<-a}function l(t,e){return t-e>a+a*Math.abs(e)}function c(t,e){return e-t>a+a*Math.abs(e)}function d(t){return t>-a}function u(t){return t<a}function p(t,e){return t-e>-(a+a*Math.abs(e))}function g(t,e){return t.x*e.x+t.y*e.y}function m(t){return{x:t.x,y:t.y}}function f(t,e){let i=e.x-t.x,n=e.y-t.y;return Math.sqrt(i*i+n*n)}function y(t,e){return{x:t.x-e.x,y:t.y-e.y}}function v(t,e){return{x:(t.x+e.x)/2,y:(t.y+e.y)/2}}function x(t,e){return{x:t.x+e.x,y:t.y+e.y}}function T(t){return Math.sqrt(t.x*t.x+t.y*t.y)}function M(t){return t.x*t.x+t.y*t.y}function C(t,e){return{x:t*e.x,y:t*e.y}}function b(t,e){let i=t.xo-e.xo,n=t.yo-e.yo,a=t.dx*t.dx+t.dy*t.dy,o=e.dx*e.dx+e.dy*e.dy,r=t.dx*e.dx+t.dy*e.dy,h=t.dx*i+t.dy*n,l=e.dx*i+e.dy*n,c=r*r-o*a;if(s(c))return null;let d=(r*h-a*l)/c;return{x:e.xo+d*e.dx,y:e.yo+d*e.dy}}function P(t,e){return{xo:t.x,yo:t.y,dx:e.x-t.x,dy:e.y-t.y}}Math.PI;const E=.5*Math.PI,D=(Math.PI,Math.PI),w=(Math.PI,1.5*Math.PI),S=(Math.PI,2*Math.PI);function I(t){return s(t)?0:(Math.sqrt(1+t*t)-1)/t}function L(t,e){let i=0,n=e.x-t.x,a=e.y-t.y;if(s(n)&&s(a))return 0;switch(d((l={x:n,y:a}).x)&&d(l.y)?1:h(l.x)&&d(l.y)?2:h(l.x)&&h(l.y)?3:4){case 1:if(r(n)){i=I(a/n)}else i=1;break;case 2:if(r(a)){i=1+I(-n/a)}else i=2;break;case 3:if(h(n)){i=2+I(a/n)}else i=3;break;case 4:if(h(a)){i=3+I(-n/a)}else i=0}return function(t){let e=t;if(u(e))return s(e),0;{if(o(e,1))return.5*Math.PI;if(o(e,2))return Math.PI;if(o(e,3))return 1.5*Math.PI;for(;p(e,4);)e-=4;let t=e%1,i=2*Math.atan(t);return s(t)?o(e,1)?.5*Math.PI:o(e,2)?Math.PI:o(e,3)?1.5*Math.PI:0:c(e,1)?i:p(e,1)&&c(e,2)?Math.PI/2+i:p(e,2)&&c(e,3)?Math.PI+i:p(e,3)&&c(e,4)?1.5*Math.PI+i:0}}(i);var l}function A(t){return s(t)?0:t}function O(t,e,i){let n={x:0,y:0},a=i;for(;h(a);)a+=S;for(;p(a,S);)a-=S;return l(a,w)?(a-=w,n.x=e*Math.sin(a),n.y=-e*Math.cos(a)):l(a,D)?(a-=Math.PI,n.x=-e*Math.cos(a),n.y=-e*Math.sin(a)):l(a,E)?(a-=E,n.x=-e*Math.sin(a),n.y=e*Math.cos(a)):(n.x=e*Math.cos(a),n.y=e*Math.sin(a)),n.x=A(t.x+n.x),n.y=A(t.y+n.y),n}function R(t,e,i,n){let a,o=y(t,i),l=M(o)-n*n,c=g(e,o),d=M(e);if(s(d))return a;let u=c*c-l*d;return r(u)?(u=Math.sqrt(u),a.push((-c-u)/d),a.push((-c+u)/d)):h(u)||a.push(-c/d),a}function _(t,e,i){let n=y(i,t),a=y(e,t);var s,o;return(o=a,(s=n).x*o.y-s.y*o.x)>=0}const k=1e-4;function j(t,e,i,n,a,s){const o=(s-e)*(i-t)-(n-e)*(a-t);return o>0||!(o<0)}function N(t,e,i=k){return Math.abs(t-e)<i}function F(t,e,i,n,a,s){let o=i,r=n,h=a-o,l=s-r;if(0!==h||0!==l){const i=((t-o)*h+(e-r)*l)/(h*h+l*l);i>1?(o=a,r=s):i>0&&(o+=h*i,r+=l*i)}return h=t-o,l=e-r,h*h+l*l}function z(t,e,i,n,a,s,o,r,h){return B(t,e,i,n,a,s,o,r,!1,h)}function B(t,e,i,n,a,s,o,r,c,d=k){const u=i-t,p=n-e,g=o-a,m=r-s,f=m*u-g*p;if(Math.abs(f)>d){const i=(-p*(t-a)+u*(e-s))/(-g*p+u*m),n=(g*(e-s)-m*(t-a))/(-g*p+u*m);if(c||!h(i)&&!l(i,1)&&!h(n)&&!l(n,1)){return{x:t+n*u,y:e+n*p}}}return null}function H(t,e,i){let n=!1,a=1/0;for(let s=0;s<i.length;s++){const o=i[s];for(let i=0,s=o.length,r=s-1;i<s;r=i++){const s=o[i],h=o[r];s.y>e!=h.y>e&&t<(h.x-s.x)*(e-s.y)/(h.y-s.y)+s.x&&(n=!n),a=Math.min(a,F(t,e,s.x,s.y,h.x,h.y))}}return(n?1:-1)*Math.sqrt(a)}function U(t){let e=0,i=0,n=0;const a=t.length;let s,o,r;for(let h=0,l=a-1;h<a;l=h++)s=t[h],o=t[l],r=s.x*o.y-o.x*s.y,e+=r,i+=(s.x+o.x)*r,n+=(s.y+o.y)*r;return r=3*e,N(r,0)?{x:0,y:0}:{x:i/r,y:n/r}}function G(t){let e=0;let i,n;for(let a=0,s=t.length;a<s;a++)i=t[a],n=t[a===t.length-1?0:a+1],e+=i.x*n.y*.5,e-=n.x*i.y*.5;return e}function V(t){if(!t||0==t.length)return{min:{x:0,y:0},max:{x:0,y:0}};const e=m(t[0]),i=m(t[0]);for(let n=0;n<t.length;n++){const a=t[n];a.x<e.x&&(e.x=a.x),a.y<e.y&&(e.y=a.y),a.x>i.x&&(i.x=a.x),a.y>i.y&&(i.y=a.y)}return{min:e,max:i}}class W{constructor(t,e,i,n){this.x=t,this.y=e,this.h=i,this.x=t,this.y=e,this.h=i,this.d=H(t,e,n),this.max=this.d+this.h*Math.SQRT2}}function J(t,e){return N(e.max,t.max)?0:e.max-t.max}function q(t,e){const i={x:0,y:0};return i.x=e[0][0]*t.x+e[0][1]*t.y+e[0][2],i.y=e[1][0]*t.x+e[1][1]*t.y+e[1][2],i}function K(t,e){return{x:t.x-e.x,y:t.y-e.y,z:t.z-e.z}}function Y(t){return Math.sqrt(t.x*t.x+t.y*t.y+t.z*t.z)}function $(t){let e=Y(t);return!s(e)&&(e=1/e,t.x*=e,t.y*=e,t.z*=e,!0)}function X(t){return nt(t,{x:-1,y:-1,z:-1})}function Q(t,e){return{x:t.y*e.z-e.y*t.z,y:e.x*t.z-t.x*e.z,z:t.x*e.y-e.x*t.y}}function Z(t,e){return t.x*e.x+t.y*e.y+t.z*e.z}function tt(t,e){e.x=t.x,e.y=t.y,e.z=t.z}function et(t){return{x:t.x,y:t.y,z:t.z}}function it(t,e){return o(t.x,e.x)&&o(t.y,e.y)&&o(t.z,e.z)}function nt(t,e){return{x:t.x*e.x,y:t.y*e.y,z:t.z*e.z}}function at(t,e,i){return{x:t.x+i*e.x,y:t.y+i*e.y}}function st(t,e){return{x:t[0][0]*e.x+t[1][0]*e.y+t[2][0]*e.z+t[3][0],y:t[0][1]*e.x+t[1][1]*e.y+t[2][1]*e.z+t[3][1],z:t[0][2]*e.x+t[1][2]*e.y+t[2][2]*e.z+t[3][2]}}function ot(t,e){const i=e.length;for(let n=0;n<i;n++){const i=t[0][0]*e[n].x+t[1][0]*e[n].y+t[2][0]*e[n].z+t[3][0],a=t[0][1]*e[n].x+t[1][1]*e[n].y+t[2][1]*e[n].z+t[3][1],s=t[0][2]*e[n].x+t[1][2]*e[n].y+t[2][2]*e[n].z+t[3][2];e[n].x=i,e[n].y=a,e[n].z=s}}function rt(){return[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]]}function ht(t){for(let e=0;e<4;e++)for(let i=0;i<4;i++)t[e][i]=e===i?1:0}function lt(t,e){return{x:t[e][0],y:t[e][1],z:t[e][2]}}function ct(t,e,i){t[e][0]=i.x,t[e][1]=i.y,t[e][2]=i.z,t[e][3]=0}function dt(t,e){const i=[[],[],[],[]];let n;for(let t=0;t<4;t++)for(let n=0;n<4;n++)i[t][n]=e[t][n];for(let a=0;a<4;a++)for(let s=0;s<4;s++){n=0;for(let e=0;e<4;e++)n+=i[a][e]*t[e][s];e[a][s]=n}}function ut(t,e){return{a:e.x,b:e.y,c:e.z,d:-Z(t,e)}}function pt(t){return{x:t.a,y:t.b,z:t.c}}function gt(t,e){const i=e.a*t.dx+e.b*t.dy+e.c*t.dz;if(s(i))return null;const n=-(e.a*t.xo+e.b*t.yo+e.c*t.zo+e.d)/i;return{x:t.xo+n*t.dx,y:t.yo+n*t.dy,z:t.zo+n*t.dz}}function mt(t,e,i){if(s(i.x)&&s(i.y)&&s(i.z))return!0;let n=Number.MAX_VALUE,a=Number.MIN_VALUE,o=Number.MAX_VALUE,r=Number.MIN_VALUE;for(const e of t){const t=Z(e,i);n=t<n?t:n,a=t>a?t:a}for(let t of e){const e=Z(t,i);o=e<o?e:o,r=e>r?e:r}if(s(r-o))return s(a-n)?s(r-a):n<r&&r<a;if(s(a-n))return o<a&&a<r;return Math.max(a,r)-Math.min(n,o)<a-n+r-o}function ft(t){const e=function(t){let e=0;for(let i=1;i<t.length;i++)(c(t[i].x,t[e].x)||o(t[i].x,t[e].x)&&(c(t[i].y,t[e].y)||o(t[i].y,t[e].y)&&c(t[i].z,t[e].z)))&&(e=i);return e}(t),i=t[yt(e,t.length)],n=t[vt(e,t.length)],a=function(t,e,i){const n=K(t,e),a=K(e,i),s=Q(n,a);return $(s),s}(i,t[e],n);return X(a)}function yt(t,e){return t+1<e?t+1:0}function vt(t,e){return t>0?t-1:e-1}function xt(){return{min:{x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY,z:Number.POSITIVE_INFINITY},max:{x:Number.NEGATIVE_INFINITY,y:Number.NEGATIVE_INFINITY,z:Number.NEGATIVE_INFINITY}}}function Tt(t,e){e.x<t.min.x&&(t.min.x=e.x),e.y<t.min.y&&(t.min.y=e.y),e.z<t.min.z&&(t.min.z=e.z),e.x>t.max.x&&(t.max.x=e.x),e.y>t.max.y&&(t.max.y=e.y),e.z>t.max.z&&(t.max.z=e.z)}function Mt(t){const e=[];return e.push({x:t.min.x,y:t.min.y,z:t.min.z}),e.push({x:t.max.x,y:t.min.y,z:t.min.z}),e.push({x:t.min.x,y:t.max.y,z:t.min.z}),e.push({x:t.max.x,y:t.max.y,z:t.min.z}),e.push({x:t.min.x,y:t.min.y,z:t.max.z}),e.push({x:t.max.x,y:t.min.y,z:t.max.z}),e.push({x:t.min.x,y:t.max.y,z:t.max.z}),e.push({x:t.max.x,y:t.max.y,z:t.max.z}),e}function Ct(t){const e=xt();for(let i=0;i<t.length;i++)Tt(e,t[i]);return e}function bt(){return{min:{x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY},max:{x:Number.NEGATIVE_INFINITY,y:Number.NEGATIVE_INFINITY}}}function Pt(t,e){e.x<t.min.x&&(t.min.x=e.x),e.y<t.min.y&&(t.min.y=e.y),e.x>t.max.x&&(t.max.x=e.x),e.y>t.max.y&&(t.max.y=e.y)}function Et(){return[[1,0,0],[0,1,0],[0,0,1]]}function Dt(t,e){const i=[[],[],[]];let n;for(let t=0;t<3;t++)for(let n=0;n<3;n++)i[t][n]=e[t][n];for(let a=0;a<3;a++)for(let s=0;s<3;s++){n=0;for(let e=0;e<3;e++)n+=i[a][e]*t[e][s];e[a][s]=n}}function wt(t,e){return{x:t[0][0]*e.x+t[1][0]*e.y+t[2][0],y:t[0][1]*e.x+t[1][1]*e.y+t[2][1]}}const St={ccw:j,clamp:function(t,e,i){return Math.max(e,Math.min(i,t))},wrap:function(t,e,i){return e+function(t,e){return(e+t%e)%e}(t-e,i-e)},floatEquals:N,round:function(t,e){const i=Math.pow(10,e);return Math.round(t*i)/i},degToRad:function(t){return Math.PI/180*t},radToDeg:function(t){return 180/Math.PI*t},angleValueXY:function(t,e){let i;if(s(i=Math.sqrt(t*t+e*e)))return 0;const n=Math.acos(t/i);return e<0?2*Math.PI-n:n},getDominantAxis:function(t,e,i){t=Math.abs(t),e=Math.abs(e),i=Math.abs(i);const n=Math.max(t,Math.max(e,i));return n==t?0:n==e?1:2},line2Intersection:function(t,e,i,n,a,s,o,r,h){return B(t,e,i,n,a,s,o,r,!0,h)},line2SegmentsIntersection:z,line2SegmentsIntersectionExists:function(t,e,i,n,a,s,o,r){return j(t,e,a,s,o,r)!=j(i,n,a,s,o,r)&&j(t,e,i,n,a,s)!=j(t,e,i,n,o,r)},line2SegmentDistanceToPointSq:F,mat2DCreate:function(t,e,i,n,a,s){let o;return o=0===arguments.length?[[1,0,0],[0,1,0]]:[[t,e,i],[n,a,s]],o},mat2DRotate:function(t,e){const i=Math.sin(e),n=Math.cos(e),a=[[],[]];return a[0][0]=t[0][0]*n+t[0][1]*i,a[1][0]=t[1][0]*n+t[1][1]*i,a[0][1]=t[0][0]*-i+t[0][1]*n,a[1][1]=t[1][0]*-i+t[1][1]*n,a[0][2]=t[0][2],a[1][2]=t[1][2],a},mat2DTranslate:function(t,e,i){const n=[[],[]];return n[0][0]=t[0][0],n[1][0]=t[1][0],n[0][1]=t[0][1],n[1][1]=t[1][1],n[0][2]=t[0][0]*e+t[0][1]*i+t[0][2],n[1][2]=t[1][0]*e+t[1][1]*i+t[1][2],n},mat2DInvert:function(t){const e=[[],[]];let i=t[0][0]*t[1][1]-t[1][0]*t[0][1];return i?(i=1/i,e[0][0]=t[1][1]*i,e[1][0]=-t[1][0]*i,e[0][1]=-t[0][1]*i,e[1][1]=t[0][0]*i,e[0][2]=(t[0][1]*t[1][2]-t[1][1]*t[0][2])*i,e[1][2]=(t[1][0]*t[0][2]-t[0][0]*t[1][2])*i,e):null},mat2DTransformVec2:q,mat2DTransformVec2Array:function(t,e){const i=[];for(let n=0;n<t.length;n++)i.push(q(t[n],e));return i},poly2ToPoly3:function(t,e,i){const n=[];for(let a=0;a<t.length;a++){const s=st(e,{x:t[a].x,y:t[a].y,z:i});n.push(s)}return n},poly2IsConvex:function(t){let e=!1;const i=t.length;if(i<4)return!0;for(let n=0;n<i;n++){const a=t[(n+2)%i].x-t[(n+1)%i].x,s=t[(n+2)%i].y-t[(n+1)%i].y,o=t[n].x-t[(n+1)%i].x,r=a*(t[n].y-t[(n+1)%i].y)-s*o;if(!N(r,0))if(0===n)e=r>0;else if(e!==r>0)return!1}return!0},poly2ContainsPoint:function(t,e){for(var i=!1,n=-1,a=e.length,s=a-1;++n<a;s=n)(e[n].y<=t.y&&t.y<e[s].y||e[s].y<=t.y&&t.y<e[n].y)&&t.x<(e[s].x-e[n].x)*(t.y-e[n].y)/(e[s].y-e[n].y)+e[n].x&&(i=!i);return i},poly2Area:function(t){return Math.abs(G(t))},poly2SignedArea:G,poly2SignedDistanceToPoint:H,poly2Centroid:U,poly2BoundingBox:V,poly2IsSelfIntersecting:function(t){const e=t.length;for(let i=0;i<e;i++){const n=t[i],a=t[(i+1)%e];for(let s=0;s<e;s++)if(i!==s){const i=t[s],o=t[(s+1)%e];if(z(n.x,n.y,a.x,a.y,i.x,i.y,o.x,o.y)&&(!N(a.x,i.x)||!N(a.y,i.y))&&(!N(o.x,n.x)||!N(o.y,n.y))&&(!N(n.x,i.x)||!N(n.y,i.y))&&(!N(a.x,o.x)||!N(a.y,o.y)))return!0}}return!1},poly2PoleOfInaccessibility:function(t,e=1,i=.1){const a=V(t[0]),s=a.max.x-a.min.x,o=a.max.y-a.min.y,r=Math.min(s,o);let h=r/2;const l=new n(null,J);if(0===r)return{x:a.min.x,y:a.min.y};for(let e=a.min.x;e<a.max.x;e+=r)for(let i=a.min.y;i<a.max.y;i+=r)l.push(new W(e+h,i+h,h,t));const c=U(t[0]);let d=new W(c.x,c.y,0,t);const u=new W(a.min.x+s/2,a.min.y+o/2,0,t);u.d-d.d>i&&(d=u);let p=l.length;for(;l.length;){const n=l.pop();n.d-d.d>i&&(d=n),n.max-d.d<=e||(h=n.h/2,p+=4,l.push(new W(n.x-h,n.y-h,h,t)),l.push(new W(n.x+h,n.y-h,h,t)),l.push(new W(n.x-h,n.y+h,h,t)),l.push(new W(n.x+h,n.y+h,h,t)))}return{x:d.x,y:d.y}},parmEq:o,parmGe:p,parmGeZero:d,parmGt:l,parmGtZero:r,parmLe:function(t,e){return e-t>-(a+a*Math.abs(e))},parmLeZero:u,parmLt:c,parmLtZero:h,parmZero:s,vec3Add:function(t,e){return{x:t.x+e.x,y:t.y+e.y,z:t.z+e.z}},vec3Distance:function(t,e){const i=e.x-t.x,n=e.y-t.y,a=e.z-t.z;return Math.sqrt(i*i+n*n+a*a)},vec3Diff:K,vec3Mod:Y,vec3Negate:X,vec3Normalize:$,vec3MultVect:Q,vec3MultScal:Z,vec3Copy:tt,vec3Clone:et,vec3ArrayClone:function(t){const e=[];for(let i of t)e.push(et(i));return e},vec3Equals:it,vec3Scale:nt,vec3ProjectTo:function(t,e,i,n){const a=-(n+Z(t,i))/Z(e,i);return{x:t.x+a*e.x,y:t.y+a*e.y,z:t.z+a*e.z}},vec2Copy:function(t,e){e.x=t.x,e.y=t.y},vec2Clone:m,vec2ArrayClone:function(t){let e=[];for(let i of t)e.push(m(i));return e},vec2Distance:f,vec2Diff:y,vec2Mid:v,vec2Add:x,vec2Equals:function(t,e){return o(t.x,e.x)&&o(t.y,e.y)},vec2Mod:T,vec2Normalize:function(t){let e=T(t);return!s(e)&&(e=1/e,t.x*=e,t.y*=e,!0)},vec2MultScal:g,vec2Mult:C,vec2PerpClockwise:function(t){return{x:t.y,y:-t.x}},vec2PerpCounterClockwise:function(t){return{x:-t.y,y:t.x}},vec2Scale:function(t,e){return{x:t.x*e,y:t.y*e}},vec2Angle:function(t,e){return Math.atan2(e.y-t.y,e.x-t.x)},pnt2Move:at,pnt2Project:function(t,e,i){const n=y(t,e),a=y(i,e);return at(e,a,g(n,a)/g(a,a))},pnt2NearestPointOnLine:function(t,e,i){const n=y(e.p2,e.p1),a=n.x*n.x+n.y*n.y;if(s(a)){const n=e.p1;return i.x=n.x,i.y=n.y,f(t,e.p1)}const o=((t.x-e.p1.x)*n.x+(t.y-e.p1.y)*n.y)/a;if(h(o)||l(o,1)){const n=f(t,e.p1),a=f(t,e.p2),s=n<a?e.p1:e.p2;return i.x=s.x,i.y=s.y,Math.min(n,a)}const r=at(e.p1,n,o);return i.x=r.x,i.y=r.y,f(t,i)},pnt3Move:function(t,e,i){return{x:t.x+i*e.x,y:t.y+i*e.y,z:t.z+i*e.z}},pnt3Transform:st,pnt3TransformArray:function(t,e){const i=[];for(let n=0;n<e.length;n++)i.push(st(t,e[n]));return i},pnt3TransformPoints:ot,pnt3Flatten:function(t){const e=[];for(let i=0;i<t.length;i++)e.push(t[i].x,t[i].y,t[i].z);return e},mat4GetIdentity:rt,mat4SetIdentity:ht,mat4SetScale:function(t,e){t[0][0]=e.x,t[1][1]=e.y,t[2][3]=e.z},mat4Clone:function(t){const e=[[],[],[],[]];for(let i=0;i<4;i++)for(let n=0;n<4;n++)e[i][n]=t[i][n];return e},mat4Copy:function(t,e){for(let i=0;i<4;i++)for(let n=0;n<4;n++)e[i][n]=t[i][n]},mat4GetPosition:function(t){return{x:t[3][0],y:t[3][1],z:t[3][2]}},mat4SetPosition:function(t,e){t[3][0]=e.x,t[3][1]=e.y,t[3][2]=e.z},mat4GetPositionX:function(t){return t[3][0]},mat4GetPositionY:function(t){return t[3][1]},mat4GetPositionZ:function(t){return t[3][2]},mat4SetPositionX:function(t,e){t[3][0]=e},mat4SetPositionY:function(t,e){t[3][1]=e},mat4SetPositionZ:function(t,e){t[3][2]=e},mat4GetRow:lt,mat4SetRow:ct,mat4MakeBasis:function(t,e,i,n){ht(t),ct(t,0,e),ct(t,1,i),ct(t,2,n)},mat4Mult:dt,mat4GetMult:function(t,e){const i=[[],[],[],[]];let n;for(let a=0;a<4;a++)for(let s=0;s<4;s++){n=0;for(let i=0;i<4;i++)n+=e[a][i]*t[i][s];i[a][s]=n}return i},mat4Translate:function(t,e,i,n){const a=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];a[3][0]=e,a[3][1]=i,a[3][2]=n,dt(a,t)},mat4RotX:function(t,e){const i=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];i[1][1]=i[2][2]=Math.cos(e),i[2][1]=-(i[1][2]=Math.sin(e)),dt(i,t)},mat4RotY:function(t,e){const i=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];i[0][0]=i[2][2]=Math.cos(e),i[0][2]=-(i[2][0]=Math.sin(e)),dt(i,t)},mat4RotZ:function(t,e){const i=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];i[0][0]=i[1][1]=Math.cos(e),i[1][0]=-(i[0][1]=Math.sin(e)),dt(i,t)},mat4SetRotationFromVectToVect:function(t,e,i){const n={x:t.x,y:t.y,z:t.z},a={x:e.x,y:e.y,z:e.z},s=Q(n,a);if(r(Y(s))){const t=Z(n,a),e=1/(1+t);i[0][0]=t+e*s.x*s.x,i[0][1]=e*s.x*s.y-s.z,i[0][2]=e*s.x*s.z+s.y,i[0][3]=0,i[1][0]=e*s.x*s.y+s.z,i[1][1]=t+e*s.y*s.y,i[1][2]=e*s.y*s.z-s.x,i[1][3]=0,i[2][0]=e*s.x*s.z-s.y,i[2][1]=e*s.y*s.z+s.x,i[2][2]=t+e*s.z*s.z,i[2][3]=0,i[3][0]=0,i[3][1]=0,i[3][2]=0,i[3][3]=1}},mat4GetInverted:function(t){const e=[[],[],[],[]];let i,n,a,o;const r=[[],[],[],[]];for(i=0;i<4;i++){for(n=0;n<4;n++)e[i][n]=0,r[i][n]=t[i][n];e[i][i]=1}for(a=0;a<3;a++){let t,h=0;for(i=a;i<4;i++){let t=Math.abs(r[i][a]);h<t&&(h=t,o=i)}if(s(h))return null;if(o!==a){let t;for(n=a;n<4;n++)t=r[a][n],r[a][n]=r[o][n],r[o][n]=t;for(n=0;n<4;n++)t=e[a][n],e[a][n]=e[o][n],e[o][n]=t}for(i=a+1;i<4;i++){for(t=r[i][a]/r[a][a],n=a+1;n<4;n++)r[i][n]-=t*r[a][n];for(n=0;n<4;n++)e[i][n]-=t*e[a][n]}}if(s(r[3][3]))return null;for(a=0;a<4;a++)for(e[3][a]/=r[3][3],i=2;i>=0;i--){for(n=i+1;n<4;n++)e[i][a]-=r[i][n]*e[n][a];e[i][a]/=r[i][i]}return e},mat4GetTransposed:function(t){const e=[[],[],[],[]];for(let i=0;i<4;i++)for(let n=0;n<4;n++)e[i][n]=t[n][i];return e},mat4Log:function(t){for(let e=0;e<4;e++)console.log(t[e][0]+" "+t[e][1]+" "+t[e][2]+" "+t[e][3])},planeGetNormal:pt,planeGetLineIntersection:gt,planeGetPointProjection:function(t,e,i){const n={x:e.x,y:e.y,z:e.z};return $(n)?gt({xo:t.x,yo:t.y,zo:t.z,dx:n.x,dy:n.y,dz:n.z},i):null},planeFromPointNormal:ut,planeFromCoplanarPoints:function(t){const e=X(ft(t));return $(e)||console.log("Error normalizing plane normal"),ut(t[0],e)},planeEquals:function(t,e){return it(pt(t),pt(e))&&o(t.d,e.d)},pmline2Intersection:b,poly3IntersectsOnAxis:mt,poly3Normal:ft,numberIncr:yt,numberDecr:vt,box2Create:bt,box2Clone:function(t){return{min:m(t.min),max:m(t.max)}},box2GetCenter:function(t){return{x:(t.max.x+t.min.x)/2,y:(t.max.y+t.min.y)/2}},box2GetSize:function(t){return{x:t.max.x-t.min.x,y:t.max.y-t.min.y}},box2Intersects:function(t,e){return!(e.max.x<t.min.x||e.min.x>t.max.x||e.max.y<t.min.y||e.min.y>t.max.y)},box2FromPoints:function(t){const e=bt();for(let i=0;i<t.length;i++)Pt(e,t[i]);return e},box3Create:xt,box3Clone:function(t){return{min:et(t.min),max:et(t.max)}},box3Copy:function(t,e){tt(t.min,e.min),tt(t.max,e.max)},box3GetVertices:Mt,box3GetCenter:function(t){return{x:(t.max.x+t.min.x)/2,y:(t.max.y+t.min.y)/2,z:(t.max.z+t.min.z)/2}},box3Intersects:function(t,e,i,n){const a=Mt(t);ot(e,a);const s=Mt(i);ot(n,s);const o=lt(e,0);if($(o),!mt(a,s,o))return!1;const r=lt(e,1);if($(r),!mt(a,s,r))return!1;const h=lt(e,2);if($(h),!mt(a,s,h))return!1;const l=lt(n,0);if($(l),!mt(a,s,l))return!1;const c=lt(n,1);if($(c),!mt(a,s,c))return!1;const d=lt(n,2);return $(d),!!mt(a,s,d)&&(!!mt(a,s,Q(o,l))&&(!!mt(a,s,Q(r,l))&&(!!mt(a,s,Q(h,l))&&(!!mt(a,s,Q(o,c))&&(!!mt(a,s,Q(r,c))&&(!!mt(a,s,Q(h,c))&&(!!mt(a,s,Q(o,d))&&(!!mt(a,s,Q(r,d))&&!!mt(a,s,Q(h,d))))))))))},box3Scale:function(t,e){return{min:nt(t.min,e),max:nt(t.max,e)}},box3Update:Tt,box3Transform:function(t,e){const i=Mt(t);return ot(e,i),Ct(i)},box3FromPoints:Ct,arcSCE:function(t,e,i){return{rad:f(e,t),sa:L(e,t),ea:L(e,i),cp:m(e)}},arcEndPoints:function(t){return{cp:O(t.cp,t.rad,t.sa),ep:O(t.cp,t.rad,t.ea)}},circleSegmentIntersection:function(t,e){let i,n=P(t.p1,t.p2),a={x:n.xo,y:n.yo},s={x:n.dx,y:n.dy},o=R(a,s,{x:e.cp.x,y:e.cp.y},e.rad),r=o.length;if(0==r)return i;1==r?(o[0]<0||o[0]>1)&&(r=0):o[1]<0||o[0]>1?r=0:o[1]<=1?o[0]<0&&(r=1,o[0]=o[1]):r=o[0]>=0?1:0;for(let t=0;t<r;t++)i.push(x(a,C(o[t],s)));return i},arcSegmentIntersection:function(t,e,i,n,a){let s,o=P(t.p1,t.p2),r={x:o.xo,y:o.yo},h={x:o.dx,y:o.dy},l=R(r,h,{x:e.x,y:e.y},i),c=l.length;if(0==c)return s;1==c?(l[0]<0||l[0]>1)&&(c=0):l[1]<0||l[0]>1?c=0:l[1]<=1?l[0]<0&&(c=1,l[0]=l[1]):c=l[0]>=0?1:0;for(let t=0;t<c;t++){let e=x(r,C(l[t],h));_({x:n.x,y:n.y},{x:a.x,y:a.y},e)&&s.push(e)}return s},mat3GetIdentity:Et,mat3Mult:Dt,mat3Translate:function(t,e,i){const n=[[1,0,0],[0,1,0],[0,0,1]];n[2][0]=e,n[2][1]=i,Dt(n,t)},mat3Rotate:function(t,e){const i=[[1,0,0],[0,1,0],[0,0,1]];i[0][0]=i[1][1]=Math.cos(e),i[1][0]=-(i[0][1]=Math.sin(e)),Dt(i,t)},mat3GetInverted:function(t){const e=[[],[],[]];let i,n,a,o;const r=[[],[],[]];for(i=0;i<3;i++){for(n=0;n<3;n++)e[i][n]=0,r[i][n]=t[i][n];e[i][i]=1}for(a=0;a<2;a++){let t,h=0;for(i=a;i<3;i++){let t=Math.abs(r[i][a]);h<t&&(h=t,o=i)}if(s(h))return null;if(o!==a){let t;for(n=a;n<3;n++)t=r[a][n],r[a][n]=r[o][n],r[o][n]=t;for(n=0;n<3;n++)t=e[a][n],e[a][n]=e[o][n],e[o][n]=t}for(i=a+1;i<3;i++){for(t=r[i][a]/r[a][a],n=a+1;n<3;n++)r[i][n]-=t*r[a][n];for(n=0;n<3;n++)e[i][n]-=t*e[a][n]}}if(s(r[2][2]))return null;for(a=0;a<3;a++)for(e[2][a]/=r[2][2],i=1;i>=0;i--){for(n=i+1;n<3;n++)e[i][a]-=r[i][n]*e[n][a];e[i][a]/=r[i][i]}return e},pnt2Transform:wt,pnt2TransformArray:function(t,e){const i=[];for(let n=0;n<e.length;n++)i.push(wt(t,e[n]));return i},nearestPow2:function(t){return Math.pow(2,Math.round(Math.log(t)/Math.log(2)))}}},function(t,e,i){"use strict";i.d(e,"c",(function(){return v})),i.d(e,"b",(function(){return M})),i.d(e,"a",(function(){return C})),i.d(e,"d",(function(){return b}));var n=i(1),a=i(9),s=i(0),o=i(2),r=i(17),h=i(7),l=i(4),c=i(21),d=i(30),u=i(28),p=i(29),g=i(8),m=i(26),f=i(25),y=i(5);class v{constructor(t,e,i,n,a,s,o){this.matManager=t,this.sceneEntities=e,this.patternManager=i,this.maskTextures=n,this.renderFrame=a,this.hotspotManager=s,this.groutEnhancedColor=o,this.nTileMaterialsChanged=t=>{0===t&&this.onPatternCompleted&&(this.onPatternCompleted(),this.renderFrame&&(this.renderFrame.value=!0))},this.nTileMaterials=new m.a(0),this.nTileMaterials.Changed.on(this.nTileMaterialsChanged)}setLineMaterial(t){this.lineMaterial=t}loadTileList(t){if(t.data.type!==s.r.DTTileList)throw new Error("Invalid node type");const e=t.getChildNodes(!1);for(;e.moveNext();)e.current.data.type==s.r.DTPattern&&this.loadPattern(e.current,t)}getPatternNodeParentObject3D(t){let e=t;do{e=e.parentNode;const t=this.sceneEntities.get(e.id);if(t)return t}while(null!=e.parentNode);return null}loadPattern(t,e){this.removePattern(t,!0);const i=e.data,a=t.data,h=new n.Mesh;h.name="GROUTMESH",h.matrixAutoUpdate=!1,h.receiveShadow=!1,h.castShadow=!1;const d=s.G.getTileListFace3D(e),u=this.sceneEntities.get(d.id);u&&!u.visible&&(u.visible=!0);const m=d.data;i.flags!==s.z.Custom||this.patternManager.hasTilingAreaFace3DData(d.id)||this.patternManager.addTilingAreaFace3DData(d.id,o.a.vec3ArrayClone(m.points));const f=o.a.vec3Negate(o.a.poly3Normal(m.points)),y=Object(c.c)(m.points,Object(c.b)(m),f),v=r.b.getTilingAreaPatternPolygon(y,a.areaRect,i.points,i.polyToModel,i.modelToPoly,!1);if(!v)return;const x=o.a.poly2ToPoly3(v,i.polyToModel,1);h.geometry=Object(l.f)(x,l.a,null,[]);const T=s.G.getPatternTiledLayer(t).data;let M=null;const C=this.getPatternNodeParentObject3D(t);this.matManager.iblShadingEnabled?(h.material=new p.a({color:a.groutColor,side:n.FrontSide}),this.maskTextures&&this.maskTextures.size>0&&(M=Object(g.m)(T.surfaceType,this.maskTextures),this.matManager.setIBLMaterialData(h.material,T.surfaceIndex,M)),C&&C.material.updateParams()):h.material=new n.MeshStandardMaterial({color:a.groutColor,side:n.FrontSide}),this.renderFrame&&(this.renderFrame.value=!0),C&&this.sceneEntities.addAndAttachToParentAndSetId(t.id,h,C),this.renderFrame&&(this.renderFrame.value=!0);for(const e of t.childNodes){const t=e;this.loadTileInst(t,h,f,v,[],i.polyToModel,a.rotation,T.surfaceIndex,M,5)}this.hotspotManager&&this.hotspotManager.filterCentroids(t.id)}loadTileInst(t,e,i,s,o,h,c,d,u,g){const m=t.data;m.estimateAreaTot=0,m.estimateNTot=0,m.estimateLTHalf=0,m.estimateGTHalf=0;const v=r.b.getTilePolygon(m.formatType,m.width,m.height,m.diagonal,m.polygonSet),x=new Map,T=new Map,M=new Map,C=new Map,b=[];for(let t=0;t<m.tiles.length;t++){const e=m.tiles[t],i=e.offshadedIndex,n=this.getTileGeometry(s,o,m,v,e,h,c,g);n&&(n.tileIndex=t,this.hotspotManager&&b.push(n.centroid),this.addValueToMap(T,i,n.vertices.length),this.addValueToMap(M,i,n.indices.length),this.addValueToMap(C,i,n.texCoord.length),this.addTileGeometryToMap(x,i,n))}this.hotspotManager&&this.hotspotManager.setTileInstCentroid(t,d,b),this.nTileMaterials.value=this.nTileMaterials.value+x.size,x.forEach(((s,o)=>{const r=new n.BufferGeometry,h=new Float32Array(T.get(o));r.setAttribute("position",new n.BufferAttribute(h,3));const c=new Uint32Array(M.get(o));r.setIndex(new n.BufferAttribute(c,1));const g=new Float32Array(C.get(o));r.setAttribute("uv",new n.BufferAttribute(g,2));const v=new Float32Array(T.get(o));r.setAttribute("normal",new n.BufferAttribute(v,3));let x=0,b=0,P=0,E=0;const D=[],w=[];for(const t of s){for(let e=0;e<t.indices.length;e++)c[b]=t.indices[e]+x/3,b++;for(const e of t.vertices)h[x]=e,x++;for(const e of t.texCoord)g[P]=e,P++;for(let e=0;e<t.vertices.length;e+=3)v[E]=i.x,v[E+1]=i.y,v[E+2]=i.z,E+=3;if(this.groutEnhancedColor)for(let e=0;e<=t.vertices.length-3;e+=3){let i=e+3;i===t.vertices.length&&(i=0),D.push(t.vertices[e],t.vertices[e+1],t.vertices[e+2]+20),D.push(t.vertices[i],t.vertices[i+1],t.vertices[i+2]+20),w.push(this.groutEnhancedColor.r,this.groutEnhancedColor.g,this.groutEnhancedColor.b,this.groutEnhancedColor.r,this.groutEnhancedColor.g,this.groutEnhancedColor.b)}}r.applyMatrix4(l.a);const S=new n.Mesh;if(S.name="OFFSHADEDMESH"+o,S.geometry=r,S.userData=new a.h(t.id),S.receiveShadow=!1,S.castShadow=!1,S.renderOrder=100,this.groutEnhancedColor){const t=new f.c;t.setPositions(D),t.setColors(w),t.applyMatrix4(l.a);const i=new f.b(t,this.lineMaterial);i.computeLineDistances(),i.scale.set(1,1,1),i.name="GROUT_LINES"+o,e.add(i)}this.matManager.iblShadingEnabled?(S.material=new p.a({color:m.dominantColor,side:n.FrontSide}),this.matManager.setIBLMaterialData(S.material,d,u)):S.material=new n.MeshStandardMaterial({color:m.dominantColor,side:n.FrontSide}),this.sceneEntities.addAndAttachToParent(S,e,!1),this.renderFrame&&(this.renderFrame.value=!0),"SIST"!==m.idManuf&&"SIST"!==m.idProduct&&"0000"!==m.colorVar?this.matManager.iblShadingEnabled?this.matManager.fetchIblTileMat(m.idManuf,m.idProduct,m.colorVar,o,d,u).then((t=>{this.nTileMaterials.value=this.nTileMaterials.value-1,t&&(t.name=m.idManuf+"-"+m.idProduct+"-"+m.colorVar+"-"+o,this.matManager.setIBLMaterialData(t,d,u),t.needsUpdate=!0,S.material=t,this.renderFrame&&(this.renderFrame.value=!0))})).catch((t=>{console.log("[PatternLoader] matManager fetchIbl error")})):this.matManager.fetchTileMat(m.idManuf,m.idProduct,m.colorVar,o,y.n,!1).then((t=>{t&&(t.needsUpdate=!0,S.material=t,this.renderFrame&&(this.renderFrame.value=!0))})).catch((t=>{console.log("[PatternLoader] matManager fetch error")})):this.nTileMaterials.value=this.nTileMaterials.value-1}))}movePattern(t,e,i){const a=t.parentNode.data.polyToModel,s=o.a.poly2ToPoly3([e],a,0)[0];s.x-=a[0][3],s.y-=a[1][3],s.z-=a[2][3];const r=new n.Vector3(s.x,s.y,s.z).applyMatrix4(l.a),h=i.get(t.id);this.updateGeometryPosition(h.geometry,r);for(const t of h.children){const e=t;this.updateGeometryPosition(e.geometry,r)}}removeTileList(t){const e=t.getChildNodes(!1);for(;e.moveNext();)e.current.data.type==s.r.DTPattern&&(this.removePattern(e.current,!0),this.renderFrame&&(this.renderFrame.value=!0))}removePattern(t,e){const i=this.sceneEntities.get(t.id);i&&this.sceneEntities.removeAndDetachFromParent(i,i.parent,!0,e),this.hotspotManager&&this.hotspotManager.removeHotspots(t.id)}addTileGeometryToMap(t,e,i){let n=t.get(e);n||(n=[],t.set(e,n)),n.push(i)}addValueToMap(t,e,i){let n=t.get(e);n||(n=0),t.set(e,n+i)}updateGeometryPosition(t,e){const i=h.a.getPositionAttibute(t);for(let t=0;t<i.count;t++)i.setY(t,i.getY(t)+e.y);i.needsUpdate=!0}getTileGeometry(t,e,i,a,l,c,p,g){if(l.rotation===s.E)return null;const m=d.a.getTileMatrix(l,i.rotation,p,a.center,i.polygonSet.contours[0].vertices[0]),f=o.a.mat3GetInverted(m.matrix),y=[];for(const t of i.polygonSet.contours){const e=o.a.pnt2TransformArray(m.matrix,t.vertices);y.push(e)}const v=r.b.getIntersectingTilePolygon(y,i.polygonSet.holes,t,e);if(v){const t=[],e=[];i.estimateAreaTot+=v.area,v.tileCut===r.a.TOT?i.estimateNTot++:v.tileCut===r.a.LESS_THEN_HALF?i.estimateLTHalf++:v.tileCut===r.a.GREAT_THEN_HALF&&i.estimateGTHalf++;const s=u.c(v.clippedPolygon),l=new n.ShapeGeometry(s),d=h.a.getPositionAttibute(l);for(let i=0;i<d.count;i++){const n={x:d.getX(i),y:d.getY(i)};t.push(n);const s=o.a.pnt2Transform(f,{x:n.x,y:n.y}),r={x:(s.x-a.textureInfo.dx)/a.textureInfo.textureWidth,y:(s.y-a.textureInfo.dy)/a.textureInfo.textureHeight};e.push(r.x,r.y)}const p=l.getIndex().array,m=o.a.poly2ToPoly3(t,c,g),y=o.a.poly2Centroid(t),T=o.a.poly2ToPoly3([y],c,g);return new x(o.a.pnt3Flatten(m),p,e,T[0])}return null}}class x{constructor(t,e,i,n){this.vertices=t,this.indices=e,this.texCoord=i,this.centroid=n}}var T=i(47);class M{constructor(t,e,i,n,a){this.project=t,this.matManager=e,this.patternLoader=i,this.renderFrame=n,this.defaultMaterials=a}getFace3DGeometry(t,e,i,a){return Object(l.f)(t,l.a,null,[],e,i,a)||new n.BufferGeometry}getMatKey(t,e){return this.project.getMaterialKeyFromId(t)||e}getDefaultMatKey(t){let e;return e=t===s.h.CLASSID_FLOOR||t===s.h.CLASSID_FLOOR_AI?this.defaultMaterials?new s.H(this.defaultMaterials.defaultFloor.manuf,this.defaultMaterials.defaultFloor.name):s.C:this.defaultMaterials?new s.H(this.defaultMaterials.defaultWall.manuf,this.defaultMaterials.defaultWall.name):s.D,e}loadFace3D(t,e,i,n,a,o=null){if(e.data.type!==s.r.DTFace3D)throw new Error("Invalid node type");const r=e.data;let h;t.name="FACE3D",t.matrixAutoUpdate=!1,t.receiveShadow=!1,t.castShadow=!1,h=o||this.getMatKey(r.materialId,this.getDefaultMatKey(r.classId)),this.updateFace3DMeshAsync(t,h,r.points,n,a);const l=e.getFirstChildOfType(s.r.DTTileList);l&&this.patternLoader.loadTileList(l)}updateFace3DMeshAsync(t,e,i,n,a){this.matManager.hasLoadedMaterial(e,n)?this.matManager.fetchIbl(e.manufacturer,e.name,n,a,T.b.IBL,!0).then((e=>{this.updateFace3DMesh(t,e,i,!0)})):(t.geometry=this.getFace3DGeometry(i,!1),this.matManager.iblShadingEnabled?(t.material=this.matManager.getIBLPlaceholderMaterial(n,a),this.renderFrame.value=!0,this.matManager.fetchIbl(e.manufacturer,e.name,n,a,T.b.IBL,!0).then((e=>{e&&(e.updateParams(),this.updateFace3DMesh(t,e,i,!1))})).catch((t=>{console.log("[Face3DLoader] matManager fetchIbl error")}))):this.matManager.fetch(e.manufacturer,e.name,!1).then((e=>{this.updateFace3DMesh(t,e,i,!1)})).catch((t=>{console.log("[Face3DLoader] matManager fetch error")})))}updateFace3DMesh(t,e,i,n){const a=this.matManager.getMaterialExtendedData(e);t.material=e,(a.hasTexture||n)&&(t.geometry.dispose(),t.geometry=this.getFace3DGeometry(i,a.hasTexture,a.width,a.height),this.renderFrame.value=!0)}reloadFace3D(t,e,i,n){if(e.data.type!==s.r.DTFace3D)throw new Error("Invalid node type");const a=e.data,o=this.getMatKey(a.materialId,this.getDefaultMatKey(a.classId));this.updateFace3DMeshAsync(t,o,a.points,i,n)}removeFace3D(t){const e=t.getFirstChildOfType(s.r.DTTileList);e&&this.patternLoader.removeTileList(e)}}class C{constructor(t,e,i){this.matManager=t,this.maskTextures=e,this.renderFrame=i}loadCorridor(t,e){const i=t.data;e.name="CORRIDORSHADOWMESH",e.renderOrder=1e4,e.geometry=Object(l.f)(i.points,l.a,null,[],!0);const a=o.a.box3FromPoints(i.points),r=Math.abs(a.max.y-a.min.y);let h=null;this.matManager.iblShadingEnabled?(e.material=new p.a({color:8421504,opacity:.5,side:n.FrontSide}),this.maskTextures&&(h=Object(g.m)(s.J.FLOOR,this.maskTextures),this.matManager.setIBLMaterialData(e.material,i.surfaceIndex,h),this.renderFrame&&(this.renderFrame.value=!0))):e.material=new n.MeshStandardMaterial({color:8421504,opacity:.5,side:n.FrontSide}),this.setTexture(i.texture,e,i.surfaceIndex,h,r/i.height)}setTexture(t,e,i,a,s){(new n.TextureLoader).loadAsync(t).then((t=>{t.colorSpace=n.SRGBColorSpace,t.wrapS=t.wrapT=n.RepeatWrapping,t.repeat.set(1,s),t.rotation=o.a.degToRad(90),this.matManager.iblShadingEnabled?(e.material=new p.a({map:t,roughness:1,color:16777215}),this.matManager.setIBLMaterialData(e.material,i,a)):e.material=new n.MeshStandardMaterial({map:t,roughness:1,color:16777215}),this.renderFrame&&(this.renderFrame.value=!0)})).catch((e=>{console.error(`Error loading texture: ${t}`)}))}}class b{constructor(t,e,i){this.matManager=t,this.activityManager=e,this.renderFrame=i,this.getMaterial=(t,e,i,a=!0,s=!1)=>new Promise(((o,r)=>{const h=performance.now();a&&this.activityManager.addNonBlockingTask();(new n.TextureLoader).loadAsync(t).then((r=>{let l;r.colorSpace=n.SRGBColorSpace,r.wrapS=r.wrapT=n.RepeatWrapping,r.anisotropy=16,this.matManager.iblShadingEnabled?(l=new p.a({map:r,roughness:1,color:16777215}),this.matManager.setIBLMaterialData(l,e,i,a)):l=new n.MeshStandardMaterial({map:r,roughness:1,color:16777215}),a&&this.activityManager.nonBlockingTaskCompleted();const c=performance.now();s&&console.debug(`Rug texture loading ${t} took: ${c-h} ms.`),o(l)})).catch((e=>{console.error(`Error loading texture: ${t}`),a&&this.activityManager.nonBlockingTaskCompleted(),r()}))}))}loadRug(t,e,i,n,a=!1){if(e.data.type!==s.r.DTRug)throw new Error("Invalid node type");t.name="RUG",this.setupRug(t,e,i,n,a)}updateRug(t,e,i,n,a=!0,s=!1){return new Promise(((o,r)=>{for(let e=t.children.length-1;e>=0;e--)h.a.disposeObject3D(t.children[e],!0);t.children=[],this.setupRug(t,e,i,n,a,s).then((()=>{o()}))}))}setupRug(t,e,i,o,r=!0,h=!1){return new Promise(((c,d)=>{const u=e.data;if(u.objModel){r&&this.activityManager.addBlockingTask();(new f.d).load(u.objModel,(s=>{r&&this.activityManager.blockingTaskCompleted();const l=s.children[0];l.userData=new a.h(e.id),l.name="RUG-TOP";const d=l.geometry,p=new n.Matrix4;p.identity(),p.scale(new n.Vector3(y.s,y.s,y.s)),d.applyMatrix4(p),r&&this.renderFrame&&(this.renderFrame.value=!0);const g=[];g.push(this.setTexture(u.texture,l,i,o,t,r,h)),Promise.all(g).then((()=>{c()})).catch((t=>{console.log("createRugGeometry promises error")}))}))}else if(u.shape===s.v.FLAT||u.texture.endsWith(".png")){const s=performance.now(),d=u.bbox.max.x-u.bbox.min.x,g=u.bbox.max.y-u.bbox.min.y,m=new n.PlaneGeometry(d,g,1);m.applyMatrix4(l.a);const f=new n.Mesh;f.geometry=m,f.userData=new a.h(e.id),f.name="RUG-TOP",f.renderOrder=200,this.matManager.iblShadingEnabled?(f.material=new p.a({color:8421504}),this.matManager.setIBLMaterialData(f.material,i,o,r)):f.material=new n.MeshStandardMaterial({color:8421504}),r&&this.renderFrame&&(this.renderFrame.value=!0),this.setTexture(u.texture,f,i,o,t,r,h).then((()=>{const t=performance.now();h&&console.debug(`Rug PNG loading took ${t-s} milliseconds.`),c()}))}else this.createRugGeometry(u,t,e.id,i,o,r,h).then((()=>{c()}))}))}createRugGeometry(t,e,i,r,h,c=!0,d=!1){return new Promise(((u,g)=>{const m=[];e.renderOrder=1e4;const f=t.bbox.max.x-t.bbox.min.x,y=t.bbox.max.y-t.bbox.min.y,v=t.bbox.max.z-t.bbox.min.z;if(t.shape===s.v.RECT)m.push({x:-f/2,y:-y/2,z:v}),m.push({x:-f/2,y:y/2,z:v}),m.push({x:f/2,y:y/2,z:v}),m.push({x:f/2,y:-y/2,z:v});else if(t.shape===s.v.ROUND){const t=new n.EllipseCurve(0,0,f/2,y/2,0,2*Math.PI,!0,0).getPoints(50);for(let e=0;e<t.length-1;e++)m.push({x:t[e].x,y:t[e].y,z:v})}const x=[];for(let t=m.length-1;t>=0;t--)x.push(o.a.pnt3Move(m[t],{x:0,y:0,z:-1},v));const T=[],M=x.length;for(let t=0;t<M;t++){const e=t,i=(t+1)%M,n=M-1-e,a=[m[(M-1-i)%M],x[i],x[e],m[n]];T.push(a)}const C=t.textureWidth?t.textureWidth:null,b=t.textureHeight?t.textureHeight:null,P=new n.Mesh;P.geometry=Object(l.f)(m,l.a,null,[],!0,C,b),P.userData=new a.h(i),P.name="RUG-TOP",P.renderOrder=200,this.matManager.iblShadingEnabled?(P.material=new p.a({color:8421504,roughness:1}),this.matManager.setIBLMaterialData(P.material,r,h,c)):P.material=new n.MeshStandardMaterial({color:8421504,roughness:1}),e.add(P),this.getMaterial(t.texture,r,h,c,d).then((t=>{P.material=t,this.renderFrame.value=!0;for(const s of T){const o=new n.Mesh;o.geometry=Object(l.f)(s,l.a,null,[],!0,C,b),o.userData=new a.h(i),o.name="RUG-BORDER",o.material=t,o.renderOrder=200,e.add(o),this.renderFrame.value=!0}u()})).catch((t=>{console.debug("[RugLoader] get material error: "+JSON.stringify(t))}))}))}setTexture(t,e,i,a,s,o=!0,r=!1){return new Promise(((h,l)=>{const c=performance.now();o&&this.activityManager.addNonBlockingTask();(new n.TextureLoader).loadAsync(t).then((l=>{l.colorSpace=n.SRGBColorSpace,l.wrapS=l.wrapT=n.RepeatWrapping,l.anisotropy=16,this.matManager.iblShadingEnabled?(e.material=new p.a({map:l,roughness:1,color:16777215}),this.matManager.setIBLMaterialData(e.material,i,a,o)):e.material=new n.MeshStandardMaterial({map:l,roughness:1,color:16777215}),s&&s.add(e),o&&(this.activityManager.nonBlockingTaskCompleted(),this.renderFrame&&(this.renderFrame.value=!0));const d=performance.now();r&&console.debug(`Rug texture loading ${t} took ${d-c} milliseconds.`),h()})).catch((e=>{console.error(`Error loading texture: ${t}`),o&&this.activityManager.nonBlockingTaskCompleted(),l()}))}))}}i(52)},function(t,e,i){"use strict";i.d(e,"a",(function(){return s}));var n=i(26),a=i(58);class s{get tasksChanged(){return this.onTasksChanged.expose()}constructor(){this.onTasksChanged=new a.a,this.nBlockingTaskChanged=t=>{this.onTasksChanged.trigger({blockingTasks:t,nonBlockingTasks:this.nNonBlockingTask.value})},this.nNonBlockingTaskChanged=t=>{this.onTasksChanged.trigger({blockingTasks:this.nBlockingTask.value,nonBlockingTasks:t})},this.nBlockingTask=new n.a(0),this.nBlockingTask.Changed.on(this.nBlockingTaskChanged),this.nNonBlockingTask=new n.a(0),this.nNonBlockingTask.Changed.on(this.nNonBlockingTaskChanged)}addBlockingTask(){this.nBlockingTask.value=this.nBlockingTask.value+1}addNonBlockingTask(){this.nNonBlockingTask.value=this.nNonBlockingTask.value+1}blockingTaskCompleted(){let t=this.nBlockingTask.value-1;t<0&&(console.warn("Activity manager blocking tasks count is less than zero"),t=0),this.nBlockingTask.value=t}nonBlockingTaskCompleted(){let t=this.nNonBlockingTask.value-1;t<0&&(console.warn("Activity manager non-blocking tasks count is less than zero"),t=0),this.nNonBlockingTask.value=t}getNBlockingTask(){return this.nBlockingTask.value}getNNonBlockingTask(){return this.nNonBlockingTask.value}}},function(t,e,i){"use strict";i.d(e,"a",(function(){return s}));var n=i(9),a=i(7);class s{constructor(t){this.modelToThreeMap=t}addAndAttachToParentAndSetId(t,e,i){const a=e.userData;return e.userData?a.id=t:e.userData=new n.h(t),this.addAndAttachToParent(e,i,!1),e}removeAndDetachFromParentById(t,e){const i=this.get(t);return i&&this.removeAndDetachFromParent(i,i.parent,e,!1),i}addAndAttachToParent(t,e,i){e.add(t),this.add(t,i)}removeAndDetachFromParent(t,e,i,n){e.remove(t),this.remove(t),i&&a.a.disposeObject3D(t,n)}add(t,e){this.addToMap(t,e)}remove(t){this.removeFromMap(t)}get(t){return this.modelToThreeMap.get(t)}addToMap(t,e){const i=t.userData;if(i&&i.id&&this.modelToThreeMap.set(i.id,t),e)for(const i of t.children)this.addToMap(i,e)}removeFromMap(t){const e=t.userData;e&&e.id&&this.modelToThreeMap.delete(e.id);for(const e of t.children)this.removeFromMap(e)}}},function(t,e,i){"use strict";i.d(e,"b",(function(){return a})),i.d(e,"a",(function(){return s}));var n=i(31);class a{}class s extends n.a{constructor(t,e){super(t,e),this.apiEndpoint=t}shareProjectLink(t){return this.post("api/share/link",JSON.stringify(t)).then(this.responseAsText)}getSharedProject(t){return this.get("api/share/file?id="+t).then((t=>this.responseAsText(t)))}uploadRoomTypePrediction(t){return this.post("api/roomNet/sendPrediction",JSON.stringify(t)).then()}urltoFile(t,e){const i=t.split(","),n=i[0].match(/:(.*?);/)[1],a=atob(i[1]);let s=a.length;const o=new Uint8Array(s);for(;s--;)o[s]=a.charCodeAt(s);return new File([o],e,{type:n})}}},function(t,e,i){"use strict";i.d(e,"a",(function(){return a}));var n=i(27);class a{constructor(){this.executeCompletedEventHandler=t=>{t.command==this.currentCommand&&(this.currentCommand=null,this.unsetCommandHandler()),this.onCommandEnd.notify(t)},this.onCommandBegin=new n.a,this.onCommandEnd=new n.a}subscribeCommandHandlerEvents(t){t.operationCompleted.attach(this.executeCompletedEventHandler)}unsubscribeCommandHandlerEvents(t){t.operationCompleted.detach(this.executeCompletedEventHandler)}unsetCommandHandler(){this.unsubscribeCommandHandlerEvents(this.commandHandler),this.commandHandler=null}setCommandHandler(t){null!=this.commandHandler&&this.unsubscribeCommandHandlerEvents(this.commandHandler),this.subscribeCommandHandlerEvents(t),this.commandHandler=t}execute(t,e){null!=this.commandHandler&&(this.pendingCommand=e,this.commandHandler.cancel()),this.pendingCommand=null,this.currentCommand=e,this.setCommandHandler(t),this.onCommandBegin.notify(e),this.commandHandler.execute(e)}cancel(){null!=this.commandHandler&&this.commandHandler.cancel()}}},function(t,e,i){"use strict";i.d(e,"a",(function(){return x})),i.d(e,"b",(function(){return T}));var n=i(1),a=i(41),s=i(9),o=i(35),r=i(7),h=i(0),l=i(3),c=i(42),d=i(2);class u{static addPCSSShadowShader(){let t=n.ShaderChunk.shadowmap_pars_fragment;t.includes("#define LIGHT_WORLD_SIZE 0.005")||(t=t.replace("#ifdef USE_SHADOWMAP","#ifdef USE_SHADOWMAP\n            #define LIGHT_WORLD_SIZE 0.005\n\t\t\t#define LIGHT_FRUSTUM_WIDTH 3.75\n\t\t\t#define LIGHT_SIZE_UV (LIGHT_WORLD_SIZE / LIGHT_FRUSTUM_WIDTH)\n\t\t\t#define NEAR_PLANE 9.5\n\t\t\t#define NUM_SAMPLES 17\n\t\t\t#define NUM_RINGS 11\n\t\t\t#define BLOCKER_SEARCH_NUM_SAMPLES NUM_SAMPLES\n\t\t\t#define PCF_NUM_SAMPLES NUM_SAMPLES\n\t\t\tvec2 poissonDisk[NUM_SAMPLES];\n\t\t\tvoid initPoissonSamples( const in vec2 randomSeed ) {\n\t\t\t\tfloat ANGLE_STEP = PI2 * float( NUM_RINGS ) / float( NUM_SAMPLES );\n\t\t\t\tfloat INV_NUM_SAMPLES = 1.0 / float( NUM_SAMPLES );\n\t\t\t\t// jsfiddle that shows sample pattern: https://jsfiddle.net/a16ff1p7/\n\t\t\t\tfloat angle = rand( randomSeed ) * PI2;\n\t\t\t\tfloat radius = INV_NUM_SAMPLES;\n\t\t\t\tfloat radiusStep = radius;\n\t\t\t\tfor( int i = 0; i < NUM_SAMPLES; i ++ ) {\n\t\t\t\t\tpoissonDisk[i] = vec2( cos( angle ), sin( angle ) ) * pow( abs(radius), 0.75 );\n\t\t\t\t\tradius += radiusStep;\n\t\t\t\t\tangle += ANGLE_STEP;\n\t\t\t\t}\n\t\t\t}\n\t\t\tfloat penumbraSize( const in float zReceiver, const in float zBlocker ) { // Parallel plane estimation\n\t\t\t\treturn (zReceiver - zBlocker) / zBlocker;\n\t\t\t}\n\t\t\tfloat findBlocker( sampler2D shadowMap, const in vec2 uv, const in float zReceiver ) {\n\t\t\t\t// This uses similar triangles to compute what\n\t\t\t\t// area of the shadow map we should search\n\t\t\t\tfloat searchRadius = LIGHT_SIZE_UV * ( zReceiver - NEAR_PLANE ) / zReceiver;\n\t\t\t\tfloat blockerDepthSum = 0.0;\n\t\t\t\tint numBlockers = 0;\n\t\t\t\tfor( int i = 0; i < BLOCKER_SEARCH_NUM_SAMPLES; i++ ) {\n\t\t\t\t\tfloat shadowMapDepth = unpackRGBAToDepth(texture2D(shadowMap, uv + poissonDisk[i] * searchRadius));\n\t\t\t\t\tif ( shadowMapDepth < zReceiver ) {\n\t\t\t\t\t\tblockerDepthSum += shadowMapDepth;\n\t\t\t\t\t\tnumBlockers ++;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif( numBlockers == 0 ) return -1.0;\n\t\t\t\treturn blockerDepthSum / float( numBlockers );\n\t\t\t}\n\t\t\tfloat PCF_Filter(sampler2D shadowMap, vec2 uv, float zReceiver, float filterRadius ) {\n\t\t\t\tfloat sum = 0.0;\n\t\t\t\tfor( int i = 0; i < PCF_NUM_SAMPLES; i ++ ) {\n\t\t\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadowMap, uv + poissonDisk[ i ] * filterRadius ) );\n\t\t\t\t\tif( zReceiver <= depth ) sum += 1.0;\n\t\t\t\t}\n\t\t\t\tfor( int i = 0; i < PCF_NUM_SAMPLES; i ++ ) {\n\t\t\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadowMap, uv + -poissonDisk[ i ].yx * filterRadius ) );\n\t\t\t\t\tif( zReceiver <= depth ) sum += 1.0;\n\t\t\t\t}\n\t\t\t\treturn sum / ( 2.0 * float( PCF_NUM_SAMPLES ) );\n\t\t\t}\n\t\t\tfloat PCSS ( sampler2D shadowMap, vec4 coords ) {\n\t\t\t\tvec2 uv = coords.xy;\n\t\t\t\tfloat zReceiver = coords.z; // Assumed to be eye-space z in this code\n\t\t\t\tinitPoissonSamples( uv );\n\t\t\t\t// STEP 1: blocker search\n\t\t\t\tfloat avgBlockerDepth = findBlocker( shadowMap, uv, zReceiver );\n\t\t\t\t//There are no occluders so early out (this saves filtering)\n\t\t\t\tif( avgBlockerDepth == -1.0 ) return 1.0;\n\t\t\t\t// STEP 2: penumbra size\n\t\t\t\tfloat penumbraRatio = 1.0; // penumbraSize( zReceiver, avgBlockerDepth );\n\t\t\t\tfloat filterRadius = penumbraRatio * LIGHT_SIZE_UV * NEAR_PLANE / zReceiver;\n\t\t\t\t// STEP 3: filtering\n\t\t\t\t//return avgBlockerDepth;\n\t\t\t\treturn PCF_Filter( shadowMap, uv, zReceiver, filterRadius );\n\t\t\t}"),t=t.replace("#if defined( SHADOWMAP_TYPE_PCF )","return PCSS( shadowMap, shadowCoord );\n#if defined( SHADOWMAP_TYPE_PCF )"),n.ShaderChunk.shadowmap_pars_fragment=t)}}var p,g,m=i(46),f=i(52);!function(t){t[t.NONE=-1]="NONE",t[t.ROTATE=0]="ROTATE",t[t.DOLLY=1]="DOLLY",t[t.PAN=2]="PAN",t[t.TOUCH_ROTATE=3]="TOUCH_ROTATE",t[t.TOUCH_DOLLY_PAN=4]="TOUCH_DOLLY_PAN"}(p||(p={})),function(t){t[t.SCREEN=0]="SCREEN",t[t.DEPTH=1]="DEPTH",t[t.ELEVATION=2]="ELEVATION"}(g||(g={}));class y extends n.EventDispatcher{constructor(t,e){super(),this.camera=t,this.domElement=e,this.onMouseDown=t=>{if(!1!==this.enabled){switch(t.preventDefault(),t.button){case this.mouseButtons.LEFT:if(t.ctrlKey||t.metaKey||t.shiftKey){if(!1===this.enablePan)return;this.handleMouseDownPan(t),this.state=p.PAN}else{if(!1===this.enableRotate)return;this.handleMouseDownRotate(t),this.state=p.ROTATE}break;case this.mouseButtons.MIDDLE:if(!1===this.enableZoom)return;this.handleMouseDownDolly(t),this.state=p.DOLLY;break;case this.mouseButtons.RIGHT:if(!1===this.enablePan)return;this.handleMouseDownPan(t),this.state=p.PAN}this.state!==p.NONE&&(document.addEventListener("mousemove",this.onMouseMove,!1),document.addEventListener("mouseup",this.onMouseUp,!1),this.dispatchEvent({type:"start"}))}},this.onMouseMove=t=>{if(!1!==this.enabled)switch(t.preventDefault(),this.state){case p.ROTATE:if(!1===this.enableRotate)return;this.handleMouseMoveRotate(t);break;case p.DOLLY:if(!1===this.enableZoom)return;this.handleMouseMoveDolly(t);break;case p.PAN:if(!1===this.enablePan)return;this.handleMouseMovePan(t)}},this.onMouseUp=t=>{!1!==this.enabled&&(this.handleMouseUp(t),document.removeEventListener("mousemove",this.onMouseMove,!1),document.removeEventListener("mouseup",this.onMouseUp,!1),this.dispatchEvent({type:"end"}),this.state=p.NONE)},this.onMouseWheel=t=>{!1===this.enabled||!1===this.enableZoom||this.state!==p.NONE&&this.state!==p.ROTATE||(t.preventDefault(),t.stopPropagation(),this.dispatchEvent({type:"start"}),this.handleMouseWheelDolly(t),this.dispatchEvent({type:"end"}))},this.onTouchStart=t=>{if(!1!==this.enabled){switch(t.preventDefault(),t.touches.length){case 1:if(!1===this.enableRotate)return;this.handleTouchStartRotate(t),this.state=p.TOUCH_ROTATE;break;case 2:if(!1===this.enableZoom&&!1===this.enablePan)return;this.handleTouchStartDollyPan(t),this.state=p.TOUCH_DOLLY_PAN;break;default:this.state=p.NONE}this.state!==p.NONE&&this.dispatchEvent({type:"start"})}},this.onTouchMove=t=>{if(!1!==this.enabled)switch(t.preventDefault(),t.stopPropagation(),t.touches.length){case 1:if(!1===this.enableRotate)return;if(this.state!==p.TOUCH_ROTATE)return;this.handleTouchMoveRotate(t);break;case 2:if(!1===this.enableZoom&&!1===this.enablePan)return;if(this.state!==p.TOUCH_DOLLY_PAN)return;this.handleTouchMoveDollyPan(t);break;default:this.state=p.NONE}},this.onTouchEnd=t=>{!1!==this.enabled&&(this.handleTouchEnd(t),this.dispatchEvent({type:"end"}),this.state=p.NONE)},this.domElement=void 0!==e?e:document,this.enabled=!0,this.target=new n.Vector3,this.minElevation=-1/0,this.maxElevation=1/0,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.25,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.panMode=g.DEPTH,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.enableKeys=!0,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},this.mouseButtons={LEFT:n.MOUSE.LEFT,MIDDLE:n.MOUSE.MIDDLE,RIGHT:n.MOUSE.RIGHT},this.target0=this.target.clone(),this.position0=this.camera.position.clone(),this.zoom0=this.camera.zoom,this.sphericalDelta=new n.Spherical,this.panOffset=new n.Vector3,this.rotateStart=new n.Vector2,this.rotateEnd=new n.Vector2,this.rotateDelta=new n.Vector2,this.panStart=new n.Vector2,this.panEnd=new n.Vector2,this.panDelta=new n.Vector2,this.dollyStart=new n.Vector2,this.dollyEnd=new n.Vector2,this.dollyDelta=new n.Vector2,this.panInternalOffset=new n.Vector3,this.panLeftV=new n.Vector3,this.panUpV=new n.Vector3,this.attachDomHandlers(),this.update()}setTileMesh(t,e){this.tileMesh=t,this.tileOrientation=e,this.spherical=new n.Spherical}getPolarAngle(){return this.spherical.phi}getAzimuthalAngle(){return this.spherical.theta}saveState(){this.target0.copy(this.target),this.position0.copy(this.camera.position),this.zoom0=this.camera.zoom}reset(){this.target.copy(this.target0),this.camera.position.copy(this.position0),this.camera.zoom=this.zoom0,this.camera.updateProjectionMatrix(),this.dispatchEvent({type:"change"}),this.tileMesh=null,this.sphericalDelta=new n.Spherical,this.update(),this.state=p.NONE}update(){if(this.tileMesh){this.autoRotate&&this.state===p.NONE&&this.rotateLeft(this.getAutoRotationAngle());const t=this.rotateInvert?-1:1;this.spherical.theta+=this.sphericalDelta.theta*t,this.spherical.phi+=this.sphericalDelta.phi*t,this.tileMesh.matrixAutoUpdate=!0,this.spherical.theta>this.minAzimuthAngle&&this.spherical.theta<this.maxAzimuthAngle?"h"===this.tileOrientation?this.tileMesh.rotation.y=-this.spherical.theta:this.tileMesh.rotation.z=this.spherical.theta:this.spherical.theta<this.minAzimuthAngle?this.spherical.theta=this.minAzimuthAngle:this.spherical.theta>this.maxAzimuthAngle&&(this.spherical.theta=this.maxAzimuthAngle),this.spherical.phi>this.minPolarAngle&&this.spherical.phi<this.maxPolarAngle?this.tileMesh.rotation.x=-this.spherical.phi:this.spherical.phi<this.minPolarAngle?this.spherical.phi=this.minPolarAngle:this.spherical.phi>this.maxPolarAngle&&(this.spherical.phi=this.maxPolarAngle),!0===this.enableDamping?(this.sphericalDelta.theta*=1-this.dampingFactor,this.sphericalDelta.phi*=1-this.dampingFactor,this.panOffset.multiplyScalar(1-this.dampingFactor)):(this.sphericalDelta.set(0,0,0),this.panOffset.set(0,0,0))}return!0}dispose(){this.domElement.removeEventListener("mousedown",this.onMouseDown,!1),this.domElement.removeEventListener("wheel",this.onMouseWheel,!1),this.domElement.removeEventListener("touchstart",this.onTouchStart,!1),this.domElement.removeEventListener("touchend",this.onTouchEnd,!1),this.domElement.removeEventListener("touchmove",this.onTouchMove,!1),document.removeEventListener("mousemove",this.onMouseMove,!1),document.removeEventListener("mouseup",this.onMouseUp,!1)}attachDomHandlers(){this.domElement.addEventListener("mousedown",this.onMouseDown,!1),this.domElement.addEventListener("wheel",this.onMouseWheel,!1),this.domElement.addEventListener("touchstart",this.onTouchStart,!1),this.domElement.addEventListener("touchend",this.onTouchEnd,!1),this.domElement.addEventListener("touchmove",this.onTouchMove,!1)}getAutoRotationAngle(){return 2*Math.PI/60/60*this.autoRotateSpeed}getZoomScale(){return Math.pow(.95,this.zoomSpeed)}rotateLeft(t){this.sphericalDelta.theta-=t}rotateUp(t){this.sphericalDelta.phi-=t}panLeft(t,e){this.panLeftV.setFromMatrixColumn(e,0),this.panLeftV.multiplyScalar(-t),this.panOffset.add(this.panLeftV)}panUp(t,e,i){switch(i){case g.DEPTH:this.panUpV.setFromMatrixColumn(e,0),this.panUpV.crossVectors(this.camera.up,this.panUpV);break;case g.SCREEN:this.panUpV.setFromMatrixColumn(e,1);break;case g.ELEVATION:this.panUpV=new n.Vector3(0,1,0)}this.panUpV.multiplyScalar(t),this.panOffset.add(this.panUpV)}pan(t,e,i){const n=this.domElement===document?this.domElement.body:this.domElement;if(r.a.isPerspectiveCamera(this.camera)){const a=this.camera.position;this.panInternalOffset.copy(a).sub(this.target);let s=this.panInternalOffset.length();s*=Math.tan(this.camera.fov/2*Math.PI/180);const o=this.camera.matrix;this.panLeft(2*t*s/n.clientHeight,o),this.panUp(2*e*s/n.clientHeight,o,i)}else r.a.isOrthographicCamera(this.camera)?(this.panLeft(t*(this.camera.right-this.camera.left)/this.camera.zoom/n.clientWidth,this.camera.matrix),this.panUp(e*(this.camera.top-this.camera.bottom)/this.camera.zoom/n.clientHeight,this.camera.matrix,i)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),this.enablePan=!1);this.dispatchEvent({type:"pan",panOffset:this.panOffset})}dollyIn(t){const e=this.camera.zoom*t;e>this.minZoom&&e<this.maxZoom&&(this.camera.zoom=e,this.camera.updateProjectionMatrix())}dollyOut(t){const e=this.camera.zoom/t;e>this.minZoom&&e<this.maxZoom&&(this.camera.zoom=e,this.camera.updateProjectionMatrix())}handleMouseDownRotate(t){this.rotateStart.set(t.clientX,t.clientY)}handleMouseDownDolly(t){this.dollyStart.set(t.clientX,t.clientY)}handleMouseDownPan(t){this.panStart.set(t.clientX,t.clientY)}handleMouseMoveRotate(t){this.rotateEnd.set(t.clientX,t.clientY),this.rotateDelta.subVectors(this.rotateEnd,this.rotateStart).multiplyScalar(this.rotateSpeed);const e=this.domElement===document?this.domElement.body:this.domElement;this.rotateLeft(2*Math.PI*this.rotateDelta.x/e.clientHeight),this.rotateUp(2*Math.PI*this.rotateDelta.y/e.clientHeight),this.rotateStart.copy(this.rotateEnd),this.update()}handleMouseMoveDolly(t){this.dollyEnd.set(t.clientX,t.clientY),this.dollyDelta.subVectors(this.dollyEnd,this.dollyStart),this.dollyDelta.y>0?this.dollyOut(this.getZoomScale()):this.dollyDelta.y<0&&this.dollyIn(this.getZoomScale()),this.dollyStart.copy(this.dollyEnd),this.update()}handleMouseMovePan(t){this.panEnd.set(t.clientX,t.clientY),this.panDelta.subVectors(this.panEnd,this.panStart).multiplyScalar(this.panSpeed),this.pan(this.panDelta.x,this.panDelta.y,this.panMode),this.panStart.copy(this.panEnd),this.update()}handleMouseUp(t){}handleMouseWheelDolly(t){t.deltaY<0?this.dollyOut(this.getZoomScale()):t.deltaY>0&&this.dollyIn(this.getZoomScale()),this.update()}handleTouchStartRotate(t){this.rotateStart.set(t.touches[0].pageX,t.touches[0].pageY)}handleTouchStartDollyPan(t){if(this.enableZoom){const e=t.touches[0].pageX-t.touches[1].pageX,i=t.touches[0].pageY-t.touches[1].pageY,n=Math.sqrt(e*e+i*i);this.dollyStart.set(0,n)}if(this.enablePan){const e=.5*(t.touches[0].pageX+t.touches[1].pageX),i=.5*(t.touches[0].pageY+t.touches[1].pageY);this.panStart.set(e,i)}}handleTouchMoveRotate(t){this.rotateEnd.set(t.touches[0].pageX,t.touches[0].pageY),this.rotateDelta.subVectors(this.rotateEnd,this.rotateStart).multiplyScalar(this.rotateSpeed);const e=this.domElement===document?this.domElement.body:this.domElement;this.rotateLeft(2*Math.PI*this.rotateDelta.x/e.clientHeight),this.rotateUp(2*Math.PI*this.rotateDelta.y/e.clientHeight),this.rotateStart.copy(this.rotateEnd),this.update()}handleTouchMoveDollyPan(t){if(this.enableZoom){const e=t.touches[0].pageX-t.touches[1].pageX,i=t.touches[0].pageY-t.touches[1].pageY,n=Math.sqrt(e*e+i*i);this.dollyEnd.set(0,n),this.dollyDelta.set(0,Math.pow(this.dollyEnd.y/this.dollyStart.y,this.zoomSpeed)),this.dollyIn(this.dollyDelta.y),this.dollyStart.copy(this.dollyEnd)}if(this.enablePan){const e=.5*(t.touches[0].pageX+t.touches[1].pageX),i=.5*(t.touches[0].pageY+t.touches[1].pageY);this.panEnd.set(e,i),this.panDelta.subVectors(this.panEnd,this.panStart).multiplyScalar(this.panSpeed),this.pan(this.panDelta.x,this.panDelta.y,this.panMode),this.panStart.copy(this.panEnd)}this.update()}handleTouchMovePan(t){if(this.enablePan){const e=t.touches[0].pageX-t.touches[1].pageX,i=t.touches[0].pageY-t.touches[1].pageY,n=Math.sqrt(e*e+i*i);this.dollyEnd.set(0,n),this.dollyDelta.subVectors(this.dollyEnd,this.dollyStart).multiplyScalar(this.panSpeed),this.pan(0,this.dollyDelta.y,g.DEPTH),this.dollyStart.copy(this.dollyEnd);const a=.5*(t.touches[0].pageX+t.touches[1].pageX),s=.5*(t.touches[0].pageY+t.touches[1].pageY);this.panEnd.set(a,s),this.panDelta.subVectors(this.panEnd,this.panStart).multiplyScalar(this.panSpeed),this.pan(this.panDelta.x,this.panDelta.y,this.panMode),this.panStart.copy(this.panEnd)}this.update()}handleTouchEnd(t){}}var v=i(26);const x=.001;class T{resize(t,e){this._width&&this._height&&this._width===t&&this._height===e||(this._width=t,this._height=e,this.renderer.setSize(t,e),this.perspectiveCamera.aspect=t/e,this.perspectiveCamera.updateProjectionMatrix())}constructor(t,e,i,r,h,l,d,p,g,m,x,T,M,C){this.containerDomElement=t,this.commandManager=h,this.resourceManager=l,this.apiEndpoint=d,this.apiToken=p,this.autoRot=g,this.initAngle=m,this.tileOrientation=x,this.bgColor=T,this.thickness=M,this.onTasksChanged=t=>{this.resourceManager&&this.resourceManager.showActivityIndicator(t.blockingTasks,t.nonBlockingTasks)},this.projectChangedEventHandler=t=>{if("FACE3D_ADDED"===t.type)this.addFace3D(t.node)},this._width=e,this._height=i,this.project=r,this.project.projectChanged.attach(this.projectChangedEventHandler),this.tileClient=new o.b(this.apiEndpoint,this.apiToken),this.canvas=this.buildCanvas(),this.scene=new n.Scene,this.scene.background=new n.Color(this.bgColor),this.renderer=this.buildRenderer(this.canvas,this._width,this._height,window.devicePixelRatio?window.devicePixelRatio:1),this.perspectiveCamera=this.buildPerspectiveCamera(this._width,this._height),this.modelToThreeMap=new Map,this.sceneEntities=new c.a(this.modelToThreeMap),this.tileControl=new y(this.perspectiveCamera,this.containerDomElement),this.setupTITileControl(.001,1e5),this.activityManager=new a.a,this.activityManager.tasksChanged.on(this.onTasksChanged),this.matManager=new s.d(new o.a(this.apiEndpoint,this.apiToken),this.project,this.scene,this.activityManager,!1,null),this.initializeSceneManagerMaterials(C),this.patternManager=new s.f(this.project,this.tileClient),this.patternLoader=new s.e(this.matManager,this.sceneEntities,this.patternManager,null,null),this.tileLoader=new f.a(this.project,this.matManager,this.patternLoader,this.sceneEntities),u.addPCSSShadowShader(),this.addLights(),this.activeOffIndex=new v.a,this.activeOffIndex.value=1,this.finalThickness=new v.a,this.update()}initAnalytics(t,e,i){window.location.href.includes("localhost")||(this.analyticsManager=new m.a(t,e,i),this.analyticsManager.notifyPagePreview("TI",window.location.href))}getNBlockingTask(){return this.activityManager.getNBlockingTask()}buildRenderer(t,e,i,a){const s=new n.WebGLRenderer({canvas:t,antialias:!0,powerPreference:"low-power"});return s.setPixelRatio(a),s.setSize(e,i),s.outputColorSpace=n.SRGBColorSpace,s.toneMappingExposure=.1,s.toneMapping=n.ACESFilmicToneMapping,s.shadowMap.enabled=!0,s.shadowMap.type=n.PCFSoftShadowMap,s}buildPerspectiveCamera(t,e){const i=t/e,a=new n.PerspectiveCamera(60,i,.01,35);return a.position.set(0,1,1),a.lookAt(new n.Vector3(0,0,0)),a}setupTITileControl(t,e){this.tileControl.enablePan=!1,this.tileControl.autoRotateSpeed=.7,this.tileControl.autoRotate=this.autoRot,"h"===this.tileOrientation?(this.tileControl.maxPolarAngle=d.a.degToRad(85)-d.a.degToRad(this.initAngle),this.tileControl.minPolarAngle=-d.a.degToRad(this.initAngle),this.tileControl.minAzimuthAngle=-1/0,this.tileControl.maxAzimuthAngle=1/0):(this.tileControl.maxPolarAngle=d.a.degToRad(90),this.tileControl.minPolarAngle=d.a.degToRad(-45),this.tileControl.minAzimuthAngle=d.a.degToRad(-85),this.tileControl.maxAzimuthAngle=d.a.degToRad(85)),this.tileControl.minZoom=.5,this.tileControl.maxZoom=5,this.tileControl.update()}initializeSceneManagerMaterials(t){this.floorMat=new n.ShadowMaterial,this.floorMat.opacity=.5;const e=new o.a(this.apiEndpoint,this.apiToken);let i;const a=new n.CubeTextureLoader;if(t&&6===t.length)i=t;else{const t=e.getEndpoint()+"/api/mat/textures?id=Background\\interior\\";i=[t+"posx.jpg",t+"negx.jpg",t+"posy.jpg",t+"negy.jpg",t+"posz.jpg",t+"negz.jpg"],a.setCrossOrigin("use-credentials")}const s=a.load(i);s.format=n.RGBAFormat,s.mapping=n.CubeReflectionMapping,s.colorSpace=n.SRGBColorSpace,this.matManager.updateDefaultEnvMap(s)}addFace3D(t){if(t.data.type!==h.r.DTFace3D)throw new Error("Invalid node type");const e=this.sceneEntities.addAndAttachToParentAndSetId(t.id,new n.Mesh,this.scene);this.tileLoader.loadTile(t,e,this.finalThickness.value),this.setupSceneForFace3D(t,e)}setupSceneForFace3D(t,e){this.tileControl.reset(),"v"===this.tileOrientation&&(e.matrixAutoUpdate=!0,e.rotation.x=d.a.degToRad(90)),this.tileControl.setTileMesh(e,this.tileOrientation);const i=t.data,n=d.a.box3FromPoints(i.points),a=n.max.x-n.min.x,s=n.max.y-n.min.y,o=a*x,r=s*x,h=Math.max(o,r),l=Math.min(o,r);this.setupFloorMesh(h,l,.5),this.setupLights(h,l,.5),this.setupCamera(h+.5);const c=Math.min(o,r)/3;this.setupTITileControl(c,2*h)}setupCamera(t){const e=t*Math.sin(d.a.degToRad(this.initAngle)),i=t*Math.cos(d.a.degToRad(this.initAngle));"h"===this.tileOrientation?this.perspectiveCamera.position.set(0,2*e/3,2*i/3):this.perspectiveCamera.position.set(0,e/2,i),this.perspectiveCamera.lookAt(new n.Vector3(0,0,0))}setupFloorMesh(t,e,i){this.floorMesh&&this.scene.remove(this.floorMesh);const a=new n.PlaneGeometry(t+i,t+i);this.floorMesh=new n.Mesh(a,this.floorMat),this.floorMesh.receiveShadow=!0,this.floorMesh.rotation.x=-d.a.degToRad(90),"h"===this.tileOrientation?this.floorMesh.position.y=-(t/2+.1):this.floorMesh.position.y=-(e+i),this.scene.add(this.floorMesh)}setupLights(t,e,i){this.directionalLight.shadow.camera.left=-(t+i),this.directionalLight.shadow.camera.right=t+i,this.directionalLight.shadow.camera.bottom=-(t+i),this.directionalLight.shadow.camera.top=t+i,this.directionalLight.position.set(0,t/2,0),this.directionalLight.target.position.set(0,0,0),this.directionalLight.shadow.camera.far=t+i,this.pointLight.position.set(0,t/2+i,0),this.directionalLight.shadow.camera.updateProjectionMatrix()}addLights(){this.hemisphereLight=this.hemisphereLight||new n.HemisphereLight(16777215,14145495,14),this.scene.add(this.hemisphereLight),this.directionalLight=this.directionalLight||new n.DirectionalLight(16774855,9),this.directionalLight.castShadow=!0,this.directionalLight.shadow.mapSize.width=1024,this.directionalLight.shadow.mapSize.height=1024,this.directionalLight.shadow.camera.near=.01,this.scene.add(this.directionalLight),this.pointLight=new n.PointLight(16777215,.5,0,2),this.scene.add(this.pointLight)}clearScene(){for(let t=this.scene.children.length-1;t>=0;t--){const e=this.scene.children[t];r.a.isPointLight(e)||r.a.isSpotLight(e)||r.a.isDirectionalLight(e)||r.a.isHemisphereLight(e)||(this.scene.remove(e),r.a.disposeObject3D(e,!0))}}clear(){this.clearScene(),this.matManager.clear(),this.modelToThreeMap.clear(),this.project.root.removeChildNodes()}executeCommand(t){if(t.type===l.Q.LoadExternalTile)this.clear(),this.commandManager.execute(new l.yb(this.project,this.matManager,this.thickness,this.analyticsManager),t)}update(){this.autoRot&&this.tileControl.update(),this.renderer.render(this.scene,this.perspectiveCamera)}buildCanvas(){const t=document.createElement("canvas");return t.style.position="absolute",this.containerDomElement.appendChild(t),t}}},function(t,e,i){"use strict";i.d(e,"a",(function(){return a}));class n{constructor(t){if(this.gaMeasurementId=t,"undefined"!=typeof window&&"undefined"!=typeof document&&!this._hasLoadedGA){const e="https://www.googletagmanager.com/gtag/js",i=document.getElementsByTagName("script");let n=!1;for(let t=0;t<i.length;t++)if(i.item(t).src.startsWith(e)){n=!0,console.debug("GTM script found");break}if(n)this.gtag=window.gtag,console.debug("gtag function found");else{const i=document.createElement("script");i.async=!0,i.src=`${e}?id=${t}`,document.body.appendChild(i),console.debug("added GTM script to the page"),window.dataLayer=window.dataLayer||[],this.gtag=function(){window.dataLayer.push(arguments)},window.gtag=this.gtag,this.gtag("js",new Date)}this._hasLoadedGA=!0}}setGlobalParameters(t,e){this.gtag("config",this.gaMeasurementId,{tenant_id:t,group_id:e,cookie_flags:"samesite=none;secure"})}sendEvent(t,e){this.gtag("event",t,Object.assign(Object.assign({},e),{send_to:this.gaMeasurementId}))}}class a{constructor(t,e,i){this.ga4Manager=new n(t),this.ga4Manager.setGlobalParameters(i,e)}notifyPagePreview(t,e){this.ga4Manager.sendEvent("component",{name:t,location:e})}droppedTile(t,e,i,n,a){this.ga4Manager.sendEvent("tile",{id_manuf:t,id_product:e,color_var:i,collection:n,surface_type:a})}droppedPattern(t){this.ga4Manager.sendEvent("pattern",{pattern_id:t})}commandExecuted(t){this.ga4Manager.sendEvent("command",{name:t})}singleTile3DViewed(t,e,i,n){this.ga4Manager.sendEvent("ti_view_3d_tile",{id_manuf:t,id_product:e,color_var:i,collection:n})}externalTileLoaded(){this.ga4Manager.sendEvent("ti_external_tile",{})}pbProjectLoaded(){this.ga4Manager.sendEvent("ti_pb_project",{})}projectShared(t){this.ga4Manager.sendEvent("project_shared",{scene_id:t})}projectSharedOpened(t){this.ga4Manager.sendEvent("open_project_shared",{scene_id:t})}vignetteCreated(t){this.ga4Manager.sendEvent("vignette_created",{type:t})}vignetteDownloaded(){this.ga4Manager.sendEvent("vignette_downloaded",{})}}},function(t,e,i){"use strict";i.d(e,"b",(function(){return n})),i.d(e,"a",(function(){return d}));var n,a=i(1),s=i(7),o=i(29),r=i(57);class h extends r.a{constructor(t){super(t),this.isCTShaderMaterial=!0,this.name="CTShaderMaterial"}dispose(){this.uShadingMap.value=null}copy(t){return super.copy(t)}clone(){return super.clone()}onBeforeCompile(t,e){super.onBeforeCompile(t,e),t.uniforms.shadingMap=this.uShadingMap,t.uniforms.screenResolution=this.uScreenResolution,t.uniforms.surfaceIndex=this.uSurfaceIndex,t.uniforms.shadingAmmount=this.uShadingAmmount,t.uniforms.reflectionAmmount=this.uReflectionAmmount,t.uniforms.selectionAmmount=this.uSelectionAmmount,t.uniforms.selectionColor=this.uSelectionColor,this.updateParams(),this.extendPixelShader(t,"map_pars_fragment","\n                uniform vec2 screenResolution;\n                uniform sampler2D shadingMap; \n                uniform float surfaceIndex;\n                uniform float shadingAmmount;\n                uniform float reflectionAmmount;\n                uniform float selectionAmmount;\n                uniform vec3 selectionColor;        \n        ");this.extendPixelShader(t,"encodings_fragment","\n                vec2 screenCoords = gl_FragCoord.xy / screenResolution;\n\n                // apply shadows\n                vec4 shading = texture2D(shadingMap, screenCoords);\n                \n                //float shadowMul = shading.g;\n                //shadowMul = pow(shadowMul, max(0.01, shadingAmmount));  // apply a gamma-based user modulation\n                //gl_FragColor.rgb = gl_FragColor.rgb * shadowMul;\n                //gl_FragColor.rgb = gl_FragColor.rgb * sqrt(max(1.0, shadingAmmount + 0.4));\n\n                // apply highlights using the computed surface normal\n                float hlPower = 1.0 / clamp(pow(roughnessFactor, 2.5), 0.0001, 1.0);                                                                            // calc a phong-like exponent from roghness\n                float fakeDotVR = clamp(dot(normalize(normal) * (128.0 / 127.0), normalize(vNormal)), 0.0, 1.0);                                                // calc a fake specular factor from the surface normal\n                float reflMul = max(0.0, 2.0 * texture2D(shadingMap, screenCoords, roughnessFactor * 8.0).b - 1.0);                                             // extract a shading value from the mask, roughness based blur\n                reflMul = pow(reflMul, clamp(1.0 / reflectionAmmount, 0.5, 3.0)) * min(reflectionAmmount - 0.2, 1.0) * mix(1.0 - roughnessFactor, 1.0, 0.5);    // apply a gamma-based user modulation\n                float hlIntensity = pow(fakeDotVR , hlPower) * clamp(reflMul, 0.0, 1.0);                                                                        // modulate specular with the shading mask, apply phong specular exponent\n                gl_FragColor.rgb = 1.0 - (1.0 - gl_FragColor.rgb) * (1.0 - vec3(hlIntensity));\n\n                gl_FragColor.rgb = mix(gl_FragColor.rgb, selectionColor, selectionAmmount);\n\n                if(step(abs(shading.r - surfaceIndex), 0.4999 / 255.0) == 1.0){\n                    gl_FragColor.a = 0.0; \n                }else{\n                    gl_FragColor.a = 1.0 - shading.a;\n                }\n                                       \n               //gl_FragColor.a = step(abs(shading.r - surfaceIndex), 0.4999 / 255.0) * shading.a * opacity * textureAlpha;\n                ")}updateParams(){this.shadingMap&&(this.uShadingMap.value=this.shadingMap,this.shadingMap.needsUpdate=!0),this.uScreenResolution.value=this.screenResolution,this.uSurfaceIndex.value=this.surfaceIndex,this.uSelectionAmmount.value=this.selectionAmmount,this.uSelectionColor.value=this.selectionColor}extendPixelShader(t,e,i){t.fragmentShader=t.fragmentShader.replace("#include <"+e+">","#include <"+e+">"+i)}extendVertexShader(t,e,i){t.vertexShader=t.vertexShader.replace("#include <"+e+">","#include <"+e+">"+i)}}!function(t){t[t.IBL=0]="IBL",t[t.CT=1]="CT"}(n||(n={}));class l{constructor(){this.id=null,this.width=null,this.height=null,this.isReflective=!1,this.hasTexture=!1,this.borderColor=null}}const c="0";class d{constructor(t,e,i,n,a=!0,s,o=0){this.matClient=t,this.project=e,this.scene=i,this.activityManager=n,this.iblShadingEnabled=a,this.renderFrame=s,this.maxTextureSize=o,this.defaultEnvMapIntensity=100,this.matMap=new Map}setMatResolution(t,e,i=!0){this.resolution=new a.Vector2(t,e),this.scene.traverse((n=>{n instanceof a.Mesh&&(s.a.isIBLStandardMaterial(n.material)||s.a.isCTShaderMaterial(n.material))&&(n.material.screenResolution.set(t,e),n.material.updateParams(),this.renderFrame&&i&&(this.renderFrame.value=!0))}))}setSelectionColor(t){const e=new a.Color(t);this.selectionColor=new a.Vector3(e.r,e.g,e.b),this.scene.traverse((t=>{t instanceof a.Mesh&&(s.a.isIBLStandardMaterial(t.material)||s.a.isCTShaderMaterial(t.material))&&(t.material.selectionColor=this.selectionColor,t.material.updateParams(),this.renderFrame&&(this.renderFrame.value=!0))}))}getSelectionColor(){return this.selectionColor}matKeyToString(t,e,i,n,a){return`${t}@${e}@${i}@${n}@${a}`}clear(){this.matMap.clear()}hasLoadedMaterial(t,e=0){const i=this.matKeyToString(t.manufacturer,t.name,c,0,e);return this.matMap.has(i)}updateDefaultEnvMap(t,e){t&&(this.defaultEnvMap=t),e&&(this.defaultEnvMapIntensity=e),this.matMap.forEach((i=>{i.then((i=>{i&&((s.a.isMeshStandardMaterial(i)||s.a.isIBLStandardMaterial(i))&&i.envMap&&(t&&(i.envMap=this.defaultEnvMap),e&&(i.envMapIntensity=this.defaultEnvMapIntensity)),s.a.isIBLStandardMaterial(i)&&(i.needsUpdate=!0,i.updateParams()),s.a.isMeshStandardMaterial(i)&&(i.needsUpdate=!0))})).catch((t=>{console.log("[MatManager] updateDefaultEnvMap matTileMap error")}))})),this.renderFrame&&(this.renderFrame.value=!0)}updateMaskShadingReflection(t,e){this.matMap.forEach((i=>{i.then((i=>{i&&s.a.isIBLStandardMaterial(i)&&(i.shadingAmmount=t,i.reflectionAmmount=e,i.updateParams())})).catch((t=>{console.log("[MatManager] uupdateMaskShadingReflection error")}))})),this.renderFrame&&(this.renderFrame.value=!0)}fetchIbl(t,e,i,n,a,s=!0){this.activityManager.addNonBlockingTask();const o=new Promise(((o,r)=>{this.matClient.getMat(t,e).then((t=>{if(t){const e=t.data;s&&(e.id=this.project.addMaterialKey(e.key));const r=this.getMaterial(e,a,!1,i,n);o(r)}else o(null)})).catch((t=>{r(t)}))}));return this.activityManager.nonBlockingTaskCompleted(),o}fetchIblTileMat(t,e,i,a,s,o,r=!0){const h=this.matKeyToString(t,e,i,a,s);let l=this.matMap.get(h);return l||(this.activityManager.addNonBlockingTask(),l=new Promise(((h,l)=>{this.matClient.getTileMat(t,e,i,a).then((t=>{if(t){const e=t.data;r&&(e.id=this.project.addMaterialKey(e.key));const i=this.getMaterial(e,n.IBL,!1,s,o);h(i)}else h(null)})).catch((t=>{console.log("fetchIblTileMat error: "+JSON.stringify(t)),l(t)}))})),this.matMap.set(h,l),this.activityManager.nonBlockingTaskCompleted()),l}fetch(t,e,i=!0,n=0){const a=this.matKeyToString(t,e,c,0,0);let s=this.matMap.get(a);return s||(this.activityManager.addNonBlockingTask(),s=new Promise(((n,a)=>{this.matClient.getMat(t,e).then((t=>{if(t){const e=t.data;i&&(e.id=this.project.addMaterialKey(e.key));const a=this.getMaterial(e,null,null,null,null);n(a)}else n(null)})).catch((t=>{a(t)}))})),this.matMap.set(a,s),this.activityManager.nonBlockingTaskCompleted()),s}fetchTileMat(t,e,i,n,a,s=!0){const o=this.matKeyToString(t,e,i,n,a);let r=this.matMap.get(o);return r||(this.activityManager.addNonBlockingTask(),r=new Promise(((a,o)=>{this.matClient.getTileMat(t,e,i,n).then((t=>{if(t){const e=t.data;s&&(e.id=this.project.addMaterialKey(e.key));const i=this.getMaterial(e,null);a(i)}else a(null)})).catch((t=>{o(t)}))})),this.matMap.set(o,r),this.activityManager.nonBlockingTaskCompleted()),r}createMat(t,e,i,n=!0){let a=this.matMap.get(this.matKeyToString(t,e,c,0,0));return a||(a=new Promise(((t,e)=>{n&&(i.id=this.project.addMaterialKey(i.key));t(this.getMaterial(i,null,!0))})),this.matMap.set(this.matKeyToString(t,e,c,0,0),a)),a}createExternalTileMat(t,e,i,a,s,o,r=!0){if(this.iblShadingEnabled){r&&(o.id=this.project.addMaterialKey(o.key));const h=this.getMaterial(o,n.IBL,!0,s),l=Promise.resolve(h),c=this.matKeyToString(t,e,i,a,s);return this.matMap.set(c,l),Promise.resolve(null)}{let n=this.matMap.get(this.matKeyToString(t,e,i,a,s));return n||(n=new Promise(((t,e)=>{r&&(o.id=this.project.addMaterialKey(o.key));t(this.getMaterial(o,null,!0))})),this.matMap.set(this.matKeyToString(t,e,i,a,s),n)),n}}getMaterialExtendedData(t){return t.userData}isMaterialReflective(t){return t.roughness<.9||t.metalness>0}getPlaceholderMaterial(){return new a.MeshBasicMaterial({color:16777215,side:a.FrontSide,opacity:0,transparent:!0,toneMapped:!1})}getIBLPlaceholderMaterial(t,e){const i=new o.a({color:16777215,side:a.FrontSide,opacity:1});return i.shadingMap=e.texture,i.shadingAmmount=e.shading,i.reflectionAmmount=e.reflection,i.surfaceIndex=t/255,i.screenResolution.set(this.resolution.x,this.resolution.y),i.updateParams(),this.renderFrame&&(this.renderFrame.value=!0),i}setIBLMaterialData(t,e,i,n=!0){t.shadingMap=i.texture,t.shadingAmmount=i.shading,t.reflectionAmmount=i.reflection,t.surfaceIndex=e/255,t.screenResolution.set(this.resolution.x,this.resolution.y),t.selectionColor=this.selectionColor,t.updateParams(),this.renderFrame&&n&&(this.renderFrame.value=!0)}getMaterial(t,e,i=!1,s=-1,r=null){let c;const d={color:16777215,side:a.FrontSide,roughness:1,metalness:0,bumpScale:3};e===n.IBL||e===n.CT?(c=e===n.IBL?new o.a(d):new h(d),c.screenResolution.set(this.resolution.x,this.resolution.y),c.selectionColor=this.selectionColor,c.surfaceIndex=s/255,r&&(c.shadingMap=r.texture,c.shadingAmmount=r.shading,c.reflectionAmmount=r.reflection)):c=new a.MeshStandardMaterial(d);const u=new l;return c.userData=u,u.id=t.id,null!=t.map?(this.getTexture(t.map,!0,i).then((t=>{c.map=t,this.update(c)})),u.hasTexture=!0):null!=t.color&&c.color.set(t.color),null!=t.alphaMap&&(this.getTexture(t.alphaMap,!1,i).then((t=>{c.alphaMap=t,this.update(c)})),c.transparent=!0,u.hasTexture=!0),null!=t.bumpMap&&(this.getTexture(t.bumpMap,!1,i).then((t=>{c.bumpMap=t,this.update(c)})),u.hasTexture=!0),null!=t.bumpScale&&(c.bumpScale=t.bumpScale),null!=t.displacementMap&&(this.getTexture(t.displacementMap,!1,i).then((t=>{c.displacementMap=t,this.update(c)})),u.hasTexture=!0),null!=t.displacementScale&&(c.displacementScale=t.displacementScale),null!=t.displacementBias&&(c.displacementBias=t.displacementBias),null!=t.emissive&&c.emissive.set(t.emissive),null!=t.emissiveIntensity&&(c.emissiveIntensity=t.emissiveIntensity),null!=t.metalness&&(c.metalness=t.metalness),null!=t.metalnessMap&&(this.getTexture(t.metalnessMap,!1,i).then((t=>{c.metalnessMap=t,this.update(c)})),u.hasTexture=!0),null!=t.normalMap&&(this.getTexture(t.normalMap,!1,i).then((t=>{c.normalMap=t,this.update(c)})),u.hasTexture=!0),null!=t.normalScale&&(c.normalScale=new a.Vector2(t.normalScale.x,t.normalScale.y)),null!=t.opacity&&(c.transparent=!0,c.opacity=t.opacity),null!=t.roughness&&(c.roughness=t.roughness),null!=t.roughnessMap&&(this.getTexture(t.roughnessMap,!1,i).then((t=>{c.roughnessMap=t,this.update(c)})),u.hasTexture=!0),null!=t.width&&(u.width=t.width),null!=t.height&&(u.height=t.height),null!=t.borderColor&&(u.borderColor=t.borderColor),c.needsUpdate=!0,c}update(t){t.needsUpdate=!0,this.renderFrame&&(this.renderFrame.value=!0)}getTexture(t,e,i=!1){return new Promise(((n,s)=>{this.activityManager.addNonBlockingTask();const o=new a.TextureLoader;let r;i?r=t:(r=this.matClient.getTextureUrl(t,this.maxTextureSize),o.setCrossOrigin("use-credentials")),o.load(r,(i=>{i.name=t,e&&(i.colorSpace=a.SRGBColorSpace,i.anisotropy=16),i.wrapS=a.RepeatWrapping,i.wrapT=a.RepeatWrapping,this.activityManager.nonBlockingTaskCompleted(),n(i)}),(t=>{}),(e=>{console.error(`Error loading texture ${t}: ${e.error}`),this.activityManager.nonBlockingTaskCompleted(),s(e.error)}))}))}}},function(t,e,i){"use strict";i.d(e,"a",(function(){return a})),i.d(e,"c",(function(){return s})),i.d(e,"b",(function(){return o}));var n=i(31);class a{constructor(t,e){this.start=t,this.end=e}}class s{}class o extends n.a{constructor(t,e){super(t,e)}perspectiveFromVanishingLine(t){return this.post("api/perspective/fromvanishinglines",JSON.stringify(t)).then(this.responseAsJson).then((t=>t))}}},function(t,e,i){"use strict";i.d(e,"b",(function(){return o})),i.d(e,"a",(function(){return r}));var n=i(13),a=i(19);const s=i(61);var o;!function(t){t[t.STATIC=0]="STATIC",t[t.CUSTOM=1]="CUSTOM"}(o||(o={}));class r extends n.a{constructor(){super(),this.type=a.a.DTProject,this.sceneId=s(),this.verMin=0,this.verMax=5,this.sceneType=o.CUSTOM}}},function(t,e,i){"use strict";var n;i.d(e,"a",(function(){return n})),function(t){t[t.PCS=0]="PCS",t[t.MM=1]="MM",t[t.CM=2]="CM",t[t.M=3]="M",t[t.IN=4]="IN",t[t.FT=5]="FT",t[t.MM2=6]="MM2",t[t.CM2=7]="CM2",t[t.M2=8]="M2",t[t.IN2=9]="IN2",t[t.FT2=10]="FT2"}(n||(n={}))},function(t,e,i){"use strict";var n;i.d(e,"a",(function(){return n})),function(t){t[t.FLOOR=0]="FLOOR",t[t.WALL=1]="WALL",t[t.BACKSPLASH=2]="BACKSPLASH",t[t.RUG=3]="RUG",t[t.HPLANE=4]="HPLANE",t[t.CORRIDOR=5]="CORRIDOR"}(n||(n={}))},function(t,e,i){"use strict";i.d(e,"a",(function(){return p}));var n=i(0),a=i(2),s=i(4),o=i(1),r=i(17),h=i(21),l=i(7),c=i(45),d=i(28),u=i(5);class p{constructor(t,e,i,n){this.project=t,this.matManager=e,this.patternLoader=i,this.sceneEntities=n,this.getBorderMatInfo=(t,e,i,n)=>{let a,s;if(e){const t=this.matManager.getMaterialExtendedData(e);t&&(a=t.width,s=t.height)}else if(-1!==i.materialId&&n){const t=n.data;a=t.width,s=t.height}return{matKey:t,material:e,texWidth:a,texHeight:s}}}getFace3DGeometry(t,e,i,n){return Object(s.f)(t,s.a,null,[],e,i,n)||new o.BufferGeometry}getMatKey(t,e){return this.project.getMaterialKey(t)||e}loadTile(t,e,i){if(t.data.type!==n.r.DTFace3D)throw new Error("Invalid node type");const a=t.getFirstChildOfType(n.r.DTTileInst);a&&this.loadTopFace(e,t,!0,a,i),this.getBorderMaterial(a,t).then((i=>{for(const a of t.childNodes)switch(a.data.type){case n.r.DTTileList:this.patternLoader.loadTileList(a);break;case n.r.DTFace3D:{const t=this.sceneEntities.addAndAttachToParentAndSetId(a.id,new o.Mesh,e);this.loadBorderFace(t,a,!0,i.material,i.matKey,i.texWidth,i.texHeight);break}}}))}getBorderMaterial(t,e){return new Promise(((i,a)=>{const s=e.getFirstChildOfType(n.r.DTFace3D).data,r=-1!==s.materialId?null:n.B;let h;if(h=r||this.getMatKey(s.materialId,null),h)this.matManager.fetch(h.manufacturer,h.name,!0).then((e=>{i(this.getBorderMatInfo(h,e,s,t))}));else{const e=new o.MeshStandardMaterial({color:16777215,side:o.FrontSide,roughness:1,metalness:0}),n=new o.Color(s.color),a=1,r=1,l=a*r,c=new Uint8Array(3*l),d=Math.floor(255*n.r),u=Math.floor(255*n.g),p=Math.floor(255*n.b);for(let t=0;t<l;t++){const e=3*t;c[e]=d,c[e+1]=u,c[e+2]=p}const g=new o.DataTexture(c,a,r,o.RGBAFormat);g.colorSpace=o.SRGBColorSpace,g.anisotropy=16,g.wrapS=o.RepeatWrapping,g.wrapT=o.RepeatWrapping,e.map=g,e.needsUpdate=!0,i(this.getBorderMatInfo(h,e,s,t))}}))}reloadTopMaterial(t,e){const i=t.data,n=this.getMatKey(i.materialId,null);if(n)this.matManager.fetchTileMat(n.manufacturer,n.name,"0",n.idx,u.n,!0).then((t=>{e.material=t,e.material.needsUpdate=!0}));else{const t=new o.MeshStandardMaterial({color:i.color,side:o.FrontSide});e.material=t,e.material.needsUpdate=!0}}loadTopFace(t,e,i,n,u){const p=e.data;t.matrixAutoUpdate=!1,t.receiveShadow=!0,t.castShadow=i,this.reloadTopMaterial(e,t);const g=n.data,m=r.b.getTilePolygon(g.formatType,g.width,g.height,g.diagonal,g.polygonSet),f=Object(h.c)(p.points,Object(h.b)(p),{x:0,y:0,z:1});let y;if(g.polygonSet.contours.length>1){const t=m.boundingBox;y={x:-t.min.x,y:-t.min.y}}else y=a.a.vec2Clone(g.polygonSet.contours[0].vertices[0]);const v=a.a.mat3GetIdentity();a.a.mat3Translate(v,-y.x,-y.y);const x=[];for(const t of g.polygonSet.contours){const e=a.a.pnt2TransformArray(v,t.vertices);x.push(e)}const T=[],M=[],C=[];let b=-1;for(let t=0;t<x.length;t++){const e=d.b(x[t]);if(g.polygonSet.holes[t]){C[b].holes.push(e)}else C.push(e),b=t}const P=new o.ShapeGeometry(C);let E=a.a.mat3GetIdentity();E=m.getTransformedPolygonMatrix(0,0,E);const D=m.getTextureRotationMatrix(0),w=l.a.getPositionAttibute(P);for(let t=0;t<w.count;t++){const e={x:w.getX(t),y:w.getY(t)};T.push(e);const i={x:e.x+y.x,y:e.y+y.y},n=r.b.getTexureCoordinate(i,E,D,m.textureInfo);M.push(n.x,n.y)}const S=P.getIndex().array,I=a.a.poly2ToPoly3(T,f._3DMatrix,0),L=a.a.pnt3Flatten(I),A=a.a.vec3Negate(a.a.poly3Normal(p.points)),O=[];for(const t of I)O.push(A.x,A.y,A.z);const R=new o.BufferGeometry,_=new Float32Array(L.length);R.setAttribute("position",new o.BufferAttribute(_,3));const k=new Uint16Array(S.length);R.setIndex(new o.BufferAttribute(k,1));const j=new Float32Array(M.length);R.setAttribute("uv",new o.BufferAttribute(j,2));const N=new Float32Array(O.length);R.setAttribute("normal",new o.BufferAttribute(N,3));for(let t=0;t<S.length;t++)k[t]=S[t];for(let t=0;t<L.length;t++)_[t]=L[t];for(let t=0;t<M.length;t++)j[t]=M[t];for(let t=0;t<O.length;t++)N[t]=O[t];R.applyMatrix4(s.a),t.geometry=R;const F=this.sceneEntities.addAndAttachToParentAndSetId("BOTTOM_MESH",new o.Mesh,t),z=R.clone();F.material=new o.MeshBasicMaterial({}),F.geometry=z,F.castShadow=!0,F.rotation.x=Math.PI,F.position.y=-u*c.a}loadBorderFace(t,e,i,a,s,o,r){if(e.data.type!==n.r.DTFace3D)throw new Error("Invalid node type");const h=e.data;t.matrixAutoUpdate=!1,t.receiveShadow=!0,t.castShadow=i,a?this.updateFace3DMesh(t,a,h.points,!0,o,r):(t.geometry=this.getFace3DGeometry(h.points,!1,o,r),t.material=this.matManager.getPlaceholderMaterial(),this.matManager.fetch(s.manufacturer,s.name).then((e=>{e&&this.updateFace3DMesh(t,e,h.points,!1,o,r)})).catch((t=>{console.log("[TileLoader] matManager fetch error")})))}updateFace3DMesh(t,e,i,n,a=null,s=null){const o=this.matManager.getMaterialExtendedData(e);t.material=e,t.material.needsUpdate=!0,(o.hasTexture||n)&&(t.geometry.dispose(),t.geometry=a&&s?this.getFace3DGeometry(i,o.hasTexture,a,s):this.getFace3DGeometry(i,o.hasTexture,o.width,o.height))}removeFace3D(t){const e=t.getFirstChildOfType(n.r.DTTileList);e&&this.patternLoader.removeTileList(e)}}},function(t,e,i){"use strict";i.d(e,"a",(function(){return a}));var n=i(27);class a{constructor(){this.selectionChanged=new n.a,this.selectedObjects=new Set}cloneSelection(t){let e=new Set;return t.forEach((t=>{e.add(t)})),e}clear(){if(this.selectedObjects.size>0){let t=this.cloneSelection(this.selectedObjects);this.selectedObjects.clear(),this.selectionChanged.notify(new s(t,this.cloneSelection(this.selectedObjects)))}}add(...t){if(this.has(...t))return;let e=this.cloneSelection(this.selectedObjects);for(const e of t)this.selectedObjects.add(e);this.selectionChanged.notify(new s(e,this.cloneSelection(this.selectedObjects)))}set(...t){if(this.matches(...t))return;let e=this.cloneSelection(this.selectedObjects);this.selectedObjects.clear();for(const e of t)this.selectedObjects.add(e);this.selectionChanged.notify(new s(e,this.cloneSelection(this.selectedObjects)))}toggle(t,e=!1){let i=this.cloneSelection(this.selectedObjects),n=this.selectedObjects.has(t);e?n?this.selectedObjects.delete(t):this.selectedObjects.add(t):(this.selectedObjects.clear(),n||this.selectedObjects.add(t)),this.selectionChanged.notify(new s(i,this.cloneSelection(this.selectedObjects)))}remove(...t){if(!this.has(...t))return;let e=this.cloneSelection(this.selectedObjects);for(const e of t)this.selectedObjects.delete(e);this.selectionChanged.notify(new s(e,this.cloneSelection(this.selectedObjects)))}has(...t){for(const e of t)if(!this.selectedObjects.has(e))return!1;return!0}matches(...t){return this.has(...t)&&t.length==this.selectedObjects.size}getSelectionSet(){return this.cloneSelection(this.selectedObjects)}}class s{constructor(t,e){this.previousSelection=t,this.currentSelection=e}}},function(t,e,i){"use strict";i.d(e,"a",(function(){return h})),i.d(e,"b",(function(){return l}));var n=i(6),a=i(3),s=i(32),o=i(4),r=i(33);class h{constructor(t,e){this.width=t,this.height=e,this.type=a.Q.SetupVignetteView}}class l extends n.a{constructor(t,e,i){super(),this.orthoCamera=t,this.viewWidth=e,this.viewHeight=i}onStart(){const t=this.command,e=s.a;e.size.x=t.width,e.size.y=t.height;const i=Object(s.b)(e,o.a,o.b),n=new r.b(this.viewWidth,this.viewHeight);n.marginPixels=new r.a(0,0,0,0),n.configureCamera(this.orthoCamera,i),this.orthoCamera.updateProjectionMatrix()}onEnd(t){t()}}},function(t,e,i){"use strict";i.d(e,"a",(function(){return J}));var n=i(1),a=i(25),s=i(9),o=i(3),r=i(2),h=i(7),l=i(0),c=i(16),d=i(23),u=i(11),p=i(40),g=i(42),m=i(53),f=i(35),y=i(41),v=i(8),x=i(46),T=i(5),M=i(26),C=i(27),b=i(15);const P=i(59);var E;!function(t){t.L="L",t.R="R",t.T="T",t.B="B"}(E||(E={}));class D{get enabled(){return this._enabled}set enabled(t){this._enabled!==t&&(this._enabled=t,this._enabled||this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height))}constructor(t,e){this.inputDomElement=t,this.camera=e,this.alignLineColor="#ff0000",this.extendLineColor="#007a00",this.cpRadius=7*window.devicePixelRatio,this.selectionTh=10*window.devicePixelRatio,this.lineWidth=2*window.devicePixelRatio,this.extendSelectionTh=20*window.devicePixelRatio,this.pointerDownEventHandler=t=>{if(this.enabled){const e=c.a.getPointerCoordinates(t,this.inputDomElement.parentElement.id),i=r.a.vec2Scale(e,window.devicePixelRatio);if(this.alignLineVisible){const t=r.a.vec2Distance(i,this.align2DPoints[0]),n=r.a.vec2Distance(i,this.align2DPoints[1]);if(t<this.selectionTh)this.planePoint=this.align3DPoints[0],this.selectedAlignIndex=0;else if(n<this.selectionTh)this.planePoint=this.align3DPoints[1],this.selectedAlignIndex=1;else{const t=this.align2DPoints[1].x-this.align2DPoints[0].x,n=this.align2DPoints[1].y-this.align2DPoints[0].y,a=r.a.line2SegmentDistanceToPointSq(i.x,i.y,this.align2DPoints[0].x,this.align2DPoints[0].y,this.align2DPoints[1].x,this.align2DPoints[1].y);if(Math.sqrt(a)<this.selectionTh){const a=((i.x-this.align2DPoints[0].x)*t+(i.y-this.align2DPoints[0].y)*n)/(t*t+n*n);a>.1&&a<.9&&(this.planePoint=this.getPlaneIntersection(this.floorPlaneNormal,this.align3DPoints[0],e),this.selectedAlignIndex=3)}}if(-1!==this.selectedAlignIndex)return this.isAligning=!0,void this.onChange.notify({type:"BEGIN"})}const n=Object(b.b)(this.clipperSolution,!0,!1),a=r.a.poly2SignedDistanceToPoint(i.x,i.y,n);if(a<0)return void this.onChange.notify({type:"DETACH"});const s=r.a.poly2BoundingBox(n[0]),o=[{x:s.min.x,y:s.min.y},{x:s.max.x,y:s.min.y},{x:s.max.x,y:s.max.y},{x:s.min.x,y:s.max.y}],h=r.a.poly2Centroid(o);for(let t=0;t<o.length;t++){const n=[[o[t],o[r.a.numberIncr(t,o.length)],h]];if(r.a.poly2SignedDistanceToPoint(i.x,i.y,n)>0){switch(t){case 0:this.selectedExtendName=E.T;break;case 1:this.selectedExtendName=E.R;break;case 2:this.selectedExtendName=E.B;break;case 3:this.selectedExtendName=E.L}this.selectionDelta=a;const i=this.getPlaneIntersection(this.planeNormal,this.grid3DPoints[0],e);this.planePoint=i.clone();break}}}},this.pointerMoveEventHandler=t=>{if(this.enabled&&null!=this.planePoint){const e=c.a.getPointerCoordinates(t,this.inputDomElement.parentElement.id);if(this.isAligning){const t=this.getPlaneIntersection(this.floorPlaneNormal,this.planePoint,e);if(t){const e=t.clone().sub(this.planePoint),i=r.a.vec3Clone(this.grid3DPoints[3]),n=r.a.vec3Clone(this.grid3DPoints[2]);i.y=this.alignPlaneHeight,n.y=this.alignPlaneHeight;const a=r.a.vec3Distance(this.align3DPoints[0],i),s=r.a.vec3Distance(this.align3DPoints[1],n);3===this.selectedAlignIndex?(this.align3DPoints[0].x+=e.x,this.align3DPoints[0].z+=e.z,this.align3DPoints[1].x+=e.x,this.align3DPoints[1].z+=e.z):(this.align3DPoints[this.selectedAlignIndex].x+=e.x,this.align3DPoints[this.selectedAlignIndex].z+=e.z);const o=this.movePoint(this.align3DPoints[0],this.align3DPoints[1],this.align3DPoints[0],a);this.grid3DPoints[3].x=o.x,this.grid3DPoints[3].z=o.z,this.grid3DPoints[0].x=o.x,this.grid3DPoints[0].z=o.z;const h=this.movePoint(this.align3DPoints[1],this.align3DPoints[0],this.align3DPoints[1],s);this.grid3DPoints[2].x=h.x,this.grid3DPoints[2].z=h.z,this.grid3DPoints[1].x=h.x,this.grid3DPoints[1].z=h.z,this.updatePoints(),this.planePoint=t.clone()}}else{this.selectedExtendName===E.L&&this.selectionDelta!==Number.MAX_VALUE?e.x=e.x-this.selectionDelta:this.selectedExtendName===E.R&&this.selectionDelta!==Number.MAX_VALUE?e.x=e.x+this.selectionDelta:this.selectedExtendName===E.T&&this.selectionDelta!==Number.MAX_VALUE?e.y=e.y-this.selectionDelta:this.selectedExtendName===E.B&&this.selectionDelta!==Number.MAX_VALUE&&(e.y=e.y+this.selectionDelta);const t=this.getPlaneIntersection(this.planeNormal,this.planePoint,e);t&&(this.alignLineVisible?this.selectedExtendName===E.L?(this.grid3DPoints[3].x=t.x,this.grid3DPoints[3].z=t.z,this.grid3DPoints[0].x=t.x,this.grid3DPoints[0].z=t.z):this.selectedExtendName===E.R?(this.grid3DPoints[2].x=t.x,this.grid3DPoints[2].z=t.z,this.grid3DPoints[1].x=t.x,this.grid3DPoints[1].z=t.z):this.selectedExtendName===E.T?t.y>this.grid3DPoints[3].y&&(this.grid3DPoints[0].y=t.y,this.grid3DPoints[1].y=t.y):this.selectedExtendName===E.B&&t.y<this.grid3DPoints[0].y&&(this.grid3DPoints[3].y=t.y,this.grid3DPoints[2].y=t.y):this.selectedExtendName===E.L?(this.grid3DPoints[3].x=t.x,this.grid3DPoints[0].x=t.x):this.selectedExtendName===E.R?(this.grid3DPoints[1].x=t.x,this.grid3DPoints[2].x=t.x):this.selectedExtendName===E.T?(this.grid3DPoints[0].z=t.z,this.grid3DPoints[1].z=t.z):this.selectedExtendName===E.B&&(this.grid3DPoints[3].z=t.z,this.grid3DPoints[2].z=t.z),this.updatePoints())}}},this.pointerUpEventHandler=t=>{if(this.enabled&&null!=this.planePoint){const t={type:"END",recalcAlignment:this.isAligning,projectedGridPoint:this.grid3DPoints,grid2DPoints:r.a.vec2ArrayClone(this.grid2DPoints)};this.alignLineVisible&&(t.align2DPoints=r.a.vec2ArrayClone(this.align2DPoints)),this.onChange.notify(t),this.isAligning=!1,this.planePoint=null,this.selectedAlignIndex=-1}},this.canvasElement=document.createElement("canvas"),this.canvasElement.style.background="transparent",this.canvasElement.style.position="absolute",this.ctx=this.canvasElement.getContext("2d"),this.inputDomElement.appendChild(this.canvasElement),this.enabled=!1,this.onChange=new C.a,this.selectedAlignIndex=-1,this.floorPlaneNormal=new n.Vector3(0,1,0),this.clipperSolution=new P.Paths,this.clipperOffsettedPath=new P.Paths,this.grid2DPoints=[],this.align2DPoints=[],this.setSize(0,0)}setPlaneData(t,e,i,n){let a=0;for(const e of t)e.y<a&&(a=e.y);if(a<0){for(const e of t)e.y-=a;e[0].y-=a,e[1].y-=a}this.alignPlaneHeight=n,this.grid3DPoints=t,this.align3DPoints=e;const s=Math.min(this.grid3DPoints[2].y,this.grid3DPoints[3].y);this.grid3DPoints[2].y=s,this.grid3DPoints[3].y=s,this.align3DPoints?(this.grid3DPoints[2].y=n,this.grid3DPoints[3].y=n,this.align3DPoints[0].y=n,this.align3DPoints[1].y=n,this.alignLineVisible=!0):this.alignLineVisible=!1,this.planeNormal=i,this.updatePoints(),this.enabled=!0}setPlaneNormal(t){this.planeNormal=t}movePoint(t,e,i,n){const a=e.clone(),s=i.clone().sub(a).normalize();s.multiplyScalar(n);const o=t.clone();return o.add(s),o}updatePoints(){const t=new P.Clipper,e=[];for(let t=0;t<this.grid3DPoints.length;t++){const i=h.a.worldToViewportPosition(this.grid3DPoints[t],this.camera,this.canvasWidth,this.canvasHeight,window.devicePixelRatio);this.grid2DPoints[t]=i,e.push({X:i.x,Y:i.y})}t.AddPath(this.imagePolygon,P.PolyType.ptSubject,!0),t.AddPath(e,P.PolyType.ptClip,!0),t.Execute(P.ClipType.ctIntersection,this.clipperSolution,P.PolyFillType.pftNonZero,P.PolyFillType.pftEvenOdd);const i=new P.ClipperOffset(2,.25);i.AddPaths(this.clipperSolution,P.JoinType.jtMiter,P.EndType.etClosedPolygon),i.Execute(this.clipperOffsettedPath,-this.extendSelectionTh),this.alignLineVisible&&(this.align2DPoints[0]=h.a.worldToViewportPosition(this.align3DPoints[0],this.camera,this.canvasWidth,this.canvasHeight,window.devicePixelRatio),this.align2DPoints[1]=h.a.worldToViewportPosition(this.align3DPoints[1],this.camera,this.canvasWidth,this.canvasHeight,window.devicePixelRatio))}getPlaneIntersection(t,e,i){const a=(new n.Plane).setFromNormalAndCoplanarPoint(t,e);return h.a.getPlaneIntersection(a,Object(r.e)(i),this.camera,this.canvasElement.offsetWidth,this.canvasElement.offsetHeight)}render(){if(this.enabled){if(this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.clipperSolution.length>0){this.ctx.globalAlpha=.3,this.ctx.strokeStyle=this.extendLineColor,this.ctx.fillStyle=this.extendLineColor,this.ctx.lineWidth=this.lineWidth,this.ctx.beginPath();let t=this.clipperSolution[0][0];this.ctx.moveTo(t.X,t.Y);for(let e=1;e<this.clipperSolution[0].length;e++)t=this.clipperSolution[0][e],this.ctx.lineTo(t.X,t.Y);if(this.ctx.closePath(),this.clipperOffsettedPath.length>0){let t=this.clipperOffsettedPath[0][0];this.ctx.moveTo(t.X,t.Y);for(let e=this.clipperOffsettedPath[0].length-1;e>0;e--)t=this.clipperOffsettedPath[0][e],this.ctx.lineTo(t.X,t.Y);this.ctx.closePath(),this.ctx.fill(),this.ctx.stroke()}}this.alignLineVisible&&(this.ctx.strokeStyle=this.alignLineColor,this.ctx.fillStyle=this.alignLineColor,this.ctx.globalAlpha=1,this.ctx.beginPath(),this.ctx.arc(this.align2DPoints[0].x,this.align2DPoints[0].y,this.cpRadius,0,2*Math.PI),this.ctx.fill(),this.ctx.stroke(),this.ctx.beginPath(),this.ctx.arc(this.align2DPoints[1].x,this.align2DPoints[1].y,this.cpRadius,0,2*Math.PI),this.ctx.fill(),this.ctx.stroke(),this.ctx.beginPath(),this.ctx.moveTo(this.align2DPoints[0].x,this.align2DPoints[0].y),this.ctx.lineTo(this.align2DPoints[1].x,this.align2DPoints[1].y),this.ctx.stroke()),this.ctx.globalAlpha=1}}attachDomHandlers(){this.inputDomElement.addEventListener("mousemove",this.pointerMoveEventHandler),this.inputDomElement.addEventListener("touchmove",this.pointerMoveEventHandler),this.inputDomElement.addEventListener("mousedown",this.pointerDownEventHandler),this.inputDomElement.addEventListener("touchstart",this.pointerDownEventHandler),this.inputDomElement.addEventListener("mouseup",this.pointerUpEventHandler),this.inputDomElement.addEventListener("touchend",this.pointerUpEventHandler),this.inputDomElement.addEventListener("touchcancel",this.pointerUpEventHandler)}detachDomHandlers(){this.inputDomElement.removeEventListener("mousemove",this.pointerMoveEventHandler),this.inputDomElement.removeEventListener("touchmove",this.pointerMoveEventHandler),this.inputDomElement.removeEventListener("mousedown",this.pointerDownEventHandler),this.inputDomElement.removeEventListener("touchstart",this.pointerDownEventHandler),this.inputDomElement.removeEventListener("mouseup",this.pointerUpEventHandler),this.inputDomElement.removeEventListener("touchend",this.pointerUpEventHandler),this.inputDomElement.removeEventListener("touchcancel",this.pointerUpEventHandler),this.enabled=!1,this.setSize(0,0)}setSize(t,e){this.canvasElement.width=t*window.devicePixelRatio,this.canvasElement.height=e*window.devicePixelRatio,this.canvasElement.style.width=t+"px",this.canvasElement.style.height=e+"px",this.canvasWidth=t,this.canvasHeight=e,this.imagePolygon=[{X:0,Y:0},{X:0,Y:this.canvasHeight*window.devicePixelRatio},{X:this.canvasWidth*window.devicePixelRatio,Y:this.canvasHeight*window.devicePixelRatio},{X:this.canvasWidth*window.devicePixelRatio,Y:0*window.devicePixelRatio}],this.enabled&&this.grid2DPoints.length>0&&this.updatePoints()}getSize(){return{x:this.canvasWidth,y:this.canvasHeight}}}var w=i(34),S=i(4);class I{constructor(t,e,i){this.inputDomElement=t,this.project=e,this.camera=i,this.onGridCanvasChanged=t=>{switch(t.type){case"BEGIN":case"CHANGED":break;case"END":{const e=this.scaleCanvasPointsToImage(t.grid2DPoints);let i=[];t.align2DPoints&&(i=this.scaleCanvasPointsToImage(t.align2DPoints));const n=this.face3DNode.data,a=r.a.pnt3TransformArray(this.threeToModelMat4,t.projectedGridPoint),s=this.project.root.data;if(s.sceneType===l.I.STATIC)n.points[0]=a[2],n.points[1]=a[3],n.points[2]=a[0],n.points[3]=a[1];else if(s.sceneType===l.I.CUSTOM){const e={x:(a[2].x+a[3].x)/2,y:(a[2].y+a[3].y)/2},i=r.a.vec2Diff(a[2],e);r.a.vec2Normalize(i);const s=r.a.vec2Add(e,r.a.vec2Mult(5e3,i)),o=r.a.vec2Diff(e,r.a.vec2Mult(5e3,i));let h=a[0].z;(t.grid2DPoints[0].y<0||t.grid2DPoints[1].y<0)&&(h=1e4),n.points[0]={x:s.x,y:s.y,z:a[2].z},n.points[1]={x:o.x,y:o.y,z:a[2].z},n.points[2]={x:o.x,y:o.y,z:h},n.points[3]={x:s.x,y:s.y,z:h}}this.project.projectChanged.notify({type:"FACE3D_UPDATE",node:this.face3DNode});const o=this.face3DNode.parentNode.data;if(null==o.arData?o.arData=new l.a(e,i,0):(o.arData.gridPoints=e,o.arData.alignPoints=i),t.recalcAlignment){const e=w.a.getPolygonNormal(Object(r.d)(t.projectedGridPoint)).normalize().negate();this.gridCanvas.setPlaneNormal(e)}break}}},this.gridCanvas=new D(this.inputDomElement,this.camera),this.threeToModelMat4=Object(r.b)(S.c)}render(){this.gridCanvas.render()}setSize(t,e){this.canvasSize={x:t,y:e},this.gridCanvas.setSize(t,e)}getSize(){return this.canvasSize}showGridCanvas(t){this.gridCanvas.setSize(this.canvasSize.x,this.canvasSize.y);const e=this.project.root.getFirstChildOfType(l.r.DTBackgroundImage).data;this.imageSize=e.imageSizeProcessing,this.node=t,this.face3DNode=t.getFirstChildOfType(l.r.DTFace3D);const i=this.project.root.getFirstChildOfType(l.r.DTPrjData);let n=0;if(i){n=i.data.alignPlaneHeight}const a=t.data;null!=a.arData?this.createGridCanvas(a,this.face3DNode.data,n):this.createDefaultVerticalGridCanvas(a,n),this.attachEventHandlers()}createDefaultVerticalGridCanvas(t,e){const i=this.gridCanvas.canvasElement.width,a=this.gridCanvas.canvasElement.height,s=[{x:i/4,y:a/4},{x:i-i/4,y:a/4},{x:i-i/4,y:a-a/4},{x:i/4,y:a-a/4}],o=[{x:i/4,y:a-a/4},{x:i-i/4,y:a-a/4}],r=new n.Vector3(0,1,0),h=new n.Vector3(0,e,0),c=this.projectPointsIn3D([{x:i/2,y:a-10}],r,h)[0].z-T.o*T.s,d=new n.Vector3(0,0,1),u=new n.Vector3(0,0,c),p=this.projectPointsIn3D(s,d,u),g=this.projectPointsIn3D(o,d,u);this.gridCanvas.setPlaneData(p,g,d,e*T.s),t.arData=new l.a(s,o,0)}createGridCanvas(t,e,i){const a=w.a.getPolygonNormal(e.points).normalize().negate();a.applyMatrix4(S.a);const s=new n.Vector3(e.points[0].x,e.points[0].y,e.points[0].z);s.applyMatrix4(S.a);const o=this.scaleImagePointsToCanvas(t.arData.gridPoints),r=this.projectPointsIn3D(o,a,s);if(0==r.length)this.createDefaultVerticalGridCanvas(t,0);else{let e,n=null;t.surfaceType!==l.J.WALL&&t.surfaceType!==l.J.BACKSPLASH||(e=this.scaleImagePointsToCanvas(t.arData.alignPoints),n=this.projectPointsIn3D(e,a,s)),this.gridCanvas.setPlaneData(r,n,a,i*T.s)}}updateAlignment(t,e,i){if(null==this.imageSize){const t=this.project.root.getFirstChildOfType(l.r.DTBackgroundImage);if(t){const e=t.data;this.imageSize=e.imageSizeProcessing}}const a=w.a.getPolygonNormal(e.points).normalize().negate();a.applyMatrix4(S.a);const s=new n.Vector3(0,i*T.s,0);let o;if(t.surfaceType===l.J.WALL||t.surfaceType===l.J.BACKSPLASH){const e=new n.Vector3(0,1,0);let i=this.projectPointsIn3D(this.scaleImagePointsToCanvas(t.arData.alignPoints),e,s),r=0;if(0===i[0].x&&0===i[0].y&&0===i[0].z||0===i[1].x&&0===i[1].y&&0===i[1].z){const n=Math.max(t.arData.alignPoints[0].y,t.arData.alignPoints[1].y);r=this.imageSize.y-n-10,t.arData.alignPoints[0].y=t.arData.alignPoints[0].y+r,t.arData.alignPoints[1].y=t.arData.alignPoints[1].y+r,i=this.projectPointsIn3D(this.scaleImagePointsToCanvas(t.arData.alignPoints),e,s)}for(const e of t.arData.gridPoints)e.y=e.y+r;o=this.projectPointsIn3D(this.scaleImagePointsToCanvas(t.arData.gridPoints),a,i[0])}else o=this.projectPointsIn3D(this.scaleImagePointsToCanvas(t.arData.gridPoints),a,s);const h=r.a.pnt3TransformArray(this.threeToModelMat4,o);e.points[0]=h[2],e.points[1]=h[3],e.points[2]=h[0],e.points[3]=h[1]}getScaledGridPoints(){return this.scaleCanvasPointsToImage(this.newGridPoints)}getScaledAlignPoints(){return this.scaleCanvasPointsToImage(this.newAlignPoints)}removeGridCanvas(){this.detachEventHandlers(),this.face3DNode=null}projectPointsIn3D(t,e,i){const n=this.gridCanvas.canvasElement.width,a=this.gridCanvas.canvasElement.height;return Object(v.w)(t,e,i,n,a,this.camera)}projectPointsIn2D(t){const e=this.gridCanvas.canvasElement.width,i=this.gridCanvas.canvasElement.height;return Object(v.v)(t,e,i,this.camera,S.a)}getCanvasSize(){return{x:this.gridCanvas.canvasElement.width,y:this.gridCanvas.canvasElement.height}}scaleCanvasPointsToImage(t){const e=[];for(const i of t)e.push(v.x(i,this.imageSize,{x:this.gridCanvas.canvasElement.clientWidth,y:this.gridCanvas.canvasElement.clientHeight}));return e}scaleImagePointsToCanvas(t){const e=[];for(const i of t)e.push(v.y(i,this.imageSize,{x:this.gridCanvas.canvasElement.clientWidth,y:this.gridCanvas.canvasElement.clientHeight}));return e}attachEventHandlers(){this.gridCanvas.onChange.attach(this.onGridCanvasChanged),this.gridCanvas.attachDomHandlers()}detachEventHandlers(){this.gridCanvas.onChange.detach(this.onGridCanvasChanged),this.gridCanvas.detachDomHandlers()}attachExternalEventHandlers(t){this.gridCanvas.onChange.attach(t)}detachExternalEventHandlers(t){this.gridCanvas.onChange.detach(t)}}var L=i(31);class A extends L.a{constructor(t,e){super(t,e)}setSessionId(t){this.sessionId=t}getSessionId(){return this.sessionId}getMasks(t,e){const i=new FormData;i.append("uploadedFile",t);const n=new Date,a=Date.UTC(n.getUTCFullYear(),n.getUTCMonth(),n.getUTCDate(),n.getUTCHours(),n.getUTCMinutes(),n.getUTCSeconds(),n.getMilliseconds());i.append("uploadTime",a.toString());let s="walls";return e&&(s="floor"),this.postFormData("api/segmentation/"+s,i).then(this.responseAsJson).then((t=>t))}}class O{constructor(t,e){this.scene=t,this.renderFrame=e,this.clock=new n.Clock,this.isLightAnimating=!1,this.lightAnimationMixer=new Map,this.lightAnimationAction=new Map}animateLights(){this.isLightAnimating?this.stopAnimation():this.lightAnimationAction.forEach(((t,e)=>{for(const t of this.scene.children){const i=t;i.uuid===e&&(i.visible=!0)}t.play(),this.renderFrame.value=!0})),this.isLightAnimating=!this.isLightAnimating}stopAnimation(){this.lightAnimationAction.forEach(((t,e)=>{t.stop(),this.renderFrame.value=!0}))}update(){if(this.isLightAnimating&&this.lightAnimationMixer.size>0){const t=this.clock.getDelta();this.lightAnimationMixer.forEach(((e,i)=>{e.update(t),this.renderFrame.value=!0}))}}addLightAnimation(t,e){const i=new n.AnimationMixer(e),a=[0],s=5/t.animationPositions.length,o=[],h=Object(r.f)(t.pnt);h.applyMatrix4(S.a),o.push(h.x,h.y,h.z);for(let e=0;e<t.animationPositions.length;e++){a.push(s*(e+1));const i=Object(r.f)(t.animationPositions[e]);i.applyMatrix4(S.a),o.push(i.x,i.y,i.z)}const l=new n.AnimationClip(null,-1,[new n.VectorKeyframeTrack(".position",a,o,n.InterpolateSmooth)]),c=i.clipAction(l);c.clampWhenFinished=!0,c.setLoop(n.LoopPingPong,1/0),this.lightAnimationMixer.set(e.uuid,i),this.lightAnimationAction.set(e.uuid,c)}removeLightAnimation(t){this.lightAnimationAction.delete(t),this.lightAnimationMixer.delete(t)}}var R,_=i(22);class k{get enabled(){return this._enabled}set enabled(t){this._enabled!=t&&(this._enabled=t,this._enabled||this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height))}constructor(t){this.inputDomElement=t,this.selectionTh=10*window.devicePixelRatio,this.pointerDownEventHandler=t=>{if(this.enabled){const e=c.a.getPointerCoordinates(t,this.inputDomElement.parentElement.id);this.selectedLine=null;for(const t of this.lines){let i=t.isSelected(e.x,e.y);if(i.distance<=this.selectionTh){i.type==R.MID?this.previousMousePos=e:this.dragOffset={x:e.x-i.closest.x,y:e.y-i.closest.y},this.dragging=!0,this.selectionResult=i,this.selectedLine=t;break}}}},this.pointerMoveEventHandler=t=>{if(this.enabled&&this.dragging){let e,i,n=c.a.getPointerCoordinates(t,this.inputDomElement.parentElement.id);this.selectionResult.type==R.START||this.selectionResult.type==R.END?(e=n.x-this.dragOffset.x,i=n.y-this.dragOffset.y):(e=n.x-this.previousMousePos.x,i=n.y-this.previousMousePos.y,this.previousMousePos={x:n.x,y:n.y}),this.selectedLine.move(this.selectionResult.type,e,i)}},this.pointerUpEventHandler=t=>{this.enabled&&(this.dragging=!1,this.selectedLine=null,this.selectionResult=null)},this.canvas=document.createElement("canvas"),this.canvas.style.background="transparent",this.canvas.style.position="absolute",this.ctx=this.canvas.getContext("2d"),this.inputDomElement.appendChild(this.canvas),this.enabled=!1,this.dragging=!1,this.lines=[]}addLine(t){this.lines.push(t)}getLines(){return this.lines}render(){if(this.enabled){this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height);for(const t of this.lines)t.render(this.ctx)}}attachDomHandlers(){this.inputDomElement.addEventListener("mousemove",this.pointerMoveEventHandler),this.inputDomElement.addEventListener("touchmove",this.pointerMoveEventHandler),this.inputDomElement.addEventListener("mousedown",this.pointerDownEventHandler),this.inputDomElement.addEventListener("touchstart",this.pointerDownEventHandler),this.inputDomElement.addEventListener("mouseup",this.pointerUpEventHandler),this.inputDomElement.addEventListener("touchend",this.pointerUpEventHandler),this.inputDomElement.addEventListener("touchcancel",this.pointerUpEventHandler)}detachDomHandlers(){this.inputDomElement.removeEventListener("mousemove",this.pointerMoveEventHandler),this.inputDomElement.removeEventListener("touchmove",this.pointerMoveEventHandler),this.inputDomElement.removeEventListener("mousedown",this.pointerDownEventHandler),this.inputDomElement.removeEventListener("touchstart",this.pointerDownEventHandler),this.inputDomElement.removeEventListener("mouseup",this.pointerUpEventHandler),this.inputDomElement.removeEventListener("touchend",this.pointerUpEventHandler),this.inputDomElement.removeEventListener("touchcancel",this.pointerUpEventHandler),this.enabled=!1}setSize(t,e){let i=this.canvas.width,n=this.canvas.height;this.canvas.width=t*window.devicePixelRatio,this.canvas.height=e*window.devicePixelRatio,this.canvas.style.width=t+"px",this.canvas.style.height=e+"px";for(const t of this.lines){let e=t;e.start.x=e.start.x*this.canvas.width/i,e.start.y=e.start.y*this.canvas.height/n,e.end.x=e.end.x*this.canvas.width/i,e.end.y=e.end.y*this.canvas.height/n}}}!function(t){t[t.START=0]="START",t[t.END=1]="END",t[t.MID=2]="MID"}(R||(R={}));class j{constructor(t,e,i,n,a,s){switch(this.start=t,this.end=e,this.name=i,this.cpRadius=a,this.lineMoved=s,this.lineWidth=2*window.devicePixelRatio,n){case"x":this.color="#FF0000";break;case"y":this.color="#00FF00";break;case"z":this.color="#0000FF"}this.startMoved=!1,this.endMoved=!1}render(t){t.strokeStyle=this.color,t.beginPath(),t.fillStyle=this.color,t.arc(this.start.x*window.devicePixelRatio,this.start.y*window.devicePixelRatio,this.cpRadius*window.devicePixelRatio,0,2*Math.PI),t.fill(),t.beginPath(),t.arc(this.end.x*window.devicePixelRatio,this.end.y*window.devicePixelRatio,this.cpRadius*window.devicePixelRatio,0,2*Math.PI),t.fill(),t.beginPath(),t.lineWidth=this.lineWidth,t.moveTo(this.start.x*window.devicePixelRatio,this.start.y*window.devicePixelRatio),t.lineTo(this.end.x*window.devicePixelRatio,this.end.y*window.devicePixelRatio),t.stroke()}move(t,e,i){t==R.START?(this.start.x=e,this.start.y=i,this.startMoved=!0):t==R.END?(this.end.x=e,this.end.y=i,this.endMoved=!0):t==R.MID&&(this.start.x=this.start.x+e,this.start.y=this.start.y+i,this.end.x=this.end.x+e,this.end.y=this.end.y+i,this.startMoved=!0,this.endMoved=!0),this.startMoved&&this.endMoved&&this.lineMoved(this.name)}isSelected(t,e){let i={closest:null,distance:0,type:null,name:this.name},n=this.end.x-this.start.x,a=this.end.y-this.start.y;if(0==n&&0==a)return i.closest=this.start,n=t-this.start.x,a=e-this.start.y,i.distance=Math.sqrt(n*n+a*a),i.type=R.START,i;let s=((t-this.start.x)*n+(e-this.start.y)*a)/(n*n+a*a);return s<.1?(i.closest=this.start,n=t-this.start.x,a=e-this.start.y,i.type=R.START):s>.9?(i.closest=this.end,n=t-this.end.x,a=e-this.end.y,i.type=R.END):(i.closest={x:this.start.x+s*n,y:this.start.y+s*a},n=t-i.closest.x,a=e-i.closest.y,i.type=R.MID),i.distance=Math.sqrt(n*n+a*a),i}}var N=i(48);class F{constructor(t){this.inputDomElement=t,this.cpRadius=7*window.devicePixelRatio,this.linesMoved={xLine1:!1,xLine2:!1,yLine1:!1,yLine2:!1,zLine1:!1,zLine2:!1},this.lineMoved=t=>{this.linesMoved[t]=!0,!this.yAdded&&this.linesMoved.xLine1&&this.linesMoved.xLine2&&(this.addYLines(),this.yAdded=!0),!this.zAdded&&this.linesMoved.yLine1&&this.linesMoved.yLine2&&(this.addZLines(),this.zAdded=!0),this.linesMoved.zLine1&&this.linesMoved.zLine2&&this.allLinesMovedCallBack&&!this.eventSent&&(this.allLinesMovedCallBack(),this.eventSent=!0)},this.perspectiveCanvas=new k(this.inputDomElement),this.yAdded=!1,this.zAdded=!1,this.eventSent=!1}addXLines(t){this.perspectiveCanvas.addLine(new j({x:this.width/4,y:this.height/4},{x:this.width-this.width/4,y:this.height/4},"xLine1","x",this.cpRadius,this.lineMoved)),this.perspectiveCanvas.addLine(new j({x:this.width/4,y:this.height-this.height/4},{x:this.width-this.width/4,y:this.height-this.height/4},"xLine2","x",this.cpRadius,this.lineMoved)),this.allLinesMovedCallBack=t}addYLines(){this.perspectiveCanvas.addLine(new j({x:this.width/4+3,y:this.height/4},{x:this.width/4,y:this.height-this.height/4},"yLine1","y",this.cpRadius,this.lineMoved)),this.perspectiveCanvas.addLine(new j({x:this.width-this.width/4-3,y:this.height/4},{x:this.width-this.width/4,y:this.height-this.height/4},"yLine2","y",this.cpRadius,this.lineMoved))}addZLines(){this.perspectiveCanvas.addLine(new j({x:this.width/3,y:this.height/4},{x:this.width/4,y:this.height-this.height/4},"zLine1","z",this.cpRadius,this.lineMoved)),this.perspectiveCanvas.addLine(new j({x:this.width-this.width/3,y:this.height/4},{x:this.width-this.width/4,y:this.height-this.height/4},"zLine2","z",this.cpRadius,this.lineMoved))}render(){this.perspectiveCanvas.render()}getVanishingLineData(){let t=this.perspectiveCanvas.getLines(),e=new N.c;e.imageWidth=this.width,e.imageHeight=this.height;for(const i of t)e[i.name]=new N.a(i.start,i.end);return e}setSize(t,e){this.width=t,this.height=e,this.perspectiveCanvas.setSize(t,e)}showPerspectiveCanvas(){this.perspectiveCanvas.enabled=!0,this.attachEventHandlers()}removePerspectiveCanvas(){this.detachEventHandlers(),this.perspectiveCanvas.enabled=!1}attachEventHandlers(){this.perspectiveCanvas.attachDomHandlers()}detachEventHandlers(){this.perspectiveCanvas.detachDomHandlers()}}var z=i(37);class B{constructor(t,e,i,n,a,s){this.scene=t,this.bgScene=e,this.renderer=i,this.perspectiveCamera=n,this.orthoCamera=a,this.matManager=s}getImage(t,e,i=!0){return new Promise(((a,s)=>{try{let s,o;const r=this.renderer.getSize(new n.Vector2),h=r.x/r.y;r.x>r.y?(s=t,o=t/h):(o=e,s=e*h);const l=this.perspectiveCamera.clone();l.aspect=s/o,l.updateProjectionMatrix(),this.matManager.setMatResolution(s,o,i),this.renderer.setSize(s,o),this.renderer.setPixelRatio(1),this.renderer.autoClear=!0,this.renderer.render(this.bgScene,this.orthoCamera),this.renderer.autoClear=!1,this.renderer.render(this.scene,l);const c=this.renderer.domElement.toDataURL("image/"+T.r,1);this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setSize(r.width,r.height),this.matManager.setMatResolution(r.width*window.devicePixelRatio,r.height*window.devicePixelRatio,i);a({img:c,width:s,height:o})}catch(t){s()}}))}getStringImage(t,e,i=!1){return new Promise(((n,a)=>{if(i)if(t.startsWith("data:image"))n(t);else{const i=new Image;i.crossOrigin="anonymous",i.onload=()=>{const t=this.getBase64Image(i,e);n(t)},i.src=t}else if(t.startsWith("http")||t.startsWith("https"))n(t);else{const i=new Image;i.crossOrigin="anonymous",i.onload=()=>{const t=this.getBase64Image(i,e);n(t)},i.src=t}}))}getBase64Image(t,e){const i=document.createElement("canvas");i.width=t.width,i.height=t.height;i.getContext("2d").drawImage(t,0,0,i.width,i.height);return i.toDataURL("image/"+e)}resizeImage(t,e,i,n){let a=document.createElement("canvas");a.width=e,a.height=i;a.getContext("2d").drawImage(t,0,0,a.width,a.height);const s=a.toDataURL("image/"+n);return a=null,s}applyWatermark(t,e){return new Promise(((i,n)=>{if(e.watermarkUrl&&""!=e.watermarkUrl){const n=new Image;n.onload=()=>{const a=new Image;a.crossOrigin="anonymous",a.onload=()=>{const s=document.createElement("canvas");s.width=t.width,s.height=t.height;const o=s.getContext("2d");let r,h;o.drawImage(a,0,0,t.width,t.height);const l=n.width,c=n.height;switch(e.watermarkPosition){case"TL":r=e.watermarkMargin,h=e.watermarkMargin;break;case"TR":r=t.width-l-e.watermarkMargin,h=e.watermarkMargin;break;case"BL":r=e.watermarkMargin,h=t.height-c-e.watermarkMargin;break;case"BR":r=t.width-l-e.watermarkMargin,h=t.height-c-e.watermarkMargin}o.globalAlpha=e.watermarkOpacity,o.drawImage(n,r,h,l,c);const d=s.toDataURL("image/"+T.r,1);i(d)},a.src=t.img},n.src=e.watermarkUrl}else i(t.img)}))}}class H{constructor(t,e,i,n){this.minHotspotDistance=t,this.camera=e,this.project=i,this.resourceManager=n,this.allHotspots=[],this.patternHotspots=new Map,null==this.minHotspotDistance&&(this.minHotspotDistance=100)}updateCanvasSize(t,e){for(const i of Array.from(this.patternHotspots.keys())){const n=this.patternHotspots.get(i);for(const i of n)i.point.x=t*i.point.x/this.canvasSize.x,i.point.y=e*i.point.y/this.canvasSize.y;const a=this.project.root.getIndexedNodeById(i);if(a){const t=l.G.getPatternTiledLayer(a),e=t.data;this.resourceManager&&this.resourceManager.setMultipleHotspot&&this.resourceManager.setMultipleHotspot(t.id,e.surfaceType,e.surfaceIndex,n)}}this.canvasSize={x:t,y:e},this.frameSize=r.a.vec2Mult(window.devicePixelRatio,this.canvasSize)}setTileInstCentroid(t,e,i){const n=Object(v.v)(i,this.canvasSize.x,this.canvasSize.y,this.camera,S.a),a=[],s=this.project.root.getFirstChildOfType(l.r.DTBackgroundImage).data,o=this.project.root.getFirstChildOfType(l.r.DTMaskList);for(const t of o.childNodes){const i=t.data;if(i.indexes&&i.indexes.indexOf(e)>=0){const t=i.indexes.indexOf(e),n=i.contour2d[t];for(const t of n){const e=[];for(const i of t){const t=Object(v.y)(i,s.imageSizeProcessing,this.frameSize);e.push(t)}a.push(e)}break}}const h=t.parentNode.id,c=t.data,d={code:c.idProduct,manufacturer:c.idManuf,color:c.colorVar};for(let t=0;t<n.length;t++){const e=n[t];if(e.x>0&&e.x<this.frameSize.x&&e.y>0&&e.y<this.frameSize.y){const n=r.a.poly2SignedDistanceToPoint(e.x,e.y,a);n>0&&this.allHotspots.push({patternId:h,point:r.a.vec2Mult(1/window.devicePixelRatio,e),dist:n,tileKey:d,tileIndex:c.tileIndex,point3d:i[t]})}}}filterCentroids(t){const e=this.project.root.getIndexedNodeById(t),i=e.childNodes.length,n=[];for(let e=0;e<i;e++){const i=this.allHotspots.filter((i=>i.tileIndex==e&&i.patternId==t));i.length>0&&n.push(i)}const a=[];for(let t=0;t<n.length;t++)if(n[t].sort(this.orderByDist),0==a.length)a.push(n[t][0]);else{const e=n[t];let i=!1;for(let t=0;t<e.length;t++){let n=!0;for(let i=0;i<a.length;i++){r.a.vec2Distance(e[t].point,a[i].point)<this.minHotspotDistance&&(n=!1)}if(n){a.push(e[t]),i=!0;break}}!i&&e.length>0&&a.push(e[Math.floor(e.length/2)])}this.patternHotspots.set(t,a);const s=l.G.getPatternTiledLayer(e),o=s.data;this.resourceManager&&this.resourceManager.setMultipleHotspot&&this.resourceManager.setMultipleHotspot(s.id,o.surfaceType,o.surfaceIndex,a)}removeHotspots(t){this.patternHotspots.delete(t),this.allHotspots=this.allHotspots.filter((e=>e.patternId!=t))}removeAllHotspots(){this.patternHotspots.clear(),this.allHotspots=[]}setResourceManager(t){this.resourceManager=t}orderByDist(t,e){return t.dist<e.dist?1:t.dist>e.dist?-1:0}}const U="#0000FF";class G{get enabled(){return this._enabled}set enabled(t){this._enabled!=t&&(this._enabled=t,this._enabled||this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height))}constructor(t){this.inputDomElement=t,this.pointerDownEventHandler=t=>{this.enabled&&(this.currentCoord=c.a.getPointerCoordinates(t,this.inputDomElement.parentElement.id),this.previousMousePos=this.currentCoord,this.selectedIndex=this.getSelectedPoint(this.currentCoord.x,this.currentCoord.y))},this.pointerMoveEventHandler=t=>{if(this.enabled&&this.currentCoord){const e=c.a.getPointerCoordinates(t,this.inputDomElement.parentElement.id);if(this.selectedIndex>-1){const t=e.x-this.previousMousePos.x,i=e.y-this.previousMousePos.y;this.previousMousePos={x:e.x,y:e.y},this.points[this.selectedIndex].x+=t,this.points[this.selectedIndex].y+=i}}},this.pointerUpEventHandler=t=>{this.enabled&&(this.selectedIndex<0&&this.points.push({x:this.currentCoord.x,y:this.currentCoord.y}),this.currentCoord=null,this.selectedIndex=-1)},this.canvas=document.createElement("canvas"),this.canvas.style.background="transparent",this.canvas.style.position="absolute",this.ctx=this.canvas.getContext("2d"),this.inputDomElement.appendChild(this.canvas),this.enabled=!1,this.selectedIndex=-1,this.points=[]}getPoints(){return r.a.vec2ArrayClone(this.points)}show(){this.enabled=!0,this.attachDomHandlers()}remove(){this.detachDomHandlers(),this.enabled=!1}clearPoints(){this.points=[]}setPoints(t){this.points=t}render(){if(this.enabled&&(this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.points.length>0)){this.ctx.strokeStyle=U,this.ctx.fillStyle=U,this.ctx.lineWidth=2;for(const t of this.points)this.ctx.beginPath(),this.ctx.arc(t.x*window.devicePixelRatio,t.y*window.devicePixelRatio,7*window.devicePixelRatio,0,2*Math.PI),this.ctx.fill();if(this.points.length>1){for(let t=0;t<this.points.length-1;t++){const e=this.points[t],i=this.points[t+1];this.ctx.beginPath(),this.ctx.lineWidth=2,this.ctx.moveTo(e.x*window.devicePixelRatio,e.y*window.devicePixelRatio),this.ctx.lineTo(i.x*window.devicePixelRatio,i.y*window.devicePixelRatio),this.ctx.stroke()}if(this.points.length>2){const t=this.points[0],e=this.points[this.points.length-1];this.ctx.beginPath(),this.ctx.lineWidth=2,this.ctx.moveTo(t.x*window.devicePixelRatio,t.y*window.devicePixelRatio),this.ctx.lineTo(e.x*window.devicePixelRatio,e.y*window.devicePixelRatio),this.ctx.stroke()}}}}getSelectedPoint(t,e){let i=-1;for(let n=0;n<this.points.length;n++){if(r.a.vec2Distance(this.points[n],{x:t,y:e})<7){i=n;break}}return i}attachDomHandlers(){this.inputDomElement.addEventListener("mousemove",this.pointerMoveEventHandler),this.inputDomElement.addEventListener("mousedown",this.pointerDownEventHandler),this.inputDomElement.addEventListener("mouseup",this.pointerUpEventHandler)}detachDomHandlers(){this.inputDomElement.removeEventListener("mousemove",this.pointerMoveEventHandler),this.inputDomElement.removeEventListener("mousedown",this.pointerDownEventHandler),this.inputDomElement.removeEventListener("mouseup",this.pointerUpEventHandler),this.enabled=!1}setSize(t,e){let i=this.canvas.width,n=this.canvas.height;this.canvas.width=t*window.devicePixelRatio,this.canvas.height=e*window.devicePixelRatio,this.canvas.style.width=t+"px",this.canvas.style.height=e+"px";for(const t of this.points)t.x=t.x*this.canvas.width/i,t.y=t.y*this.canvas.height/n}}var V=i(43),W=i(65);class J{get unitOfMeasurement(){return this._unitOfMeasurement}set unitOfMeasurement(t){this._unitOfMeasurement!==t&&(this._unitOfMeasurement=t)}get selectionColor(){return this._selectionColor}set selectionColor(t){null!=t&&this._selectionColor!==t&&(this._selectionColor=t,this.matManager.setSelectionColor(this.selectionColor))}get resourceManager(){return this._resourceManager}set resourceManager(t){this._resourceManager!==t&&(this._resourceManager=t,this.hotspotManager&&this.hotspotManager.setResourceManager(this._resourceManager))}get gizmoConfig(){return this._gizmoConfig}set gizmoConfig(t){var e,i,n,a,s,o,r,h;if(null==this.gizmoConfigExt){const e=Object.assign(Object.assign({},t),{whiteLineMaterial:this.whiteLineMaterial,blackLineMaterial:this.blackLineMaterial,detailedEvents:this.detailedEvents});null==e.gizmoRotationEnabled&&(e.gizmoRotationEnabled=!0),null==e.autoReposition&&(e.autoReposition=!0),null==e.nArrow&&(e.nArrow=4),null==e.rotateOusideCanvas&&(e.rotateOusideCanvas=!1),null==e.tapArea&&(e.tapArea=20),null==e.scaleFactor&&(e.scaleFactor=1),null==e.position&&(e.position=_.b.OUTSIDE),this.gizmoConfigExt=new M.a(e)}else if(t&&(null!=t.gizmoRotationEnabled&&this.gizmoConfigExt.value.gizmoRotationEnabled!==t.gizmoRotationEnabled||null!=t.autoReposition&&this.gizmoConfigExt.value.autoReposition!==t.autoReposition||null!=t.nArrow&&this.gizmoConfigExt.value.nArrow!==t.nArrow||null!=t.rotateOusideCanvas&&this.gizmoConfigExt.value.rotateOusideCanvas!==t.rotateOusideCanvas||null!=t.tapArea&&this.gizmoConfigExt.value.tapArea!==t.tapArea||null!=t.scaleFactor&&this.gizmoConfigExt.value.scaleFactor!==t.scaleFactor||null!=t.position&&this.gizmoConfigExt.value.position!==t.position||null!=t.centerPositionChanged&&this.gizmoConfigExt.value.centerPositionChanged!==t.centerPositionChanged)){const l=Object.assign(Object.assign({},t),{whiteLineMaterial:this.whiteLineMaterial,blackLineMaterial:this.blackLineMaterial,detailedEvents:this.detailedEvents,gizmoRotationEnabled:null!==(e=t.gizmoRotationEnabled)&&void 0!==e?e:this.gizmoConfigExt.value.gizmoRotationEnabled,autoReposition:null!==(i=t.autoReposition)&&void 0!==i?i:this.gizmoConfigExt.value.autoReposition,nArrow:null!==(n=t.nArrow)&&void 0!==n?n:this.gizmoConfigExt.value.nArrow,rotateOusideCanvas:null!==(a=t.rotateOusideCanvas)&&void 0!==a?a:this.gizmoConfigExt.value.rotateOusideCanvas,tapArea:null!==(s=t.tapArea)&&void 0!==s?s:this.gizmoConfigExt.value.tapArea,scaleFactor:null!==(o=t.scaleFactor)&&void 0!==o?o:this.gizmoConfigExt.value.scaleFactor,position:null!==(r=t.position)&&void 0!==r?r:this.gizmoConfigExt.value.position,centerPositionChanged:null!==(h=t.centerPositionChanged)&&void 0!==h?h:null});this.gizmoConfigExt.value=l}}resize(t,e){if(t=Math.round(t),e=Math.round(e),!this._width||!this._height||this._width!==t||this._height!==e){this._width=t,this._height=e,this.perspectiveCamera.aspect=t/e,this.perspectiveCamera.updateProjectionMatrix(),this.renderer.setSize(t,e),this.renderer.setPixelRatio(window.devicePixelRatio),this.matManager.setMatResolution(t*window.devicePixelRatio,e*window.devicePixelRatio),this.whiteLineMaterial.resolution.set(t,e),this.blackLineMaterial.resolution.set(t,e),this.pickingRenderTarget.setSize(t/T.t,e/T.t),this.updatePicking=!0,this.hotspotManager&&this.hotspotManager.updateCanvasSize(this._width,this._height);const i=this.project.root.getFirstChildOfType(l.r.DTGroupList);i&&i.walkOnAllChildrenByType(l.r.DTGroup,!1,(t=>{this.addGroupHotspot(t)})),this.resourceManager&&null==this.hotspotManager&&this.project.root.walkOnAllChildrenByType(l.r.DTTiledLayer,!1,(t=>{const e=t.data;if(e.hotspot){const i=this._width*e.hotspot.x/100,n=this._height*e.hotspot.y/100,a=Object(v.i)(this.project,t.id),s=Object(v.z)(e.surfaceType);this.addHotspot(t,t.id,i,n,e.surfaceType,s,e.surfaceIndex,e.label,a?u.b.LAYER_IS_IN_GROUP:u.b.SINGLE_LAYER)}})),this.gridCanvasManager&&this.gridCanvasManager.setSize(t,e),this.perspectiveCanvasManager&&this.perspectiveCanvasManager.setSize(t,e),this.polyCanvas&&this.polyCanvas.setSize(t,e)}}get showStats(){return this._showStats}set showStats(t){this._showStats!==t&&(this._showStats=t,this._showStats?this.containerDomElement.appendChild(this.stats.dom):this.stats.dom.parentElement===this.containerDomElement&&this.containerDomElement.removeChild(this.stats.dom))}constructor(t,e,i,a,u,x,C,b,P,E,D,w,I,L,O,R,_,k){this.containerDomElement=t,this.engineId=e,this.commandManager=x,this.aiConfig=P,this.catalogueApiEndpoint=E,this.apiEndpoint=D,this.selectableLayers=R,this.detailedEvents=_,this.initAdvancedCanvases=()=>{this.perspectiveCanvasManager=new F(this.containerDomElement),this.polyCanvas=new G(this.containerDomElement),this.polyCanvas.setSize(this._width,this._height)},this.renderFrameChanged=t=>{this.renderFrame=t},this.isSelecting=()=>this.selectionAnimation.start+this.selectionAnimation.time>(new Date).getTime(),this.onTasksChanged=t=>{this.activeTask.value=t.blockingTasks+t.nonBlockingTasks,this.resourceManager&&this.resourceManager.showActivityIndicator(t.blockingTasks,t.nonBlockingTasks)},this.attachInputEventHandlers=t=>{t.addEventListener(d.a.POINTERDOWN,this.onPointerDown),t.addEventListener(d.a.POINTERUP,this.onPointerUp)},this.onPointerDown=t=>{if(this.isCurrentCommand(o.Q.SetupRug)||this.isCurrentCommand(o.Q.EditLights)||this.isCurrentCommand(o.Q.AddTiledLayer)||this.isCurrentCommand(o.Q.EditTiledLayer)||this.isCurrentCommand(o.Q.SetupCorridor)||this.isCurrentCommand(o.Q.AlignTiledLayer)||this.isCurrentCommand(o.Q.CalcPerspective)||this.isCurrentCommand(o.Q.EditPerspective)||this.isCurrentCommand(o.Q.AddGroups)||this.isCurrentCommand(o.Q.ShowLightPlaceholder))return;let e=null;const i=c.a.getPointerCoordinates(t.originalEvent,this.engineId);let n=null;for(const i of t.intersections){if(e)break;h.a.traverseSelfAndAncestors(i.object,(a=>{if(!e){if(z.a.isGizmoPart(a))return e=a,void(t.target=i);if(this.getProjectNodeByType(a,l.r.DTRug)){const s=a.userData.id,h=this.project.root.getIndexedNodeById(s);if(h&&this.isSelectableNode(h))return e=a,t.target=i,this.selection.set(s),n=h,void(this.isCurrentCommand(o.Q.EditRug)||this.executeCommand(new o.jb(Object(r.c)(i.point.clone().applyMatrix4(S.c)))))}if(this.getProjectNodeByType(a,l.r.DTCorridor)){const s=a.userData.id,h=this.project.root.getIndexedNodeById(s);if(h&&this.isSelectableNode(h))return e=a,t.target=i,this.selection.set(s),n=h,void(this.isCurrentCommand(o.Q.EditCorridor)||this.executeCommand(new o.X(Object(r.c)(i.point.clone().applyMatrix4(S.c)))))}}}))}if(null==n){const t=this.getSelectedLayerId(i),e=this.project.root.getIndexedNodeById(t);e&&this.isSelectableNode(e)&&(n=e)}n&&this.selectNodeAndExecuteDefaultCommand(n),null==n&&null==e&&(this.selection.clear(),this.selectingMeshes.clear(),this.commandManager.cancel(),this.gridCanvasManager&&this.gridCanvasManager.removeGridCanvas(),this.resourceManager.setSelectedLayer(null,-1,t.originalEvent.type,null),this.renderFrameRequest.value=!0)},this.onPointerUp=t=>{this.isCurrentCommand(o.Q.AlignTiledLayer)||this.detailedEvents&&0===this.selection.getSelectionSet().size&&this.resourceManager.setSelectedLayer(null,-1,t.originalEvent.type,null)},this.getProjectNodeByType=(t,e)=>{const i=t.userData,n=this.project.root.getIndexedNodeById(i.id);return n&&n.data.type===e?n:null},this.getSelectedLayerId=t=>{const e=t.x/T.t,i=(this._height-t.y)/T.t,n=new Uint8Array(4);this.renderer.readRenderTargetPixels(this.pickingRenderTarget,e,i,1,1,n);let a=null;return this.project.root.walkOnAllChildrenByType(l.r.DTTiledLayer,!1,(t=>{t.data.surfaceIndex===n[0]&&(a=t.id)})),a},this.selectNodeAndExecuteDefaultCommand=t=>{if(this.selectingMeshes.clear(),t.data.type===l.r.DTTiledLayer){this.commandManager.cancel();const e=t.data;this.checkEditPattern(t);const i=Object(v.i)(this.project,t.id);if(i){const t=i.data.layers;this.selection.set(...t),this.resourceManager.setSelectedGroup(i.id),this.animateByIdNodes(t)}else this.selection.set(t.id),this.resourceManager.setSelectedLayer(e.surfaceType,e.surfaceIndex,t.id),this.animateByIdNodes([t.id])}},this.checkEditPattern=t=>{const e=t.getFirstChildOfType(l.r.DTFace3D);if(e&&e.childNodes.length>0){const t=e.getFirstChildOfType(l.r.DTTileList);if(t){const e=t.getFirstChildOfType(l.r.DTPattern);this.executeCommand(new o.fb(e.id))}}},this.animateByIdNodes=t=>{for(const e of t){const t=this.project.root.getIndexedNodeById(e);if(t){const e=this.getSelectingMesh(t);e&&this.selectingMeshes.set(e.uuid,e)}}this.selectionAnimation={start:(new Date).getTime(),time:T.v},this.renderFrameRequest.value=!0},this.projectChangedEventHandler=t=>{switch(t.type){case"LOADED":this.freeResources(),this.buildEntityObjects();break;case"PATTERN_ADDED":this.addPattern(t.node,t.blockUI);break;case"PATTERN_REMOVED":this.removePattern(t.node);break;case"PATTERN_UPDATED":this.updatePattern(t.node);break;case"PATTERN_MOVED":this.movePattern(t.node,t.delta);break;case"TILELIST_ADDED":this.addTileList(t.node);break;case"TILELIST_REMOVED":this.removeTileList(t.node);break;case"GROUTCOLOR_CHANGED":this.updateGroutColor(t.node);break;case"BACKGROUNDIMAGE_ADDED":this.addBackgroundImage(t.node);break;case"TILEDLAYER_ADDED":this.createTiledLayer(t.node);break;case"TILEDLAYER_CHANGED":this.updateTiledLayer(t.node);break;case"TILEDLAYER_REMOVED":this.removeTiledLayer(t.node);break;case"CAMERAPARAMS_UPDATED":{const e=t.node.data;this.buildPerspectiveCamera(e.cameraParams);break}case"MASK_ADDED":this.addMask(t.node);break;case"MASKLIST_ADDED":this.addMaskList(t.node);break;case"MASK_UPDATED":this.updateMask(t.node);break;case"LIGHT_ADDED":this.addLight(t.node,this.scene);break;case"LIGHT_REMOVED":this.removeLight(t.node);break;case"LIGHT_CHANGED":this.changeLight(t.node);break;case"FACE3D_UPDATE":this.reloadFace3D(t.node);break;case"RUG_ADDED":this.addRug(t.node);break;case"RUG_REMOVED":this.removeRug(t.node);break;case"RUG_UPDATED":this.updateRug(t.node);break;case"PROJECT_BUILT":this.buildEntityObjects();break;case"CORRIDOR_ADDED":this.addCorridor(t.node);break;case"CORRIDOR_REMOVED":this.removeCorridor(t.node)}},this.onPatternCompleted=()=>{this.blockUI&&(this.blockUI=!1,this.objectControls.enabled=!0,this.activityManager.blockingTaskCompleted())},console.debug("PLATFORM: "+navigator.userAgent),console.debug("three js version: "+n.REVISION),this.stats=this.buildStats(),this.layerSelectionEnabled=new M.a,this.layerSelectionEnabled.value=!0,this.projectLoaded=new M.a,this.projectLoaded.value=!1,this.renderFrame=!1,this.renderFrameRequest=new M.a(!1),this.renderFrameRequest.Changed.on(this.renderFrameChanged),this._selectionColor=31232,null!=this.apiEndpoint&&(this.coreClient=new V.a(this.apiEndpoint,b)),this.tileClient=new f.b(this.catalogueApiEndpoint,b),this.matClient=new f.a(this.catalogueApiEndpoint,b),this.aiClient=new A(this.aiConfig.segmentationEndpoint,b),this._width=i,this._height=a,this._resourceManager=C,this.selection=new m.a,this.selectingMeshes=new Map,this.selectionAnimation={start:(new Date).getTime(),time:0},this.canvas=this.buildCanvas(),this.modelToThreeMap=new Map,this.scene=new n.Scene,this.bgScene=new n.Scene,this.orthoCamera=new n.OrthographicCamera(-1,1,1,-1,0,1),this.phScene=new n.Scene,this.maskTextures=new Map,this.sceneEntities=new g.a(this.modelToThreeMap),this.renderer=this.buildRenderer(this.canvas,this._width,this._height),this.pickingScene=new n.Scene,this.pickingScene.background=new n.Color(0,0,0),this.pickingRenderTarget=new n.WebGLRenderTarget(i/T.t,a/T.t,{depthBuffer:!1,stencilBuffer:!1}),this.updatePicking=!1,this.perspectiveCamera=new n.PerspectiveCamera,this.buildPerspectiveCamera(new l.b(67,0,0,1500,1.3333)),this.objectControls=new d.b(this.perspectiveCamera,this.scene,this.phScene,this.containerDomElement),this.objectControls.enabled=!0,this.objectControls.attachDomHandlers(),this.attachInputEventHandlers(this.objectControls),this.activityManager=new y.a,this.activityManager.tasksChanged.on(this.onTasksChanged),this.activeTask=new M.a,this.activeTask.value=0;this.matManager=new s.d(this.matClient,u,this.scene,this.activityManager,!0,this.renderFrameRequest,k),this.matManager.setMatResolution(i*window.devicePixelRatio,a*window.devicePixelRatio),this.matManager.setSelectionColor(this.selectionColor),this.initializeSceneManagerMaterials(w),this.project=u,this.initAnimationManager(),this.project.projectChanged.attach(this.projectChangedEventHandler),L&&(this.hotspotManager=new H(O,this.perspectiveCamera,this.project,this.resourceManager),this.hotspotManager.updateCanvasSize(this._width,this._height)),this.patternManager=new s.f(this.project,this.tileClient),this.patternLoader=new p.c(this.matManager,this.sceneEntities,this.patternManager,this.maskTextures,this.renderFrameRequest,this.hotspotManager),this.patternLoader.onPatternCompleted=this.onPatternCompleted,this.blockUI=!1,this.face3DLoader=new p.b(this.project,this.matManager,this.patternLoader,this.renderFrameRequest,I),this.rugLoader=new p.d(this.matManager,this.activityManager,this.renderFrameRequest),this.corridorLoader=new p.a(this.matManager,this.maskTextures,this.renderFrameRequest),this.imageManager=new B(this.scene,this.bgScene,this.renderer,this.perspectiveCamera,this.orthoCamera,this.matManager)}buildStats(){const t=new W;return t.dom.style.position="absolute",t}initAnalytics(t,e,i){window.location.href.includes("localhost")||(this.analyticsManager=new x.a(t,e,i),this.analyticsManager.notifyPagePreview("RR",window.location.href))}setUserInteraction(t){this.objectControls.enabled=t}initializeSceneManagerMaterials(t){this.whiteLineMaterial=new a.a({color:16777215,linewidth:1.2,vertexColors:!0,alphaToCoverage:!0,dashed:!1,toneMapped:!1,polygonOffset:!0,polygonOffsetFactor:-1,polygonOffsetUnits:-1,depthWrite:!0,resolution:new n.Vector2(this._width,this._height)}),this.blackLineMaterial=new a.a({color:0,linewidth:1.2,vertexColors:!0,alphaToCoverage:!0,dashed:!1,toneMapped:!1,polygonOffset:!0,polygonOffsetFactor:-1,polygonOffsetUnits:-1,depthWrite:!0,resolution:new n.Vector2(this._width,this._height)})}initGridCanvasManager(){this.gridCanvasManager||(this.gridCanvasManager=new I(this.containerDomElement,this.project,this.perspectiveCamera),this.gridCanvasManager.setSize(this._width,this._height))}initAnimationManager(){this.animationManager||(this.animationManager=new O(this.scene,this.renderFrameRequest))}buildRenderer(t,e,i){const a=new n.WebGLRenderer({canvas:t,alpha:!0,antialias:!0,powerPreference:"low-power"});a.setClearColor(0,0),a.setPixelRatio(window.devicePixelRatio),a.setSize(e,i),a.outputColorSpace=n.SRGBColorSpace,a.toneMappingExposure=.1,a.toneMapping=n.ACESFilmicToneMapping,a.shadowMap.enabled=!1;return a.getContext().pixelStorei(37443,0),a}buildPerspectiveCamera(t){this.perspectiveCamera.fov=t.fov,this.perspectiveCamera.aspect=t.imageAspect,this.perspectiveCamera.near=T.b,this.perspectiveCamera.far=T.a;const e=new n.Vector3(0,0,t.heightFromGround);e.applyMatrix4(S.a),this.perspectiveCamera.position.set(e.x,e.y,e.z);const i=new n.Vector3(0,0,-1);i.applyAxisAngle(new n.Vector3(1,0,0),-r.a.degToRad(t.grade)),i.normalize();const a=new n.Vector3(0,1,0);a.applyAxisAngle(new n.Vector3(0,0,1),r.a.degToRad(t.roll)),a.normalize(),this.perspectiveCamera.up.set(a.x,a.y,a.z);const s=e.clone();s.add(i),this.perspectiveCamera.lookAt(s),this.perspectiveCamera.updateProjectionMatrix()}buildCanvas(){const t=document.createElement("canvas");return t.style.position="absolute",t.style.backgroundColor="#ffffff00",this.containerDomElement.appendChild(t),t}update(){if(this._showStats&&this.stats.begin(),this.renderer.renderLists.dispose(),this.objectControls.update(),this.gridCanvasManager&&this.gridCanvasManager.render(),this.animationManager&&this.animationManager.update(),this.perspectiveCanvasManager&&this.perspectiveCanvasManager.render(),this.polyCanvas&&this.polyCanvas.render(),this.updatePicking&&(this.renderer.setRenderTarget(this.pickingRenderTarget),this.renderer.render(this.pickingScene,this.orthoCamera),this.renderer.setRenderTarget(null),this.updatePicking=!1),this.phScene.children.length>0&&(this.renderFrame=!0),this.renderFrame){if(this.renderFrameRequest.value=!1,this.renderFrame=!1,this.selectingMeshes.size>0){const t=(new Date).getTime();let e=0;this.isSelecting()?(e=.7-(t-this.selectionAnimation.start)/this.selectionAnimation.time*.7,this.renderFrame=!0):e=0;for(const t of this.scene.children)(t instanceof n.Mesh||t instanceof n.Group)&&t.traverse((i=>{i instanceof n.Mesh&&(h.a.isIBLStandardMaterial(i.material)||h.a.isCTShaderMaterial(i.material))&&(this.selectingMeshes.has(t.uuid)?i.material.selectionAmmount=e:i.material.selectionAmmount=0,i.material.updateParams())}));this.isSelecting()||this.selectingMeshes.clear()}this.renderer.autoClear=!0,this.renderer.render(this.bgScene,this.orthoCamera),this.renderer.autoClear=!1,this.renderer.render(this.scene,this.perspectiveCamera),this.phScene.children.length>0&&this.renderer.render(this.phScene,this.perspectiveCamera),this.renderer.info.autoReset=!1,this.renderer.info.reset()}this._showStats&&this.stats.end()}onCommandEnd(t){t.canceled||!t.nextCommand||this.executeCommand(t.nextCommand)}executeCommand(t){let e=!0;switch(t.type){case o.Q.LoadProject:this.freeResources(),this.commandManager.execute(new o.Ab(this.project,this.projectLoaded,this.activityManager),t);break;case o.Q.Cancel:this.commandManager.cancel(),this.selection.clear();break;case o.Q.ToggleLightAnimation:this.commandManager.execute(new o.rc(this.animationManager),t);break;case o.Q.ApplyProjectCustomization:e=!1,this.commandManager.execute(new o.t(this.project,this.activityManager),t);break;case o.Q.ChangeGrout:this.commandManager.execute(new o.L(this.project,this.selection,this.patternManager,this.activityManager),t);break;case o.Q.ChangeGroutColor:this.commandManager.execute(new o.J(this.project,this.selection),t);break;case o.Q.ChangePatternRotation:this.commandManager.execute(new o.P(this.project,this.selection,this.patternManager,this.activityManager),t);break;case o.Q.ApplyPatternsToSurfaces:this.commandManager.execute(new o.r(this.project,this.tileClient,this.patternManager,this.resourceManager,this.activityManager),t);break;case o.Q.ApplyTilePatternToSurface:this.commandManager.execute(new o.x(this.project,this.tileClient,this.patternManager,this.selection,this.resourceManager,this.activityManager),t);break;case o.Q.ApplyTile:e=!1,this.commandManager.execute(new o.v(this.project,this.tileClient,this.patternManager,this.selection,this.resourceManager,this.activityManager,this.analyticsManager,this.perspectiveCamera,{x:this._width,y:this._height},this.scene),t);break;case o.Q.ApplyPattern:this.commandManager.execute(new o.n(this.project,this.tileClient,this.patternManager,this.selection,this.resourceManager,this.activityManager,this.analyticsManager),t);break;case o.Q.EditPattern:e=!1,this.commandManager.execute(new o.gb(this.project,this.resourceManager,this.objectControls,this.patternManager,this.activityManager,this.renderFrameRequest),t);break;case o.Q.AddBackgroundImage:this.freeResources(),this.project.createNew(),this.commandManager.execute(new o.b(this.project,this._width),t);break;case o.Q.CalcSegmentation:this.commandManager.execute(new o.D(this.project,this.aiClient,this.activityManager,{x:this._width,y:this._height},this.aiConfig,this.projectLoaded,this.resourceManager),t);break;case o.Q.CalcPerspective:this.commandManager.execute(new o.B(this.project,this.phScene,this.resourceManager,this.perspectiveCanvasManager,this.activityManager,this.renderFrameRequest,this.containerDomElement,this.perspectiveCamera,this._width,this._height),t);break;case o.Q.SaveImage:this.commandManager.execute(new o.Tb(this.project,this.imageManager,this.activityManager),t);break;case o.Q.SaveProject:this.commandManager.execute(new o.Vb(this.project,this.imageManager,this.activityManager),t);break;case o.Q.SaveProjectCustomization:e=!1,this.commandManager.execute(new o.Xb(this.project,this.activityManager),t);break;case o.Q.LoadSceneWithPB:this.freeResources(),this.commandManager.execute(new o.Eb(this.project,this.tileClient,this.patternManager,this.activityManager,this.projectLoaded,this.perspectiveCamera,{x:this._width,y:this._height},this.scene),t);break;case o.Q.LoadExternalProject:this.freeResources(),this.commandManager.execute(new o.wb(this.project,this.tileClient,this.matManager,this.patternManager,this.activityManager,this.projectLoaded),t);break;case o.Q.ChangeMaterial:this.commandManager.execute(new o.N(this.project,this.selection,this.tileClient,this.patternManager,this.resourceManager,this.matManager,this.activityManager),t);break;case o.Q.SetSelectedLayer:e=!1,this.commandManager.execute(new o.Zb(this.project,this.selection),t);break;case o.Q.ApplyPatternExt:this.commandManager.execute(new o.p(this.project,this.selection,this.tileClient,this.patternManager,this.resourceManager,this.matManager,this.activityManager),t);break;case o.Q.GetSceneRugImage:this.commandManager.execute(new o.qb(this.project,this.imageManager,this.modelToThreeMap,this.maskTextures,this.rugLoader,this.activityManager),t);break;case o.Q.DeleteTiledLayer:this.commandManager.execute(new o.U(this.project),t);break;case o.Q.AddTiledLayer:e=!1,this.initGridCanvasManager(),this.commandManager.execute(new o.j(this.project,this.gridCanvasManager,this.resourceManager,this.objectControls,this.layerSelectionEnabled,this.unitOfMeasurement,this.tileClient,this.matManager,this.patternManager),t);break;case o.Q.AddGroups:this.commandManager.execute(new o.f(this.project,this.resourceManager,this.containerDomElement,this._width,this._height),t);break;case o.Q.EditGroups:this.commandManager.execute(new o.ab(this.project,this.resourceManager,this._width,this._height),t);break;case o.Q.DeleteGroups:this.commandManager.execute(new o.S(this.project,this.resourceManager),t);break;case o.Q.EditLights:this.commandManager.execute(new o.bb(this.project,this.phScene,this.resourceManager,this.animationManager,this.containerDomElement,this.layerSelectionEnabled,this.perspectiveCamera,this._width,this._height,this.tileClient,this.matManager,this.patternManager,this.renderFrameRequest),t);break;case o.Q.EditLightIntensity:this.commandManager.execute(new o.db(this.project),t);break;case o.Q.ShowLightPlaceholder:this.commandManager.execute(new o.pc(this.project,this.phScene,this.perspectiveCamera,this._width,this._height,this.layerSelectionEnabled,this.containerDomElement,this.renderFrameRequest),t);break;case o.Q.ExportProject:e=!1,this.commandManager.execute(new o.ob(this.project,this.matManager,this.patternManager,this.imageManager,this.unitOfMeasurement,this.activeTask),t);break;case o.Q.EditPerspective:this.initGridCanvasManager(),this.commandManager.execute(new o.ib(this.project,this.phScene,this.resourceManager,this.gridCanvasManager,this.renderFrameRequest,this.containerDomElement,this.perspectiveCamera,this._width,this._height),t);break;case o.Q.EditTiledLayer:this.initGridCanvasManager(),this.commandManager.execute(new o.mb(this.project,this.gridCanvasManager,this.resourceManager,this.objectControls,this.layerSelectionEnabled,this.selection),t);break;case o.Q.PublishProject:this.commandManager.execute(new o.Nb(this.project),t);break;case o.Q.CalcPerspectiveAI:this.commandManager.execute(new o.z(this.project,this.aiClient,this.activityManager,this.resourceManager),t);break;case o.Q.EditRug:e=!1,this.commandManager.execute(new o.kb(this.project,this.selection,this.objectControls,this.sceneEntities,this.gizmoConfigExt,this.renderer,this.scene,this.perspectiveCamera,this.matManager,this.renderFrameRequest,this.resourceManager,this.phScene),t);break;case o.Q.CalcSegmentationRug:this.commandManager.execute(new o.H(this.project,this.aiClient,this.activityManager,{x:this._width,y:this._height},this.aiConfig,this.selection,this.resourceManager),t);break;case o.Q.AddRug:this.commandManager.cancel(),this.commandManager.execute(new o.h(this.project,this.selection,{x:this._width,y:this._height},this.perspectiveCamera,this.activityManager,this.objectControls.enabled),t);break;case o.Q.SetupRug:this.commandManager.execute(new o.fc(this.project,this.objectControls,this.layerSelectionEnabled,this.resourceManager,{x:this._width,y:this._height},this.perspectiveCamera),t);break;case o.Q.SetSelectedNode:e=!1,this.commandManager.execute(new o.bc(this.project,this.selection,this.selectNodeAndExecuteDefaultCommand),t);break;case o.Q.Print:this.commandManager.execute(new o.Kb(this.project,this.resourceManager,this.imageManager),t);break;case o.Q.AlignTiledLayer:this.initGridCanvasManager(),this.commandManager.execute(new o.l(this.project,this.selection,this.gridCanvasManager),t);break;case o.Q.RequestInfo:this.commandManager.execute(new o.Rb(this.project,this.resourceManager,this.imageManager),t);break;case o.Q.ShareProjectLink:this.commandManager.execute(new o.lc(this.project,this.resourceManager,this.coreClient,this.activityManager,this.analyticsManager),t);break;case o.Q.ShareProjectLinkMail:this.commandManager.execute(new o.nc(this.project,this.resourceManager,this.coreClient,this.activityManager,this.analyticsManager,this.imageManager),t);break;case o.Q.ShareOnFacebook:this.commandManager.execute(new o.jc(this.project,this.resourceManager,this.coreClient,this.activityManager,this.analyticsManager),t);break;case o.Q.LoadSharedProject:this.freeResources(),this.commandManager.execute(new o.Gb(this.project,this.resourceManager,this.coreClient,this.activityManager,this.analyticsManager,this.projectLoaded),t);break;case o.Q.SetupCorridor:this.commandManager.execute(new o.dc(this.project,this.objectControls,this.layerSelectionEnabled,this.resourceManager,{x:this._width,y:this._height},this.perspectiveCamera),t);break;case o.Q.AddCorridor:this.commandManager.execute(new o.d(this.project,{x:this._width,y:this._height},this.perspectiveCamera,this.activityManager,this.selection),t);break;case o.Q.EditCorridor:e=!1,this.commandManager.execute(new o.Y(this.project,this.selection,this.objectControls,this.sceneEntities,this.gizmoConfigExt,this.resourceManager,this.phScene,this.renderFrameRequest),t);break;case o.Q.CalcSegmentationCorridor:this.commandManager.execute(new o.F(this.project,this.aiClient,this.activityManager,{x:this._width,y:this._height},this.aiConfig,this.matManager,this.patternManager,this.selection,this.resourceManager,this.tileClient),t);break;case o.Q.RemoveCorridor:this.commandManager.execute(new o.Pb(this.project),t)}this.analyticsManager&&e&&this.analyticsManager.commandExecuted(o.Q[t.type])}getNBlockingTask(){return this.activityManager.getNBlockingTask()}isCurrentCommand(t){return this.commandManager.currentCommand&&this.commandManager.currentCommand.type===t}getSelectingMesh(t){let e=null;switch(t.data.type){case l.r.DTTiledLayer:case l.r.DTRug:case l.r.DTCorridor:e=t.id}if(e){return this.sceneEntities.get(e)}return null}isSelectableNode(t){if(this.selectableLayers&&this.selectableLayers.length>0)switch(t.data.type){case l.r.DTTiledLayer:{const e=t.data;return this.selectableLayers.indexOf(e.surfaceType)>-1}case l.r.DTRug:return this.selectableLayers.indexOf(l.J.RUG)>-1;case l.r.DTCorridor:return this.selectableLayers.indexOf(l.J.CORRIDOR)>-1}return!0}freeResources(){this.clearScene(),this.matManager.clear(),this.modelToThreeMap.clear(),this.maskTextures.clear(),this.patternManager.clear(),this.hotspotManager&&this.hotspotManager.removeAllHotspots(),this.projectLoaded.value=!1}dispose(){this.freeResources(),this.objectControls.dispose(),this.bgScene=null,this.scene=null,this.pickingScene=null,this.phScene=null,this.pickingRenderTarget.dispose(),this.renderer.setSize(1,1),this.renderer.dispose(),this.renderer.forceContextLoss(),this.containerDomElement.removeChild(this.canvas),this.canvas=null,this.renderer=null}clearScene(){h.a.clearScene(this.scene),h.a.clearScene(this.bgScene),h.a.clearScene(this.pickingScene),h.a.clearScene(this.phScene)}buildEntityObjects(){const t=performance.now(),e=this.project.root.getFirstChildOfType(l.r.DTBackgroundImage);e&&this.addBackgroundImage(e).then((()=>{const e=this.project.root.getFirstChildOfType(l.r.DTLightList);if(e)for(const t of e.childNodes)this.addLight(t,this.scene);const i=this.project.root.getFirstChildOfType(l.r.DTMaskList);i&&this.addMaskList(i).then((()=>{this.project.root.walkOnAllChildrenByType(l.r.DTTiledLayer,!1,(t=>{this.buildDTTiledLayer(t,null)}));const e=this.project.root.getFirstChildOfType(l.r.DTGroupList);if(e)for(const t of e.childNodes)this.addGroupHotspot(t);this.project.root.walkOnAllChildrenByType(l.r.DTRug,!1,(t=>{this.buildDTRug(t,null)})),this.project.root.walkOnAllChildrenByType(l.r.DTCorridor,!1,(t=>{this.buildDTCorridor(t,null)})),this.projectLoaded.value=!0,this.renderFrame=!0;const i=performance.now();this.showStats&&console.debug(`Project loading took ${i-t} milliseconds.`)})).catch((t=>{console.log("[SceneManager] addMaskList error")}))})).catch((t=>{console.log("[SceneManager] addBackground error")}))}compareDtNodes(t,e){return t&&e&&JSON.stringify(t)===JSON.stringify(e)}createTiledLayer(t){const e=t.data;if(null!=Object(v.m)(e.surfaceType,this.maskTextures))this.addTiledLayer(t);else{const i=this.project.root.getFirstChildOfType(l.r.DTMaskList);if(i){const n=v.n(e.surfaceType);let a;for(const t of i.childNodes){const e=t.data;if(e.id==l.F.ALL||e.id===n){a=t;break}}a?this.addMask(a).then((()=>{this.addTiledLayer(t)})).catch((t=>{console.log("[SceneManager] addMask error")})):console.log("CREATE TILED LAYER ERROR: CANNOT FIND MASK")}}}buildDTTiledLayer(t,e){if(t){const i=e&&e.root.getIndexedNodeById(t.id);this.compareDtNodes(i,t)||(i&&this.removeDTTiledLayer(i),this.addTiledLayer(t))}}buildDTRug(t,e){if(t){const i=e&&e.root.getIndexedNodeById(t.id);this.compareDtNodes(i,t)||(i&&this.removeRug(i),this.addRug(t))}}buildDTCorridor(t,e){if(t){const i=e&&e.root.getIndexedNodeById(t.id);this.compareDtNodes(i,t)||(i&&this.removeCorridor(i),this.addCorridor(t))}}removeDTTiledLayer(t){if(t.data.type!==l.r.DTTiledLayer)throw new Error("Invalid node type")}removeRug(t){this.sceneEntities.removeAndDetachFromParentById(t.id,!0),this.renderFrameRequest.value=!0}removeCorridor(t){this.sceneEntities.removeAndDetachFromParentById(t.id,!0),this.renderFrameRequest.value=!0}addBackgroundImage(t){if(t.data.type!==l.r.DTBackgroundImage)throw new Error("Invalid node type");return new Promise(((e,i)=>{const a=t.data;a.src=this.getImageUrl(this.apiEndpoint,a.src),this.buildPerspectiveCamera(Object.assign(Object.assign({},a.cameraParams),{imageAspect:this._width/this._height})),null!=this.bgMesh&&this.bgScene.remove(this.bgMesh);const s=performance.now();(new n.TextureLoader).load(a.src,(t=>{t.anisotropy=16,t.wrapS=n.RepeatWrapping,t.wrapT=n.RepeatWrapping;const i=new n.ShaderMaterial({vertexShader:"varying vec2 vUv;\n                                   void main() {\n                                        vUv = uv;\n                                        gl_Position = vec4(position, 1.0);\n                                   }",fragmentShader:"uniform sampler2D texture1;\n                                     varying vec2 vUv;\n\n                                      void main() {\n                                           vec4 bg = texture2D( texture1, vUv );\n                                           gl_FragColor = bg;\n                                           //gl_FragColor = vec4(vUv, 0.0, 1.0);\n                                      }",uniforms:{texture1:{value:t}},depthWrite:!1,depthTest:!1});this.bgMesh=new n.Mesh(new n.PlaneGeometry(2,2),i),this.bgMesh.name="BG-MESH",i.needsUpdate=!0,t.needsUpdate=!0,this.bgScene.add(this.bgMesh),this.renderFrameRequest.value=!0;const a=performance.now();this.showStats&&console.debug(`Background loading took ${a-s} milliseconds.`),e()}))}))}getImageUrl(t,e){return e.startsWith("http://")||e.startsWith("https://")||e.startsWith("blob:")||e.startsWith("data:")?e:`${t}/api/scene/file?id=${encodeURIComponent(e)}&isMobile=${encodeURIComponent(Object(v.t)())}`}addMaskList(t){if(t.data.type!==l.r.DTMaskList)throw new Error("Invalid node type");return new Promise(((e,i)=>{const n=[];for(const e of t.childNodes)n.push(this.addMask(e));Promise.all(n).then((()=>{e()})).catch((t=>{console.log("[SceneManager] addMaskList error"),i(t)}))}))}addMask(t){if(t.data.type!==l.r.DTMask)throw new Error("Invalid node type");return new Promise(((e,i)=>{const a=t.data;a.src=this.getImageUrl(this.apiEndpoint,a.src);const s=performance.now();(new n.TextureLoader).load(a.src,(t=>{t.anisotropy=16;const i={texture:t,reflection:a.reflection,shading:a.shading};this.maskTextures.set(a.id,i);const o=new n.ShaderMaterial({vertexShader:"varying vec2 vUv;\n                                   void main() {\n                                        vUv = uv;\n                                        gl_Position = vec4(position, 1.0);\n                                   }",fragmentShader:"uniform sampler2D texture1;\n                                     varying vec2 vUv;\n                                         \n                                      void main() {\n                                           vec4 bg = texture2D( texture1, vUv );\n                                           gl_FragColor = bg;\n                                           //gl_FragColor.a = bg.b;\n                                      }",uniforms:{texture1:{value:t}},depthWrite:!1,depthTest:!1,transparent:!0}),r=new n.Mesh(new n.PlaneGeometry(2,2),o);o.needsUpdate=!0,this.pickingScene.add(r),this.updatePicking=!0,this.renderFrameRequest.value=!0;const h=performance.now();this.showStats&&console.debug(`Mask loading took ${h-s} milliseconds.`),e()}))}))}updateMask(t){if(t.data.type!==l.r.DTMask)throw new Error("Invalid node type");const e=t.data;e.src=this.getImageUrl(this.apiEndpoint,e.src)}addTiledLayer(t){if(t.data.type!==l.r.DTTiledLayer)throw new Error("Invalid node type");const e=t.data,i=t.getFirstChildOfType(l.r.DTFace3D);if(e.hotspot&&null==this.hotspotManager){const i=this._width*e.hotspot.x/100,n=this._height*e.hotspot.y/100,a=Object(v.i)(this.project,t.id),s=Object(v.z)(e.surfaceType);this.addHotspot(t,t.id,i,n,e.surfaceType,s,e.surfaceIndex,e.label,a?u.b.LAYER_IS_IN_GROUP:u.b.SINGLE_LAYER)}if(this.resourceManager.setOriginPoseById&&e.origin){const i={x:this._width*e.origin.x/100,y:this._height*e.origin.y/100};this.resourceManager.setOriginPoseById(t.id,i)}const a=this.sceneEntities.addAndAttachToParentAndSetId(t.id,new n.Group,this.scene);a.name="TL"+t.id;const s=this.sceneEntities.addAndAttachToParentAndSetId(i.id,new n.Mesh,a);s.visible=e.visible,s.name=l.J[e.surfaceType];const o=Object(v.m)(e.surfaceType,this.maskTextures);this.face3DLoader.loadFace3D(s,i,!1,e.surfaceIndex,o)}addHotspot(t,e,i,n,a,s,o,h,c){let d;if(t){const i=l.G.getTiledLayerPattern(t);if(i){const t=i.data;d={groutSize:t.groutSize,groutColor:t.groutColor,tiles:[],id:e,surfaceType:a,surfaceIndex:o,pattern:t.id,rotation:r.a.radToDeg(t.rotation),formatSize:"",tileDestination:s},i.walkOnAllChildrenByType(l.r.DTTileInst,!1,(t=>{const e=t.data;0==d.tiles.filter((t=>t.code==e.idProduct&&t.manufacturer==e.idManuf&&t.color==e.colorVar)).length&&(d.tiles.push({code:e.idProduct,manufacturer:e.idManuf,color:e.colorVar}),d.formatSize=v.k(e.width,e.height,e.diagonal))}))}}this.resourceManager.setHotspot&&this.resourceManager.setHotspot(e,i,n,a,o,d,h,s,c)}updateTiledLayer(t){if(t.data.type!==l.r.DTTiledLayer)throw new Error("Invalid node type");const e=t.data,i=Object(v.m)(e.surfaceType,this.maskTextures),n=t.getFirstChildOfType(l.r.DTFace3D),a=this.modelToThreeMap.get(n.id);this.face3DLoader.reloadFace3D(a,n,e.surfaceIndex,i),this.patternManager.updateFace3DTileListNodes(n)}removeTiledLayer(t){if(t.data.type!==l.r.DTTiledLayer)throw new Error("Invalid node type");const e=t.getFirstChildOfType(l.r.DTFace3D);this.face3DLoader.removeFace3D(e),this.sceneEntities.removeAndDetachFromParentById(e.id,!0),this.gridCanvasManager&&this.gridCanvasManager.removeGridCanvas(),this.renderFrameRequest.value=!0}addLight(t,e){if(t.data.type!==l.r.DTLight)throw new Error("Invalid node type");const i=t.data,n=Object(v.h)(t.id,i,e);let a;i.animationPositions&&i.animationPositions.length>0&&this.animationManager.addLightAnimation(i,n),i.lightType===l.o.Directional?a={id:t.id,minIntensity:0,maxIntensity:6,intensity:n.intensity}:i.lightType===l.o.Omni?a={id:t.id,minIntensity:0,maxIntensity:1e3,intensity:n.power}:i.lightType===l.o.Rect&&(a={id:t.id,minIntensity:0,maxIntensity:1e3,intensity:n.intensity}),a&&this.resourceManager.setLightInfo&&this.resourceManager.setLightInfo(a)}removeLight(t){if(t.data.type!==l.r.DTLight)throw new Error("Invalid node type");for(const e of this.scene.children){e.userData.id===t.id&&(this.scene.remove(e),this.renderFrame=!0)}this.animationManager&&this.animationManager.removeLightAnimation(t.id)}changeLight(t){const e=t.data;for(const i of this.scene.children){if(i.userData.id===t.id){switch(e.lightType){case l.o.Ambient:i.intensity=e.power;break;case l.o.Omni:{const t=i;t.power=e.power;const a=new n.Vector3(e.pnt.x,e.pnt.y,e.pnt.z);a.applyMatrix4(S.a),t.position.set(a.x,a.y,a.z),e.animationPositions&&e.animationPositions.length>0&&this.animationManager.addLightAnimation(e,t)}break;case l.o.Directional:{const t=i;t.intensity=e.power;const a=new n.Vector3(e.pnt.x,e.pnt.y,e.pnt.z);a.applyMatrix4(S.a),t.position.set(a.x,a.y,a.z);const s=new n.Vector3(e.targetPnt.x,e.targetPnt.y,e.targetPnt.z);s.applyMatrix4(S.a),t.target.position.set(s.x,s.y,s.z)}break;case l.o.Rect:{const t=i;t.power=e.power;const a=new n.Vector3(e.pnt.x,e.pnt.y,e.pnt.z);a.applyMatrix4(S.a),t.position.set(a.x,a.y,a.z),t.rotation.y=e.angle,t.width=e.areaDim1*T.s,t.height=e.areaDim2*T.s}}this.renderFrameRequest.value=!0;break}}}addGroupHotspot(t){if(t.data.type!==l.r.DTGroup)throw new Error("Invalid node type");const e=t.data,i=e.hotspot,n=i.x*this._width/100,a=i.y*this._height/100;if(this.resourceManager){const i=this.project.root.getIndexedNodeById(e.layers[0]);this.addHotspot(i,t.id,n,a,null,e.tileDestination,null,e.label,u.b.GROUP)}}addRug(t){if(t.data.type!==l.r.DTRug)throw new Error("Invalid node type");const e=t.data,i=this.sceneEntities.addAndAttachToParentAndSetId(t.id,new n.Group,this.scene);h.a.setObject3DTransform(i,Object(S.e)(e.matrix,S.c,S.a)),this.renderFrameRequest.value=!0;const a=Object(v.m)(l.J.FLOOR,this.maskTextures);this.rugLoader.loadRug(i,t,1,a,this.showStats)}updateRug(t){if(t.data.type!==l.r.DTRug)throw new Error("Invalid node type");const e=t.data,i=this.modelToThreeMap.get(t.id);h.a.setObject3DTransform(i,Object(S.e)(e.matrix,S.c,S.a));const n=Object(v.m)(l.J.FLOOR,this.maskTextures);this.rugLoader.updateRug(i,t,1,n,this.showStats)}addCorridor(t){if(t.data.type!==l.r.DTCorridor)throw new Error("Invalid node type");const e=t.data,i=this.sceneEntities.addAndAttachToParentAndSetId(t.id,new n.Mesh,this.scene);h.a.setObject3DTransform(i,Object(S.e)(e.matrix,S.c,S.a)),this.renderFrameRequest.value=!0,this.corridorLoader.loadCorridor(t,i)}reloadFace3D(t){if(t.data.type!==l.r.DTFace3D)throw new Error("Invalid node type");const e=l.G.getFace3DTiledLayer(t).data,i=Object(v.m)(e.surfaceType,this.maskTextures),n=this.modelToThreeMap.get(t.id);this.face3DLoader.reloadFace3D(n,t,e.surfaceIndex,i),this.patternManager.updateFace3DTileListNodes(t)}addTileList(t){if(t.data.type!==l.r.DTTileList)throw new Error("Invalid node type");this.patternLoader.loadTileList(t)}removeTileList(t){if(t.data.type!==l.r.DTTileList)throw new Error("Invalid node type");this.patternLoader.removeTileList(t),this.renderFrameRequest.value=!0}addPattern(t,e){if(t.data.type!==l.r.DTPattern)throw new Error("Invalid node type");e&&(this.blockUI=!0,this.objectControls.enabled=!1,this.activityManager.addBlockingTask()),this.patternLoader.loadPattern(t,t.parentNode)}updatePattern(t){if(t.data.type!==l.r.DTPattern)throw new Error("Invalid node type");this.patternLoader.loadPattern(t,t.parentNode)}removePattern(t){if(t.data.type!==l.r.DTPattern)throw new Error("Invalid node type");this.patternLoader.removePattern(t,!0),this.renderFrameRequest.value=!0}movePattern(t,e){if(t.data.type!==l.r.DTPattern)throw new Error("Invalid node type");this.patternLoader.movePattern(t,e,this.modelToThreeMap)}updateGroutColor(t){if(t.data.type!==l.r.DTPattern)throw new Error("Invalid node type");const e=this.modelToThreeMap.get(t.id),i=t.data,a=e.material;a.color=new n.Color(i.groutColor),a.needsUpdate=!0,this.renderFrameRequest.value=!0}}},function(t,e,i){"use strict";i.d(e,"a",(function(){return s})),i.d(e,"b",(function(){return o}));var n=i(15);i(2);const a=i(59);function s(t,e){let i=Object(n.d)(t),s=new a.ClipperOffset(2,.25);s.AddPath(i,a.JoinType.jtRound,a.EndType.etClosedPolygon);let o=new a.Paths;return s.Execute(o,e),Object(n.b)(o,!1)[0]}function o(t,e){const i=new a.Clipper;i.Clear();const s=[Object(n.d)(t)];i.AddPaths(s,a.PolyType.ptSubject,!0);const o=[];for(const t of e){const e=Object(n.d)(t);o.push(e)}const r=new a.Paths;return i.AddPaths(o,a.PolyType.ptClip,!0),i.Execute(a.ClipType.ctDifference,r,a.PolyFillType.pftNonZero,a.PolyFillType.pftNonZero),Object(n.c)(r)}},function(t,e,i){"use strict";i.d(e,"a",(function(){return a}));var n=i(1);class a extends n.MeshStandardMaterial{constructor(t){super(t),this.transparent=!0,this.depthTest=!1,this.uShadingMap=new n.Uniform(null),this.screenResolution=new n.Vector2(100,100),this.uScreenResolution=new n.Uniform(this.screenResolution),this.shadingAmmount=1,this.uShadingAmmount=new n.Uniform(this.shadingAmmount),this.reflectionAmmount=1,this.uReflectionAmmount=new n.Uniform(this.reflectionAmmount),this.uSurfaceIndex=new n.Uniform(this.surfaceIndex),this.selectionAmmount=0,this.uSelectionAmmount=new n.Uniform(this.selectionAmmount),this.selectionColor=new n.Vector3(1,0,0),this.uSelectionColor=new n.Uniform(this.selectionColor)}}},function(t,e,i){"use strict";i.d(e,"a",(function(){return n}));class n{constructor(){this.handlers=[]}on(t){this.handlers.push(t)}off(t){this.handlers=this.handlers.filter((e=>e!==t))}trigger(t){this.handlers.slice(0).forEach((e=>e(t)))}expose(){return this}}},function(t,e){t.exports=__WEBPACK_EXTERNAL_MODULE__59__},function(t,e){t.exports=__WEBPACK_EXTERNAL_MODULE__60__},function(t,e,i){var n=i(70),a=i(71);t.exports=function(t,e,i){var s=e&&i||0;"string"==typeof t&&(e="binary"===t?new Array(16):null,t=null);var o=(t=t||{}).random||(t.rng||n)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,e)for(var r=0;r<16;++r)e[s+r]=o[r];return e||a(o)}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return LoadTileVignetteCommand})),__webpack_require__.d(__webpack_exports__,"b",(function(){return LoadTileVignetteCommandHandler}));var _CommandHandler__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(6),___WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(3),_model__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(0),_tiler_Tiler__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(10),_engine_Config__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(5),_engine_Utils__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(8),_lib_gmath__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(2),_SetupVignetteViewCommand__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(54),_tiler_PatternCalculator__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(30),_tiler_TilerUtils__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(17),_model_DTFace3DUtils__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(21);class LoadTileVignetteCommand{constructor(t,e){this.tiles=t,this.patternId=e,this.type=___WEBPACK_IMPORTED_MODULE_1__.Q.LoadTileVignette}}class LoadTileVignetteCommandHandler extends _CommandHandler__WEBPACK_IMPORTED_MODULE_0__.a{constructor(t,e,i,n,a,s,o,r){super(),this.project=t,this.tileClient=e,this.matManager=i,this.patternManager=n,this.minVignetteWidth=a,this.minVignetteHeight=s,this.activityManager=o,this.analyticsManager=r}onStart(){const t=this.command;this.activityManager.addBlockingTask(),this.analyticsManager&&this.analyticsManager.vignetteCreated("Tile"),this.tileClient.getSeamlessPattern(t.patternId).then((e=>{if(-1!==e.poseFile.xDir0.indexOf("SF_HWFIX")||-1!==e.poseFile.xDir0.indexOf("SF_HWRAND"))return console.log("PATTERN_NOT_SUPPORTED"),this.activityManager.blockingTaskCompleted(),void this.end();const i=this.getVignetteSizeAndOrigin(e.seamlessData,this.minVignetteWidth,this.minVignetteHeight,t.tiles);i.seamless||console.log("PATTERN IS NOT SEAMLESS---------------------------");const n=[];n.push({x:i.size.x/2,y:i.size.y/2,z:0}),n.push({x:i.size.x/2,y:-i.size.y/2,z:0}),n.push({x:-i.size.x/2,y:-i.size.y/2,z:0}),n.push({x:-i.size.x/2,y:i.size.y/2,z:0});const a=_model__WEBPACK_IMPORTED_MODULE_2__.i.FF_COVER|_model__WEBPACK_IMPORTED_MODULE_2__.i.FF_FILLED,s=new _model__WEBPACK_IMPORTED_MODULE_2__.g(a,_engine_Config__WEBPACK_IMPORTED_MODULE_4__.j,n,_model__WEBPACK_IMPORTED_MODULE_2__.h.CLASSID_FLOOR,-1,[]),o=new _model__WEBPACK_IMPORTED_MODULE_2__.c(s),r=Object(_engine_Utils__WEBPACK_IMPORTED_MODULE_5__.r)(t.tiles,-1,this.matManager,!1),h=_tiler_Tiler__WEBPACK_IMPORTED_MODULE_3__.g.createPatternStructureWithTiles(e.poseFile,r,0);if(h){const t=this.patternManager.getTileListDefaultFlags(s.classId),a=this.patternManager.get2DFace3D(o),r=new _model__WEBPACK_IMPORTED_MODULE_2__.y(a.points,a.points[0],t);r.modelToPoly=a._2DMatrix,r.polyToModel=a._3DMatrix;const l=0,c=new _model__WEBPACK_IMPORTED_MODULE_2__.s(h.posFile.id,0,16777215,l,0,h.posInfo.strategyId);c.areaRect=_lib_gmath__WEBPACK_IMPORTED_MODULE_6__.a.poly2BoundingBox(a.points),c.v0=_lib_gmath__WEBPACK_IMPORTED_MODULE_6__.a.vec2Clone(h.posInfo.v0),c.v1=_lib_gmath__WEBPACK_IMPORTED_MODULE_6__.a.vec2Clone(h.posInfo.v1),origin&&(c.origin=_lib_gmath__WEBPACK_IMPORTED_MODULE_6__.a.vec2Clone(i.origin));const d=new _model__WEBPACK_IMPORTED_MODULE_2__.c(c),u=new _model__WEBPACK_IMPORTED_MODULE_2__.c(r);u.appendChild(d),this.patternManager.setPatternStructure(d.id,h);const p=this.patternManager.fillPattern(d,h,a.points);o.appendChild(u);const g=d.id;this.project.root.appendChild(o),e.seamlessData.checkCut&&this.findSeamlessTiles(g,h,p,n),this.project.projectChanged.notify({type:"FACE3D_ADDED",node:o}),this.activityManager.blockingTaskCompleted(),this.end(new _SetupVignetteViewCommand__WEBPACK_IMPORTED_MODULE_7__.a(i.size.x,i.size.y))}else console.log("PATTERN_CONSTRAINTS_VIOLATION"),this.activityManager.blockingTaskCompleted(),this.end()})).catch((t=>{this.activityManager.blockingTaskCompleted(),console.log(t.stack),this.end()}))}findSeamlessTiles(t,e,i,n){const a=this.project.root.getIndexedNodeById(t),s=_model__WEBPACK_IMPORTED_MODULE_2__.G.getPatternFace3D(a),o=_model__WEBPACK_IMPORTED_MODULE_2__.G.getPatternTileList(a),r=a.data,h=s.data,l=o.data,c=_lib_gmath__WEBPACK_IMPORTED_MODULE_6__.a.vec3Negate(_lib_gmath__WEBPACK_IMPORTED_MODULE_6__.a.poly3Normal(h.points)),d=Object(_model_DTFace3DUtils__WEBPACK_IMPORTED_MODULE_10__.c)(h.points,Object(_model_DTFace3DUtils__WEBPACK_IMPORTED_MODULE_10__.b)(h),c),u=_tiler_TilerUtils__WEBPACK_IMPORTED_MODULE_9__.b.getTilingAreaPatternPolygon(d,r.areaRect,l.points,l.polyToModel,l.modelToPoly,!1);u[0].x=u[0].x+3,u[0].y=u[0].y-3,u[1].x=u[1].x-3,u[1].y=u[1].y-3,u[2].x=u[2].x-3,u[2].y=u[2].y+3,u[3].x=u[3].x+3,u[3].y=u[3].y+3;const p=[],g=[],m=[],f=[];let y=0;a.walkOnAllChildrenByType(_model__WEBPACK_IMPORTED_MODULE_2__.r.DTTileInst,!1,(t=>{const e=t.data,i=_tiler_TilerUtils__WEBPACK_IMPORTED_MODULE_9__.b.getTilePolygon(e.formatType,e.width,e.height,e.diagonal,e.polygonSet);for(let t=0;t<e.tiles.length;t++){const n=this.getCompleteTilePoly(e.tiles[t],e.rotation,i,e.polygonSet),a=n.poly;this.polyIntersectSegment(u[2].x,u[2].y,u[3].x,u[3].y,a)&&g.push({tile:e.tiles[t],center:n.center,tileInst:e,tilePolygon:i,tileInstIndex:y,tileIndex:t});this.polyIntersectSegment(u[1].x,u[1].y,u[0].x,u[0].y,a)&&p.push({tile:e.tiles[t],center:n.center,tileInst:e,tilePolygon:i,tileInstIndex:y,tileIndex:t});this.polyIntersectSegment(u[2].x,u[2].y,u[1].x,u[1].y,a)&&f.push({tile:e.tiles[t],center:n.center,tileInst:e,tilePolygon:i,tileInstIndex:y,tileIndex:t});this.polyIntersectSegment(u[3].x,u[3].y,u[0].x,u[0].y,a)&&m.push({tile:e.tiles[t],center:n.center,tileInst:e,tilePolygon:i,tileInstIndex:y,tileIndex:t})}y++})),this.sortSeamlessX(p),this.sortSeamlessX(g),this.sortSeamlessY(f),this.sortSeamlessY(m);for(let t=0;t<p.length;t++){const e=g[t],n=p[t],a=n.tile.rotation-_lib_gmath__WEBPACK_IMPORTED_MODULE_6__.a.degToRad(n.tileInst.rotation)-r.rotation,s=i[e.tileInstIndex][e.tileIndex];s&&(s.offshadedIndex=n.tile.offshadedIndex,s.texRotationIndex=e.tilePolygon.getNearestDegreeIndex(a))}for(let t=0;t<m.length;t++){const e=f[t];if(null==e)continue;const n=m[t],a=n.tile.rotation-_lib_gmath__WEBPACK_IMPORTED_MODULE_6__.a.degToRad(n.tileInst.rotation)-r.rotation,s=i[e.tileInstIndex][e.tileIndex];s&&(s.offshadedIndex=n.tile.offshadedIndex,s.texRotationIndex=e.tilePolygon.getNearestDegreeIndex(a))}a.removeChildNodes(),this.patternManager.fillPattern(a,e,d.points,i,!1,!1)}sortSeamlessX(t){t.sort(((t,e)=>t.center.x>e.center.x?1:t.center.x<e.center.x?-1:0))}sortSeamlessY(t){t.sort(((t,e)=>t.center.y>e.center.y?1:t.center.y<e.center.y?-1:0))}polyIntersectSegment(t,e,i,n,a){let s=!1;for(let o=0;o<a[0].length;o++){const r=a[0][o],h=o==a[0].length-1?a[0][0]:a[0][o+1];if(_lib_gmath__WEBPACK_IMPORTED_MODULE_6__.a.line2SegmentsIntersection(t,e,i,n,r.x,r.y,h.x,h.y)){s=!0;break}}return s}getCompleteTilePoly(t,e,i,n){const a=_tiler_PatternCalculator__WEBPACK_IMPORTED_MODULE_8__.a.getTileMatrix(t,e,0,i.center,n.contours[0].vertices[0]),s=[];for(let t=0;t<n.contours.length;t++){const e=_lib_gmath__WEBPACK_IMPORTED_MODULE_6__.a.pnt2TransformArray(a.matrix,n.contours[t].vertices);s.push(e)}return{poly:s,center:_lib_gmath__WEBPACK_IMPORTED_MODULE_6__.a.pnt2Transform(a.matrix,i.center)}}getVignetteSizeAndOrigin(seamlessData,minWidth,minHeight,tiles){const substitutions={SQRT:"Math.sqrt"};for(let t=0;t<tiles.length;t++){const e=t,i=`D0${e}_0`,n=`D0${e}_1`,a=`D0${e}_2`;substitutions[i]=tiles[t].width,substitutions[n]=tiles[t].height,substitutions[a]=tiles[t].diagonal}let seamless=!0;if(seamlessData.checkTileSize){const checkTileSizeReplace=_tiler_Tiler__WEBPACK_IMPORTED_MODULE_3__.g.replaceIdentifiers(seamlessData.checkTileSize,substitutions);seamless=eval(checkTileSizeReplace)}const repeatableWidthReplace=_tiler_Tiler__WEBPACK_IMPORTED_MODULE_3__.g.replaceIdentifiers(seamlessData.repeatW,substitutions),repeatableHeightReplace=_tiler_Tiler__WEBPACK_IMPORTED_MODULE_3__.g.replaceIdentifiers(seamlessData.repeatH,substitutions),finalRepeatableWidth=eval(repeatableWidthReplace),finalRepeatableHeight=eval(repeatableHeightReplace),size={x:Math.ceil(minWidth/finalRepeatableWidth)*finalRepeatableWidth,y:Math.ceil(minHeight/finalRepeatableHeight)*finalRepeatableHeight};let offsetX=0,offsetY=0;if(null!=seamlessData.offsetX||""!=seamlessData.offsetX){const offsetXReplace=_tiler_Tiler__WEBPACK_IMPORTED_MODULE_3__.g.replaceIdentifiers(seamlessData.offsetX,substitutions);offsetX=eval(offsetXReplace)}if(null!=seamlessData.offsetY||""!=seamlessData.offsetY){const offsetYReplace=_tiler_Tiler__WEBPACK_IMPORTED_MODULE_3__.g.replaceIdentifiers(seamlessData.offsetY,substitutions);offsetY=eval(offsetYReplace)}const origin={x:offsetX,y:offsetY};return{size:size,origin:origin,seamless:seamless}}onEnd(t){t()}}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return CobylaWrapper}));var ___WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(64);let globalCobylaObjectiveFn=null;class CobylaWrapper{constructor(){this.rhobeg=5,this.rhoend=1e-6,this.iprint=0,this.maxfun=3500,this.resultTh=4.3578776856567636e-7}createObjectiveFunction(functionDeclaration){return eval(`${Object.keys({globalCobylaObjectiveFn:globalCobylaObjectiveFn})[0]} = ${functionDeclaration}`),globalCobylaObjectiveFn}resolveConstraints(t,e,i,n){return Object(___WEBPACK_IMPORTED_MODULE_0__.a)(t,i,n,e,this.rhobeg,this.rhoend,this.iprint,this.maxfun).resmax}clearObjectiveFunction(){eval(`${Object.keys({globalCobylaObjectiveFn:globalCobylaObjectiveFn})[0]} = null`)}}},function(t,e,i){"use strict";function n(t){for(var e=new Array(t),i=0;i<t;i++)e[i]=0;return e}function a(t,e){for(var i=new Array(t),a=0;a<t;)i[a]=n(e),a+=1;return i}function s(t,e,i,n,a){for(var s=0;s<a;)i[s+n]=t[s+e],s++}i.d(e,"a",(function(){return l}));var o=0,r=1,h=2;function l(t,e,i,l,f,y,v,x){var T=i+2,M=n(e+1);M[0]=0,s(l,0,M,1,e);var C=function(t,e,i,s,l,f,y,v,x){var T,M=-1,C=.25,b=2.1,P=.5,E=1.1,D=0,w=0,S=e+1,I=i+1,L=f,A=0,O=!1,R=!1,_=0,k=0,j=0,N=n(1+s),F=a(1+e,1+S),z=a(1+e,1+e),B=a(1+s,1+S),H=a(1+e,1+I),U=n(1+e),G=n(1+e),V=n(1+e),W=n(1+e),J=n(1+e);v>=2&&console.log("The initial value of RHO is "+L+" and PARMU is set to zero.");for(var q=0,K=1/L,Y=1;Y<=e;++Y)F[Y][S]=l[Y],F[Y][Y]=L,z[Y][Y]=K;var $=S,X=!1;t:for(;;){if(q>=x&&q>0){M=r;break t}++q,D=t(e,i,l,N),w=0;for(var Q=1;Q<=i;++Q)w=Math.max(w,-N[Q]);q!=v-1&&3!=v||d(q,D,w,l,e),N[I]=D,N[s]=w;var Z=!0;if(!X){Z=!1;for(Y=1;Y<=s;++Y)B[Y][$]=N[Y];if(q<=S){if($<=e)if(B[I][S]<=D)l[$]=F[$][S];else{F[$][S]=l[$];for(Q=1;Q<=s;++Q)B[Q][$]=B[Q][S],B[Q][S]=N[Q];for(Q=1;Q<=$;++Q){F[$][Q]=-L,K=0;for(Y=Q;Y<=$;++Y)K-=z[Y][Q];z[$][Q]=K}}if(q<=e){l[$=q]+=L;continue t}}X=!0}e:for(;;){i:do{if(!Z){for(var tt=B[I][S]+A*B[s][S],et=S,it=1;it<=e;++it)(K=B[I][it]+A*B[s][it])<tt?(et=it,tt=K):K==tt&&0==A&&B[s][it]<B[s][et]&&(et=it);if(et<=e){for(Y=1;Y<=s;++Y)K=B[Y][S],B[Y][S]=B[Y][et],B[Y][et]=K;for(Y=1;Y<=e;++Y){K=F[Y][et],F[Y][et]=0,F[Y][S]+=K;var nt=0;for(Q=1;Q<=e;++Q)F[Y][Q]-=K,nt-=z[Q][Y];z[et][Y]=nt}}var at=0;for(Y=1;Y<=e;++Y)for(it=1;it<=e;++it)K=m(g(u(z,Y),1,e),g(p(F,it),1,e))-(Y==it?1:0),at=Math.max(at,Math.abs(K));if(at>.1){M=h;break t}for(Q=1;Q<=I;++Q){N[Q]=-B[Q][S];for(it=1;it<=e;++it)J[it]=B[Q][it]+N[Q];for(Y=1;Y<=e;++Y)H[Y][Q]=(Q==I?-1:1)*m(g(J,1,e),g(p(z,Y),1,e))}O=!0,_=C*L;var st=b*L;for(it=1;it<=e;++it){var ot=0;for(Q=1;Q<=e;++Q)ot+=z[it][Q]*z[it][Q];var rt=0;for(Q=1;Q<=e;++Q)rt+=F[Q][it]*F[Q][it];U[it]=1/Math.sqrt(ot),G[it]=Math.sqrt(rt),(U[it]<_||G[it]>st)&&(O=!1)}if(!X&&!O){$=0,K=st;for(it=1;it<=e;++it)G[it]>K&&($=it,K=G[it]);if(0==$)for(it=1;it<=e;++it)U[it]<K&&($=it,K=U[it]);K=P*L*U[$];for(Q=1;Q<=e;++Q)W[Q]=K*z[$][Q];var ht=0,lt=0;T=0;for(Q=1;Q<=I;++Q)T=m(g(p(H,Q),1,e),g(W,1,e)),Q<I&&(K=B[Q][S],ht=Math.max(ht,-T-K),lt=Math.max(lt,T-K));var ct=A*(ht-lt)>2*T?-1:1;K=0;for(Y=1;Y<=e;++Y)W[Y]=ct*W[Y],F[Y][$]=W[Y],K+=z[$][Y]*W[Y];for(Q=1;Q<=e;++Q)z[$][Q]/=K;for(it=1;it<=e;++it){if(it!=$){K=m(g(u(z,it),1,e),g(W,1,e));for(Q=1;Q<=e;++Q)z[it][Q]-=K*z[$][Q]}l[it]=F[it][S]+W[it]}continue t}if(!(R=c(e,i,H,N,L,W))){K=0;for(Q=1;Q<=e;++Q)K+=W[Q]*W[Q];if(K<.25*L*L){X=!0;break i}}T=0;var dt=0;N[I]=0;for(Q=1;Q<=I;++Q)T=N[Q]-m(g(p(H,Q),1,e),g(W,1,e)),Q<I&&(dt=Math.max(dt,T));var ut=(k=B[s][S]-dt)>0?T/k:0;if(A<1.5*ut){A=2*ut,v>=2&&console.log("Increase in PARMU to "+A);var pt=B[I][S]+A*B[s][S];for(it=1;it<=e;++it)if((K=B[I][it]+A*B[s][it])<pt||K==pt&&0==A&&B[s][it]<B[s][S])continue e}j=A*k-T;for(Q=1;Q<=e;++Q)l[Q]=F[Q][S]+W[Q];X=!0;continue t}Z=!1;var gt=B[I][S]+A*B[s][S]-(D+A*w);0==A&&D==B[I][S]&&(j=k,gt=B[s][S]-w);var mt=gt<=0?1:0;$=0;for(it=1;it<=e;++it)(K=Math.abs(m(g(u(z,it),1,e),g(W,1,e))))>mt&&($=it,mt=K),V[it]=K*U[it];var ft=E*L,yt=0;for(it=1;it<=e;++it)if(V[it]>=_||V[it]>=U[it]){if(K=G[it],gt>0){K=0;for(Q=1;Q<=e;++Q)K+=Math.pow(W[Q]-F[Q][it],2);K=Math.sqrt(K)}K>ft&&(yt=it,ft=K)}if(yt>0&&($=yt),0!=$){K=0;for(Y=1;Y<=e;++Y)F[Y][$]=W[Y],K+=z[$][Y]*W[Y];for(Q=1;Q<=e;++Q)z[$][Q]/=K;for(it=1;it<=e;++it)if(it!=$){K=m(g(u(z,it),1,e),g(W,1,e));for(Q=1;Q<=e;++Q)z[it][Q]-=K*z[$][Q]}for(Q=1;Q<=s;++Q)B[Q][$]=N[Q];if(gt>0&&gt>=.1*j)continue e}}while(0);if(O){if(L<=y){M=o;break t}var vt=0,xt=0;if((L*=.5)<=1.5*y&&(L=y),A>0){var Tt=0;for(Q=1;Q<=I;++Q){xt=vt=B[Q][S];for(Y=1;Y<=e;++Y)vt=Math.min(vt,B[Q][Y]),xt=Math.max(xt,B[Q][Y]);Q<=i&&vt<.5*xt&&(K=Math.max(xt,0)-vt,Tt=Tt<=0?K:Math.min(Tt,K))}0==Tt?A=0:xt-vt<A*Tt&&(A=(xt-vt)/Tt)}v>=2&&console.log("Reduction in RHO to "+L+"  and PARMU = "+A),2==v&&d(q,B[I][S],B[s][S],p(F,S),e)}else X=!1}}switch(M){case o:if(v>=1&&console.log("\nNormal return from subroutine COBYLA\n"),R)return v>=1&&d(q,D,w,l,e),{status:M,resmax:w};break;case r:v>=1&&console.log("\nReturn from subroutine COBYLA because the MAXFUN limit has been reached.\n");break;case h:v>=1&&console.log("\nReturn from subroutine COBYLA because rounding errors are becoming damaging.\n")}for(Q=1;Q<=e;++Q)l[Q]=F[Q][S];D=B[I][S],w=B[s][S],v>=1&&d(q,D,w,l,e);return{status:M,resmax:w}}((function(e,i,a,o){var r=n(e);s(a,1,r,0,e);var h=n(i),l=t(e,i,r,h);return s(h,0,o,1,i),l}),e,i,T,M,f,y,v,x);return s(M,1,l,0,e),C}function c(t,e,i,s,o,r){for(var h=0,l=0,c=0,d=a(1+t,1+t),u=n(2+e),f=n(2+e),y=n(1+t),v=n(1+t),x=n(2+e),T=n(2+e),M=e,C=0,b=1;b<=t;++b)d[b][b]=1,r[b]=0;var P=0,E=0;if(e>=1){for(var D=1;D<=e;++D)s[D]>E&&(E=s[D],P=D);for(D=1;D<=e;++D)T[D]=D,f[D]=E-s[D]}var w=!0;do{t:for(;;){(!w||w&&0==E)&&(P=M=e+1,T[M]=M,f[M]=0),w=!1;var S=0,I=0,L=0,A=0;e:do{var O=M==e?E:-m(g(r,1,t),g(p(i,M),1,t));if(0==I||O<S?(S=O,l=C,I=3):C>l?(l=C,I=3):--I,0==I)break t;var R=0;if(P<=C){if(P<C){var _=T[P],k=f[P];D=P;do{var j=T[V=D+1],N=m(g(p(d,D),1,t),g(p(i,j),1,t));h=Math.sqrt(N*N+u[V]*u[V]);var F=u[V]/h,z=N/h;u[V]=F*u[D],u[D]=h;for(b=1;b<=t;++b)h=F*d[b][V]+z*d[b][D],d[b][V]=F*d[b][D]-z*d[b][V],d[b][D]=h;T[D]=j,f[D]=f[V],D=V}while(D<C);T[D]=_,f[D]=k}if(--C,M>e){h=1/u[C];for(D=1;D<=t;++D)y[D]=h*d[D][C]}else{h=m(g(y,1,t),g(p(d,C+1),1,t));for(D=1;D<=t;++D)y[D]-=h*d[D][C+1]}}else{for(j=T[P],D=1;D<=t;++D)v[D]=i[D][j];var B=0;for(D=t;D>C;){N=0;var H=0;for(b=1;b<=t;++b)N+=h=d[b][D]*v[b],H+=Math.abs(h);var U=H+.1*Math.abs(N),G=H+.2*Math.abs(N);if((H>=U||U>=G)&&(N=0),0==B)B=N;else{var V=D+1;F=N/(h=Math.sqrt(N*N+B*B)),z=B/h;B=h;for(b=1;b<=t;++b)h=F*d[b][D]+z*d[b][V],d[b][V]=F*d[b][V]-z*d[b][D],d[b][D]=h}--D}if(0==B){R=-1;D=C;do{var W=0,J=0;for(b=1;b<=t;++b)W+=h=d[b][D]*v[b],J+=Math.abs(h);U=J+.1*Math.abs(W),G=J+.2*Math.abs(W);if(J<U&&U<G){if((h=W/u[D])>0&&T[D]<=e){var q=f[D]/h;(R<0||q<R)&&(R=q)}if(D>=2){var K=T[D];for(b=1;b<=t;++b)v[b]-=h*i[b][K]}x[D]=h}else x[D]=0}while(--D>0);if(R<0)break t;for(D=1;D<=C;++D)f[D]=Math.max(0,f[D]-R*x[D]);if(P<C){_=T[P],k=f[P],D=P;do{K=T[V=D+1],N=m(g(p(d,D),1,t),g(p(i,K),1,t));h=Math.sqrt(N*N+u[V]*u[V]);F=u[V]/h,z=N/h;u[V]=F*u[D],u[D]=h;for(b=1;b<=t;++b)h=F*d[b][V]+z*d[b][D],d[b][V]=F*d[b][D]-z*d[b][V],d[b][D]=h;T[D]=K,f[D]=f[V],D=V}while(D<C);T[D]=_,f[D]=k}if(0==(h=m(g(p(d,C),1,t),g(p(i,j),1,t))))break t;u[C]=h,f[P]=0,f[C]=R}else u[++C]=B,f[P]=f[C],f[C]=0;if(T[P]=T[C],T[C]=j,M>e&&j!=M){N=m(g(p(d,D=C-1),1,t),g(p(i,j),1,t));h=Math.sqrt(N*N+u[C]*u[C]);F=u[C]/h,z=N/h;u[C]=F*u[D],u[D]=h;for(b=1;b<=t;++b)h=F*d[b][C]+z*d[b][D],d[b][C]=F*d[b][D]-z*d[b][C],d[b][D]=h;T[C]=T[D],T[D]=j,h=f[D],f[D]=f[C],f[C]=h}if(M>e){h=1/u[C];for(D=1;D<=t;++D)y[D]=h*d[D][C]}else{j=T[C],h=(m(g(y,1,t),g(p(i,j),1,t))-1)/u[C];for(D=1;D<=t;++D)y[D]-=h*d[D][C]}}var Y=o*o,$=0,X=0;for(b=1;b<=t;++b)Math.abs(r[b])>=1e-6*o&&(Y-=r[b]*r[b]),$+=r[b]*y[b],X+=y[b]*y[b];if(Y<=0)break t;if(h=Math.sqrt(X*Y),Math.abs($)>=1e-6*h&&(h=Math.sqrt(X*Y+$*$)),L=A=Y/(h+$),M==e){G=L+.2*E;if(L>=(U=L+.1*E)||U>=G)break e;L=Math.min(L,E)}for(D=1;D<=t;++D)v[D]=r[D]+L*y[D];if(M==e){c=E,E=0;for(D=1;D<=C;++D){h=s[j=T[D]]-m(g(p(i,j),1,t),g(v,1,t)),E=Math.max(E,h)}}D=C;do{var Q=0,Z=0;for(b=1;b<=t;++b)Q+=h=d[b][D]*v[b],Z+=Math.abs(h);U=Z+.1*Math.abs(Q),G=Z+.2*Math.abs(Q);if((Z>=U||U>=G)&&(Q=0),x[D]=Q/u[D],D>=2)for(j=T[D],b=1;b<=t;++b)v[b]-=x[D]*i[b][j]}while(D-- >=2);M>e&&(x[C]=Math.max(0,x[C]));for(D=1;D<=t;++D)v[D]=r[D]+L*y[D];if(M>C)for(D=C+1;D<=M;++D){var tt=E-s[j=T[D]],et=E+Math.abs(s[j]);for(b=1;b<=t;++b)tt+=h=i[b][j]*v[b],et+=Math.abs(h);U=et+.1*Math.abs(tt),G=et+.2*Math.abs(tt);(et>=U||U>=G)&&(tt=0),x[D]=tt}R=1,P=0;for(D=1;D<=M;++D)x[D]<0&&(h=f[D]/(f[D]-x[D]))<R&&(R=h,P=D);h=1-R;for(D=1;D<=t;++D)r[D]=h*r[D]+R*v[D];for(D=1;D<=M;++D)f[D]=Math.max(0,h*f[D]+R*x[D]);M==e&&(E=c+R*(E-c))}while(P>0);if(L==A)return!0}}while(M==e);return!1}function d(t,e,i,n,a){console.log("NFVALS = "+t+"  F = "+e+"  MAXCV = "+i),console.log("X = "+g(n,1,a))}function u(t,e){for(var i=t[0].length,a=n(i),s=0;s<i;++s)a[s]=t[e][s];return a}function p(t,e){for(var i=t.length,a=n(i),s=0;s<i;++s)a[s]=t[s][e];return a}function g(t,e,i){for(var a=n(i-e+1),s=0,o=e;o<=i;++o,++s)a[s]=t[o];return a}function m(t,e){for(var i=0,n=0;n<t.length;++n)i+=t[n]*e[n];return i}},function(t,e){t.exports=__WEBPACK_EXTERNAL_MODULE__65__},function(t,e){function i(t,e,i){var n,a,s,o,r;function h(){var l=Date.now()-o;l<e&&l>=0?n=setTimeout(h,e-l):(n=null,i||(r=t.apply(s,a),s=a=null))}null==e&&(e=100);var l=function(){s=this,a=arguments,o=Date.now();var l=i&&!n;return n||(n=setTimeout(h,e)),l&&(r=t.apply(s,a),s=a=null),r};return l.clear=function(){n&&(clearTimeout(n),n=null)},l.flush=function(){n&&(r=t.apply(s,a),s=a=null,clearTimeout(n),n=null)},l}i.debounce=i,t.exports=i},,,,function(t,e){var i="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(i){var n=new Uint8Array(16);t.exports=function(){return i(n),n}}else{var a=new Array(16);t.exports=function(){for(var t,e=0;e<16;e++)0==(3&e)&&(t=4294967296*Math.random()),a[e]=t>>>((3&e)<<3)&255;return a}}},function(t,e){for(var i=[],n=0;n<256;++n)i[n]=(n+256).toString(16).substr(1);t.exports=function(t,e){var n=e||0,a=i;return[a[t[n++]],a[t[n++]],a[t[n++]],a[t[n++]],"-",a[t[n++]],a[t[n++]],"-",a[t[n++]],a[t[n++]],"-",a[t[n++]],a[t[n++]],"-",a[t[n++]],a[t[n++]],a[t[n++]],a[t[n++]],a[t[n++]],a[t[n++]]].join("")}}])}));